;(function (g) {
  var f = window.AmazonUIPageJS || window.P,
    n = f._namespace || f.attributeErrors,
    a = n ? n('CommonDetailPageScripts', '') : f
  a.guardFatal
    ? a.guardFatal(g)(a, window)
    : a.execute(function () {
        g(a, window)
      })
})(function (g, f, n) {
  g.when('jQuery', 'jumpLink').execute(function (a, b) {
    var f = a('#miniATFUDP'),
      k = 0
    0 < f.length && (k = f.height() + 9)
    0 < a('#reviewStarsLinkedCustomerReviews').length &&
      b.bind('#reviewStarsLinkedCustomerReviews', 10, k)
    0 < a('#askATFLink').length && b.bind('#askATFLink', 10, k)
    g.when('cf').execute(function (g) {
      0 < a("#important-information a[href\x3d'#legal-disclaimer']").length &&
        b.bind("#important-information a[href\x3d'#legal-disclaimer']", 10, k, !0)
    })
    b.bind('#seeMoreDetailsLink', 300, k)
  })
  ;('use strict')
  g.when('A', 'jQuery', 'ImageBlockATF', 'jumpLink', 'cf').register(
    'miniATFUtils',
    function (a, b, n, k) {
      function x(e) {
        ;(r && !e) ||
          t ||
          ((e = new Date().getTime() - y),
          (e = 50 > e ? 50 - e : 10),
          (r = 1),
          (r = 0),
          (y = new Date().getTime()),
          setTimeout(function () {
            var e = u.scrollTop(),
              a = b('#miniATFUDP')
            if (0 < a.length) {
              var c = z
              if ('T1' === c) {
                c = b('#sims_fbt')
                if (0 >= c.length || 0 >= c.height()) c = b('#buyxgety_feature_div')
                var d = c
                c = Number.MAX_VALUE
                if (d && 0 < d.length) {
                  var l = d.height()
                  d = d.offset()
                  l && d && (c = d.top + l)
                }
                c = Math.min(c, 1200)
              } else if ('T2' === c) {
                c =
                  '#product-details-grid_feature_div #prodDetails #important-information_feature_div #importantInformation #detail-bullets #detail_bullets_id #technical-data #technicalSpecifications_feature_div #productDescription #product-description-iframe #dpx-btf-hlcx-comparison_feature_div #HLCXComparisonWidget_feature_div'.split(
                    ' ',
                  )
                d = Number.MAX_VALUE
                for (l = 0; l < c.length; l++) {
                  var h = b(c[l])
                  if (h && 0 < h.length && 0 < h.height()) {
                    var m = Number.MAX_VALUE
                    h && 0 < h.length && (h = h.offset()) && (m = h.top)
                    m < d && (d = m)
                  }
                }
                c = Math.min(d, 1700) - 100
              } else c = void 0
              e > c
                ? !v && a.is(':hidden') && (a.removeClass('a-hidden'), a.slideDown(200))
                : (a.slideUp(200), (v = 0))
            }
          }, e))
      }
      k = b('#miniATFUDP')
      var A = b('#miniATFPartialSelection')[0],
        p = b('.twister-dropdown-highlight')[0]
      if (!(0 >= k.length)) {
        var v = 0,
          y = 0,
          r = 0,
          q = {},
          t = 0,
          w = 0,
          z = 'T2'
        q.setMiniATFShowHeight = function (b) {
          z = b
        }
        q.setMiniATFScrollUpHeight = function (a) {
          w = 0
          'T1' === a &&
            ((a = b('#productTitle')), 0 < a.length && (a = a.offset()) && (w = a.top - 20))
        }
        b('body').delegate('.go-to-top', 'click', function () {
          b('body, html').animate({ scrollTop: w }, 300)
          v = 1
          A &&
            p &&
            (b(p).removeClass('transparentTwisterDropdownBorder'),
            b(p).addClass('highlightTwisterDropdownBorder'))
          return !1
        })
        A &&
          p &&
          b(p).click(function () {
            b(this).addClass('transparentTwisterDropdownBorder')
            b(this).removeClass('highlightTwisterDropdownBorder')
          })
        var u = b(f)
        u.scroll(function () {
          x(0)
        })
        u.resize(function () {
          x(1)
        })
        g.when('ImageBlockBTF').execute(function (e) {
          var g = function (a) {
              var m = a.getState().selected_variations
              if (m) {
                var c = '',
                  d = a.getState().variation_display_labels
                b.each(e.visualDimensions, function (a, b) {
                  a = 1 === e.gIsNewTwister ? b : d[b]
                  m[a] && (c += ' ' + m[a])
                })
                return c && c.substring(1)
              }
            },
            f = e.defaultColor,
            c = f,
            d = e.landingAsinColor,
            l,
            h = b('#miniATF_image')
          0 < h.length && (l = h.attr('src'))
          q.updateMiniATFDiv = function () {
            t = 0
            var a = b('#miniATF_image')
            0 < a.length && l && a.attr('src', l)
          }
          a.on('image-block-twister-swatch-click', function (a, b, h, k) {
            t = 1
            a = (a = k ? k : g(b)) && '' !== a ? a : f
            a === d && (a = f)
            a !== c &&
              ((l =
                (b = a !== f && a !== d ? e : n) &&
                b.colorImages &&
                b.colorImages[a] &&
                0 < b.colorImages[a].length &&
                b.colorImages[a][0]
                  ? b.colorImages[a][0].large
                  : null),
              (c = a))
          })
        })
        return q
      }
    },
  )
  ;('use strict')
  g.when('ueCount', 'jQuery').execute(function (a, b) {
    b('#miniATF_BackToTopLink').click(function () {
      a.incrementCounterByOne('sl_back_to_top_button_click_count')
    })
  })
  ;('use strict')
  g.when('jQuery', 'dp-util-cookie', 'cf').execute(function (a, b) {
    '000-0000000-8675309' === a('#addToCart').find('input[name\x3d"session-id"]').val() &&
      a('#addToCart').find('input[name\x3d"session-id"]').val(b('session-id'))
  })
})
/* ******** */
;(function (e) {
  var g = window.AmazonUIPageJS || window.P,
    q = g._namespace || g.attributeErrors,
    a = q ? q('DetailPageCommonScripts', '') : g
  a.guardFatal
    ? a.guardFatal(e)(a, window)
    : a.execute(function () {
        e(a, window)
      })
})(function (e, g, q) {
  e.when('A', 'jQuery').register('jumpLink', function (a, b) {
    return {
      bind: function (a, f, d, u) {
        try {
          ;(f = f || 1e3),
            (d = d || 0),
            b('body').delegate(a, 'click', function (c) {
              try {
                var e = b(a)
                if (e.get(0)) {
                  var h = e.attr('href')
                  h &&
                    '#' === h.charAt(0) &&
                    ((h = u && 0 === b(h).length ? "[name\x3d'" + h.substring(1) + "']" : h),
                    0 !== b(h).length &&
                      (c.preventDefault(),
                      b('html, body').animate({ scrollTop: b(h).offset().top - d }, f)))
                }
              } catch (m) {
                g.ueLogError &&
                  g.ueLogError(m, {
                    logLevel: 'FATAL',
                    attribution: 'jumpLink',
                    message: '[JumpLink - Error in executing click handler]',
                  })
              }
            })
        } catch (k) {
          g.ueLogError &&
            g.ueLogError(k, {
              logLevel: 'FATAL',
              attribution: 'jumpLink',
              message: '[JumpLink - Error in binding click handler]',
            })
        }
      },
    }
  })
  ;('use strict')
  e.when('A').execute(function (a) {
    a.declarative('mySummaryExpander_1', 'click', function (a) {
      if ((a = document.getElementById('summaryText')))
        a.style.display = 'block' === a.style.display ? 'none' : 'block'
    })
  })
  ;('use strict')
  e.when('A').register('dp-log-utils', function (a) {
    a.on('dpLogFatalsEvent', function (a, c, f) {
      g.ueLogError && g.ueLogError({ message: a }, { logLevel: c, attribution: f })
    })
  })
  ;('use strict')
  e.register('dp-client-counter', function () {
    var a = function () {}
    g.ue && g.ue.count && 'function' === typeof g.ue.count && (a = g.ue.count)
    return {
      set: function (b, c) {
        'undefined' !== typeof c && a(b, c)
      },
      get: function (b) {
        return a(b)
      },
      inc: function (b) {
        a(b, (a(b) || 0) + 1)
      },
    }
  })
  ;('use strict')
  e.when('dp-client-counter').register('dp-click-counter', function (a) {
    return {
      record: function (b, c) {
        b &&
          b.addEventListener('click', function () {
            a.inc(c + '-clicked')
          })
      },
    }
  })
  ;('use strict')
  e.when('A').register('cache', function (a) {
    function b() {
      this.data = {}
    }
    function c(b) {
      var f = b
      if ('object' === typeof b) {
        var c = ''
        f = ''
        a.each(b, function (a, b) {
          f += c + b + '\x3d' + a
          c = '\x26'
        })
      }
      return f
    }
    b.prototype = {
      put: function (a, b) {
        a = c(a)
        this.data[a] = b
      },
      get: function (a) {
        a = c(a)
        return this.data[a]
      },
      exists: function (a) {
        return c(a) in this.data
      },
    }
    return b
  })
  ;('use strict')
  e.register('dp-util-cookie', function () {
    return function (a) {
      a += '\x3d'
      for (var b = decodeURIComponent(document.cookie).split(';'), c = 0; c < b.length; c++) {
        var f = b[c]
        f = f.replace(/^\s+/, '')
        if (0 === f.indexOf(a)) return f.substring(a.length, f.length)
      }
      return ''
    }
  })
  e.when('jQuery').register('quanityChangePriceUpdate', function (a) {
    return { ajaxCall: function (a) {} }
  })
  ;('use strict')
  e.when('A', 'jQuery', 'a-popover', 'a-dropdown', 'ready').register(
    'moq-core',
    function (a, b, c, f) {
      function d(a) {
        return 0 < a.length && 0 < a.find("div[data-name\x3d'quantity.improvedMOQ']").length
      }
      function e() {
        return b(n.join(', '))
      }
      function k(a) {
        return 'locked' === a.find("div[data-name\x3d'quantity.improvedMOQ']").attr('moq-lock')
      }
      function g() {
        return (
          b(h.join(', ')).length
            ? h
            : b(m.join(', ')).length
              ? m
              : b(t.join(', ')).length
                ? t
                : ['#buybox']
        )
          .map(function (a) {
            return b(a)
          })
          .filter(d)
      }
      var h = [
          'div[id^\x3dnewAccordionRow]',
          '#snsAccordionRowMiddle',
          '#snsAccordionRowMobileMiddle',
          '#snsAccordionRowMobileAppMiddle',
        ],
        m = ['#oneTimeBuyBox', '#snsBuyBox'],
        t = ['#toggleBuyBox \x3e #sns', '#toggleBuyBox \x3e #onetime'],
        n = [
          '#snsBuyBox',
          '#toggleBuyBox \x3e #sns',
          '#snsAccordionRowMiddle',
          '#snsAccordionRowMobileMiddle',
          '#snsAccordionRowMobileAppMiddle',
        ],
        p =
          '#add-to-cart-button;#mobb\\.addToCart;#buy-now-button;#one-click-button;#oneClickBuyButton;#prime-toggle-main;#rcx-subscribe-submit-button input;#rcx-subscribe-submit-button button'.split(
            ';',
          )
      return {
        isSnsLocked: function () {
          var a = e()
          return k(a)
        },
        isLocked: k,
        getSnsSubscriptionContainer: e,
        offerContainerHasMoq: d,
        findMoqOfferContainers: g,
        findMoqOfferContainerWithDomElement: function (a) {
          var b = g().filter(function (b) {
            return b[0].contains(a)
          })
          return 0 === b.length ? null : b[0]
        },
        tweakDisplayTextForMoqQuantityDropdown: function (a) {
          var b = f.getSelect(a).getOptions(0),
            c = b.info()[0]
          c.selected
            ? b.update({ text: c.value })
            : b.update({ text: a.children('option[data-displayText]').attr('data-displayText') })
        },
        lockSubmission: function (a, c, f) {
          var d = a.find(p.join(', ')),
            e = a.find("div[data-name\x3d'quantity.improvedMOQ']")
          d.each(function () {
            'hidden' !== b(this).prop('type') &&
              (this.hasAttribute('moq-original-button-type') ||
                b(this).attr('moq-original-button-type', b(this).prop('type')),
              e.attr('moq-lock', 'locked'),
              b(this).prop('type', 'button'),
              b(this).bind('click.moq', c),
              'function' === typeof f && f(b(this)))
          })
        },
        unlockSubmission: function (a, c) {
          var f = a.find(p.join(', ')),
            d = a.find("div[data-name\x3d'quantity.improvedMOQ']")
          f.each(function () {
            'button' === b(this).prop('type') &&
              (d.attr('moq-lock', 'unlocked'),
              b(this).prop('type', b(this).attr('moq-original-button-type')),
              b(this).unbind('click.moq'),
              'function' === typeof c && c(b(this)))
          })
        },
      }
    },
  )
  ;('use strict')
  e.when('A', 'dp-pre-atc-monitor').execute('dp-pre-atc-execution', function (a, b) {
    a.declarative('dp-pre-atc-declarative', 'click', function (c) {
      var f = b.getInstance()
      a.$.isEmptyObject(f.preAddToCartHeroFunctionRegister.heroFunctionMap) ||
        a.$.isEmptyObject(f.getHeroName()) ||
        f.triggerHeroFunction(c)
    })
  })
  ;('use strict')
  e.when('A', 'ready').register('dp-pre-atc-hero-candidates', function (a) {
    var b = a.state('dp-pre-atc-hero') === q ? '' : a.state('dp-pre-atc-hero').heroName
    return {
      getHeroName: function () {
        return b
      },
      setHeroName: function (a) {
        a && (b = a)
      },
      hasHeroName: function () {
        return !a.$.isEmptyObject(b)
      },
      getHeroCandidates:
        a.state('dp-pre-atc-hero-candidates') === q ? [] : a.state('dp-pre-atc-hero-candidates'),
    }
  })
  ;('use strict')
  e.when('A').register('dp-pre-atc-hero-function-register', function (a) {
    function b() {
      this.heroFunctionMap = {}
      this.registerHero = function (a, b) {
        if (a && 'function' === typeof b) this.heroFunctionMap[a] = b
        else
          throw Error(
            'PRE-ATC-ERROR-REGISTER-1 Failed to register as your Hero name might be invalid or triggerFunction is not function type.',
          )
      }
    }
    var c
    return {
      getInstance: function () {
        c || (c = new b())
        return c
      },
    }
  })
  ;('use strict')
  e.when('A', 'dp-pre-atc-hero-candidates', 'dp-pre-atc-hero-function-register').register(
    'dp-pre-atc-monitor',
    function (a, b, c) {
      function f(a, b) {
        this.preAddToCartHeroCandidates = a
        this.preAddToCartHeroFunctionRegister = b
        this.logAttribution = 'dp_pre_atc_monitor'
      }
      f.prototype = {
        getHeroName: function () {
          return this.preAddToCartHeroCandidates.getHeroName()
        },
        updateHero: function (b) {
          b
            ? -1 < this.preAddToCartHeroCandidates.getHeroCandidates.indexOf(b)
              ? (this.preAddToCartHeroCandidates.setHeroName(b),
                a.state.replace('dp-pre-atc-hero', null),
                (b = g.ue),
                'undefined' !== typeof b &&
                  'undefined' !== typeof b.count &&
                  b.count(
                    'dpOffers:preatc:updateHero',
                    (b.count('dpOffers:preatc:updateHero') || 0) + 1,
                  ))
              : a.trigger(
                  'dpLogFatalsEvent',
                  'PRE-ATC-ERROR-MONITOR-1 Failed to update Hero to ' +
                    b +
                    ' as it is not registered on DPX side.',
                  'ERROR',
                  this.logAttribution,
                )
            : a.trigger(
                'dpLogFatalsEvent',
                'PRE-ATC-ERROR-MONITOR-2 Empty Hero name, Hero has been deleted.',
                'WARN',
                this.logAttribution,
              )
        },
        triggerHeroFunction: function (b) {
          if (
            !a.$.isEmptyObject(this.preAddToCartHeroFunctionRegister.heroFunctionMap) &&
            this.preAddToCartHeroCandidates.hasHeroName()
          ) {
            var c = this.getHeroName()
            try {
              this.preAddToCartHeroFunctionRegister.heroFunctionMap[c](b)
            } catch (v) {
              a.trigger(
                'dpLogFatalsEvent',
                "PRE-ATC-ERROR-MONITOR-3 PreAddToCartMonitor could not find Hero's function.",
                'ERROR',
                this.logAttribution,
              )
            }
          } else
            a.trigger(
              'dpLogFatalsEvent',
              'PRE-ATC-ERROR-MONITOR-4 PreAddToCartMonitor tried to trigger Hero function when Hero does not exist.',
              'ERROR',
              this.logAttribution,
            )
        },
      }
      f.prototype.constructor = f
      var d
      return {
        getInstance: function () {
          d || (d = new f(b, c.getInstance()))
          return d
        },
      }
    },
  )
  ;('use strict')
  e.when('dp-accordion-click-counter').execute(
    'gsbb-accordion-click-counter-desktop',
    function (a) {
      a.recordAccordionClick('gsbb', 'desktop')
    },
  )
  ;('use strict')
  e.when('dp-button-click-counter').execute('gsbb-button-click-counter-desktop', function (a) {
    a.recordButtonClick('desktop_buybox', 'gsbb', 'desktop')
  })
  ;('use strict')
  e.when('A', 'dp-client-counter', 'dp-get-buybox-element-ids', 'ready').register(
    'dp-accordion-click-counter',
    function (a, b, c) {
      return {
        recordAccordionClick: function (c, d) {
          var f = c + ':' + d + ':'
          a.on('a:accordion:buybox-accordion:select', function (a) {
            b.inc(f + a.selectedRow.rowName + ':click')
          })
        },
      }
    },
  )
  ;('use strict')
  e.when('A', 'dp-client-counter', 'dp-get-buybox-element-ids', 'ready').register(
    'dp-button-click-counter',
    function (a, b, c) {
      var f = a.$
      return {
        recordButtonClick: function (a, e, g) {
          ;(a = c.getAccordionRowIds(a)) &&
            a.length &&
            a.forEach(function (a) {
              var d = c.getButtonIds(a)
              d &&
                d.length &&
                d.forEach(function (c) {
                  var d = e + ':' + g + ':' + a + ':' + c + ':click'
                  f('#' + c).click(function () {
                    b.inc(d)
                  })
                })
            })
        },
        recordSingleOfferButtonClick: function (a, e, g) {
          if (a) {
            var d = c.getButtonIds(a)
            d &&
              d.length &&
              d.forEach(function (c) {
                var d = e + ':' + g + ':' + a + ':' + c + ':click'
                f('#' + c).click(function () {
                  b.inc(d)
                })
              })
          }
        },
      }
    },
  )
  ;('use strict')
  e.when('A', 'ready').register('dp-get-buybox-element-ids', function (a) {
    function b(a) {
      return c(a).length
        ? c(a)
            .map(function () {
              return this.id
            })
            .get()
        : []
    }
    var c = a.$
    return {
      getAccordionRowIds: function (a) {
        return b('#' + a + ' [data-a-accordion-row-name]')
      },
      getButtonIds: function (a) {
        return b('#' + a + ' .a-button-input')
      },
    }
  })
  ;('use strict')
  e.when('A', 'ready').register('dp-get-offerDisplay-container', function (a) {
    var b = a.$
    return {
      getOfferDisplayContainerByElement: function (a) {
        var c = [
            '#buyBoxAccordion [data-a-accordion-row-name]',
            '[id^\x3dgsod_singleOfferDisplay]',
            '[id^\x3dtab_][id*\x3d_buybox_group_]',
            '#buybox',
          ],
          d = b('body')
        a && a.closest && (d = a.closest(c.join(',')))
        return d.length ? d : b('body')
      },
    }
  })
  ;('use strict')
  e.register('dp-csm-metrics', function () {
    return {
      updateCount: function (a) {
        var b = g.ue
        b && b.count && 'string' === typeof a && b.count(a, (b.count(a) || 0) + 1)
      },
      startLatencyTime: function (a) {
        'function' === typeof uet && 'string' === typeof a && uet('bb', a, { wb: 1 })
      },
      recordLatencyTime: function (a) {
        'function' === typeof uex && 'string' === typeof a && uex('ld', a, { wb: 1 })
      },
    }
  })
  ;('use strict')
  e.register('add-to-cart-constants', function () {
    return {
      PREFIX: 'items',
      ITEM_TYPES: { BASE: 'base' },
      PARAMETER_PATHS: {
        ASIN: ['asin'],
        OFFER_LISTING_ID: ['offerListingId'],
        QUANTITY: ['quantity'],
        GIFTOPTIONS: ['additionalParameters', 'giftOptions', 'includeGiftReceipt'],
        DEVICEPREREGISTRATION: ['additionalParameters', 'devicePreregistration', 'selected'],
      },
      CLIENT_NAME: 'clientName',
      CSRF_TOKEN: 'anti-csrftoken-a2z',
    }
  })
  ;('use strict')
  e.when('A', 'add-to-cart-constants').register('add-to-cart-parameter-name', function (a, b) {
    return {
      constructParameterName: function (c, f, d) {
        if ('string' === typeof c && 'number' === typeof f && 0 <= f && Array.isArray(d)) {
          var e = b.PREFIX
          e += '[' + (f + '.' + c) + ']'
          d.forEach(function (a) {
            e += '[' + a + ']'
          })
          return e
        }
        a.trigger(
          'dpLogFatalsEvent',
          '[Invalid parameters used to construct add to cart parameter]',
          'WARN',
          'addtocart_construct_parameter_error',
        )
      },
    }
  })
  ;('use strict')
  e.when('add-to-cart-constants').register('offersx-csrf-utils', function (a) {
    function b(b) {
      var c = "input[name\x3d'" + a.CSRF_TOKEN + "']"
      return (c = b ? c + "[id\x3d'" + b + "']" : c)
        ? (b = document.querySelector(c))
          ? b.value
          : ''
        : ''
    }
    function c(b, c) {
      c instanceof Object || (c = {})
      b && '' !== b && (c[a.CSRF_TOKEN] = b)
      return c
    }
    return {
      getCSRFToken: b,
      setCSRFHeader: c,
      setCSRFHeaderFromId: function (a, d) {
        a = b(a)
        return c(a, d)
      },
    }
  })
  ;('use strict')
  e.when('A', 'hdp-invite-button-ajax-handler', 'atf').execute(
    'hdp-invite-button-action-handler',
    function (a, b) {
      a.declarative('invite-button', 'click', function (a) {
        a.$event.preventDefault()
        b.hdpInviteButtonAjaxHandle(a.data, a.action)
      })
      a.declarative('request-invite', 'click', function (a) {
        a.$event.preventDefault()
        b.hdpInviteButtonAjaxHandle(a.data, a.action)
      })
      a.declarative('notify-details', 'click', function (a) {
        a.$event.preventDefault()
        b.hdpInviteButtonAjaxHandle(a.data, a.action)
      })
    },
  )
  ;('use strict')
  e.when('A', 'dp-client-counter', 'hdp-ajax-success-dialog-handler', 'a-button', 'atf').register(
    'hdp-invite-button-ajax-handler',
    function (a, b, c, e) {
      var d = a.$,
        f,
        k,
        q
      c.initialize()
      return {
        hdpInviteButtonAjaxHandle: function (c, m) {
          c = d('#hdp-ib-ajax-endpoint')
          var h = d('#hdp-ib-csrf-token'),
            n = d('#hdp-ib-signedIn'),
            p = d('#hdp-sign-in-url'),
            r = d('#hdp-language'),
            l = d('#hdp-ib-post-click-display-string')
          p = p ? p.val() : '/gp/sign-in.html'
          n = n ? 'true' === n.val() : !1
          r = r ? r.val() : 'en_US'
          'notify-details' === m
            ? ((f = 'iod:prime:signup:details:click'), (k = 'notify-program-details'))
            : ((f = 'hdp:request:invitation:click'), (k = 'request-invite'))
          q = l ? l.val() : 'Details emailed'
          if (n && c && h) {
            c.val() && (l = c.val().split('/')) && 4 < l.length && b.inc(f + ':' + l[l.length - 1])
            b.inc(f)
            h = {
              'Accept-Language': r,
              Accept:
                'application/vnd.com.amazon.api+json; type\x3d"aapi.highdemandproductcontracts.' +
                k +
                '/v1"',
              'x-api-csrf-token': h.val(),
            }
            if ((l = document.querySelector('meta[name\x3d"encrypted-slate-token"]')))
              h['x-amzn-encrypted-slate-token'] = l.content
            d.ajax({
              url: 'https://' + c.val(),
              type: 'POST',
              contentType:
                'application/vnd.com.amazon.api+json; type\x3d"aapi.highdemandproductcontracts.' +
                k +
                '.request/v1"',
              headers: h,
              data: JSON.stringify({}),
              xhrFields: { withCredentials: !0 },
              timeout: 1e4,
              success: function (b) {
                if ('request-invite' === m || 'invite-button' === m) {
                  b = d('#shippingMessageInsideBuyBox_feature_div')
                  var c = d('#availabilityInsideBuyBox_feature_div'),
                    f = d('#tabular_feature_div'),
                    g = d('#hdp-detail-no-requested-id'),
                    h = d('#hdp-invite-button'),
                    k = d('#hdp-detail-expired-id'),
                    l = d('#hdp-detail-requested-id'),
                    n = d('#iod-request-invite-success-message-trigger'),
                    p = d('#hdpInviteButton_feature_div').attr('data-csa-c-asin')
                  'invite-button' === m && f && f.hide()
                  b && b.hide()
                  c && c.hide()
                  g && g.hide()
                  h && h.hide()
                  k && k.hide()
                  l && l.removeClass('aok-hidden')
                  n.length && n.click()
                  a.trigger(
                    'updateCustomPageRefreshParams',
                    p,
                    'hdpCustomerAction',
                    'requestInvite',
                  )
                } else
                  'notify-details' === m &&
                    ((b = d('#hdpInviteButton_feature_div').attr('data-csa-c-asin')),
                    (c = e('#hdp-invite-button')),
                    c.isEmpty() ||
                      (c.disable().text(q),
                      a.trigger(
                        'updateCustomPageRefreshParams',
                        b,
                        'hdpCustomerAction',
                        'notifyDetails',
                      )))
              },
              error: function () {
                a.trigger(
                  'dpLogFatalsEvent',
                  'HDP Invite Button Ajax call failed',
                  'ERROR',
                  'HDPAjaxFailure',
                )
                var b = d('#hdp-ajax-failure-modal')
                b && b.click()
              },
            })
          } else
            n
              ? a.trigger(
                  'dpLogFatalsEvent',
                  'HDP Invite Button Ajax data is missing',
                  'ERROR',
                  'HDPAjaxFailure',
                )
              : (g.location.href = p)
        },
      }
    },
  )
  ;('use strict')
  e.when('dp-button-click-counter').execute('hdp-button-click-counter-desktop', function (a) {
    a.recordSingleOfferButtonClick('hdp_buybox_desktop', 'hdp', 'desktop')
  })
  e.when('A', 'a-modal').register('hdp-ajax-success-dialog-handler', function (a, b) {
    return {
      initialize: function () {
        var b = this
        a.declarative('close-iod-request-invite-success-dialog', 'click', function () {
          b.hide()
        })
      },
      hide: function () {
        var a = b.get('iodRequestInviteSuccessMessageModal')
        a && a.hide()
      },
    }
  })
})
/* ******** */
;(function (n) {
  var l = window.AmazonUIPageJS || window.P,
    p = l._namespace || l.attributeErrors,
    g = p ? p('DetailPageLatencyAssets', '') : l
  g.guardFatal
    ? g.guardFatal(n)(g, window)
    : g.execute(function () {
        n(g, window)
      })
})(function (n, l, p) {
  n.when('dp-interactive-feature-component-base', 'dp-click-to-ci-utils', 'A').register(
    'dp-interactive-feature',
    function (g, d, a) {
      function e(a, f) {
        this.name = a
        this._baseComponents = {}
        this.getComponent('default', f)
      }
      function m(a) {
        return k.isPlainObject(a) && a.hasComponents && k.isArray(a.components)
      }
      var k = a.$
      e.prototype = {
        getTimeToInteractivity: function (h, f) {
          h = h || {}
          var c,
            b,
            e = 0,
            g = !1,
            l = []
          m(h)
            ? (a.each(
                h.components,
                function (a) {
                  k.isPlainObject(a) &&
                    d.isValidNonEmptyString(a.name) &&
                    ((c = this.getComponent(a.name, f)),
                    (b = c.getTimeToInteractivity(f, a.events)) && b.interactive
                      ? b.interactiveTime > e && (e = b.interactiveTime)
                      : l.push(a.name))
                },
                this,
              ),
              l.length || (g = !0))
            : ((b = this.getComponent('default', f).getTimeToInteractivity(f, h.events)),
              (g = b.interactive),
              (e = b.interactiveTime))
          return { interactive: g, interactiveTime: g ? e : 0 }
        },
        getComponent: function (a, f) {
          a = a.toLowerCase()
          this._baseComponents[a] || (this._baseComponents[a] = new g(a, f))
          return this._baseComponents[a]
        },
        updateFeatureInformation: function (h, f) {
          var c = { timestamp: h.timestamp, type: h.type, options: {} },
            b = !1
          m(h.options)
            ? a.each(
                h.options.components,
                function (a) {
                  k.isPlainObject(a) &&
                    d.isValidNonEmptyString(a.name) &&
                    ((c.options = a),
                    (a = this.getComponent(a.name, f).updateComponentInformation(c, f)),
                    (b = b || a))
                },
                this,
              )
            : ((c.options = h.options || {}),
              (b = this.getComponent('default', f).updateComponentInformation(c, f)))
          return b
        },
        updateRenderTime: function (h, f, c) {
          h = h || {}
          var b
          m(h)
            ? a.each(
                h.components,
                function (a) {
                  k.isPlainObject(a) &&
                    d.isValidNonEmptyString(a.name) &&
                    (b = this.getComponent(a.name)) &&
                    c &&
                    b.updateRenderTime(c, f)
                },
                this,
              )
            : this.getComponent('default', c).updateRenderTime(c, f)
        },
        resetFeatureInfo: function (h, f) {
          h = h || {}
          var c
          m(h)
            ? a.each(
                h.components,
                function (b) {
                  k.isPlainObject(b) &&
                    d.isValidNonEmptyString(b.name) &&
                    (c = this.getComponent(b.name)) &&
                    f &&
                    c.resetComponentInfo(f)
                },
                this,
              )
            : this.getComponent('default', f).resetComponentInfo(f)
        },
      }
      return e
    },
  )
  n.when(
    'A',
    'dp-interactive-feature',
    'dp-click-to-ci',
    'dp-critical-features',
    '3p-promise',
    'dp-click-to-ci-utils',
  ).register('dp-time-to-interactive', function (g, d, a, e, m, k) {
    var h = g.$
    return {
      _features: {},
      criticalFeatures: {},
      _clickToCI: {},
      pageType: 'glance',
      getTimeToInteractivity: function (a, c) {
        a = a || {}
        var b = {
            features: a,
            longPoleFeatureName: '',
            interactiveTime: 0,
            allFeaturesInteractive: !1,
            nonInteractiveFeatures: [],
          },
          e = []
        h.isPlainObject(a) &&
          !h.isEmptyObject(a) &&
          (g.each(
            a,
            function (c, a) {
              a = a.toLowerCase()
              var f = this._features[a]
              f
                ? ((f = f.getTimeToInteractivity(c, this.pageType)),
                  f.interactive
                    ? ((c.interactiveTime = f.interactiveTime),
                      f.interactiveTime > b.interactiveTime &&
                        ((b.interactiveTime = f.interactiveTime), (b.longPoleFeatureName = a)))
                    : e.push(a))
                : e.push(a)
            },
            this,
          ),
          e.length || (b.allFeaturesInteractive = !0),
          (b.nonInteractiveFeatures = e))
        return b
      },
      updateFeatures: function (a) {
        a = a || []
        var c = !1
        h.isArray(a) &&
          (g.each(
            a,
            function (b) {
              var a = !1
              h.isPlainObject(b) &&
                k.isValidNonEmptyString(b.name) &&
                b.timestamp &&
                (a = this.getFeatureObject(b.name).updateFeatureInformation(b, this.pageType))
              c = c || a
            },
            this,
          ),
          this._getClickToCIObj(this.pageType).getMetricInfo().allFeaturesInteractive ||
            this.updateMetricInfo())
        return c
      },
      getFeatureObject: function (a) {
        a = a.toLowerCase()
        this._features[a] || (this._features[a] = new d(a, this.pageType))
        return this._features[a]
      },
      updateRenderTime: function (a) {
        if (a && 'twisterupdate' === this.pageType) {
          var c = this.getCriticalFeatureObj().getCriticalFeaturesPromise(),
            b = this._getClickToCIObj(this.pageType).getMetricInfo(),
            e = this
          c &&
            c.then(function (c) {
              h.isPlainObject(c) &&
                !h.isEmptyObject(c) &&
                g.each(
                  c,
                  function (c, b) {
                    b = b.toLowerCase()
                    ;(b = e._features[b]) && b.updateRenderTime(c, a, e.pageType)
                  },
                  this,
                )
              b.allFeaturesInteractive || e.updateMetricInfo(!0)
            })
        }
      },
      updatePage: function (f) {
        if (f) {
          var c = this.pageType
          this.pageType = f.toLowerCase()
          var b = this.getCriticalFeatureObj().getCriticalFeatures()
          k.logCounter('ClickToCITwisterUpdateTotalCount')
          b &&
            this._clickToCI[c] &&
            !this._clickToCI[c].isResolved() &&
            this._clickToCI[c].reject(Error('ClicktoCI not available '))
          this._resetFeatureInfo(b, f)
          this._clickToCI[this.pageType] = new a()
          this.criticalFeatures = new e()
          'twisterupdate' === this.pageType &&
            this.criticalFeatures.setIgnoreCriticalFeatures('twister')
        }
      },
      _resetFeatureInfo: function (a, c) {
        c = c.toLowerCase()
        a = a || {}
        h.isPlainObject(a) &&
          !h.isEmptyObject(a) &&
          g.each(
            a,
            function (a, f) {
              f = f.toLowerCase()
              ;(f = this._features[f]) && f.resetFeatureInfo(a, c)
            },
            this,
          )
      },
      _getClickToCIObj: function (f) {
        f = f.toLowerCase()
        this._clickToCI[f] || (this._clickToCI[f] = new a())
        return this._clickToCI[f]
      },
      getCriticalFeatureObj: function () {
        h.isEmptyObject(this.criticalFeatures) && (this.criticalFeatures = new e())
        return this.criticalFeatures
      },
      updateMetricInfo: function (a) {
        var c = this._getClickToCIObj(this.pageType),
          b = this,
          e = this.getCriticalFeatureObj()
        e.getCriticalFeaturesPromise().then(function (h) {
          e.isCriticalFeaturesKnown &&
            !c.getMetricInfo().allFeaturesInteractive &&
            c.setMetricInfo(b.getTimeToInteractivity(h, b.pageType))
          c.getMetricInfo().allFeaturesInteractive &&
          b._clickToCI[b.pageType] &&
          !b._clickToCI[b.pageType].isResolved()
            ? (b._clickToCI[b.pageType].resolve(c.getMetricInfo()),
              b._clickToCI[b.pageType].setResolved(!0),
              a && k.logCounter('ClickToCITwisterUpdateSuccessCount'),
              n.now('dp-critical-features-interactive-marker').execute(function (a) {
                a ||
                  n.register('dp-critical-features-interactive-marker', function () {
                    return c.getMetricInfo().allFeaturesInteractive
                  })
              }))
            : a &&
              !c.getMetricInfo().allFeaturesInteractive &&
              k.logCounter('ClickToCITwisterUpdateFailureCount')
        })
      },
      getClickToCIPromise: function (a) {
        if (a) {
          if (((a = a.toLowerCase()), this._clickToCI[a]))
            return this._clickToCI[a].getPromiseObject()
        } else if (this._clickToCI[this.pageType])
          return this._clickToCI[this.pageType].getPromiseObject()
      },
      updateCriticalFeatures: function () {
        this.getCriticalFeatureObj().updateCriticalInteractiveFeatures()
        this.updateMetricInfo()
      },
    }
  })
  n.when('A').register('dp-interactive-feature-component', function (g) {
    function d(a) {
      if (a instanceof d) {
        var m = {}
        this._renderTime = 0
        this._isInteractive = a._isInteractive
        g.each(
          a._events,
          function (a) {
            a.alwaysInteractive &&
              (m[a.name] = {
                name: a.name,
                interactiveTime: a.interactiveTime,
                alwaysInteractive: !0,
              })
          },
          this,
        )
        this._events = m
      } else (this._renderTime = 0), (this._isInteractive = !0), (this._events = {})
    }
    var a = g.$
    d.prototype = {
      updateComponentInformation: function (e) {
        var d = !1
        if (a.isPlainObject(e))
          switch (e.type) {
            case 'render':
              d = this._updateRenderInformation(e)
              break
            case 'interactive':
              d = this._updateInteractiveInformation(e)
          }
        return d
      },
      _updateRenderInformation: function (a) {
        var d = !1,
          g = a.options || {}
        this._renderTime ||
          ((this._renderTime = a.timestamp),
          (this._isInteractive = g.isInteractive === p ? !0 : g.isInteractive),
          (d = !0))
        return d
      },
      _updateInteractiveInformation: function (a) {
        var d
        d = a.options || {}
        var k = d.alwaysInteractive || !1,
          h = !1
        this._isInteractive &&
          ((d = d.events || ['click']),
          g.each(
            d,
            function (f) {
              this._events[f] ||
                ((this._events[f] = {
                  name: f,
                  interactiveTime: a.timestamp,
                  alwaysInteractive: k,
                }),
                (h = !0))
            },
            this,
          ))
        return h
      },
      getTimeToInteractivity: function (e) {
        var d = 0,
          k = !1,
          h = []
        this.isRendered() &&
          (this._isInteractive
            ? (a.isArray(e) || (e = ['click']),
              g.each(
                e,
                function (a) {
                  var c = this._events[a]
                  c ? c.interactiveTime > d && (d = c.interactiveTime) : h.push(a)
                },
                this,
              ),
              h.length || ((k = !0), this._renderTime > d && (d = this._renderTime)))
            : ((k = !0), (d = this._renderTime)))
        return { interactive: k, interactiveTime: k ? d : 0 }
      },
      isRendered: function () {
        return !!this._renderTime
      },
      updateRenderTime: function (a) {
        a && !this.isRendered() && (this._renderTime = a)
        return this._renderTime
      },
    }
    return d
  })
  n.when('dp-time-to-interactive').register('dp-interactive-page-refresh-handler', function (g) {
    return {
      twisterStartTime: null,
      createInteractivityObjectForTwisterUpdate: function () {
        this.twisterStartTime = l.parseInt(new Date().getTime())
        g.updatePage('twisterUpdate')
      },
      updateCriticalFeatures: function () {
        g.updateCriticalFeatures()
      },
      updateRenderTime: function () {
        g.updateRenderTime(this.twisterStartTime)
      },
      getClickToCIMetric: function () {
        return g.getClickToCIPromise('twisterUpdate')
      },
    }
  })
  n.when('dp-interactive-feature-component').register(
    'dp-interactive-feature-component-base',
    function (g) {
      function d(a, d) {
        this.compName = a
        this._pageType = {}
        this.getComponentByPageType(d)
      }
      d.prototype = {
        getComponentByPageType: function (a) {
          if (a)
            return (
              this._pageType[a] || (this._pageType[a] = this.getComponent(a)), this._pageType[a]
            )
        },
        updateComponentInformation: function (a, d) {
          return this.getComponentByPageType(d).updateComponentInformation(a)
        },
        getTimeToInteractivity: function (a, d) {
          return a
            ? this.getComponentByPageType(a).getTimeToInteractivity(d)
            : { interactive: !1, interactiveTime: 0 }
        },
        resetComponentInfo: function (a) {
          a && this._pageType[a] && (this._pageType[a] = this.getComponent(a))
        },
        updateRenderTime: function (a, d) {
          return this.getComponentByPageType(a).updateRenderTime(d)
        },
        getComponent: function (a) {
          return this._pageType[a]
            ? new g(this._pageType[a])
            : this._pageType.glance
              ? new g(this._pageType.glance)
              : new g()
        },
      }
      return d
    },
  )
  n.when('3p-promise').register('dp-click-to-ci', function (g) {
    function d() {
      this.reject = this.resolve = null
      this.resolved = !1
      var a = this
      this.promiseObject = new g(function (d, g) {
        a.resolve = d
        a.reject = g
      })
      this.metricInfo = {
        features: {},
        longPoleFeatureName: '',
        interactiveTime: 0,
        allFeaturesInteractive: !1,
      }
    }
    d.prototype = {
      getMetricInfo: function () {
        return this.metricInfo
      },
      setMetricInfo: function (a) {
        this.metricInfo = a
      },
      getPromiseObject: function () {
        return this.promiseObject
      },
      isResolved: function () {
        return this.resolved
      },
      setResolved: function (a) {
        this.resolved = a
      },
    }
    return d
  })
  n.when('A', 'dp-time-to-interactive', 'dp-click-to-ci-utils').register(
    'dp-clicktoci-metric-for-glanceview',
    function (g, d, a) {
      function e() {
        var c = d.getClickToCIPromise('GLANCE')
        c &&
          c
            .then(function (a) {
              k(a.features)
              h(a.features)
              m(a)
            })
            .catch(function (c) {
              a.logCounter('ClickToCIFailureCount')
            })
      }
      function m(c) {
        a.addTag('DPCIFLongPole' + c.longPoleFeatureName)
        a.widgetTime('cf', 'clickToCI', { wb: 1 }, c.interactiveTime)
        a.widgetTime('fn', p, p, c.interactiveTime)
        a.postCSMMetrics('ld', 'clickToCI', { wb: 1 })
        l.ue && ue.isl && a.postCSMMetrics('at')
      }
      function k(c) {
        f.isPlainObject(c.atc)
          ? ((c = c.atc),
            a.addTag('DPCIFBuyable'),
            a.widgetTime('cf', 'dpATCTTI', { wb: 1 }, c.interactiveTime),
            a.postCSMMetrics('ld', 'dpATCTTI', { wb: 1 }),
            c.hasComponents &&
              f.isArray(c.components) &&
              ((c = c.components[0]),
              f.isPlainObject(c) &&
                a.isValidNonEmptyString(c.name) &&
                a.addTag('DPCIFBuyable-' + c.name)))
          : a.addTag('DPCIFNonBuyable')
      }
      function h(c) {
        if (f.isPlainObject(c)) {
          var b = l.performance
          'object' === typeof b &&
            'object' === typeof b.timing &&
            g.each(c, function (c, f) {
              var d = 'DP' + f + 'TTI'
              a.logCounter('DPCF' + f + 'TTI', c.interactiveTime - b.timing.navigationStart)
              a.widgetTime('cf', d, { wb: 1 }, c.interactiveTime)
              a.postCSMMetrics('ld', d, { wb: 1 })
            })
        }
      }
      var f = g.$
      a.widgetTime('bb', 'dpATCTTI', { wb: 1 })
      e()
      n.when('atf').execute('dp-get-critical-interactive-features', function () {
        d.updateCriticalFeatures()
      })
      return {
        markClickToCI: e,
        publishTTIOfCriticalFeatures: h,
        tagBuyablibity: k,
        publishTimeToInteractive: m,
      }
    },
  )
  n.when('A').register('dp-click-to-ci-utils', function (g) {
    return {
      widgetTime: function (d, a, e, g) {
        'function' === typeof uet && uet(d, a, e, g)
      },
      addTag: function (d) {
        l.ue && l.ue.tag && l.ue.tag(d)
      },
      logCounter: function (d, a) {
        l.ue &&
          g.$.isFunction(l.ue.count) &&
          ((a = a || (l.ue.count(d) || 0) + 1), l.ue.count(d, a))
      },
      isValidNonEmptyString: function (d) {
        return 'string' === typeof d && 0 < d.length
      },
      postCSMMetrics: function (d, a, e) {
        'function' === typeof uex && uex(d, a, e)
      },
    }
  })
  n.when('A', '3p-promise', 'dp-click-to-ci-utils').register(
    'dp-critical-features',
    function (g, d, a) {
      function e() {
        this._resolve
        this._reject = null
        var a = this
        this._promiseObj = new d(function (f, c) {
          a._resolve = f
          a._reject = c
        })
        this._features = null
        this.isCriticalFeaturesKnown = !1
      }
      var m = g.$,
        k = []
      e.prototype = {
        getCriticalFeatures: function () {
          return this._features
        },
        getCriticalFeaturesPromise: function () {
          return this._promiseObj
        },
        setCriticalFeatures: function (a) {
          m.isPlainObject(a) &&
            !m.isEmptyObject(a) &&
            ((this._features = a), this._resolve(a), (this.isCriticalFeaturesKnown = !0))
        },
        setIgnoreCriticalFeatures: function (a) {
          k.push(a)
        },
        updateCriticalInteractiveFeatures: function () {
          var d = {},
            f = m('.dp-cif')
          f.length
            ? (f.each(function () {
                var c = (m(this).data() || {}).featureDetails
                if (m.isPlainObject(c) && a.isValidNonEmptyString(c.name)) {
                  var b
                  b = k.length && k.includes(c.name) ? !1 : !0
                  b && (d[c.name] = c)
                } else a.logCounter('DPCIFInvalidData')
              }),
              this._parseCriticalFeatures(d))
            : a.addTag('DPCIFNoData')
        },
        _parseCriticalFeatures: function (d) {
          var f = {}
          m.isPlainObject(d)
            ? (g.each(d, function (a, b) {
                f[b] = {}
                m.isPlainObject(a) && (f[b] = a)
              }),
              m.isEmptyObject(f) ? a.addTag('DPCIFNoData') : this.setCriticalFeatures(f))
            : a.addTag('DPCIFNoData')
        },
        resetIgnoreCriticalFeatures: function () {
          k = []
        },
      }
      return e
    },
  )
  n.when('dp-critical-features-interactive-marker').register('dp-latency-marker', function (g) {})
  ;('use strict')
  n.when('A', 'load').execute('logDpAssetInjectionMetric', function (g) {
    var d = g.state('dp_injected_meta_assets')
    if ('undefined' != typeof performance && 'undefined' != typeof performance.getEntries) {
      for (var a = 0, e = 0, m = 0, k = 0, h = performance.getEntries(), f = 0; f < h.length; f++) {
        var c = h[f],
          b = c.initiatorType
        c.name.match(/\.css\?AUIClients\/AmazonUI/g) &&
          b &&
          'link' === b &&
          c.duration + c.startTime > a + e &&
          ((a = c.duration), (e = c.startTime))
        if (
          'undefined' != typeof d &&
          'undefined' != typeof d.assetNames &&
          0 < d.assetNames.length
        )
          for (var q = 0; q < d.assetNames.length; q++)
            if (
              c.name.match(new RegExp('\\.css\\?AUIClients/' + d.assetNames[q])) &&
              b &&
              'link' === b
            ) {
              if (0 === m || m > c.startTime) m = c.startTime
              k < c.startTime && (k = c.startTime)
              break
            }
      }
      l.ue &&
        g.$.isFunction(l.ue.count) &&
        (l.ue.count('aui.auiDuration', a),
        l.ue.count('aui.auiStartTime', e),
        0 !== m &&
          0 !== k &&
          (l.ue.count('dpcss.dpStartTimeMin', m),
          l.ue.count('dpcss.dpStartTimeMax', k),
          l.ue.count('dpcss.auiDiffMin', m - e),
          l.ue.count('dpcss.auiDiffMax', k - e)))
    }
  })
  n.when('A', 'load').execute('dp-asset-metric-logging', function (g) {
    function d(a) {
      l.ue && ue.tag && ue.tag(a)
    }
    function a(a, d) {
      l.ue && ue.count && a && ue.count(a, d)
    }
    function e(d, f, c) {
      0 < f &&
        (a(d + 'EncodeSize', Math.round(f / 1024)), a(d + 'DecodeSize', Math.round(c / 1024)))
    }
    function m(a, d, c) {
      return g.filter(a, function (a) {
        if (a && a.initiatorType === c && a.name && a.name.match(d)) return !0
      })
    }
    function k(d, f, c, b) {
      var e = { encodedSize: 0, decodedSize: 0, httpProtocol: '', count: 0 }
      g.each(f, function (f) {
        var k = m(d, new RegExp('\\.' + c + '\\?AUIClients/' + f), b) || []
        e.count += k.length
        g.each(k, function (b, g) {
          g = f + (g + 1)
          if (b && 0 < b.encodedBodySize) {
            var k
            k = b && 0 === b.transferSize ? !0 : void 0
            k ? a('DP' + c + 'Cached' + g, 1) : a('DP' + c + 'NotCached' + g, 1)
          }
          g = e.encodedSize
          k = b && b.encodedBodySize ? b.encodedBodySize : 0
          e.encodedSize = g + k
          g = e.decodedSize
          b = b && b.decodedBodySize ? b.decodedBodySize : 0
          e.decodedSize = g + b
          e.httpProtocol = d.nextHopProtocol || ''
        })
      })
      return e
    }
    ;(function () {
      if (l.performance && performance.getEntriesByType) {
        var e = performance.getEntriesByType('navigation')[0]
        e &&
          (0 < e.encodedBodySize &&
            (a('DPEncodedSize', Math.round(e.encodedBodySize / 1024)),
            a('DPDecodedSize', Math.round(e.decodedBodySize / 1024))),
          e.nextHopProtocol && d('DPhttpProtocol' + e.nextHopProtocol))
      }
    })()
    ;(function () {
      if (l.performance && performance.getEntries) {
        var h = performance.getEntries(),
          f = g.state('dp_injected_meta_assets'),
          c = []
        f && f.assetNames && (c = f.assetNames || [])
        var f = k(h, c, 'js', 'script'),
          b = k(h, ['AmazonUI', 'AmazonUIjQuery'], 'js', 'script'),
          c = k(h, c, 'css', 'link'),
          h = k(h, ['AmazonUI'], 'css', 'link')
        e('DPJS', f.encodedSize, f.decodedSize)
        e('AUIJS', b.encodedSize, b.decodedSize)
        e('DPCSS', c.encodedSize, c.decodedSize)
        e('AUICSS', h.encodedSize, h.decodedSize)
        a('DPCSSResourceCount', c.count)
        a('DPJSResourceCount', f.count)
        f.httpProtocol && d('DPJSHttpProtocal' + f.httpProtocol)
        c.httpProtocol && d('DPCSSHttpProtocal' + c.httpProtocol)
      }
    })()
  })
  n.when('A', 'load').execute('dp-asset-connection-metric-logging', function (g) {
    function d(a) {
      l.ue && ue.tag && ue.tag(a)
    }
    ;(function () {
      if (l.navigator && l.navigator.connection) {
        var a = 1024 * l.navigator.connection.downlink,
          e = l.navigator.connection.rtt,
          g = l.navigator.connection.effectiveType
        e &&
          (l.ue && ue.count && ue.count('rtt', e),
          0 <= e && 100 > e ? d('rtt:0_100') : 100 <= e && 200 >= e && d('rtt:100_200'))
        a &&
          (l.ue && ue.count && ue.count('downlink', a),
          0 <= a && 5120 > a ? d('downlink:0_5') : 5120 <= a && 10240 >= a && d('downlink:5_10'))
        d('EffectiveConnectionType:' + g)
      }
    })()
  })
  n.when('A').register('get-resource-time', function (g) {
    return {
      getResourceTimeByName: function (d, a) {
        var e = []
        l.performance &&
          performance.getEntries &&
          d &&
          g.$.isArray(a) &&
          0 < a.length &&
          ((e = performance.getEntries()),
          (e = g.filter(e, function (e) {
            return e && e.initiatorType === d ? -1 < g.indexOfArray(a, e.name) : !1
          })))
        return e
      },
    }
  })
  n.when('A', 'dp-interactivity-metric-utils').execute('dp-non-critical-tti', function (g, d) {
    var a = g.$
    ;(function () {
      a('.a-container').click(function (a) {
        d.calculateInteractivity(a)
      })
    })()
  })
  n.when('A').register('dp-log-critical-asset-source-details', function (g) {
    function d(a) {
      l.ue && ue.tag && ue.tag(a)
    }
    function a(a) {
      return a && 0 < a.encodedBodySize
    }
    function e(d, c, b, e) {
      var h = []
      g.each(c, function (c) {
        var k = new RegExp('\\.' + b + '\\?AUIClients/' + c + '([^a-zA-Z]|$)')
        c = g.filter(d, function (c) {
          return c && c.initiatorType === e && c.name && c.name.match(k) && a(c) ? !0 : !1
        })
        h = h.concat(c)
      })
      return h
    }
    function m(a) {
      for (var c in a) {
        var b = a[c]
        if (b && 0 !== b.transferSize) return !1
      }
      return !0
    }
    var k = [
        'DPMobileAppCriticalFeatureMetaAsset',
        'DetailPageMobileWebCriticalFeatureAsset',
        'DetailPageDesktopImageBlockMetaAsset',
      ],
      h = ['AmazonUI']
    return {
      logAssetCacheSourceDetails: function (a) {
        var c = e(a, k, 'js', 'script'),
          c = c.concat(e(a, k, 'js', 'link'))
        a = e(a, h, 'css', 'link')
        var b = ''
        0 < c.length &&
          0 < a.length &&
          ((b += 'dpcriticaljs_'),
          (b = m(c) ? b + 'cached' : b + 'not_cached'),
          (b += ':auicss_'),
          (b = m(a) ? b + 'cached' : b + 'not_cached'),
          d(b))
        return b
      },
      checkEncodedBodySize: a,
      getFilteredResources: e,
      isResourceCached: m,
      logTag: d,
    }
  })
  n.when('dp-log-critical-asset-source-details', 'ready').execute(
    'dp-log-critical-asset-source-details_execute',
    function (g) {
      if (l.performance && performance.getEntries) {
        var d = performance.getEntries()
        g.logAssetCacheSourceDetails(d)
      }
    },
  )
  n.when('A', 'dp-click-to-ci-utils').register('dp-interactivity-metric-utils', function (g, d) {
    var a = g.$
    return {
      calculateInteractivity: function (e) {
        var g = e.type,
          k = a(e.target),
          h = k.closest("div[id$\x3d'_feature_div']")
        d.logCounter('Total-' + g)
        h &&
          ((h = a(h).data('feature-name'))
            ? d.logCounter(h + '-' + g)
            : d.logCounter(e.target.id + '-' + g))
        ;(e = k.closest('.a-declarative')) &&
          (e = a(e).data('action')) &&
          d.logCounter(e + '-' + g + '-dec-action')
      },
    }
  })
  n.when('A', 'dp-log-critical-asset-source-details').register(
    'logging-asset-metrics',
    function (g, d) {
      function a(a) {
        var b = 'numCSSAssets_',
          b =
            20 >= a
              ? b.concat('0-20')
              : 40 >= a
                ? b.concat('21-40')
                : 60 >= a
                  ? b.concat('41-60')
                  : 80 >= a
                    ? b.concat('61-80')
                    : 100 >= a
                      ? b.concat('81-100')
                      : b.concat('\x3e100')
        d.logTag(b)
        return b
      }
      function e(a) {
        var b = 'numJSAssets_',
          b =
            25 >= a
              ? b.concat('0-25')
              : 50 >= a
                ? b.concat('26-50')
                : 75 >= a
                  ? b.concat('51-75')
                  : 100 >= a
                    ? b.concat('76-100')
                    : 125 >= a
                      ? b.concat('101-125')
                      : b.concat('\x3e125')
        d.logTag(b)
        return b
      }
      function l(a, b) {
        a = (a / b) * 100
        b = 'cachedAssetPercent_'
        b =
          10 >= a
            ? b.concat('0-10')
            : 20 >= a
              ? b.concat('11-20')
              : 30 >= a
                ? b.concat('21-30')
                : 40 >= a
                  ? b.concat('31-40')
                  : 50 >= a
                    ? b.concat('41-50')
                    : 60 >= a
                      ? b.concat('51-60')
                      : 70 >= a
                        ? b.concat('61-70')
                        : 80 >= a
                          ? b.concat('71-80')
                          : 90 >= a
                            ? b.concat('81-90')
                            : b.concat('91-100')
        d.logTag(b)
        return b
      }
      function k(a) {
        var b = 'numImageAssets_',
          b =
            20 >= a
              ? b.concat('0-20')
              : 40 >= a
                ? b.concat('21-40')
                : 60 >= a
                  ? b.concat('41-60')
                  : 80 >= a
                    ? b.concat('61-80')
                    : 100 >= a
                      ? b.concat('81-100')
                      : b.concat('\x3e100')
        d.logTag(b)
        return b
      }
      function h(a) {
        a /= 1e6
        var b = 'MBsDownloaded_',
          b =
            10 >= a
              ? b.concat('0-10')
              : 20 >= a
                ? b.concat('11-20')
                : 30 >= a
                  ? b.concat('21-30')
                  : 40 >= a
                    ? b.concat('31-40')
                    : 50 >= a
                      ? b.concat('41-50')
                      : 60 >= a
                        ? b.concat('51-60')
                        : 70 >= a
                          ? b.concat('61-70')
                          : 80 >= a
                            ? b.concat('71-80')
                            : 90 >= a
                              ? b.concat('81-90')
                              : 100 >= a
                                ? b.concat('91-100')
                                : b.concat('\x3e100')
        d.logTag(b)
        return b
      }
      function f(a) {
        var b = [],
          d = [],
          e = [],
          f = 0,
          h = 0,
          k = /\.css([^a-zA-Z]|$)/,
          l = /\.js([^a-zA-Z]|$)/
        g.each(a, function (a) {
          a &&
            (a.transferSize && (0 === a.transferSize && (f += 1), (h += a.transferSize)),
            a.name &&
              (a.name.match(l)
                ? d.push(a)
                : a.name.match(k)
                  ? e.push(a)
                  : -1 !== a.name.indexOf('.jpg', a.name.length - 4) && b.push(a)))
        })
        return { imageAssets: b, JSAssets: d, CSSAssets: e, cachedAssets: f, bytesDownloaded: h }
      }
      return {
        classifyAndLog: function (c) {
          var b = f(c),
            d
          d = ''.concat(e(b.JSAssets.length))
          d = d.concat(':', a(b.CSSAssets.length))
          d = d.concat(':', k(b.imageAssets.length))
          d = d.concat(':', l(b.cachedAssets, c.length))
          return (d = d.concat(':', h(b.bytesDownloaded)))
        },
        classifyResources: f,
        logBytesDownloaded: h,
        logImageAssets: k,
        logCSSAssets: a,
        logJSAssets: e,
        logCachedAssetsPercent: l,
      }
    },
  )
  n.when('logging-asset-metrics', 'ready').execute('logging-asset-metrics-execute', function (g) {
    if (l.performance && performance.getEntries) {
      var d = performance.getEntries()
      g.classifyAndLog(d)
    }
  })
})
/* ******** */
;(function (c) {
  var b = window.AmazonUIPageJS || window.P,
    d = b._namespace || b.attributeErrors,
    a = d ? d('DetailPageCommonOffersAssets', '') : b
  a.guardFatal
    ? a.guardFatal(c)(a, window)
    : a.execute(function () {
        c(a, window)
      })
})(function (c, b, d) {})
/* ******** */
;(function (b) {
  var c = window.AmazonUIPageJS || window.P,
    d = c._namespace || c.attributeErrors,
    a = d ? d('DeliveryStaticPackard', '') : c
  a.guardFatal
    ? a.guardFatal(b)(a, window)
    : a.execute(function () {
        b(a, window)
      })
})(function (b, c, d) {
  b.when('A', 'GLUXWidget').execute(function (a, b) {
    a.on('packard:glow:destinationChangeAll', function () {
      c.location.reload()
    })
  })
  b.when('A', 'GlowTriggerMetrics', 'a-modal').register(
    'dpContextualIngressPtTrigger',
    function (a, c, f) {
      function b(d) {
        c.logGLOWTriggerCountFromIngress(c.getEvents().cip.desktop)
        var e = f.get(a.$('#nav-global-location-slot'))
        e && (d.$event.preventDefault(), e.show())
      }
      a.declarative('dpContextualIngressPt', 'click', function (a) {
        b(a)
      })
      return { showGlowModal: b }
    },
  )
  b.when('A').register('GlowTriggerMetrics', function (a) {
    var b = {
      cip: {
        desktop: 'cip.desktop',
        mobileWeb: 'cip.mobileWeb',
        tabletApp: 'cip.tabletApp',
        mobileApp: 'cip.mobileApp',
        micron: 'cip.micron',
      },
      glowTop: {
        tabletApp: 'glow-top.tabletApp',
        mobileApp: 'glow-top.mobileApp',
        micron: 'glow-top.micron',
      },
      gpsOnLoad: { nativeApp: 'gpsOnLoad.nativeApp' },
      unknown: { nativeApp: 'unknown.nativeApp' },
    }
    return {
      getEvents: function () {
        return b
      },
      logGLOWTriggerCountFromIngress: function (a) {
        a = 'GLOWTrigger.' + a
        c.ue
          ? c.ue.count(a, 1)
          : ((a =
              'Failed to increment metrics counter: ' + a + ' because window.ue is not present.'),
            c.ueLogError &&
              a &&
              c.ueLogError({ message: a }, { logLevel: 'ERROR', attribution: 'GLOWTrigger' }))
      },
    }
  })
  b.when('BottomSheetPlugin').register('GlowOpener', function (a) {
    return {
      openGlow: function (b) {
        a.ShowBottomSheet(b)
      },
    }
  })
})
/* ******** */
;(function (k) {
  var m = window.AmazonUIPageJS || window.P,
    r = m._namespace || m.attributeErrors,
    b = r ? r('DeliveryStatic', '') : m
  b.guardFatal
    ? b.guardFatal(k)(b, window)
    : b.execute(function () {
        k(b, window)
      })
})(function (k, m, r) {
  k.when('A', 'jQuery', 'ready').register('DeliveryCountdownComponent', function (b, a) {
    function h(a, b, c, d, e) {
      this.strings = a
      this.asin = b
      this.deliveryMessageSectionId = c
      this.countdownElementId = d
      this.secondsLeft = e
      this.intervalHandle = null
    }
    m.DeliveryCountdownHandler = function (a) {
      var b = a.strings,
        c = a.asin,
        d = a.deliveryMessageSectionId,
        e = a.fastCountdownElementId,
        n = a.cheapCountdownElementId
      this.cheapCountdownTimer = this.fastCountdownTimer = null
      this.start = function (a, l) {
        0 < a && ((this.fastCountdownTimer = new h(b, c, d, e, a)), this.fastCountdownTimer.start())
        0 < l &&
          ((this.cheapCountdownTimer = new h(b, c, d, n, l)), this.cheapCountdownTimer.start())
      }
      this.stop = function () {
        this.fastCountdownTimer &&
          (this.fastCountdownTimer.stop(), (this.fastCountdownTimer = null))
        this.cheapCountdownTimer &&
          (this.cheapCountdownTimer.stop(), (this.cheapCountdownTimer = null))
      }
    }
    h.prototype.start = function () {
      var a = this
      this.intervalHandle = b.interval(function () {
        a && a.updateCountdownText()
      }, 1e3)
    }
    h.prototype.stop = function () {
      this.intervalHandle && m.clearInterval(this.intervalHandle)
    }
    h.prototype.updateCountdownText = function () {
      this.secondsLeft--
      if (0 < this.secondsLeft) {
        var b = Math.floor(this.secondsLeft / 60),
          g = b % 60,
          b = Math.floor(b / 60),
          c = this.secondsLeft % 60,
          d = this.strings.inNext,
          e = 1 < b ? this.strings.hours : this.strings.hour,
          n = 1 < g ? this.strings.minutes : this.strings.minute,
          w = 1 < c ? this.strings.seconds : this.strings.second,
          h = this.strings.timeSeperator,
          g =
            0 < b && 0 < g
              ? b + h + e + h + g + h + n + h + d
              : 0 < b && 0 === g
                ? b + h + e + d
                : 0 === b && 0 < g
                  ? g + h + n + d
                  : c + h + w + d
        a(this.countdownElementId).html(g)
      } else
        this.stop(),
          (g =
            "\x3ca href\x3d'javacript:window.location.reload();'\x3e" +
            this.strings.refreshTimeout +
            '\x3c/a\x3e'),
          a(this.deliveryMessageSectionId).html(g)
    }
  })
  k.when('A', 'jQuery', 'LUXContext').register('LUXController', function (b, a, h) {
    function l() {
      return {
        addressLabel: n,
        addressId: w,
        obfuscatedId: y,
        countryCode: f,
        zipCode: t,
        state: u,
        city: x,
        district: p,
        locationType: v,
      }
    }
    function g(a) {
      n = a.addressLabel
      w = a.addressId
      y = a.obfuscatedId
      f = a.countryCode
      t = a.zipCode
      u = a.state
      x = a.city
      p = a.district
      v = a.locationType
    }
    function c(a, f, d) {
      a = b.copy(a)
      a.deviceType = h.deviceType
      a.pageType = e
      a.actionSource = 'locux'
      b.post('/gp/delivery/ajax/address-change.html', {
        contentType: 'application/x-www-form-urlencoded;charset\x3dutf-8',
        params: a,
        success: function (a) {
          if (a.sembuUpdated) {
            a.address && g(a.address)
            var c = l()
            h.fullPageRefresh
              ? (k.when('LUXMetrics').execute(function (a) {
                  a.logLocationChange(c.locationType)
                }),
                m.location.reload())
              : (b.trigger('DeliveryAddressDropdown_OnSembuUpdateSuccess', c),
                b.trigger('DeliveryAddressDropdown_OnAddressChange', c),
                f && f(),
                k.when('LUXMetrics').execute(function (a) {
                  a.logLocationChange(c.locationType)
                }))
          } else d && d()
        },
        error: function () {
          b.trigger('DeliveryAddressDropdown_OnSembuUpdateFail', l())
          d && d()
        },
      })
    }
    var d = !1,
      e = null,
      n,
      w,
      y,
      f,
      t,
      u,
      x,
      p,
      v
    return {
      locationChangeEventName: 'DeliveryAddressDropdown_OnAddressChange',
      locationTypes: {
        defaultAddress: 'DEFAULT_ADDRESS',
        accountAddress: 'ACCOUNT_ADDRESS',
        lockerAddress: 'LOCKER_ADDRESS',
        locationInput: 'LOCATION_INPUT',
        realmDefault: 'REALM_DEFAULT',
        region: 'REGION',
        country: 'COUNTRY',
        ip2location: 'IP2LOCATION',
      },
      init: function (a) {
        k.when('LUXResponder').execute(function (f) {
          d ? b.equals(a, l()) || (g(a), f.refresh()) : (g(a), f.activate(), (d = !0))
        })
        k.when('LUXCustom').execute(function (a) {
          a.activate()
        })
        k.when('LUXMetrics').execute(function (a) {
          e = a.getPageType()
        })
      },
      getLocationData: function () {
        return l()
      },
      changeLocation: function (a, b, f) {
        c(a, b, f)
      },
    }
  })
  k.when('A', 'LUXDPOnly').register('LUXDPRefreshController', function (b) {
    function a(a) {
      e = a
      h({
        addressId: e.addressId,
        zipCode: e.zipCode,
        city: e.city,
        state: e.state,
        district: e.district,
        countryCode: e.countryCode,
        relatedRequestId: e.relatedRequestId,
      })
      var b = {
        asin: e.asin,
        merchantId: e.merchantId,
        deviceType: e.deviceType,
        smid: e.smid,
        wdg: e.wdg,
        exMerchId: e.exMerchId,
        oneClick: e.oneClick,
      }
      k.when('UnifiedLocationUpdateHandler').execute(function (a) {
        a.init(b)
        d = a
      })
      l(e.obfuscatedId)
      g(e.obfuscatedId)
    }
    function h(a) {
      var d = c('#buybox select[name\x3d"quantity"]').val() || 1
      b.state('unifiedLocation', {
        addressId: a.addressId,
        zipCode: a.zipCode,
        city: a.city,
        state: a.state,
        district: a.district,
        countryCode: a.countryCode,
        quantity: d,
        relatedRequestId: a.relatedRequestId,
      })
    }
    function l(a) {
      if (e && e.oneClick) {
        var d = 'unifiedLocation1ClickAddress'
        e.deviceType && 'mobileApp' === e.deviceType && (d = 'addressID')
        a || (a = c('#' + d).data('addnewaddress')) || (a = 'new')
        d = '[id\x3d"' + d + '"]'
        0 < c(d).length && c(d).val(a)
        if (e.deviceType && e.deviceType in n && (d = b.state('buyNowInfo'))) {
          var f = d.urlParams,
            f =
              0 < f.indexOf('addressID\x3d')
                ? f.replace(/(addressID=)[^&]*/, '$1' + a)
                : f + '\x26addressID\x3d' + a
          d.urlParams = f
          b.state('buyNowInfo', d)
        }
      }
    }
    function g(a) {
      e &&
        !e.oneClick &&
        'T1' === e.updateAddressForNon1Click &&
        (a || (a = c('#unifiedLocationAddress').data('addnewaddress')),
        1 === c('#unifiedLocationAddress').length && c('#unifiedLocationAddress').val(a))
    }
    var c = b.$,
      d = null,
      e = null,
      n = { tabletApp: 1, tabletLargeApp: 1, iPad: 1 }
    b.on('DeliveryAddressDropdown_OnAddressChange', function (a) {
      var c = b.state('unifiedLocation') ? b.state('unifiedLocation').relatedRequestId : r
      a.relatedRequestId = c
      h(a)
      l(a.obfuscatedId)
      g(a.obfuscatedId)
      null !== d && (d.refresh(), b.trigger('LocationUX_OnAddressChange', a))
    })
    b.on('UnifiedLocationPostRefresh', function () {
      b.trigger('diodeAjaxRefreshed')
    })
    return {
      init: function (d) {
        a(d)
      },
      updateFeaturesForNewQuantitySelection: function (a) {
        h(a)
        null !== d && (d.refresh(), b.trigger('LocationUX_OnAddressChange', a))
      },
    }
  })
  k.when('A', 'LUXController', 'LUXDPRefreshController', 'LUXDPOnly').register(
    'LUXDPQuantityRefresh',
    function (b, a, h) {
      b.declarative('quantity-dropdown', 'change', function (b) {
        b = a.getLocationData()
        h.updateFeaturesForNewQuantitySelection(b)
      })
    },
  )
  k.when('A', 'detailPage:RefreshHandler', 'LUXDPOnly', 'a-state').execute(function (b, a) {
    k.register('TwisterUpdateHandler', function () {
      return {
        init: function (a) {
          b.state('unifiedLocation', a)
        },
        refresh: function () {
          var h = a.getHandlerInstance('LocationUX'),
            l = [],
            g = 'addressId zipCode city state district countryCode relatedRequestId'.split(' ')
          if (h) {
            var c = b.state('unifiedLocation'),
              d
            for (d in c)
              if (c.hasOwnProperty(d) && -1 < b.$.inArray(d, g)) {
                var e = typeof c[d]
                ;('number' === e || 'boolean' === e || 'string' === e || c[d] instanceof String) &&
                  l.push(h.getURLParamObject(d, null === c[d] ? '' : c[d], 1))
              }
          }
          0 < l.length && h.doPageRefresh(l)
        },
      }
    })
  })
  k.when('A', 'LUXDPOnly', 'a-state').execute(function (b) {
    k.register('UnifiedLocationUpdateHandler', function () {
      return {
        init: function (a) {
          b.state('unifiedLocation', a)
        },
        refresh: function () {
          a = 2
          h()
        },
      }
    })
    var a = 0,
      h = function () {
        var a = b.state('unifiedLocation')
        a.urlParams = JSON.stringify(a.urlParams)
        for (var e in a)
          if (a.hasOwnProperty(e)) {
            var n = typeof a[e]
            'number' === n ||
              'boolean' === n ||
              'string' === n ||
              a[e] instanceof String ||
              (null === a[e] ? (a[e] = '') : delete a[e])
          }
        a &&
          a.asin &&
          a.merchantId &&
          (b.trigger('UnifiedLocationPreRefresh'),
          b.ajax(
            '/gp/product/features/unified-location/udp/refresh-features.html?_encoding\x3dUTF-8',
            { params: a, method: 'POST', success: l, error: g, abort: c },
          ))
      },
      l = function () {
        b.trigger('UnifiedLocationPostRefresh', !0)
      },
      g = function () {
        b.trigger('UnifiedLocationPostRefresh', !1)
        0 < --a && h()
      },
      c = function (a) {
        b.trigger('UnifiedLocationPostRefresh', !1)
      }
  })
  k.when('A', 'jQuery', 'a-popover', 'LUXWidgetConfig', 'ready').execute(function (b, a, h, l) {
    function g(c) {
      var d = !1,
        e = c.selectedAddressId,
        n = c.selectedObfuscatedId,
        h = c.selectedAddressLabel,
        g = c.selectedCountryCode,
        f = c.selectedZipCode,
        t = c.selectedState,
        u = c.selectedCity,
        x = c.selectedDistrict,
        p = c.addressPopover.name,
        v = c.addressPopover.type,
        r = l.initialAddressLoadCount,
        z = l.addressReloadCount,
        q = c.deviceType,
        N = c.isRecognized,
        C = 0,
        A = !1
      this.init = function () {
        d || ((d = !0), O())
      }
      this.destroy = function () {
        b.off('a:popover:beforeShow:' + p, D)
        b.off('a:popover:afterHide:' + p, E)
        b.capabilities.tablet && a.isFunction(b.off.orientationchange) && b.off.orientationchange(F)
        a(document).undelegate('#unifiedLocationAddrInput', 'focus')
        a(document).undelegate('#unifiedLocationAddrInput', 'input')
        a(document).undelegate('#unifiedLocationSignIn', 'click')
        a(document).undelegate('#unifiedLocationAddrUpdate', 'click')
        a(document).undelegate(
          '#unifiedLocationAccountAddrList input[type\x3dradio], #unifiedLocationPopoverSelections ul li .a-touch-link.a-touch-select',
          'click',
        )
        a(document).undelegate('#unifiedLocationSeeMore', 'click')
      }
      var G = function () {
          k.when(v).execute(function (a) {
            a.get(p) && a.get(p).hide()
          })
        },
        O = function () {
          b.on('a:popover:beforeShow:' + p, D)
          b.on('a:popover:afterHide:' + p, E)
          b.capabilities.tablet && a.isFunction(b.on.orientationchange) && b.on.orientationchange(F)
          a(document).delegate('#unifiedLocationAddrInput', 'focus', function (a) {
            H()
          })
          a(document).delegate('#unifiedLocationSignIn', 'click', function () {
            var a = !0
            'mobileApp' === q &&
              k.now('mash').execute(function (b) {
                b &&
                  ((a = !1),
                  b.navstack.begin().back().end(),
                  b.showLoginDialog({
                    successCallback: function () {
                      b.navstack.begin().back().forward(m.location.href).end()
                    },
                  }))
              })
            a && (m.location.href = c.addressPopover.signInURL + m.location.pathname)
          })
          a(document).delegate('#unifiedLocationAddrInput', 'keyup', function (a) {
            I()
          })
          a(document).delegate('#unifiedLocationAddrInput', 'keypress', function (a) {
            13 === (a.keyCode || a.which) && J()
          })
          a(document).delegate('#unifiedLocationAddrUpdate', 'click', function (a) {
            J()
          })
          a(document).delegate(
            '#unifiedLocationAccountAddrList input[type\x3dradio], #unifiedLocationPopoverSelections ul li .a-touch-link.a-touch-select',
            'click',
            function (b) {
              b = a.parseJSON(
                a(this).hasClass('a-touch-link')
                  ? a(this).find('input[type\x3dhidden]').val()
                  : a(this).val(),
              )
              if (a(this).hasClass('a-active')) G()
              else if (b) {
                var f = b.id
                f !== e &&
                  K(
                    {
                      addressId: f,
                      isDefaultShippingAddress: b.isDefault,
                      addressLabel: b.label,
                      deviceType: q,
                    },
                    !1,
                    a(this),
                  )
              }
            },
          )
          a(document).delegate('#unifiedLocationSeeMore', 'click', function (a) {
            L()
          })
          'tabletApp' === q && m.scrollBy(0, 1)
        },
        P = a('#unifiedLocationAddrInput').attr('placeholder'),
        I = function () {
          'tabletApp' === q &&
            (a('#unifiedLocationAddrInput').val()
              ? a('#unifiedLocationAddrInput').removeAttr('placeholder')
              : a('#unifiedLocationAddrInput').attr('placeholder', P))
        },
        J = function () {
          var b = a('#unifiedLocationAddrInput').val()
          b && b.match(/^\d{5}$/) ? K({ zipCode: b, deviceType: q }, !0, null) : M()
        },
        D = function (f) {
          a('#unifiedLocationInvalidInputAlert').hasClass('aok-hidden') ||
            (a('#unifiedLocationAddrInput').val(''), H())
          b.capabilities.tablet &&
            a('#a-popover-lgtbox') &&
            a('#a-popover-lgtbox').css({
              position: 'absolute',
              top: '0px',
              left: '0px',
              width: '100%',
              height: a('#a-page').css('height'),
            })
          I()
          A || L()
        },
        E = function () {
          'tabletApp' === q && document.activeElement.blur()
        },
        F = function () {
          k.when(v).execute(function (a) {
            a.get(p) && a.get(p).refresh()
          })
        },
        L = function () {
          N &&
            a.ajax({
              type: 'POST',
              url: '/gp/delivery/ajax/get-customer-address-list.html',
              contentType: 'application/x-www-form-urlencoded;charset\x3dutf-8',
              data: {
                currentAddressCount: C,
                loadCount: A ? z : r,
                selectedAddressId: e,
                deviceType: q,
              },
              dataType: 'json',
              success: function (b) {
                if (b) {
                  var f = b.loadedAddressCount
                  if (0 < f) {
                    var d = b.html
                    d &&
                      (a('#unifiedLocationPopoverSelections').length
                        ? (a('#unifiedLocationPopoverSelections ul li')
                            .has('span .a-touch-link.a-touch-select')
                            .remove(),
                          a('#unifiedLocationPopoverSelections ul').html(
                            d + a('#unifiedLocationPopoverSelections ul').html(),
                          ))
                        : a('#unifiedLocationAccountAddrList').html(d),
                      a('#unifiedLocationTitleSelectAddress').removeClass('a-hidden aok-hidden'),
                      a('#unifiedLocationTitleNoAddress').addClass('aok-hidden'),
                      a('#unifiedLocationSeeMoreDiv').removeClass('a-hidden aok-hidden'),
                      k.when(v).execute(function (a) {
                        a.get(p) && a.get(p).updatePosition()
                      }),
                      b.hasMore
                        ? a('#unifiedLocationSeeMore').removeClass('a-hidden aok-hidden')
                        : a('#unifiedLocationSeeMore').addClass('aok-hidden'),
                      (C = f))
                  }
                }
                A = !0
              },
              error: function () {},
            })
        },
        M = function () {
          a('#unifiedLocationAddrInput').addClass('a-form-error')
          a('#unifiedLocationInvalidInputAlert').removeClass('a-hidden aok-hidden')
          'tabletApp' === q &&
            (document.activeElement.blur(),
            a('#unifiedLocationInvalidInputAlert')[0].scrollIntoView())
        },
        H = function () {
          a('#unifiedLocationAddrInput').removeClass('a-form-error')
          a('#unifiedLocationInvalidInputAlert').addClass('aok-hidden')
        },
        K = function (b, d, c) {
          a.ajax({
            type: 'POST',
            url: '/gp/delivery/ajax/address-change.html',
            contentType: 'application/x-www-form-urlencoded;charset\x3dutf-8',
            data: b,
            dataType: 'json',
            success: function (b) {
              if (b.sembuUpdated) {
                if ((b = b.address))
                  (e = b.addressId),
                    (n = b.obfuscatedId),
                    (h = b.addressLabel),
                    (g = b.countryCode),
                    (f = b.zipCode),
                    (t = b.state),
                    (u = b.city),
                    (x = b.district),
                    (b = h ? h : (u ? u + ', ' : '') + (t ? t + ' ' : '') + f),
                    a('#unifiedLocationSelectedAddressText').html(b),
                    d &&
                      (a('#unifiedLocationAccountAddrList input[type\x3dradio]:checked').attr(
                        'checked',
                        !1,
                      ),
                      a('#unifiedLocationAddrInput').val('')),
                    a(
                      '#unifiedLocationPopoverSelections ul li .a-touch-link.a-touch-select.a-active',
                    ).removeClass('a-active'),
                    c && c.hasClass('a-touch-link') && c.addClass('a-active')
                G()
                B('DeliveryAddressDropdown_OnSembuUpdateSuccess')
                B('DeliveryAddressDropdown_OnAddressChange')
              } else b.isValidAddress || M()
            },
            error: function () {
              B('DeliveryAddressDropdown_OnSembuUpdateFail')
            },
          })
        },
        B = function (a) {
          b.trigger(a, {
            addressId: e,
            obfuscatedId: n,
            countryCode: g,
            zipCode: f,
            state: t,
            city: u,
            district: x,
          })
        }
    }
    k.register('DeliveryAddressDropdown', function () {
      var a
      return {
        init: function (b) {
          a && a.destroy()
          ;(a = new g(b)).init()
        },
      }
    })
  })
  k.when(
    'A',
    'jQuery',
    'LUXContext',
    'LUXWidgetConfig',
    'LUXUtils',
    'LUXController',
    'LUXMetrics',
    'ready',
  ).register('LUXResponder', function (b, a, h, l, g, c, d) {
    function e(b) {
      a('#unifiedLocationAddrInput').trigger('updateAlerts', [b])
      1 === b
        ? (a('#unifiedLocationAddrInput').addClass('a-form-error'),
          a('#LUXInvalidZipCodeAlert')
            .width(a('#LUXInvalidZipCodeAlert').parent().width())
            .removeClass('aok-hidden'),
          a('#LUXMilitaryZipCodeAlert').addClass('aok-hidden'))
        : 2 === b
          ? (a('#unifiedLocationAddrInput').removeClass('a-form-error'),
            a('#LUXInvalidZipCodeAlert').addClass('aok-hidden'),
            a('#LUXMilitaryZipCodeAlert')
              .width(a('#LUXMilitaryZipCodeAlert').parent().width())
              .removeClass('aok-hidden'))
          : 3 === b &&
            (a('#unifiedLocationAddrInput').removeClass('a-form-error'),
            a('#LUXInvalidZipCodeAlert').addClass('aok-hidden'),
            a('#LUXMilitaryZipCodeAlert').addClass('aok-hidden'))
    }
    function n(b) {
      a('.lux-location-label').html(g.generateLocationLabel(b))
    }
    function w(f) {
      a('#LUXAddressSelections input[type\x3dradio]:checked').attr('checked', !1)
      var d = a('#LUXAddressSelections .a-declarative').has('.a-radio input[type\x3dradio]')
      f = f.addressId
      for (var c = d.length - 1; 0 <= c; c--)
        if (b.parseJSON(d[c].getAttribute('data-lux-address-selection')).addressId === f) {
          a('.a-radio input[type\x3dradio]', d[c]).attr('checked', !0)
          break
        }
    }
    function y(b) {
      b = b.locationType === c.locationTypes.locationInput && b.zipCode ? b.zipCode : ''
      a('#unifiedLocationAddrInput').trigger('updateZipCodeField', b)
      a('#unifiedLocationAddrInput').val(b)
      e(3)
    }
    function f(a) {
      k.when('a-dropdown').execute(function (f) {
        f = f.getSelect(l.countrySelectorComponentName)
        b.objectIsEmpty(f) ||
          (a.locationType === c.locationTypes.country ||
          a.locationType === c.locationTypes.region ||
          (a.locationType === c.locationTypes.ip2location && !a.state)
            ? f.setValue(g.mapLocationDataToCode(a))
            : f.setValue(''))
      })
    }
    function t() {
      b.post('/gp/delivery/ajax/get-country-selections.html', {
        contentType: 'application/x-www-form-urlencoded;charset\x3dutf-8',
        params: g.prepareCountrySelectionGeneratorInput(),
        success: function (b) {
          a('#unifiedLocationCountrySelectionDiv').html(b)
          f(c.getLocationData())
        },
      })
    }
    function u(a) {
      c.changeLocation(a.data, null, function () {
        w(c.getLocationData())
      })
    }
    function x(a) {
      c.changeLocation(g.mapCodeToLocationData(a.value), null, function () {
        f(c.getLocationData())
      })
    }
    function p() {
      var b = a('#unifiedLocationAddrInput').val()
      g.validateZipCode(b)
        ? c.changeLocation(
            { zipCode: g.preprocessZipCode(b), locationType: c.locationTypes.locationInput },
            function () {
              e(3)
            },
            function () {
              e(1)
            },
          )
        : g.isMilitaryZipCode(b)
          ? e(2)
          : e(1)
    }
    function v() {
      k.when(l.addressSelectorComponentType).execute(function (a) {
        a.get(l.addressSelectorComponentName) && a.get(l.addressSelectorComponentName).hide()
      })
    }
    function r() {
      var b = a('#LUXAddressSelections .a-radio'),
        f = a('#LUXAddressSelections .a-radio.aok-hidden'),
        b = b.length === f.length
      f.slice(0, b ? l.initialAddressLoadCount : l.addressReloadCount).removeClass('aok-hidden')
      0 === a('#LUXAddressSelections .a-radio.aok-hidden').length &&
        (a('#LUXSeeMoreAddressLink').addClass('aok-hidden'),
        a('#LUXAddressActionSeparator').addClass('aok-hidden'))
      b || d.logEvent(d.getEvents().click.seeMore)
    }
    function z(a) {
      n(a)
      w(a)
      y(a)
      g.shouldPopulateCountrySelector() && f(a)
      v()
    }
    function q() {
      var f = c.getLocationData()
      y(f)
      h.isRecognizedCustomer &&
        0 === a('#LUXAddressSelections .a-radio').length &&
        0 === a('#LUXNoAddressNote').length &&
        b.get('/gp/delivery/ajax/get-address-selections.html', {
          params: {
            currentAddressId: f.addressId,
            deviceType: h.deviceType,
            isOneClickFromContext: h.isOneClick,
            clientPage: h.clientPage,
          },
          success: function (b) {
            b &&
              (a('#unifiedLocationTitleNoAddress').remove(),
              a('#unifiedLocationAccountAddrList').remove(),
              a('#unifiedLocationSeeMoreDiv').remove(),
              a('#unifiedLocationTitleSelectAddress').remove(),
              a('.lux-address-selector-divider').before(b),
              r())
          },
        })
      !a.trim(a('#unifiedLocationCountrySelectionDiv').html()).length &&
        g.shouldPopulateCountrySelector() &&
        t(f)
      d.logWidgetView(d.getEvents().view.addressSelector)
    }
    return {
      activate: function () {
        var f = c.getLocationData()
        d.logPageView(f.locationType)
        f.locationType === c.locationTypes.region && n(f)
        b.on('a:popover:beforeShow:' + l.addressSelectorComponentName, q)
        y(f)
        b.on(c.locationChangeEventName, z)
        b.declarative('lux-address-selection', ['change'], u)
        a(document).delegate('#unifiedLocationAddrInput', 'keypress', function (a) {
          13 === a.which && p()
        })
        a(document).delegate('#unifiedLocationAddrInput', 'focus', function () {
          e(3)
        })
        a(document).delegate('#unifiedLocationAddrUpdate', 'click', p)
        a(document).delegate('#unifiedLocationSignIn', 'click', function () {
          d.logEvent(d.getEvents().click.signIn)
          var a = l.signInURL + m.location.pathname
          'Search' === d.getPageType() && (a += m.location.search)
          m.location.href = a
        })
        a(document).delegate('#LUXSeeMoreAddressLink', 'click', r)
        a(document).delegate('.lux-manage-address-link', 'click', function (a) {
          d.logEvent(d.getEvents().click.manageAddressBook)
          return !0
        })
        b.on('a:dropdown:' + l.countrySelectorComponentName + ':select', x)
      },
      refresh: function (a) {
        z(c.getLocationData())
      },
    }
  })
  k.declare('LUXWidgetConfig', {
    addressSelectorComponentName: 'LUXAddressSelector',
    addressSelectorComponentType: 'a-popover',
    countrySelectorComponentName: 'LUXCountrySelector',
    countrySelectorComponentType: 'a-dropdown',
    initialAddressLoadCount: 5,
    addressReloadCount: 5,
    signInURL: '/gp/sign-in.html?ie\x3dUTF8\x26useRedirectOnSuccess\x3d1\x26path\x3d',
  })
  k.when('A', 'jQuery', 'LUXController', 'RegionNames', 'ready').register(
    'LUXRegionData',
    function (b, a, h, l) {
      function g(a) {
        if (b.objectIsEmpty(a) || !a.countryCode || !a.zipCode) return null
        for (var e in c)
          if (
            c.hasOwnProperty(e) &&
            b.reduce(
              c[e],
              function (n, h, g) {
                return n && !b.objectIsEmpty(a[g]) && b.equals(a[g], c[e][g])
              },
              !0,
            )
          )
            return e
        return null
      }
      var c = {
        'GB-ML': { countryCode: 'GB', zipCode: 'KA10 6EB' },
        'GB-NI': { countryCode: 'GB', zipCode: 'BT1 3ES' },
        'GB-JE': { countryCode: 'GB', zipCode: 'JE2 4QA' },
        'GB-IS': { countryCode: 'GB', zipCode: 'ZE1 0BX' },
        'GB-BF': { countryCode: 'GB', zipCode: 'BFPO 204' },
        'GB-HI': { countryCode: 'GB', zipCode: 'PH41 4PU' },
        'DE-ML': { countryCode: 'DE', zipCode: '60313' },
        'DE-GI': { countryCode: 'DE', zipCode: '27498' },
        'FR-ML': { countryCode: 'FR', zipCode: '75001' },
        'FR-CH': { countryCode: 'FR', zipCode: '20000' },
        'FR-GP': { countryCode: 'FR', zipCode: '97100' },
        'FR-GY': { countryCode: 'FR', zipCode: '97300' },
        'FR-MC': { countryCode: 'FR', zipCode: '98000' },
        'FR-MQ': { countryCode: 'FR', zipCode: '97200' },
        'FR-NC': { countryCode: 'FR', zipCode: '98800' },
        'FR-PF': { countryCode: 'FR', zipCode: '98700' },
        'FR-RE': { countryCode: 'FR', zipCode: '97400' },
        'FR-SB': { countryCode: 'FR', zipCode: '97133' },
        'FR-SM': { countryCode: 'FR', zipCode: '97150' },
        'FR-SP': { countryCode: 'FR', zipCode: '97500' },
        'FR-WF': { countryCode: 'FR', zipCode: '98611' },
        'FR-YT': { countryCode: 'FR', zipCode: '97600' },
        'IT-ML': { countryCode: 'IT', zipCode: '20125' },
        'IT-II': { countryCode: 'IT', zipCode: '09121' },
        'ES-ML': { countryCode: 'ES', zipCode: '28004' },
        'ES-BI': { countryCode: 'ES', zipCode: '07003' },
        'ES-CI': { countryCode: 'ES', zipCode: '35005' },
        'BR-SP': { countryCode: 'BR', zipCode: '01319900' },
      }
      return {
        getRegions: function () {
          return c
        },
        mapLocationDataToRegionCode: function (a) {
          return g(a)
        },
        mapRegionCodeToLocationData: function (b) {
          b = c.hasOwnProperty(b)
            ? a.extend(
                {},
                {
                  addressLabel: l[b],
                  countryCode: c[b].countryCode,
                  zipCode: c[b].zipCode,
                  state: c[b].state,
                  city: c[b].city,
                  locationType: h.locationTypes.region,
                },
              )
            : null
          return b
        },
      }
    },
  )
  k.when('A', 'jQuery', 'ready').register('LUXRegionConfig', function (b, a) {
    var h = [],
      l =
        'AD AE AF AG AI AL AM AN AO AQ AR AS AT AU AW AX AZ BA BB BD BE BF BG BH BI BJ BL BM BN BO BQ BR BS BT BV BW BY BZ CA CC CD CF CG CH CI CK CL CM CN CO CR CU CV CW CX CY CZ DE DJ DK DM DO DZ EC EE EG EH ER ES ET FI FJ FK FM FO FR GA GB GD GE GF GG GH GI GL GM GN GP GQ GR GS GT GU GW GY HK HM HN HR HT HU ID IE IL IM IN IO IQ IR IS IT JE JM JO JP KE KG KH KI KM KN KP KR KW KY KZ LA LB LC LI LK LR LS LT LU LV LY MA MC MD ME MF MG MH MK ML MM MN MO MP MQ MR MS MT MU MV MW MX MY MZ NA NC NE NF NG NI NL NO NP NR NU NZ OM PA PE PF PG PH PK PL PM PN PR PS PT PW PY QA RE RO RS RU RW SA SB SC SD SE SG SH SI SJ SK SL SM SN SO SR SS ST SV SX SY SZ TC TD TF TG TH TJ TK TL TM TN TO TR TT TV TW TZ UA UG UM US UY UZ VA VC VE VG VI VN VU WF WS XK YE YT ZA ZM ZW'.split(
          ' ',
        ),
      g = /^\d{5}([ \-]\d{4})?$/,
      c =
        /^[ \t]*([AFD](\.?)([ \t]?)P(\.?)([ \t]?)O(\.?)[ \t]*[A-Z]{2}[ \t]*[0-9]{5}([ \-][0-9]{4})?)[ \t]*$/
    return {
      getPrimarySelections: function () {
        return h
      },
      getSecondarySelections: function () {
        return l
      },
      getZipCodePattern: function () {
        return g
      },
      getMilitaryZipCodePattern: function () {
        return c
      },
      preprocessZipCode: function (a) {
        return a.toUpperCase().trim().substring(0, 5)
      },
    }
  })
  k.declare('RegionNames', {
    'GB-ML': 'UK - Mainland',
    'GB-BF': 'UK - BFPO',
    'GB-JE': 'UK - Channel Islands',
    'GB-IS': 'UK - Islands',
    'GB-NI': 'UK - Northern Ireland',
    'GB-HI': 'UK - Scottish Highlands',
    'DE-ML': 'Germany - Mainland',
    'DE-GI': 'German Islands',
    'FR-ML': 'France - Mainland',
    'FR-CH': 'Corsica',
    'FR-GP': 'Guadeloupe',
    'FR-GY': 'Guyane',
    'FR-MC': 'Monaco',
    'FR-MQ': 'Martinique',
    'FR-NC': 'New Caledonia',
    'FR-PF': 'French Polynesia',
    'FR-RE': 'Reunion',
    'FR-SB': 'Saint Barthlemy',
    'FR-SM': 'Saint Martin',
    'FR-SP': 'Saint Pierre and Miquelon',
    'FR-WF': 'Wallis and Futuna Islands',
    'FR-YT': 'Mayotte',
    'IT-ML': 'Italy - Mainland',
    'IT-II': 'Italian Islands',
    'ES-ML': 'Spain - Mainland',
    'ES-BI': 'Spain - Balearic Islands',
    'ES-CI': 'Spain - Canary Islands, Ceuta and Melilla',
    'BR-SP': 'Brazil',
  })
  k.declare('CountryNames', {
    AD: 'Andorra',
    AE: 'United Arab Emirates',
    AF: 'Afghanistan',
    AG: 'Antigua and Barbuda',
    AI: 'Anguilla',
    AL: 'Albania',
    AM: 'Armenia',
    AN: 'Netherlands Antilles',
    AO: 'Angola',
    AQ: 'Antarctica',
    AR: 'Argentina',
    AS: 'American Samoa',
    AT: 'Austria',
    AU: 'Australia',
    AW: 'Aruba',
    AX: 'Aland Islands',
    AZ: 'Azerbaijan',
    BA: 'Bosnia and Herzegovina',
    BB: 'Barbados',
    BD: 'Bangladesh',
    BE: 'Belgium',
    BF: 'Burkina Faso',
    BG: 'Bulgaria',
    BH: 'Bahrain',
    BI: 'Burundi',
    BJ: 'Benin',
    BL: 'Saint Barthelemy',
    BM: 'Bermuda',
    BN: 'Brunei Darussalam',
    BO: 'Bolivia',
    BQ: 'Bonaire, Saint Eustatius and Saba',
    BR: 'Brazil',
    BS: 'Bahamas, The',
    BT: 'Bhutan',
    BV: 'Bouvet Island',
    BW: 'Botswana',
    BY: 'Belarus',
    BZ: 'Belize',
    CA: 'Canada',
    CC: 'Cocos (Keeling) Islands',
    CD: 'Congo, The Democratic Republic of the',
    CF: 'Central African Republic',
    CG: 'Congo',
    CH: 'Switzerland',
    CI: "Cote D'ivoire",
    CK: 'Cook Islands',
    CL: 'Chile',
    CM: 'Cameroon',
    CN: 'China',
    CO: 'Colombia',
    CR: 'Costa Rica',
    CS: 'Serbia and Montenegro',
    CU: 'Cuba',
    CV: 'Cape Verde',
    CW: 'Curaao',
    CX: 'Christmas Island',
    CY: 'Cyprus',
    CZ: 'Czech Republic',
    DE: 'Germany',
    DJ: 'Djibouti',
    DK: 'Denmark',
    DM: 'Dominica',
    DO: 'Dominican Republic',
    DZ: 'Algeria',
    EC: 'Ecuador',
    EE: 'Estonia',
    EG: 'Egypt',
    EH: 'Western Sahara',
    ER: 'Eritrea',
    ES: 'Spain',
    ET: 'Ethiopia',
    FI: 'Finland',
    FJ: 'Fiji',
    FK: 'Falkland Islands (Malvinas)',
    FM: 'Micronesia, Federated States of',
    FO: 'Faroe Islands',
    FR: 'France',
    GA: 'Gabon',
    GB: 'United Kingdom',
    GD: 'Grenada',
    GE: 'Georgia',
    GF: 'French Guiana',
    GG: 'Guernsey',
    GH: 'Ghana',
    GI: 'Gibraltar',
    GL: 'Greenland',
    GM: 'Gambia, The',
    GN: 'Guinea',
    GP: 'Guadeloupe',
    GQ: 'Equatorial Guinea',
    GR: 'Greece',
    GS: 'South Georgia and the South Sandwich Islands',
    GT: 'Guatemala',
    GU: 'Guam',
    GW: 'Guinea-Bissau',
    GY: 'Guyana',
    HK: 'Hong Kong',
    HM: 'Heard Island and the McDonald Islands',
    HN: 'Honduras',
    HR: 'Croatia',
    HT: 'Haiti',
    HU: 'Hungary',
    ID: 'Indonesia',
    IE: 'Ireland',
    IL: 'Israel',
    IM: 'Isle of Man',
    IN: 'India',
    IO: 'British Indian Ocean Territory',
    IQ: 'Iraq',
    IR: 'Iran, Islamic Republic of',
    IS: 'Iceland',
    IT: 'Italy',
    JE: 'Jersey',
    JM: 'Jamaica',
    JO: 'Jordan',
    JP: 'Japan',
    KE: 'Kenya',
    KG: 'Kyrgyzstan',
    KH: 'Cambodia',
    KI: 'Kiribati',
    KM: 'Comoros',
    KN: 'Saint Kitts and Nevis',
    KP: "Korea, Democratic People's Republic of",
    KR: 'Korea, Republic of',
    KW: 'Kuwait',
    KY: 'Cayman Islands',
    KZ: 'Kazakhstan',
    LA: "Lao People's Democratic Republic",
    LB: 'Lebanon',
    LC: 'Saint Lucia',
    LI: 'Liechtenstein',
    LK: 'Sri Lanka',
    LR: 'Liberia',
    LS: 'Lesotho',
    LT: 'Lithuania',
    LU: 'Luxembourg',
    LV: 'Latvia',
    LY: 'Libya',
    MA: 'Morocco',
    MC: 'Monaco',
    MD: 'Moldova, Republic of',
    ME: 'Montenegro',
    MF: 'Saint Martin',
    MG: 'Madagascar',
    MH: 'Marshall Islands',
    MK: 'Macedonia, The Former Yugoslav Republic of',
    ML: 'Mali',
    MM: 'Myanmar',
    MN: 'Mongolia',
    MO: 'Macao',
    MP: 'Northern Mariana Islands',
    MQ: 'Martinique',
    MR: 'Mauritania',
    MS: 'Montserrat',
    MT: 'Malta',
    MU: 'Mauritius',
    MV: 'Maldives',
    MW: 'Malawi',
    MX: 'Mexico',
    MY: 'Malaysia',
    MZ: 'Mozambique',
    NA: 'Namibia',
    NC: 'New Caledonia',
    NE: 'Niger',
    NF: 'Norfolk Island',
    NG: 'Nigeria',
    NI: 'Nicaragua',
    NL: 'Netherlands',
    NO: 'Norway',
    NP: 'Nepal',
    NR: 'Nauru',
    NU: 'Niue',
    NZ: 'New Zealand',
    OM: 'Oman',
    PA: 'Panama',
    PE: 'Peru',
    PF: 'French Polynesia',
    PG: 'Papua New Guinea',
    PH: 'Philippines',
    PK: 'Pakistan',
    PL: 'Poland',
    PM: 'Saint Pierre and Miquelon',
    PN: 'Pitcairn',
    PR: 'Puerto Rico',
    PS: 'Palestinian Territories',
    PT: 'Portugal',
    PW: 'Palau',
    PY: 'Paraguay',
    QA: 'Qatar',
    RE: 'Reunion',
    RO: 'Romania',
    RS: 'Serbia',
    RU: 'Russian Federation',
    RW: 'Rwanda',
    SA: 'Saudi Arabia',
    SB: 'Solomon Islands',
    SC: 'Seychelles',
    SD: 'Sudan',
    SE: 'Sweden',
    SG: 'Singapore',
    SH: 'Saint Helena, Ascension and Tristan da Cunha',
    SI: 'Slovenia',
    SJ: 'Svalbard and Jan Mayen',
    SK: 'Slovakia',
    SL: 'Sierra Leone',
    SM: 'San Marino',
    SN: 'Senegal',
    SO: 'Somalia',
    SR: 'Suriname',
    SS: 'South Sudan',
    ST: 'Sao Tome and Principe',
    SV: 'El Salvador',
    SX: 'Sint Maarten',
    SY: 'Syria',
    SZ: 'Swaziland',
    TC: 'Turks and Caicos Islands',
    TD: 'Chad',
    TF: 'French Southern Territories',
    TG: 'Togo',
    TH: 'Thailand',
    TJ: 'Tajikistan',
    TK: 'Tokelau',
    TL: 'Timor-leste',
    TM: 'Turkmenistan',
    TN: 'Tunisia',
    TO: 'Tonga',
    TR: 'Turkey',
    TT: 'Trinidad and Tobago',
    TV: 'Tuvalu',
    TW: 'Taiwan',
    TZ: 'Tanzania, United Republic of',
    UA: 'Ukraine',
    UG: 'Uganda',
    UM: 'United States Minor Outlying Islands',
    US: 'United States',
    UY: 'Uruguay',
    UZ: 'Uzbekistan',
    VA: 'Holy See',
    VC: 'Saint Vincent and the Grenadines',
    VE: 'Venezuela',
    VG: 'Virgin Islands, British',
    VI: 'Virgin Islands, U.S.',
    VN: 'Vietnam',
    VU: 'Vanuatu',
    WF: 'Wallis and Futuna',
    WS: 'Samoa',
    XK: 'Kosovo',
    YE: 'Yemen',
    YT: 'Mayotte',
    YU: 'Yugoslavia',
    ZA: 'South Africa',
    ZM: 'Zambia',
    ZW: 'Zimbabwe',
  })
  k.when(
    'A',
    'jQuery',
    'LUXController',
    'LUXRegionData',
    'LUXRegionConfig',
    'LUXContext',
    'CountryNames',
    'RegionNames',
  ).register('LUXUtils', function (b, a, h, l, g, c, d, e) {
    function n(a) {
      return !b.objectIsEmpty(a) && a.countryCode && d.hasOwnProperty(a.countryCode)
        ? b.equals(a.locationType, h.locationTypes.country)
          ? a.countryCode
          : b.equals(a.locationType, h.locationTypes.region)
            ? l.mapLocationDataToRegionCode(a)
            : l.mapLocationDataToRegionCode(a) || a.countryCode
        : null
    }
    function k(a) {
      return d.hasOwnProperty(a) ? d[a] : e.hasOwnProperty(a) ? e[a] : null
    }
    function m(a) {
      var c = {}
      if (!b.objectIsEmpty(a)) for (var d = a.length, e = 0; e < d; e++) c[k(a[e])] = a[e]
      return c
    }
    return {
      getNameForCode: function (a) {
        return k(a)
      },
      mapCodeToLocationData: function (a) {
        a = a
          ? d.hasOwnProperty(a)
            ? { countryCode: a, locationType: h.locationTypes.country, district: a }
            : l.mapRegionCodeToLocationData(a)
          : null
        return a
      },
      mapLocationDataToCode: function (a) {
        return n(a)
      },
      generateLocationLabel: function (a) {
        a.addressLabel
          ? (a = a.addressLabel)
          : a.locationType !== h.locationTypes.region &&
              a.locationType !== h.locationTypes.country &&
              a.zipCode
            ? (g.formatZipCodeForAddressLabel &&
                (a.zipCode = g.formatZipCodeForAddressLabel(a.zipCode)),
              (a =
                a.city || a.state
                  ? g.generateDiffLocationLabelForZip
                    ? g.generateDiffLocationLabelForZip(a)
                    : (a.city ? a.city + ', ' : '') + (a.state ? a.state + ' ' : '') + a.zipCode
                  : g.formatZipCodeForAddressLabel
                    ? a.zipCode
                    : k(n(a))))
            : (a = k(n(a)))
        return a
      },
      prepareCountrySelectionGeneratorInput: function () {
        return {
          deviceType: c.deviceType,
          primarySelections: JSON.stringify(m(g.getPrimarySelections())),
          primarySelectionsOrder: JSON.stringify(g.getPrimarySelections()),
          secondarySelections: JSON.stringify(m(g.getSecondarySelections())),
        }
      },
      validateZipCode: function (a) {
        return !b.objectIsEmpty(a) && g.getZipCodePattern().test(a.toUpperCase())
      },
      preprocessZipCode: function (a) {
        return g.preprocessZipCode(a)
      },
      isMilitaryZipCode: function (a) {
        return !b.objectIsEmpty(a) && g.getMilitaryZipCodePattern().test(a.toUpperCase())
      },
      shouldPopulateCountrySelector: function () {
        var a = !0
        'undefined' !== typeof c.shouldPopulateCountrySelector &&
          (a = c.shouldPopulateCountrySelector)
        return a
      },
    }
  })
  k.when('A', 'jQuery', 'LUXContext', 'ready').register('LUXMetrics', function (b, a, h) {
    function l(a, b) {
      m.ueLogError &&
        a &&
        m.ueLogError({ message: a }, { logLevel: b || 'ERROR', attribution: 'LocationUX' })
    }
    function g(a) {
      m.ue
        ? m.ue.count(a, (m.ue.count(a) || 0) + 1)
        : l(
            'Failed to increment metrics counter: ' + a + ' because window.ue is not present.',
            'ERROR',
          )
    }
    function c() {
      var a
      if ((a = m.ue_pty))
        a: {
          a = m.ue_pty
          for (var c in d)
            if (d.hasOwnProperty(c) && -1 !== b.indexOfArray(d[c], a)) {
              a = !0
              break a
            }
          a = !1
        }
      return a ? m.ue_pty : 'unrecognizedPage'
    }
    var d = {
        detail: ['Detail', 'DetailAW', 'DetailWebView', 'TabletUDP'],
        search: ['Search', 'SearchAW'],
        offerListing: ['OfferListing', 'OfferListingAW', 'OfferListingMobileAppAW'],
      },
      e = {
        click: {
          signIn: 'click.signIn',
          seeMore: 'click.seeMore',
          manageAddressBook: 'click.manageAddressBook',
        },
        view: {
          page: 'view.page',
          addressSelector: 'view.addressSelector',
          countrySelector: 'view.countrySelector',
        },
        selection: 'selection',
        override: 'override',
      }
    return {
      getPageType: function () {
        return c()
      },
      getEvents: function () {
        return e
      },
      logLocationChange: function (a) {
        k.when('LUXController').execute(function (k) {
          var l = c(),
            f = 'LocationUX.' + l,
            f =
              b.equals(a, k.locationTypes.locationInput) ||
              b.equals(a, k.locationTypes.realmDefault) ||
              b.equals(a, k.locationTypes.ip2location)
                ? f + ('.' + e.override + '.' + a)
                : f + ('.' + e.selection + '.' + a)
          b.equals(a, k.locationTypes.defaultAddress) ||
            b.equals(a, k.locationTypes.accountAddress) ||
            b.equals(a, k.locationTypes.lockerAddress) ||
            (f += '.' + (h.isRecognizedCustomer ? 'recognized' : 'unrecognized'))
          ;-1 !== b.indexOfArray(d.detail, l) &&
            h.isRecognizedCustomer &&
            (f += '.' + (h.isOneClick ? '1Click' : 'Non1Click'))
          g(f)
        })
      },
      logPageView: function (a) {
        k.when('LUXController').execute(function (k) {
          var l = c(),
            f = 'LocationUX.' + l + '.' + e.view.page + '.' + a
          b.equals(a, k.locationTypes.defaultAddress) ||
            b.equals(a, k.locationTypes.accountAddress) ||
            b.equals(a, k.locationTypes.lockerAddress) ||
            (f += '.' + (h.isRecognizedCustomer ? 'recognized' : 'unrecognized'))
          ;-1 !== b.indexOfArray(d.detail, l) &&
            h.isRecognizedCustomer &&
            (f += '.' + (h.isOneClick ? '1Click' : 'Non1Click'))
          g(f)
        })
      },
      logWidgetView: function (a) {
        var e = c()
        a =
          'LocationUX.' +
          e +
          '.' +
          a +
          '.' +
          (h.isRecognizedCustomer ? 'recognized' : 'unrecognized')
        ;-1 !== b.indexOfArray(d.detail, e) &&
          h.isRecognizedCustomer &&
          (a += '.' + (h.isOneClick ? '1Click' : 'Non1Click'))
        g(a)
      },
      logEvent: function (a) {
        a = 'LocationUX.' + c() + '.' + a
        g(a)
      },
      logError: function (a, b) {
        l(a, b)
      },
    }
  })
})
/* ******** */
;(function (d) {
  var f = window.AmazonUIPageJS || window.P,
    k = f._namespace || f.attributeErrors,
    a = k ? k('ListsCommonUtilityAssets', '') : f
  a.guardFatal
    ? a.guardFatal(d)(a, window)
    : a.execute(function () {
        d(a, window)
      })
})(function (d, f, k) {
  d.when('A').register('al-ajax-response-state-parser', function (a) {
    var b = a.$
    return {
      getState: function (c) {
        c = b(c).filter('#listsAjaxResponseStateSection')
        var e = b('#listsAjaxResponseStateSection')
        e && 0 <= e.length && e.remove()
        b(c).appendTo('body')
        a.state.parse()
        c = a.state('listsAjaxResponseState') || {}
        return {
          hasError: c.hasError,
          authRequired: c.authRequired,
          authUrl: c.authUrl,
          error: c.error,
        }
      },
    }
  })
  ;('use strict')
  d.when('A', 'al-bottomsheet-with-fallback', 'iphone-x-detector').register(
    'bottom-sheet-utils',
    function (a, b, c) {
      var e = a.$
      a.declarative('al-sheet-with-fallback', 'click', function (e) {
        e.$event.preventDefault()
        var a = e.data
        e = b.create(
          b.buildComponentParams(
            a.componentName,
            a.showCloseButton,
            c.getAdjustedHeightPx(a.bottomsheetHeight),
            a.popoverHeight,
            a.popoverWidth,
            a.headerForPopover,
            a.viewLabel,
            a.viewDescription ? a.viewDescription : a.viewLabel,
            a.paddingForPopover,
            a.closeMessage,
          ),
          e.$target,
        )
        b.show(e)
      })
      return {
        raiseBottomsheet: function (b) {
          b = e(b).parents('.a-sheet-web-container')
          b.css('z-index', 1e4)
          b.siblings('.a-sheet-lightbox').css('z-index', 8e3)
        },
      }
    },
  )
  ;('use strict')
  d.when('A').register('al-bottomsheet-with-fallback', function (a) {
    function b(b) {
      f.ueLogError && f.ueLogError({ logLevel: 'ERROR', message: b })
    }
    var c, e
    d.when('a-sheet').execute(function (b) {
      c = b
    })
    d.when('a-modal').execute(function (b) {
      e = b
    })
    var g = function (a) {
        if (a) return c ? c.get(a.name) : e.get(a.name)
        b('No ComponentParams specified. Please generate componentParams using .create(component)')
      },
      n = { IS_POPOVER_LABEL: 'IS_POPOVER', IS_BOTTOMSHEET_LABEL: 'IS_BOTTOMSHEET' }
    return {
      create: function (a, p) {
        if (a) return c ? c.create(a) : e.create(p, a), a
        b('No ComponentParams specified. Please generate componentParams using .create(component)')
      },
      show: function (a) {
        ;(a = g(a))
          ? a.show()
          : b('No View Created. Please create a view first by calling .create(component)')
      },
      hide: function (a) {
        ;(a = g(a))
          ? a.hide()
          : b('No View Created. Please create a view first by calling .create(component)')
      },
      changeHeight: function (a, e, d) {
        var l = g(a)
        l
          ? c
            ? (l.changeHeight({ height: e, duration: d }), (a.bottomsheetHeight = e))
            : (l.update({ height: e }), (a.popoverHeight = e))
          : b('No View Found. Please create a view first by calling .create(component)')
      },
      remove: function (a) {
        ;(a = g(a))
          ? a.$container.remove()
          : b('No View Created. Please create a view first by calling .create(component)')
      },
      exists: function (a) {
        return g(a) ? !0 : !1
      },
      onCloseExecute: function (e, d, g) {
        if ('function' !== typeof d) b('Expected onCloseFunction to be of type function')
        else if (e)
          a.on(
            (c ? 'a:sheet' : 'a:popover') + ':' + (g ? 'beforeHide' : 'afterHide') + ':' + e.name,
            d,
          )
        else
          b(
            'No ComponentParams specified. Please generate componentParams using .create(component)',
          )
      },
      onOpenExecute: function (e, d, g) {
        if ('function' !== typeof d) b('Expected onOpenFunction to be of type function')
        else if (e)
          a.on(
            (c ? 'a:sheet' : 'a:popover') + ':' + (g ? 'beforeShow' : 'afterShow') + ':' + e.name,
            d,
          )
        else
          b(
            'No ComponentParams specified. Please generate componentParams using .create(component)',
          )
      },
      buildComponentParams: function (a, b, e, d, g, f, u, v, w, x) {
        var l = c !== k,
          h = { viewTypeLabel: l ? n.IS_BOTTOMSHEET_LABEL : n.IS_POPOVER_LABEL, name: a }
        l
          ? ((h.closeType = b ? 'icon' : x ? 'message' : k),
            (h.closeMessage = x),
            (h.height = e),
            (h.sheetLabel = u),
            (h.sheetDescription = v),
            (h.preloadDomId = a))
          : ((h.closeButton = b),
            (h.height = d),
            (h.width = g),
            (h.dataStrategy = 'preload'),
            (h.header = f),
            (h.hideHeader = f === k),
            (h.padding = w !== k ? w : 'none'),
            (h.popoverLabel = u))
        return h
      },
      VIEW_TYPE_LABELS: n,
    }
  })
  ;('use strict')
  d.when('A').register('lists-dpx-common-utils', function (a) {
    return {
      urlParamValue: function (a) {
        for (var b = f.location.search.substring(1).split('\x26'), e = 0; e < b.length; e++) {
          var d = b[e].split('\x3d')
          if (d[0] === a) return d[1]
        }
      },
    }
  })
  ;('use strict')
  d.when('A').register('iphone-x-detector', function () {
    function a() {
      try {
        var a = b()
        c.forEach(function (b) {
          if (-1 < a.indexOf(b)) return !0
        })
      } catch (g) {}
      return !1
    }
    function b() {
      try {
        a: {
          for (var a = document.cookie.split(';'), b = 0; b < a.length; b++) {
            for (var c = a[b]; ' ' === c.charAt(0); ) c = c.substring(1, c.length)
            if (0 === c.indexOf('amzn-app-ctxt\x3d')) {
              var d = c.substring(14, c.length)
              break a
            }
          }
          d = null
        }
        if (d) {
          var f = d.match(/"v":.*%2C*/)
          if (f) return f.toString().toLowerCase()
        }
      } catch (m) {}
      return ''
    }
    var c = ['iphone10', 'iphone11']
    return {
      isIphoneX: a,
      getDeviceType: b,
      getAdjustedHeightPx: function (b) {
        try {
          if (((b = parseInt(b, 10)), a())) return b + 40
        } catch (g) {}
        return b
      },
    }
  })
  ;('use strict')
  d.when('A', 'lists-metric-logger').register('amazon-lists-csrf-utils', function (a, b) {
    var c = a.$
    return {
      addCsrfToken: function (a) {
        0 !== c('meta[id\x3d"lists-sp-csrf-meta-token"]').length
          ? (a['anti-csrftoken-a2z'] = c('meta[id\x3d"lists-sp-csrf-meta-token"]').attr('content'))
          : 0 !== c('input[id\x3d"lists-sp-csrf-form-token"]').length
            ? (a['anti-csrftoken-a2z'] = c('input[id\x3d"lists-sp-csrf-form-token"]').attr('value'))
            : 0 !== c('input[id\x3d"lists-sp-csrf-input-token"]').length
              ? (a['anti-csrftoken-a2z'] = c('input[id\x3d"lists-sp-csrf-input-token"]').attr(
                  'value',
                ))
              : b.incrementMetricCountByOne('Lists:CSRF:UnableToRetrieveToken')
      },
      hasCsrfToken: function (a) {
        a = a['anti-csrftoken-a2z']
        return '' !== a && a !== k
      },
    }
  })
  ;('use strict')
  d.when('A', 'lists-metric-logger').register('idea-list-csrf-utils', function (a, b) {
    var c = a.$
    return {
      addIdeaListCsrfToken: function (a) {
        0 !== c('input[id\x3d"creator-sp-csrf-form-token"]').length
          ? (a['anti-csrftoken-a2z'] = c('input[id\x3d"creator-sp-csrf-form-token"]').attr('value'))
          : b.incrementMetricCountByOne('Lists:CSRF:UnableToRetrieveToken')
      },
    }
  })
  ;('use strict')
  d.when('A', 'amazon-lists-csrf-utils').register('lists-ajax-handler', function (a, b) {
    function c(a) {
      b.hasCsrfToken(a) || b.addCsrfToken(a)
    }
    function d(a, b) {
      'function' === typeof a ? a(b) : r('callableFunction passed in is not callable: ' + a)
    }
    function g(a, b, c) {
      m(a)
      c && m(p(a, c))
      b && m(p(a, b))
      b && c && m(p(a, b, c))
    }
    function n(a) {
      m('lists_ajax_before_send')
      a && m(p('lists_ajax_before_send', a))
    }
    function l(a) {
      try {
        return a.replaceAll('/', '_')
      } catch (v) {
        r('Replace all failed for URL: ' + a)
      }
    }
    function p(a, b, c) {
      return [a, b, c]
        .filter(function (a) {
          return '' !== a && a !== k
        })
        .join(':')
    }
    function m(a) {
      q && q.count(a, (q.count(a) || 0) + 1)
    }
    function r(a) {
      f.ueLogError(k, {
        logLevel: 'ERROR',
        attribution: 'ListsCommonUtilityAssets::ListsAjaxHandler',
        message: a,
      })
    }
    var t = a.$,
      q = f.ue
    return {
      post: function (a) {
        var b = a.headers || []
        c(b)
        var e = l(a.url)
        n(e)
        return t.ajax({
          type: 'POST',
          url: a.url,
          cache: a.isCached,
          headers: b,
          data: a.params,
          timeout: a.timeout,
          success: function (b, c) {
            g('lists_ajax_success', e, c)
            d(a.successCallback, b)
          },
          error: function (b, c) {
            g('lists_ajax_error', e, c)
            d(a.errorCallback)
          },
        })
      },
      get: function (a) {
        var b = l(a.url)
        n(b)
        return t.ajax({
          type: 'GET',
          url: a.url,
          headers: a.headers,
          cache: a.isCached,
          data: a.params,
          timeout: a.timeout,
          success: function (c, e) {
            g('lists_ajax_success', b, e)
            d(a.successCallback, c)
          },
          error: function (c, e) {
            g('lists_ajax_error', b, e)
            d(a.errorCallback)
          },
        })
      },
    }
  })
  ;('use strict')
  d.when('A').register('lists-mash-overlay-helper', function () {
    function a(a) {
      return b && b.dispatchEvent && 'function' === typeof b.dispatchEvent
        ? (b.dispatchEvent({ type: a }), !0)
        : !1
    }
    var b
    d.when('mash').execute('amazon-lists-mash-api-registration', function (a) {
      b = a
    })
    return {
      hideGLOWOverlay: function () {
        return a('appOverlays.Hide')
      },
      showGLOWOverlay: function () {
        return a('appOverlays.Show')
      },
    }
  })
  ;('use strict')
  d.when('A').register('al-client-side-widget-latency-helper', function () {
    var a = { wb: 1 }
    return {
      emitFeatureBegin: function (b) {
        b && 'function' == typeof f.uet && f.uet('bb', b, a)
      },
      emitFeatureLoaded: function (b) {
        b && 'function' == typeof f.uet && f.uet('cf', b, a)
        b && 'function' == typeof f.uex && f.uex('ld', b, a)
      },
    }
  })
  ;('use strict')
  d.when('A').register('lists-update-cart-count', function (a) {
    return {
      updateCartCount: function (a) {
        d.when('mash').execute(function (b) {
          b.cart.didUpdate({
            newCartQuantity: a,
            successCallback: function () {
              f.amazon.cordova.notification.vibrate(50)
            },
            failCallback: null,
          })
        })
        d.when('nav.setCartCount').execute(function (b) {
          b(a)
        })
      },
    }
  })
  ;('use strict')
  d.register('lists-metric-logger', function () {
    return {
      incrementMetricCountByOne: function (a) {
        var b = f.ue
        b && b.count(a, (b.count(a) || 0) + 1)
      },
    }
  })
})
/* ******** */
;(function (l) {
  var k = window.AmazonUIPageJS || window.P,
    n = k._namespace || k.attributeErrors,
    e = n ? n('ListsCreateAssets', '') : k
  e.guardFatal
    ? e.guardFatal(l)(e, window)
    : e.execute(function () {
        l(e, window)
      })
})(function (l, k, n) {
  l.when(
    'A',
    'al-bottomsheet-with-fallback',
    'al-ajax-response-state-parser',
    'create-new-list-hz',
    'bottom-sheet-utils',
    'lists-dpx-common-utils',
    'lists-mash-overlay-helper',
  ).execute(function (e, d, r, q, C, x, z) {
    function t(a) {
      var c = a.data || {}
      'HEARTS_V2_SELECT_HEARTING_BOTTOMSHEET' === h() && u && f && d.remove(f)
      f = d.create(
        d.buildComponentParams(
          c.componentName,
          !0,
          v,
          430,
          400,
          n,
          c.viewName,
          c.viewDescription,
          n,
          c.closeMessage,
        ),
        a.$target,
      )
      z.hideGLOWOverlay()
      d.show(f)
      'DETAIL_PAGE' === h() &&
        w &&
        (d.onOpenExecute(f, g),
        d.onCloseExecute(
          f,
          function () {
            z.showGLOWOverlay()
          },
          !1,
        ))
    }
    function g() {
      C.raiseBottomsheet('#create-list-form-wrapper')
      d.changeHeight(f, v, 0)
    }
    function D(a) {
      var c = k.ue ? k.ue.rid : n
      a = { createIngressName: a.ingressName, isHearts: !1, sourceVendorId: a.sourceVendorId }
      c && (a.relatedRequestID = c)
      'HEARTS_V2_SELECT_HEARTING_BOTTOMSHEET' === h() && u && (a.isHearts = !0)
      m.ajax({
        type: 'GET',
        url: '/hz/wishlist/create',
        data: a,
        success: E,
        error: function (a, c, b) {
          A('Failed to fetch CreateList-Form. Status: ' + c + '; Error: ' + b)
        },
        timeout: 2e4,
      })
    }
    function E(a) {
      var c = m(a).filter('#createlist-form-container')
      a = r.getState(a)
      a.authRequired && a.authUrl
        ? (k.location.href = a.authUrl)
        : a.hasError
          ? A('CreateList form has error \x3d ' + a.error)
          : (c.find('#bottomSheetSize').length &&
              ((v = c.find('#bottomSheetSize').val()), d.changeHeight(f, v, 0)),
            m('#create-list-form-wrapper').html(c),
            b('#create-list-form-spinner'),
            B('#create-list-form-wrapper'))
    }
    function b(a) {
      m(a).addClass('aok-hidden')
    }
    function B(a) {
      m(a).removeClass('aok-hidden')
    }
    function A(a) {
      d.changeHeight(f, 110)
      b('#create-list-form-spinner')
      b('#create-list-form-wrapper')
      B('#createlist-form-loading-error-section')
      k.ueLogError && k.ueLogError({ logLevel: 'FATAL', message: a })
      if ('DETAIL_PAGE' !== h() || !w) d.onCloseExecute(f, H, !1)
    }
    function H() {
      b('#createlist-form-loading-error-section')
      b('#create-list-form-wrapper')
      B('#create-list-form-spinner')
      k.location.reload()
    }
    function I(a, c, b) {
      A('List creation failed. Status: ' + c + '; Error: ' + b)
    }
    function p(a) {
      a.hasError
        ? A('List creation failed with Error: ' + a.error)
        : 'YOUR_STUFF_LISTS_CAROUSEL' === h() && F
          ? (d.onCloseExecute(
              f,
              function () {
                F.bufferReloadOnBackNavigation()
                k.location = '/hz/wishlist/ls/' + a.listExternalId
              },
              !1,
            ),
            d.hide(f))
          : (d.hide(f), (k.location = '/hz/wishlist/ls/' + a.listExternalId))
    }
    function h() {
      return (e.state('createListIngressState') || {}).ingressName
    }
    function y() {
      m('#createlist-list-name-textinput').parent('div').addClass('a-form-error')
      m('#mobile-alert-list-name').removeClass('aok-hidden')
      m('#createlist-list-name-textinput')
        .attr('aria-describedby', 'mobile-alert-list-name')
        .attr('aria-invalid', !0)
        .focus()
    }
    function G() {
      m('#createlist-list-name-textinput').parent('div').removeClass('a-form-error')
      m('#mobile-alert-list-name').addClass('aok-hidden')
      m('#createlist-list-name-textinput').removeAttr('aria-describedby').removeAttr('aria-invalid')
    }
    var m = e.$,
      v = 380,
      w,
      u,
      F,
      f
    e.declarative('awl-create-list-bottomsheet', 'click', function (a) {
      var c = a.data || {}
      e.state('createListIngressState', { ingressName: c.ingressName })
      var b = c.componentName
      b && 'function' == typeof uet && uet('bb', b, { wb: 1 })
      t(a)
      D(c)
      ;(a = c.componentName) && 'function' == typeof uet && uet('cf', a, { wb: 1 })
      a && 'function' == typeof uex && uex('ld', a, { wb: 1 })
    })
    e.declarative('list-name-toggle', 'click', function (a) {
      if ('input' === a.targetTag) {
        var c = m('span[data-action\x3dcreate-list-bottomsheet-submit]')[0],
          b = JSON.parse(c.getAttribute('data-create-list-bottomsheet-submit')),
          d = document.getElementById('createlist-list-name-textinput')
        b.persistence = a.data.persistence
        c.setAttribute('data-create-list-bottomsheet-submit', JSON.stringify(b))
        d.value = a.data.name
      }
    })
    e.declarative('create-list-bottomsheet-submit', 'click', function (a) {
      a = a.data || {}
      var c = k.ue ? k.ue.rid : n
      c && (a.relatedRequestID = c)
      c = m('#createlist-list-name-textinput').val()
      c === n || 0 === c.length
        ? y()
        : (G(),
          b('#createlist-form-loading-error-section'),
          b('#create-list-form-wrapper'),
          B('#create-list-form-spinner'),
          (a.listName = c),
          (c = x.urlParamValue('createAndAddAsin')) && 0 < c.length && (a.asin = c),
          'DETAIL_PAGE' === h() && w
            ? ((c = w.getAsin()) && 0 < c.length && (a.asin = c),
              q(a, w.handleSuccess, w.handleError))
            : 'HEARTS_V2_SELECT_HEARTING_BOTTOMSHEET' === h() && u
              ? ((c = u.getAsin()) && 0 < c.length && (a.asin = c),
                d.hide(f),
                q(a, u.onCreateSuccess, u.onCreateError))
              : ((c = e.state('atwl')),
                c !== n && c.asin !== n && 0 < c.asin.length && (a.asin = m.trim(c.asin)),
                q(a, p, I)))
    })
    l.when('dp-create-list-handler').execute(function (a) {
      w = a
    })
    l.when('hearts-v2-create-list-handler').execute(function (a) {
      u = a
    })
    l.when('lists-your-saves-refresh-utils').execute(function (a) {
      F = a
    })
    e.on('a:expander:create-list-learn-more-popover:toggle:expand', function () {
      f.viewTypeLabel === d.VIEW_TYPE_LABELS.IS_BOTTOMSHEET_LABEL
        ? d.changeHeight(f, v + 165)
        : d.changeHeight(f, 580)
    })
    e.on('a:expander:create-list-learn-more-popover:toggle:collapse', function () {
      d.changeHeight(f, v)
      f.viewTypeLabel === d.VIEW_TYPE_LABELS.IS_BOTTOMSHEET_LABEL
        ? d.changeHeight(f, v)
        : d.changeHeight(f, 430)
    })
    e.declarative('createlist-list-name-validation', ['keyup'], function (a) {
      a = a.$target.context.value
      0 !== a.length &&
      m('#createlist-list-name-textinput').parent('div').hasClass('a-form-error') &&
      m('#mobile-alert-list-name').is(':visible')
        ? G()
        : 0 === a.length && y()
    })
  })
  ;('use strict')
  l.when(
    'A',
    'create-new-list-hz',
    'a-modal',
    'a-toggle-button-group',
    'lists-dpx-common-utils',
    'create-list-state-util',
    'lists-metric-logger',
  ).register('create-utils', function (e, d, r, l, C, x, z) {
    function q(b) {
      b && 'function' == typeof uet && uet('cf', b, { wb: 1 })
      b && 'function' == typeof uex && uex('ld', b, { wb: 1 })
    }
    var g = e.$,
      D = function (b) {
        b = '#' + (b.formId || 'addToCart')
        0 === g(b).length && (b = '#atwl-form')
        return b
      }
    e.declarative('show-create-list', ['click touchstart'], function (b) {
      b.$event.preventDefault()
      var d = b.data
      if (d.url || d.name)
        'function' == typeof uet && uet('bb', 'create-list-dp-widget', { wb: 1 }),
          r.create(b.$target, d).show({ padding: 'none' }),
          q('create-list-dp-widget')
      e.on('a:popover:afterHide:create-list', function () {
        r.remove('create-list')
        d.url.includes('DESKTOP_DETAIL_PAGE') &&
          (l('#add-to-wishlist-button-group').setSelected('#wishListDropDown'),
          g('#add-to-wishlist-button').focus())
      })
      e.on('a:popover:show:create-list', function (b) {
        E(b.popover.$popover)
      })
      d.createAndAddAsin && x.saveCreateAndAddAsin(d.createAndAddAsin)
    })
    e.declarative('list-name-validation', ['keyup'], function (b) {
      0 !== b.$target.context.value.length &&
        g('#alert-list-name').is(':visible') &&
        (g('#alert-list-name').addClass('aok-hidden'),
        g('#alert-list-name')
          .parent('div')
          .find('input')
          .each(function () {
            g(this).removeClass('a-form-error')
          }),
        g('#list-name').removeAttr('aria-describedby').removeAttr('aria-invalid'))
    })
    var E = function (b) {
      b.delegate('input:text', 'keypress', function (b) {
        13 === b.which && b.preventDefault()
      })
    }
    return {
      submitCreate: function (b, l, r) {
        b.$event.preventDefault()
        var q = g('#create-list-form').closest('.a-popover'),
          t = g('#list-name').val()
        if ('' === t)
          g('#alert-list-name').removeClass('aok-hidden'),
            g('#alert-list-name')
              .parent('div')
              .find('input')
              .each(function () {
                g(this).addClass('a-form-error')
              }),
            g('#list-name')
              .attr('aria-describedby', '#alert-list-name'.replace('#', ''))
              .attr('aria-invalid', !0)
              .focus()
        else {
          g('#list-name').removeAttr('aria-describedby').removeAttr('aria-invalid')
          var p = {},
            h = e.state('popoverState') || {}
          h = D(h)
          var y = C.urlParamValue('createAndAddAsin')
          y && 1 < y.length && (p.asin = y)
          '1' === g('#is-create-and-add').val() &&
            ((h = g(h).find("#ASIN, [name^\x3d'ASIN'], [name\x3d'a'], [name\x3d'asin']").val()),
            '' === h &&
              ((h = e.state('atwl').asin),
              z.incrementMetricCountByOne(
                'Lists:CreateListAndAddItem:FallbackToGiftingModuleASIN',
              )),
            'undefined' !== h && (p.asin = g.trim(h)))
          ;(h = x.getCreateAndAddAsin()) && 'undefined' !== h && (p.asin = h)
          g('#create-list-loading').removeClass('aok-hidden')
          q.find('#popover-spinner .a-popover-loading').show()
          g('#create-list-form').addClass('aok-hidden')
          p.listName = t
          p.sid = b.data.sessionId
          p.vendorId = b.data.sourceVendorId
          p.privacyStatus = b.data.privacyStatus
          p.listType = b.data.listType
          if ((b = k.ue ? k.ue.rid : n)) p.relatedRequestID = b
          d(p, l, r)
        }
      },
    }
  })
  ;('use strict')
  l.when('A', 'amazon-lists-csrf-utils').register('create-new-list-hz', function (e, d) {
    var l = e.$
    return function (e, r, x) {
      var q = []
      d.addCsrfToken(q)
      var t = k.ue ? k.ue.rid : n
      t && (e.relatedRequestID = t)
      e.isJson = !0
      return l.ajax('/hz/wishlist/create/newlist', {
        type: 'POST',
        headers: q,
        data: e,
        success: r,
        error: x,
        timeout: 1e4,
      })
    }
  })
  ;('use strict')
  l.when('A').register('create-list-state-util', function (e) {
    var d = e.$
    ;(function () {
      var e = d('\x3cinput type\x3d"hidden"\x3e')
      e.attr('id', 'lists-createlist-createAndAddAsin')
      e.appendTo('body')
    })()
    return {
      getCreateAndAddAsin: function () {
        return d('#lists-createlist-createAndAddAsin').val()
      },
      saveCreateAndAddAsin: function (e) {
        d('#lists-createlist-createAndAddAsin').val(e)
      },
    }
  })
})
/* ******** */
;(function (f) {
  var n = window.AmazonUIPageJS || window.P,
    p = n._namespace || n.attributeErrors,
    d = p ? p('ListsDPXCommonAssets', '') : n
  d.guardFatal
    ? d.guardFatal(f)(d, window)
    : d.execute(function () {
        f(d, window)
      })
})(function (f, n, p) {
  f.when('A', 'a-dropdown', 'a-modal', 'legacy-create-utils').execute(function (d, u, b, h) {
    var m = d.$
    d.declarative('reg-create-change-privacy', ['click'], function (b) {
      h.changePrivacySetting(b)
    })
    d.declarative('list-privacy-toggle', ['click'], function (b) {
      h.togglePrivacy(b)
    })
    d.declarative('list-name-toggle', ['click'], function (b) {
      h.toggleListName(b)
    })
    d.declarative('idea-list-toggle', ['click'], function (b) {
      h.toggleIdeaList(b)
    })
    d.on('a:popover:beforeShow:reg-create', function (b) {
      m('#createCal').append(m('#popCal'))
    })
    d.on('a:popover:show:reg-create', function (b) {
      h.onShow(b)
    })
    d.on('a:popover:ajaxContentLoaded:reg-create', function (b) {
      b = b.popover.$popover
      m('#createCal').append(m('#popCal'))
      b.hasClass('pop-create') || b.addClass('pop-create')
    })
    d.on('a:popover:beforeHide:reg-create', function (b) {
      m('#createCalHolder').append(m('#popCal'))
    })
    d.on('a:popover:hide:reg-create', function (b) {
      h.onClose(b)
    })
    d.on('a:dropdown:select', function (b) {
      h.onDropdownSelect(b)
    })
  })
  ;('use strict')
  f.when('A', 'create-new-list-hz').register('legacy-create-utils', function (d, u) {
    var b = d.$
    d.state.parse()
    d.state('pageInfo')
    d.state('createInfo')
    var h = d.state('popoverState') || {},
      m = 0,
      f = function (a) {
        a = '#' + (a.formId || 'addToCart')
        0 === b(a).length && (a = '#atwl-form')
        return a
      },
      r = f(h),
      v = function (a) {
        var c = {}
        b.each(a.serializeArray(), function (a, b) {
          b.name.match(/create-|next-/) && (c[b.name] = b.value)
        })
        return c
      },
      z = function (a) {
        var c = {},
          q = {}
        c['create-sourceVendorId'] = a['create-sourceVendorId']
        'undefined' !== typeof w('vendorId') && (c['create-sourceVendorId'] = w('vendorId'))
        var k = 'wishlist'
        if (a['create-for']) {
          var e = a['create-for']
          'friend' === e
            ? (k = 'giftlist')
            : 'child' === e && ((k = 'giftlist'), (c['create-isKidList_Registry'] = 1))
        }
        h = d.state('popoverState') || {}
        r = f(h)
        '1' === b('#create-isCreateAndAdd').val() &&
          ((c.isCreateAndAdd = !0),
          (e = b(r).find("#ASIN, [name^\x3d'ASIN'], [name\x3d'a'], [name\x3d'asin']").val()),
          (c.asin = b.trim(e)),
          (e = d.state('wishlistDPState') || {}),
          e.customizationToken && (c.customizationToken = e.customizationToken))
        if ('giftlist' !== k && '1' === b('#create-isIdeaList').val())
          return (
            (e = b.trim(a['create-name-il'])),
            '' !== e ? (c.name = e) : (q.list_name_il = 'empty'),
            (c.isIdeaList = !0),
            (c.description = b.trim(a['create-description-il'])),
            { errors: q, userCreateArgs: c }
          )
        c['create-registryType'] = k
        if ('wishlist' === k)
          (e = b.trim(a['create-name'])),
            '' !== e ? (c['create-name'] = e) : (q.list_name = 'empty')
        else {
          var g = b.trim(a['create-first-name']),
            l = b.trim(a['create-last-name']),
            e = b.trim(a['create-participant_relationship'])
          '' !== g || '' !== l
            ? ((c['create-participant2-givenName'] = g),
              (c['create-participant2-surName'] = l),
              (g = g + ' ' + l),
              (c['create-participant2-name'] = g),
              (c['create-name'] = g),
              (c['create-participant2-relationship_Participant'] = e))
            : (q.recipient_name = 'empty')
        }
        e = 'N'
        g = 'wishlist' === k ? 'Y' : 'N'
        if ((l = a['create-privacy']))
          'public' === l
            ? ('undefined' !== typeof a['create-recipient-name'] &&
                (c['create-recipient-name'] = b.trim(a['create-recipient-name'])),
              (g = 'Y'))
            : ('hidden' !== l && (e = 'Y'), (g = 'N'))
        c['create-isPrivate'] = e
        c['create-isSearchable'] = g
        'wishlist' === k && (c['create-persistence'] = b.trim(a['create-persistence']))
        e = a['create-month']
        g = a['create-day']
        0 < b('#popCal').length &&
          ((l = b('[data-action\x3d"a-cal-input"]').val())
            ? ((e = l.split('/')[0]), (g = l.split('/')[1]))
            : (e = l = '-1'))
        e &&
          g &&
          ('-1' !== e || '-1' !== g) &&
          ((e = parseInt(e, 10)),
          (g = parseInt(g, 10)),
          ((l = new Date(1904, e - 1, g)), l.getMonth() + 1 === e) && l.getDate() === g
            ? ((c['create-occasion1-fromDate_Month'] = e),
              (c['create-occasion1-fromDate_Day'] = g),
              (c['create-occasion1-fromDate_Year'] = 1904),
              'giftlist' === k &&
                (c['create-isKidList_Registry'] &&
                  a['create-age'] &&
                  '-1' !== a['create-age'] &&
                  (c['create-occasion1-firstYear_Occasion'] =
                    new Date().getFullYear() - a['create-age']),
                a['create-reminder'] &&
                  (c['create-occasion1-reminderOffset_Occasion'] = a['create-reminder'])))
            : 1 < m || (q.occasion_date = 'invalid'))
        a['create-next'] &&
          ((k = a['create-next']),
          (c['next-action'] = k),
          'add' === k &&
            d.each(
              ['asin', 'purchasedQty', 'requestedQty', 'purchaseDate', 'redirect'],
              function (b, e) {
                b = 'next-' + b
                a[b] && (c[b] = a[b])
              },
            ))
        return { errors: q, userCreateArgs: c }
      },
      A = function (a) {
        a.find('#WLNEW_error').addClass('a-hidden')
        a.find('.a-alert-inline').addClass('a-hidden')
        a.find('.a-form-error').removeClass('a-form-error')
        a.find('.reg-create-form').removeClass('a-hidden')
      },
      t = function (a) {
        var b = a.find('select[name\x3d"create-month"]').val(),
          d = a.find('select[name\x3d"create-day"]').val()
        b && '-1' !== b && d && '-1' !== d
          ? a.find('#WLNEW_section_occAge').removeClass('a-hidden')
          : a.find('#WLNEW_section_occAge').addClass('a-hidden')
      },
      x = function (a, c) {
        c.find('#WLNEW_input_privacy').val(a)
        var d = ''
        b('#a-popover-reg-create-privacy')
          .find('.a-list-link li a')
          .each(function () {
            b(this).removeClass('a-active')
            var c = b(this).data('reg-create-change-privacy')
            c && c.type === a && ((d = c.triggerText), b(this).addClass('a-active'))
          })
        c.find('a[id^\x3d"WLNEW_privacy_"]').find('span').html(d)
      },
      y = function (a) {
        'private' === a
          ? (b('.reg-create-form').find('#private_blurb').removeClass('a-hidden'),
            b('.reg-create-form').find('#public_blurb').addClass('a-hidden'),
            b('.reg-create-form').find('#public_recipient').addClass('a-hidden'))
          : (b('.reg-create-form').find('#private_blurb').addClass('a-hidden'),
            b('.reg-create-form').find('#public_blurb').removeClass('a-hidden'),
            b('.reg-create-form').find('#public_recipient').removeClass('a-hidden'))
      },
      w = function (a) {
        for (var b = n.location.search.substring(1).split('\x26'), d = 0; d < b.length; d++) {
          var k = b[d].split('\x3d')
          if (k[0] === a) return k[1]
        }
      },
      B = function (a) {
        a.each(function () {
          b.data(this, 'default', this.value)
        })
          .focus(function () {
            this.select()
            this.onmouseup = function () {
              this.onmouseup = null
              return !1
            }
          })
          .keyup(function () {
            b.data(this, 'edited', '' !== b.trim(this.value))
          })
          .change(function () {
            b.data(this, 'edited', '' !== b.trim(this.value))
          })
          .blur(function () {
            b.data(this, 'edited') || (this.value = b.data(this, 'default'))
          })
      },
      C = function (a) {
        a.delegate('input:text', 'keypress', function (a) {
          13 === a.which && a.preventDefault()
        })
      }
    return {
      changePrivacySetting: function (a) {
        a.$event.preventDefault()
        var c = a.$target.closest('.a-popover')
        a = a.data
        var d = a.type
        c.hide()
        b('#a-popover-reg-create-privacy').find('.a-active').removeClass('a-active')
        b('#a-popover-reg-create-privacy')
          .find('#WLNEW_link_' + d)
          .addClass('a-active')
        b('.reg-create-form').find('#WLNEW_input_privacy').val(d)
        b('.reg-create-form').find('a[id^\x3d"WLNEW_privacy_"]').find('span').html(a.triggerText)
        y(a.privacy)
      },
      togglePrivacy: function (a) {
        a.$event.preventDefault()
        a = a.data
        var c = a.privacy
        b('.reg-create-form').find('#WLNEW_input_privacy').val(c)
        b('.reg-create-form').find('a[id^\x3d"WLNEW_privacy_"]').find('span').html(a.triggerText)
        y(c)
      },
      toggleListName: function (a) {
        var c = a.data
        a = c.name
        var d = c.privacy,
          k = c.persistence,
          e = c.isReorderList === p ? !1 : c.isReorderList,
          c = c.isReorderListView === p ? !1 : c.isReorderListView
        b('.reg-create-form').find('#WLNEW_section_wlName').show()
        b('.reg-create-form').find('#create-isIdeaList').val('0')
        b('.reg-create-form').find('#WLNEW_section_ideaList').hide()
        b('.reg-create-form').find('#WLNEW_list_name').val(a)
        b('.reg-create-form')
          .find('#WLNEW_privacy_' + d)
          .click()
        b('.reg-create-form').find('#WLNEW_input_privacy').val(d)
        b('.pop-create')
          .find('#WLNEW_list_persistence')
          .prop('checked', c ? e : 'persistent' === k)
        c &&
          b('.reg-create-form')
            .find('#WLNEW_list_persistence')
            .val(e ? 'persistent' : 'non-persistent')
      },
      toggleIdeaList: function (a) {
        b('.reg-create-form').find('#WLNEW_section_wlName').hide()
        b('.reg-create-form').find('#create-isIdeaList').val('1')
        b('.reg-create-form').find('#WLNEW_section_ideaList').removeClass('a-hidden').show()
      },
      onShow: function (a) {
        var c = a.popover
        a = a.popover.$popover
        c.data.first && a.find('#WLNEW_section_wlFor').addClass('a-hidden')
        c.data.forFriend &&
          (a
            .find(
              '#WLNEW_section_wlName, #WLNEW_section_occAge, #WLNEW_listfor_listtype_divider, #WLNEW_section_wlType, #WLNEW_section_wlFor, #WLNEW_listtype_listname_divider, #WLNEW_section_ideaList',
            )
            .addClass('a-hidden'),
          a
            .find(
              '#WLNEW_section_glName, #WLNEW_section_occDate, #WLNEW_section_occReminder, #WLNEW_privacy_gl',
            )
            .removeClass('a-hidden'),
          'child' === c.data.value && t(a),
          b('.reg-create-form').find('#WLNEW_privacy_private').click(),
          b('.reg-create-form').find('#WLNEW_input_privacy').val('private'),
          a.find('select[name\x3d"create-for"]').val('friend'))
        c.data.sourceVendorId &&
          a.find('input[name\x3d"create-sourceVendorId"]').val(c.data.sourceVendorId)
        if (c.data.next) {
          var h = c.data.next,
            k = a.find('.reg-create-form')
          k.find('input[name\x3d"create-next"]').val(h)
          d.each(c.data, function (a, c) {
            c.match(/^next-/) &&
              ((a = b('\x3cinput/\x3e', { type: 'hidden', name: c, value: a })), k.prepend(a))
          })
        }
        B(a.find('#WLNEW_list_name'))
        C(a)
      },
      onDropdownSelect: function (a) {
        var c = b(a.selectNode).closest('.a-popover')
        if ('create-for' === a.name) {
          var d = 'public'
          if ('self' === a.value)
            c
              .find(
                '#WLNEW_section_glName, #WLNEW_section_occDate, #WLNEW_section_occAge, #WLNEW_section_occReminder, #WLNEW_privacy_gl',
              )
              .addClass('a-hidden'),
              c
                .find(
                  '#WLNEW_section_wlName, #WLNEW_listfor_listtype_divider, #WLNEW_section_wlType, #WLNEW_section_ideaList',
                )
                .removeClass('a-hidden'),
              '1' === b('#create-isIdeaList').val()
                ? c.find('#WLNEW_section_wlName').hide()
                : c.find('#WLNEW_section_ideaList').hide()
          else if ('friend' === a.value || 'child' === a.value)
            c
              .find(
                '#WLNEW_section_wlName, #WLNEW_section_occAge, #WLNEW_listfor_listtype_divider, #WLNEW_section_wlType, #WLNEW_section_ideaList',
              )
              .addClass('a-hidden'),
              c
                .find(
                  '#WLNEW_section_glName, #WLNEW_section_occDate, #WLNEW_section_occReminder, #WLNEW_privacy_gl',
                )
                .removeClass('a-hidden'),
              0 === b('#popCal').length && c.find('#WLNEW_occ_date').removeClass('a-hidden'),
              'child' === a.value && t(c),
              (d = 'hidden'),
              b('.reg-create-form').find('#WLNEW_privacy_private').click(),
              b('.reg-create-form').find('#WLNEW_input_privacy').val('private')
          x(d, c)
        } else
          'create-month' === a.name || 'create-day' === a.name
            ? (a = c.find('select[name\x3d"create-for"]').val()) && 'child' === a && t(c)
            : 'choose-relationship' === a.name &&
              ((a = a.value), c.find('#create-participant_relationship').val(a))
      },
      onClose: function (a) {
        x('public', a.popover.$popover)
        m = 0
      },
      submitCreate: function (a, c, h, k, e) {
        a.$event.preventDefault()
        var g = a.$target.closest('.reg-create-form'),
          l = g.closest('.a-popover')
        A(g)
        m++
        var f = v(g),
          f = z(f),
          p = !1
        d.each(f.errors, function (a, c) {
          a = l.find('#WLNEW_alert_' + c)
          a.removeClass('a-hidden')
          a.parent('div')
            .find('input')
            .each(function () {
              b(this).addClass('a-form-error')
            })
          p = !0
        })
        p ||
          ((a = { sid: a.data.sid, createListToken: a.data.createListToken }),
          b.extend(a, f.userCreateArgs),
          l.find('#WLNEW_loading').removeClass('a-hidden'),
          l.find('#popover-spinner .a-popover-loading').show(),
          g.addClass('a-hidden'),
          f.userCreateArgs.isIdeaList
            ? ((c = '/hz/wishlist/ajax/createlist?ref\x3ddl_create_list_lv'),
              f.userCreateArgs.isCreateAndAdd &&
                (c = '/hz/wishlist/ajax/createlistandadditem?ref\x3ddl_create_list_dp'),
              b.ajax(c, { type: 'POST', data: a, success: k, error: e }))
            : ((k = 'Y' === a['create-isPrivate'] ? 'private' : 'public'),
              (e = {}),
              (e.sid = a.sid),
              'undefined' !== typeof a.createListToken && (e.createListToken = a.createListToken),
              (e.listType = a['create-registryType']),
              (e.privacyStatus = k),
              'undefined' !== typeof a['create-name'] && (e.listName = a['create-name']),
              'undefined' !== typeof a['create-persistence'] &&
                (e.persistence = a['create-persistence']),
              'undefined' !== typeof a['create-sourceVendorId'] &&
                (e.vendorId = a['create-sourceVendorId']),
              'undefined' !== typeof a['create-participant2-name'] &&
                (e.participantName = a['create-participant2-name']),
              'undefined' !== typeof a['create-participant2-surName'] &&
                (e.participantGivenName = a['create-participant2-surName']),
              'undefined' !== typeof a['create-participant2-givenName'] &&
                (e.participantSurName = a['create-participant2-givenName']),
              'undefined' !== typeof a['create-participant2-relationship_Participant'] &&
                (e.relationship = a['create-participant2-relationship_Participant']),
              'undefined' !== typeof a['create-occasion1-fromDate_Day'] &&
                (e.occasionFromDate = a['create-occasion1-fromDate_Day']),
              'undefined' !== typeof a['create-occasion1-fromDate_Month'] &&
                (e.occasionFromMonth = a['create-occasion1-fromDate_Month']),
              'undefined' !== typeof a['create-occasion1-fromDate_Year'] &&
                (e.occasionFromYear = a['create-occasion1-fromDate_Year']),
              'undefined' !== typeof a['create-occasion1-reminderOffset_Occasion'] &&
                (e.occasionReminderOffset = a['create-occasion1-reminderOffset_Occasion']),
              'undefined' !== typeof a.asin && (e.asin = a.asin),
              'undefined' !== typeof a.customizationToken &&
                (e.customizationToken = a.customizationToken),
              'undefined' !== typeof a['create-recipient-name'] &&
                (e.recipientName = a['create-recipient-name']),
              u(e, c, h)))
      },
    }
  })
  ;('use strict')
  f.register('mash-capabilities', function () {
    var d
    return {
      isDispatchEventAvailable: function () {
        if (d !== p) return d
        var f
        a: {
          f = document.cookie.split(';')
          for (var b = 0; b < f.length; b++) {
            for (var h = f[b]; ' ' === h.charAt(0); ) h = h.substring(1, h.length)
            if (0 === h.indexOf('amzn-app-ctxt\x3d')) {
              f = h.substring(14, h.length)
              break a
            }
          }
          f = null
        }
        b = 0
        if (null !== f)
          try {
            var m = f.match(/"cp":[0-9]*/)
            null === m && (m = decodeURIComponent(f).match(/"cp":[0-9]*/))
            if (null !== m && 0 < m.length) {
              var n = m[0].split(/:/)
              if (null !== n && 2 === n.length) {
                var r = parseInt(n[1], 10)
                b = 'number' === typeof r ? r & 2048 : 0
              }
            }
          } catch (v) {}
        return (d = 0 !== b)
      },
    }
  })
  ;('use strict')
  f.when('A').register('weblab-trigger', function (d) {
    var f = d.$
    return function (b) {
      f.ajax({
        url: '/hz/wishlist/triggerweblab?name\x3d' + b,
        success: function (d) {
          d ||
            n.ueLogError(p, {
              logLevel: 'FATAL',
              attribution: 'ListsDPXCommonAssets::' + b,
              message: 'failed To trigger weblab ' + b,
            })
        },
        timeout: 2e4,
      })
    }
  })
})
/* ******** */
;(function (k) {
  var h = window.AmazonUIPageJS || window.P,
    u = h._namespace || h.attributeErrors,
    a = u ? u('RegistryDPAssets', '') : h
  a.guardFatal
    ? a.guardFatal(k)(a, window)
    : a.execute(function () {
        k(a, window)
      })
})(function (k, h, u) {
  k.when('A', 'b2b-lists-detail').execute(function (a, c) {
    function d() {
      var b = a.$('#free-form-quantity-dropdown'),
        e = a.$('#quantity-update-text'),
        d = a.$('#quantity'),
        c = 1
      0 < b.length && b.is(':visible')
        ? ((c = b.val()), 0 === c.length && (c = e.val()))
        : 0 < e.length && e.is(':visible')
          ? (c = e.val())
          : 0 < d.length && d.is(':visible') && (c = d.val())
      return c
    }
    c.isEnabled() &&
      (a.on('a:dropdown:selected:quantity', function (b) {
        c.updateQuantity(b.value)
      }),
      a.on('a:dropdown:selected:free-form-quantity-dropdown', function (b) {
        0 < b.value.length
          ? c.updateQuantity(b.value)
          : c.updateQuantity(a.$('#quantity-update-text').val())
      }),
      a.$(document).delegate('#quantity-update-text', 'change', function (b) {
        c.updateQuantity(b.target.value)
      }),
      a.on('a:pageUpdate', function () {
        var b = a.$('#ASIN').val()
        c.updateQuantityAndAsin(d(), b)
      }))
  })
  k.when('A', 'a-modal').register('b2b-lists-detail', function (a, c) {
    function d() {
      return c.get(a.$('#business-list-modal'))
    }
    function b(b, a, d) {
      var c = new RegExp('([?\x26])' + a + '\x3d.*?(\x26|$)', 'i'),
        f = b
      b.match(c) && (f = b.replace(c, '$1' + a + '\x3d' + d + '$2'))
      return f
    }
    return {
      updateQuantityAndAsin: function (c, n) {
        var l = (a.state('businessListPageState') || {}).businessListUrl
        l && ((l = b(l, 'quantity', c)), (c = l = b(l, 'asin', n)), d().update({ url: c }))
      },
      updateQuantity: function (c) {
        var n = (a.state('businessListPageState') || {}).businessListUrl
        n && ((c = n = b(n, 'quantity', c)), d().update({ url: c }))
      },
      isEnabled: function () {
        return 0 < a.$('#add-business-list-button').length
      },
    }
  })
  ;('use strict')
  k.when(
    'A',
    'a-popover',
    'atwl-common-util',
    'atwl-dropdown-util',
    'atwl-util',
    'atwl-inline-util',
    'add-to-wish-list:plugin-registry',
    'lists-ajax-handler',
    'atwl-ready',
  ).register('add-to-wish-list', function (a, c, d, b, e, n, l, q) {
    'undefined' !== typeof a.state.parse && a.state.parse()
    var f = a.$
    d.getState('atwl')
    var g = d.getState('popoverState')
    d.atwlFormSelector()
    var v = h.currentType
    h.setRegistryId = d.setRegistryId
    var m = [],
      k = function (b) {
        'undefined' !== typeof b && b.preventDefault()
        r()
        var c = function () {
            var c = d.getState('wishlistDPState').isFirstCreate ? 'create' : 'add'
            'add' === c && f('html').hasClass('a-lt-ie9')
              ? ((h.atwlLoaded = !1), atwlEarlyClick(b))
              : ((v = 'wishlist'),
                (h.currentType = v),
                a.state('wishlistDPState', { action: c, type: v }),
                f('#add-wishlist-declarative').trigger('click'))
          },
          e = l.getPlugin()
        e && e.addToList ? e.addToList(c) : c()
      }
    a.on('addFormSubmit', k)
    var r = function () {
      var b = d.getState('wishlistDPState')
      delete b.customizationToken
      delete b.customizedPrice
      a.state.replace('wishlistDPState', b)
    }
    c = function () {
      ;(g.showWishListDropDown ||
        g.showBabyRegDropdown ||
        g.isAddToWishListDropDownAuiEnabled ||
        g.showPopover) &&
        g.showPopover &&
        (f('#add-to-wishlist-button-submit').unbind('click').bind('click', k),
        a.declarative('add-wishlist-declarative', ['click'], function (b) {
          b = d.getState('wishlistDPState')
          e.parsePostData(b.action, b.type)
          ;(b = h.ue) &&
            b.count('lists:dp:addtolist:click', (b.count('lists:dp:addtolist:click') || 0) + 1)
        }))
    }
    c()
    a.on('atwl-trigger-onload-bindings', c)
    return {
      setPostAddSuccess: function (b) {
        m.push(b)
      },
    }
  })
  ;('use strict')
  k.when('A', 'a-popover', 'atwl-common-util').register('atwl-dropdown-util', function (a, c, d) {
    var b = a.$
    d.getState('popoverState')
    var e = 0,
      n,
      l = d.CONST,
      q = d.ie8NoScroll,
      f = d.setAtwlState,
      g = function () {
        b('#wishListDropDown').removeClass('a-button-selected')
        b('#wishListMainButton').removeClass('a-button-selected')
      },
      v = function () {
        var b = d.getState('atwl'),
          a = b.activePopoverButtonId
        return 'undefined' !== a && 'add-to-baby-button-group' === a
          ? b.babyDropDownHtml
          : b.dropDownHtml
      },
      m = function (b) {
        var a = d.getState('atwl').activePopoverButtonId
        'undefined' !== a && 'add-to-baby-button-group' === a
          ? f({ babyDropDownHtml: b })
          : f({ dropDownHtml: b })
      },
      k = function () {
        var a = b('#atwl-dd-ul').parent()
        if (a && a.get(0)) {
          var c = a.get(0).scrollHeight,
            d = a.height(),
            a = 2 * parseInt(a.css('padding-top'), 10)
          return c > d + a
        }
        return !1
      },
      r = function (a) {
        0 !== b('.atl-keyboard-a11y').length &&
          ((a = a.find('.a-button-close')),
          b('.atl-keyboard-a11y').each(function (a) {
            b(this).attr('tabindex', '-1')
            b(this).find('.a-declarative').eq(0).attr('tabindex', '0')
          }),
          a.show(),
          a.addClass('atwl-hz-button-close'))
      },
      x = function (c) {
        c.find('.a-button-close').hide()
        c.find('.a-popover-content').css({ 'margin-right': '0px' })
        c.css({ padding: '0' })
        c.find('.a-popover-inner').css({ padding: '0' })
        r(c)
        setTimeout(function () {
          c.find('.a-arrow-border').addClass('aok-hidden')
          b('#atwl-rich-content').css({ 'margin-bottom': '0px', width: 'auto' })
          var e = d.getState('atwl')
          if (e.hzPopover) {
            var f = document.getElementById(e.activePopoverButtonId)
            if (null !== f && 'undefined' !== typeof f) {
              var p = f.getBoundingClientRect().left
              a.capabilities.rtl && (p = b(h).width() - f.getBoundingClientRect().right)
              c.css({ left: p + 'px' })
            }
          }
          b.browser.msie &&
            ((p = b('#' + e.wishlistButtonSubmitId)),
            (e = p.offset()),
            (f = p.height()),
            (p = e.left),
            (e = e.top + f),
            q() &&
              ((p += document.body.parentElement.scrollLeft),
              (e += document.body.parentElement.scrollTop)),
            k() && (p -= 17),
            c.css({ left: p + 'px', top: e + 'px' }))
        }, 50)
      },
      w = function (a) {
        var c
        c = q() ? 50 : 0
        setTimeout(function () {
          var c = b('#atwl-popover-inner'),
            e = c.width(),
            f = d.getState('atwl'),
            p = document.getElementById(f.activePopoverButtonId)
          f.hzPopover && null !== p && 'undefined' !== typeof p
            ? (e = p.getBoundingClientRect().width)
            : k()
              ? (e += l.overflowWidth)
              : b('.atwl-dd-list-name').each(function (a) {
                  a = b(this)
                  a.width(a.width() + l.noOverflowWidth)
                })
          f = a.find('ul li a.a-active').first()
          f.css('margin-left', '1px')
          f.parent().focus()
          c.width(e)
        }, c)
      },
      t = function () {
        if (n) {
          var b = c.get(n)
          b && b.hide()
        }
      },
      p = function (a) {
        var e = l.widthStaticPopovers
        try {
          e = document.getElementById('add-to-wishlist-button-group').clientWidth
        } catch (f) {}
        b('#' + a)
          .children()
          .first()
          .width(e)
        t()
        if (c) {
          var p = c.get(n),
            g = d.getState('atwl'),
            p = p
              ? c.get(n)
              : c.create(b('#' + g.activePopoverButtonId), {
                  content: b('#' + a).html(),
                  name: 'atwl',
                  skin: function (b) {
                    return b
                  },
                  activate: 'onmouseclick',
                  width: e,
                  position: g.dropDownPosition || 'triggerBottom',
                  closeButtonLabel: g.closeButtonAriaLabel,
                  popoverLabel: g.dropdownAriaLabel,
                })
          p.update({ width: e, content: b('#' + a).html() })
          n = p.id
          p.show().updatePosition()
          x(p.$popover)
        }
      },
      y = function () {
        g()
        e++
        t()
        p('atwl-dd-error-holder')
      },
      B = function () {
        var a = d.getState('atwl')
        return c.create(b('#' + a.activePopoverButtonId), {
          content: v(),
          name: 'atwl',
          skin: function (b) {
            return b
          },
          activate: 'onmouseclick',
          position: a.dropDownPosition || 'triggerBottom',
          closeButtonLabel: a.closeButtonAriaLabel,
          popoverLabel: a.dropdownAriaLabel,
        })
      },
      u = function (b) {
        b.update({ content: v(), width: 'auto' })
        b.show()
        x(b.$popover)
        w(b.$popover)
      },
      C = function () {
        var e = c.get('atwl')
        e && e.isActive()
          ? e.hide()
          : ((e = B()),
            c.remove(e),
            (e = B()),
            u(e),
            a.capabilities.touch &&
              setTimeout(function () {
                var a = b('#wishlistButtonStack'),
                  c = a.clone(),
                  e = a.parent()
                a.remove()
                e.append(c)
              }, 300),
            'function' === typeof h.uet && h.uet('cf', 'addToListDropdown', { wb: 1 }),
            'function' === typeof h.uex && h.uex('ld', 'addToListDropdown', { wb: 1 }))
      },
      D = function () {
        var b = c.get('atwl')
        b && b.isActive() && b.hide()
      },
      z = function (b, a, c) {
        b.append(
          '\x3cinput type\x3d"hidden" id\x3d"' +
            a +
            '" name\x3d"' +
            a +
            '" value\x3d"' +
            c +
            '"\x3e',
        )
      }
    return {
      makeDropDownArrowInactive: g,
      getDropDownHtml: v,
      setDropDownHtml: m,
      resetDropDownHtml: function () {
        m('')
      },
      resetAjaxFailCount: function () {
        this.ajaxFailCount = 0
      },
      hideDropdown: D,
      hideError: function () {
        t()
        var b = d.getState('atwl')
        return e >= b.maxAjaxFailureCount
      },
      showUnavail: function () {
        t()
        t()
        p('atwl-dd-unavail-holder')
      },
      showSpinner: function () {
        p('atwl-dd-spinner-holder')
      },
      parseAjaxResponse: function (c) {
        g()
        t()
        var e
        if ('object' === typeof c) e = c
        else
          try {
            e = a.parseJSON(c)
          } catch (d) {
            y()
            return
          }
        'undefined' !== typeof e.html && 'undefined' !== e.css
          ? (m(e.html), (c = e.css), b('body').append(c), C())
          : y()
      },
      showError: y,
      showDropDown: C,
      setDropdownButtonAriaExpanded: function (a) {
        b('#add-to-wishlist-button').attr('aria-expanded', a)
      },
      removeDropdownButtonAriaControls: function () {
        b('#add-to-wishlist-button').removeAttr('aria-controls')
      },
      setDropdownButtonAriaControls: function () {
        var a = c.get('atwl')
        a.$container &&
          a.$container[0] &&
          b('#add-to-wishlist-button').attr('aria-controls', a.$container[0].id)
      },
      setInputRegistryId: function (c, e) {
        'undefined' === typeof e && (e = 'wishlist')
        var p = 'pop_' + c + '_' + e,
          g = b(d.atwlFormSelector()),
          r = g.find(d.popCommandSelector)
        r.length ? r.attr('value', p) : z(g, 'sourceCustomerOrgListID', p)
        p = g.find("[name\x3d'registryID']")
        p.length ? p.attr('value', c) : z(g, 'registryID', c)
        c = g.find("[name\x3d'registryType']")
        c.length ? c.attr('value', e) : z(g, 'registryType', e)
        f({ inSubmit: !0 })
        e = g
          .find("[name\x3d'submit.add-to-registry.wishlist'],[name\x3d'submit.add-to-wishlist']")
          .eq(0)
        e.length ? e.click() : a.trigger('addFormSubmit')
        D()
        return !1
      },
    }
  })
  ;('use strict')
  k.when(
    'A',
    'a-popover',
    'atwl-dropdown-util',
    'atwl-common-util',
    'atwl-inline-util',
    'kbp',
    'idea-list-csrf-utils',
    'add-to-list-modal-util',
    'lists-ajax-handler',
    'atwl-ready',
  ).execute('atwl-dropdown', function (a, c, d, b, e, n, l, q, f) {
    var g = a.$,
      v = b.getState('popoverState'),
      m = b.getState('atwl'),
      k = m.wireDeclaratives,
      r = function () {
        var b = g('#' + m.wishlistButtonId),
          c = g('#' + m.wishlistButtonSubmitId)
        a.on('wl-drop-down', function (b) {
          w(b)
        })
        c.addClass('a-declarative')
        c.attr('data-action', 'atwl-splitbutton-main')
        g('#wishListMainButton')
          .addClass('a-declarative')
          .attr('data-action', 'add-wishlist-declarative')
        h.atwlEc &&
          setTimeout(function () {
            b.click()
            g('#atwl-dd-spinner-holder').addClass('a-hidden')
            h.atwlEc = !1
          }, 1)
        h.atwlLoaded = !0
      }
    a.on('a:pageUpdate', function () {
      g('#wishListMainButton').hasClass('a-declarative') ||
        (r(), a.trigger('atwl-trigger-onload-bindings'))
    })
    var x = function () {
        var b
        b = h.atwlEc ? 'lists:dp:ech:early' : 'lists:dp:ech:late'
        var a = h.ue
        a && a.count(b, (a.count(b) || 0) + 1)
      },
      w = function (a) {
        a.$event &&
          a.$event.originalEvent &&
          a.$event.originalEvent.acknowledge &&
          a.$event.originalEvent.acknowledge(a.$currentTarget.get(0))
        'function' === typeof h.uet && h.uet('bb', 'addToListDropdown', { wb: 1 })
        x()
        b.setAtwlState({ activePopoverButtonId: 'add-to-wishlist-button-group' })
        a.$event ? a.$event.preventDefault() : a.preventDefault()
        setTimeout(function () {
          d.makeDropDownArrowInactive()
        }, 0)
        if ('not-allowed' === (a.$target ? a.$target : g(a.target)).css('cursor')) return !1
        if (d.hideError()) return d.showUnavail(), !1
        if ((a = d.getDropDownHtml()) && a.length) d.showDropDown()
        else {
          d.showSpinner()
          a = b.getState('wishlistDPState')
          var c = 'website.wishlist.detail.add'
          'undefined' !== typeof a.vendorId && (c = a.vendorId)
          a =
            '/hz/wishlist/addtolist?' +
            g.param({
              sortMethod: m.sortMethod || 0,
              type: 'wishlist',
              useAll: m.showAllTypes || 0,
              sourceVendorId: c,
            })
          g.ajax({ url: a, cache: !1, success: d.parseAjaxResponse, error: d.showError })
        }
        return !1
      }
    if (v.showWishListDropDown || v.isAddToWishListDropDownAuiEnabled || v.showPopover)
      r(),
        b.setAtwlState({ resetDropDownHtml: d.resetDropDownHtml }),
        k ||
          (a.declarative('atwl-splitbutton-arrow', 'click', w),
          a.declarative('atwl-dd', 'click', function (c) {
            c.$event.preventDefault()
            t()
            d.hideDropdown()
            var e = c.data
            q.show(c.$target, {
              height: e.height,
              width: e.width,
              name: e.name,
              header: e.header,
              padding: e.padding,
            })
            c = {
              asin: b.getAsin(),
              vendorId: 'website.wishlist.detail.add',
              listExternalId: e.listExternalId,
              listType: e.listType,
              isAjax: '1',
            }
            a.state.replace('atwl-huc-recommendation-state', {
              listId: c.listExternalId,
              listType: c.listType,
            })
            f.post({
              url: '/hz/wishlist/additemtolist',
              params: c,
              successCallback: function (a) {
                q.updateHtmlContent(a)
              },
              errorCallback: function (a) {},
            })
          }),
          a.declarative('atwl-dd', 'keydown', function (b) {
            var e = a.constants.keycodes,
              d = b.$event
            d.which === e.ENTER || d.which === e.SPACE
              ? (d.preventDefault(), b.$target.click())
              : d.which === e.ESCAPE &&
                (d.preventDefault(),
                (b = c.get('atwl').$container.find('.a-button-close')),
                b.focus(),
                b.eq(0).trigger('click'))
          }),
          a.declarative('atwl-dd-dl', 'click', function (c) {
            c.$event.preventDefault()
            d.hideDropdown()
            e.showSpinner()
            var f = b.getAsin(),
              r = b.getSid(),
              f = g.extend({}, { asin: f, sid: r }, c.data),
              r = []
            l.addIdeaListCsrfToken(r)
            a.post('/create/api/addToList?ref\x3didea_dp_ai', {
              params: f,
              headers: r,
              success: function (a) {
                a.registryName = c.data.listName
                e.addItemResponseHandler(a)
              },
              error: e.showError,
              abort: e.showError,
            })
            return !1
          }),
          a.declarative('atwl-kbp-landing', 'click', function (a) {
            a = a.data
            var c = b.getAsin()
            h.open(a.url + ('\x26asin\x3d' + c))
            return !1
          }),
          a.on('a:popover:hide:atwl', function () {
            d.setDropdownButtonAriaExpanded(!1)
            d.removeDropdownButtonAriaControls()
          }),
          a.on('a:popover:show:atwl', function () {
            d.setDropdownButtonAriaExpanded(!0)
            d.setDropdownButtonAriaControls()
          })),
        m &&
          'kbp' === m.sortMethod &&
          (a.state('atwl', { kbpPromo: { mouseOver: !1, countDown: !1 } }),
          a.ajax('/gp/toys/birthday/atwl-dpx.html', {
            method: 'get',
            cache: !1,
            params: { isAUI: 1 },
            success: n.showKbpPromoPopover,
            error: function () {},
          }),
          k ||
            (a.declarative('atwl-kbp-promo-mouseover', 'mouseleave', function () {
              var e = b.getState('atwl').kbpPromo
              e.mouseOver = !1
              if (e.countDown) {
                var d = c.get('kbpPromoPopover')
                d && (d.unlock().hide(), c.remove(d))
              }
              a.state('atwl', { kbpPromo: e })
            }),
            a.declarative('atwl-kbp-promo-mouseover', 'mouseenter', function () {
              var c = b.getState('atwl').kbpPromo
              c.mouseOver = !0
              a.state('atwl', { kbpPromo: c })
            }),
            a.on('a:popover:hide:kbpPromoPopover', function () {
              var a = c.get('kbpPromoPopover')
              a.unlock().hide()
              c.remove(a)
            }))),
        b.setAtwlState({ wireDeclaratives: !0 })
    var t = function () {
      var a = h.ue
      a &&
        a.count(
          'lists:dp:addtolist:dropdownentry:click',
          (a.count('lists:dp:addtolist:dropdownentry:click') || 0) + 1,
        )
    }
  })
  ;('use strict')
  ;(function () {
    var a = !1
    k.when('cf').execute(function () {
      a || ((a = !0), c())
    })
    k.when('atwl-cf').execute(function () {
      a || ((a = !0), c())
    })
    var c = function () {
      k.now('cf-or-atwl-cf').execute(function (a) {
        'undefined' === typeof a && h.P.register('cf-or-atwl-cf')
      })
    }
  })()
  k.when('A', 'cf-or-atwl-cf').register('atwl-common-util', function (a) {
    var c = a.$,
      d = function () {
        return '#' + (b('popoverState').formId || 'addToCart') + ',#addToWL'
      },
      b = function (b) {
        a.state.parse()
        return 0 === c('script[data-a-state\x3d"{"key":"' + b + '"}"]').length
          ? {}
          : a.state(b) ||
              JSON.parse(c('script[data-a-state\x3d"{"key":"' + b + '"}"]').text()) ||
              {}
      }
    return {
      CONST: {
        widthStaticPopovers: 230,
        overflowWidth: 10,
        noOverflowWidth: 10,
        scrollbarWidth: 17,
      },
      getAsin: function () {
        var a = c(d()).find('#ASIN').val()
        return 'undefined' === typeof a
          ? c(d()).find("[name^\x3d'ASIN'],[name^\x3d'ASIN.0']").val()
          : '' === a
            ? b('atwl').asin
            : a
      },
      getSid: function () {
        var a = c(d()).find('#session-id').val()
        'undefined' === typeof a && (a = c(d()).find("[name\x3d'session-id']").val())
        return a
      },
      ie8NoScroll: function () {
        return 9 > parseInt(c.browser.version, 10) && document.body && document.body.parentElement
          ? !(!document.body.parentElement.scrollLeft && !document.body.parentElement.scrollTop)
          : !1
      },
      setRegistryID: function (a) {
        var b = c(d())
        b.find(
          "[name\x3d'sourceCustomerOrgListID'],[name\x3d'colid'],[name\x3d'wlPopCommand']",
        ).attr('value', a)
        b.find("[name\x3d'submit.add-to-registry.wishlist'],[name\x3d'submit.add-to-wishlist']")
          .eq(0)
          .click()
        return !1
      },
      setAtwlState: function (b) {
        a.state('atwl', c.extend(a.state('atwl') || {}, b))
      },
      getState: b,
      clearText: function (a) {
        a.value === a.defaultValue && (a.value = '')
      },
      forceFormSubmit: function (a) {
        var b = a.attr('name')
        a = a.parents('form')
        b = c('\x3cinput type\x3d"hidden" /\x3e').attr('name', b).val('1')
        a.append(c(b))
        a.submit()
      },
      clearPopCommandFields: function () {
        for (var a = ['wlPopCommand', 'sourceCustomerOrgListID'], b = 0; b < a.length; b++) {
          var d = c('[name^\x3d"' + a[b] + '"]')
          d && d.length && d.val('')
        }
      },
      atwlFormSelector: d,
      popCommandSelector:
        "[name\x3d'sourceCustomerOrgListID'],[name\x3d'colid'],[name\x3d'wlPopCommand']",
    }
  })
  ;('use strict')
  k.when('A', 'a-popover', 'atwl-common-util').register('kbp', function (a, c, d) {
    var b = a.$,
      e = d.getState('atwl'),
      n = b('#' + e.wishlistButtonSubmitId)
    return {
      showKbpPromoPopover: function (b) {
        if (b && b.promoEnabled) {
          var e = b.html
          if (e) {
            var f = c.create(n.parent(), {
              name: 'kbpPromoPopover',
              content: e,
              position: 'triggerBottom',
              width: b.width,
            })
            f.show().lock()
            a.delay(function () {
              var b = d.getState('atwl').kbpPromo || {}
              b.mouseOver ? (b.countDown = !0) : (f.unlock().hide(), c.remove(f))
              a.state('atwl', { kbpPromo: b })
            }, 1e4)
          }
        }
      },
    }
  })
  ;('use strict')
  k.when(
    'A',
    'atwl-util',
    'atwl-dropdown-util',
    'atwl-common-util',
    'lists-ajax-handler',
    'atwl-ready',
  ).execute('atwl-huc', function (a, c, d, b, e) {
    var n = a.$
    d = b.getState('popoverState')
    var l = b.getState('createInfo') || {},
      q = 'addCreateToWishlist'
    l.isHorizonte && (q = 'reg-create')
    if (
      d.showWishListDropDown ||
      d.showBabyRegDropdown ||
      d.isAddToWishListDropDownAuiEnabled ||
      d.showPopover
    )
      a.on('a:popover:show:' + q, function (d) {
        var g = d.popover,
          n = g.$popover
        d = b.getState('wishlistDPState')
        var m = d.action
        n.addClass('pop-huc-' + m)
        var q = g.$trigger.closest('.a-button').find('input'),
          n = d.type
        q.closest('.a-button-selected').removeClass('a-button-selected')
        n = c.parsePostData(m, n)
        d.customizationToken && (n.customizationToken = d.customizationToken)
        d = n.url
        var r = n.streaming,
          k = 'ajax_' + r,
          w = new Date()
        h.ue && h.uet('tc', k)
        var t = function () {
            g.hide()
            b.forceFormSubmit(q)
          },
          p = function () {
            g.$popover.find('#popover-spinner').addClass('a-hidden')
            b.clearPopCommandFields()
          }
        'create' !== m && r
          ? ((d = c.buildAddItemToDefaultListParams(n)),
            a.state.replace('atwl-huc-recommendation-state', { listId: '', listType: d.listType }),
            e.post({
              url: '/hz/wishlist/additemtolist',
              params: d,
              successCallback: function (a) {
                p()
                g.$popover.find('#WLHUC_result').html(a).removeClass('a-hidden')
                g.updatePosition()
              },
              errorCallback: t,
            }))
          : l.isHorizonte
            ? a.ajax(d, {
                method: 'get',
                success: function (a) {
                  g.$popover.find('#popover-spinner').addClass('a-hidden')
                  g.$popover.find('#WLHUC_result').html(a).removeClass('a-hidden')
                  g.updatePosition()
                },
                error: t,
              })
            : a.ajax(d, {
                method: 'post',
                params: n,
                success: function (a) {
                  a && a.html
                    ? (h.ue &&
                        (h.ues('id', k, a.requestId), h.ues('t0', k, w), h.ues('ctb', k, '1')),
                      a.status && 'no-asins' === a.status
                        ? t()
                        : (p(),
                          'add' === m
                            ? g.$popover.find('#WLHUC_result').html(a.html).removeClass('a-hidden')
                            : (g.$popover.find('#WLNEW_main').html(a.html).removeClass('a-hidden'),
                              (a = b.getState('atwl')) &&
                                a.resetDropDownHtml &&
                                a.resetDropDownHtml()),
                          g.updatePosition()),
                      h.ue && (h.uet('be', k), h.uex('ld', k)))
                    : ('create' === m && b.forceFormSubmit(q), g.hide())
                },
                error: t,
              })
      }),
        a.on('a:popover:beforeShow:' + q, function (a) {
          a = a.popover
          var c = b.getState('wishlistDPState')
          a.$popover.find('#popover-spinner').removeClass('a-hidden')
          a.$popover.find('.wlAddCreatePop').html('').addClass('a-hidden')
          var d = c.action,
            e = d + 'Header'
          'create' === d && c.isFirstCreate && (e = 'first' + e)
          a.update({ header: c[e] })
          'create' === d && a.update({ width: c[d + 'Width'], height: c[d + 'Height'] })
          a.updatePosition()
        }),
        a.on('a:popover:hide:' + q, function (a) {
          n('.a-modal-scroller').css({ visibility: 'hidden' })
          b.clearPopCommandFields()
        })
  })
  ;('use strict')
  k.when('A', 'atwl-common-util', 'add-to-wish-list:plugin-registry').register(
    'atwl-util',
    function (a, c, d) {
      var b = a.$
      return {
        parsePostData: function (a, b) {
          var l = c.getState('popoverState'),
            l = document.getElementById(l.formId || 'addToCart')
          if ('undefined' === typeof l || null === l) l = document.getElementById('addToWL')
          var k = []
          if ('undefined' !== typeof l && null !== l) {
            var f = [],
              k = !1,
              g = l.elements
            g || ((g = l.querySelectorAll('input')), (k = !0))
            for (var h = 0; h < g.length; h++) {
              var m
              if (!(m = k)) {
                m = g[h]
                var u = /^(?:checkbox|radio)$/i,
                  r = /^(?:submit|button|image|reset|file)$/i,
                  x = /^(?:input|select|textarea|keygen)/i
                if (m) {
                  var w = m.type
                  m =
                    m.name &&
                    !m.disabled &&
                    x.test(m.nodeName) &&
                    !r.test(w) &&
                    (m.checked || !u.test(w))
                } else m = !1
              }
              m && f.push(g[h])
            }
            k = f
          }
          f = {}
          g = c.getState('wishlistDPState')
          for (h = 0; h < k.length; h++) 'submit' !== k[h].type && (f[k[h].name] = k[h].value)
          f.requestedQty = f.quantity =
            null !== l && 'undefined' !== typeof l.quantity ? l.quantity.value : 1
          f.sid = 'undefined' !== typeof f['session-id'] ? f['session-id'] : g.sid
          f.cache = !1
          f.url = g[a + 'Url']
          f.action = a
          f.type = f.registryType || 'wishlist'
          'add' === a
            ? ((f.type = f.registryType || b),
              (f.caller = 'aui'),
              (f.streaming = g.streaming),
              (f.sourceVendorId =
                'undefined' !== typeof g.vendorId ? g.vendorId : 'website.wishlist.detail.add'))
            : 'create' === a &&
              ((f.create_sid = f.sid),
              (f.create_type = f.registryType || b),
              (f.create_nextAction = 'add'),
              (f.create_includeEmptyList = 1),
              (f.create_isFirst = g.isFirstCreate ? 1 : 0),
              (f.caller = 'aui'),
              (f.create_sourceVendorId =
                'undefined' !== typeof g.vendorId ? g.vendorId : 'website.wishlist.detail.add'))
          ;(a = d.getPlugin()) && a.filterFormData && a.filterFormData(f)
          return f
        },
        hideAddToListButtonStack: function () {
          b('#add-to-wishlist-button-group').hasClass('a-hidden') ||
            b('#add-to-wishlist-button-group').addClass('a-hidden')
        },
        showAddToListButtonStack: function () {
          b('#add-to-wishlist-button-group').hasClass('a-hidden') &&
            b('#add-to-wishlist-button-group').removeClass('a-hidden')
        },
        buildAddItemToDefaultListParams: function (a) {
          return {
            asin: c.getAsin(),
            vendorId: 'website.wishlist.detail.add',
            listType: a.type,
            isAjax: '1',
          }
        },
      }
    },
  )
  ;('use strict')
  k.when('A', 'atwl-util', 'atwl-dropdown-util', 'cf').register(
    'atwl-inline-util',
    function (a, c, d) {
      var b = a.$,
        e = function () {
          b('#atwl-inline-spinner').addClass('a-hidden')
        },
        n = function () {
          c.hideAddToListButtonStack()
          b('#atwl-inline-spinner').removeClass('a-hidden')
        },
        l = function () {
          e()
          b('#atwl-inline').addClass('a-hidden')
          c.showAddToListButtonStack()
          d.makeDropDownArrowInactive()
          b('#atwl-inline-error').removeClass('a-hidden')
        },
        k = function (a) {
          b('#atwl-inline-error-msg').empty()
          b('#atwl-inline-error-msg').html(a)
        },
        f = function (a, c) {
          a =
            c && 'giftlist' === c
              ? '/gp/registry/giftlist/' + a + '/ref\x3dwl_inline_title'
              : c && 'discoverlist' === c
                ? '/create/collection?id\x3damzn1.ideas.' + a + '\x26ref_\x3didea_dp_inline'
                : '/gp/registry/wishlist/' + a + '/ref\x3dwl_inline_title'
          b('#atwl-inline-link').attr('href', a)
        },
        g = function (a) {
          b('#atwl-inline-link-text').empty()
          b('#atwl-inline-link-text').text(a)
        },
        h = function () {
          e()
          b('#atwl-inline-error').addClass('a-hidden')
          b('#atwl-inline').removeClass('a-hidden')
        },
        m = function (a) {
          a && a.message && k(a.message)
          l()
          b('.reg-create-form').closest('.a-popover').find('.a-button-close').click()
        },
        A = function (a) {
          n()
          b('.reg-create-form').closest('.a-popover').find('.a-button-close').click()
          g(a.listName)
        }
      return {
        showSpinner: n,
        showError: l,
        showErrorClosePopover: m,
        parseParams: function (a, b) {
          a = c.parsePostData(a, b)
          b = a.ASIN || a['ASIN.0']
          var d = a['session-id'],
            e = a.sourceVendorId,
            f = a.type || 'wishlist',
            g
          g =
            'create' === a.action
              ? 'newsl'
              : a.wlPopCommand
                ? a.wlPopCommand.split('_')[1]
                : a.sourceCustomerOrgListID
                  ? a.sourceCustomerOrgListID.split('_')[1]
                  : 'default'
          return {
            asin: b,
            sid: d,
            sourceVendorId: e,
            type: f,
            registryID: g,
            pcomp: 0,
            action: a.action,
          }
        },
        addItemResponseHandler: function (a) {
          try {
            typeof a !== u
              ? 1 === a.isValid || !0 === a.updateSuccessful
                ? (f(a.registryID, a.registryType), g(a.registryName), h())
                : typeof a.message !== u && (k(a.message), l())
              : l()
          } catch (b) {
            l()
          }
        },
        addItemResponseHandlerHZ: function (a) {
          try {
            typeof a !== u && !1 === a.hasError ? (A(a), f(a.listExternalId, a.listType), h()) : l()
          } catch (b) {
            l()
          }
        },
        addItemResponseHandlerHZIdeaList: function (a) {
          try {
            typeof a !== u && a.updateSuccessful ? (A(a), f(a.listId, 'discoverlist'), h()) : m(a)
          } catch (b) {
            m(a)
          }
        },
      }
    },
  )
  ;('use strict')
  k.register('add-to-wish-list:plugin-registry', function () {
    var a = null
    return {
      registerPlugin: function (c) {
        if (null !== a) throw Error('Only a single plugin can be registered.')
        a = c
      },
      getPlugin: function () {
        return a
      },
    }
  })
  ;('use strict')
  k.when('A', 'a-modal').register('add-to-list-modal-util', function (a, c) {
    a.declarative('continue-shopping-submit', 'click', function (a) {
      d('reg-create', 'hide')
      d('add-item-to-list-modal', 'remove')
    })
    var d = function (a, d) {
      var n = c.get(a)
      n && ('hide' == d ? n.hide() : c.remove(a))
    }
    return {
      show: function (a, e) {
        d('add-item-to-list-modal', 'remove')
        c.create(a, e).show()
      },
      updateHtmlContent: function (a) {
        c.get('add-item-to-list-modal').update({ content: a })
      },
    }
  })
  ;('use strict')
  k.when('A', 'atwl-common-util', 'amazon-lists-csrf-utils').register(
    'add-to-list-from-huc-recs',
    function (a, c, d) {
      var b = a.$,
        e = function (a) {
          var b = h.ue
          b && b.count(a, (b.count(a) || 0) + 1)
        }
      a.on('lists:widget:add_card_item_to_list_requested', function (h, k) {
        var q = a.state('atwl-huc-recommendation-state')
        k = {
          listId: q.listId,
          listType: q.listType,
          asin: h,
          sid: c.getSid(),
          tags: JSON.stringify(k),
        }
        var f = function () {
            e('lists:dp:card:addtolist:failed')
            a.trigger('lists:widget:add_card_item_to_list_failed', h)
          },
          q = []
        d.addCsrfToken(q)
        b.ajax({
          type: 'POST',
          url: '/hz/wishlist/addasin',
          data: k,
          headers: q,
          success: function (b) {
            b && !1 === b.hasError
              ? (e('lists:dp:card:addtolist:succeeded'),
                a.trigger('lists:widget:add_card_item_to_list_succeeded', h))
              : f()
          },
          error: f,
        })
      })
    },
  )
  ;('use strict')
  k.when('A', 'legacy-create-utils', 'atwl-inline-util').execute(function (a, c, d) {
    var b = a.$
    a.state.parse()
    if ((a.state('createInfo') || {}).isHorizonte) {
      var e = function () {
          b('#WLNEW_error').removeClass('a-hidden')
        },
        h = function (a) {
          try {
            if (typeof a !== u && !1 === a.hasError) {
              b('#WLNEW_loading').addClass('a-hidden')
              var c = b('.reg-create-form')
              c.addClass('a-hidden')
              a.htmlMessage ? c.parent().append(a.htmlMessage) : e()
            } else e()
          } catch (d) {
            e()
          }
        }
      a.declarative('reg-create-submit', ['click'], function (a) {
        c.submitCreate(a, h, e, d.addItemResponseHandlerHZIdeaList, d.showErrorClosePopover)
      })
    }
  })
  ;('use strict')
  k.when('A', 'jQuery').execute(function (a, c) {
    a.declarative('remaining-customizations-action', 'click', function (a) {
      var b = a.$currentTarget.parent().find('.remaining_customization_info')
      b.show()
      b.removeClass('aok-hidden')
      a.$currentTarget.hide()
      a.$event.preventDefault()
    })
  })
  ;('use strict')
  k.when('A', 'create-utils').execute(function (a, c) {
    var d = a.$,
      b = function (a) {
        d('#create-list-loading').addClass('aok-hidden')
        d('#create-list-error').removeClass('aok-hidden')
        a.message
          ? d('#create-list-error').html(a.message)
          : h.ueLogError &&
            h.ueLogError({ message: 'Redesigned Create List failed.', logLevel: 'FATAL' })
      },
      e = function (a) {
        a && !a.hasError
          ? a.htmlMessage
            ? (d('#create-list-loading').addClass('aok-hidden'),
              d('#create-list-form').parent().append(a.htmlMessage))
            : b()
          : b()
      }
    a.declarative('create-list-submit', ['click'], function (a) {
      c.submitCreate(a, e, b)
    })
  })
})
/* ******** */
;(function (n) {
  var g = window.AmazonUIPageJS || window.P,
    t = g._namespace || g.attributeErrors,
    B = t ? t('GenericRegistryDPXAssets', '') : g
  B.guardFatal
    ? B.guardFatal(n)(B, window)
    : B.execute(function () {
        n(B, window)
      })
})(function (n, g, t) {
  'use strict'
  n.when(
    'A',
    'a-modal',
    'a-popover',
    'a-checkbox',
    'a-dropdown',
    'a-splitdropdown',
    'ready',
  ).register('add-to-br-util', function (c, G, p, f, e) {
    function r() {
      return encodeURIComponent(b('#ASIN').val())
    }
    function H(a) {
      var q = c.state('atbrState'),
        E = q.hasBabyReg || !1,
        k = 'true' === b('#is-fully-selected-baby-reg').val() || !1,
        f = r()
      f !== t &&
        k &&
        ((k = encodeURIComponent(q.sessionId)),
        E
          ? d(q, 'C', a)
          : (g.location.href =
              '/baby-reg/signup/ref\x3ddp_create_br_desktop?asin\x3d' +
              f +
              '\x26sessionId\x3d' +
              k))
    }
    function d(a, q, d) {
      var k = r()
      a = encodeURIComponent(a.sessionId)
      var e = {}
      e.asin = k
      e.sid = a
      e.vendorId = d || 'website.dpx.atbr'
      c.post('/baby-reg/button-action/atbr-dpx/ref\x3ddpx_atbr_dsk', {
        params: e,
        timeout: 5e3,
        success: function (a) {
          a !== t && 'failure' !== a.result
            ? ('duplicate' === a.result
                ? (b('#br-dp-post-atbr-status-add-to-registry-success').addClass('a-hidden'),
                  b('#br-dp-post-atbr-status-add-to-registry-dup').removeClass('a-hidden'))
                : (b('#br-dp-post-atbr-status-add-to-registry-dup').addClass('a-hidden'),
                  b('#br-dp-post-atbr-status-add-to-registry-success').removeClass('a-hidden')),
              f('#br_dp_post_atbr_manage_must_have_item').hide(),
              f('#br_dp_post_atbr_manage_group_gifting_item').hide(),
              f('#br_dp_post_atbr_manage_private_item').hide(),
              (document.getElementById(
                'dp-br-post-atbr-header-checklist-text-circle',
              ).style.paddingLeft = 460 - b('#dp-br-post-atbr-header-text').width() + 'px'),
              b('#br-dp-post-atbr-light-box').removeClass('a-hidden'),
              b('#br-dp-post-atbr-container').removeClass('a-hidden'),
              b('body').addClass('br-dp-post-atbr-no-scroll'),
              b('#br-dp-post-atbr-container').removeClass('br-dp-post-atbr-container-hide'),
              b('#br-dp-post-atbr-container').addClass('br-dp-post-atbr-container-show'),
              K(),
              v(q))
            : (g.location.href = '/baby-reg/ref\x3ddpx_atbr_dsk_hp?asin\x3d' + k)
        },
        error: function () {
          g.location.href = '/baby-reg/ref\x3ddpx_atbr_dsk_er?asin\x3d' + k
        },
      })
    }
    function v(a) {
      b('#br-dp-post-atbr-recommadation').html('\x3cspan\x3e\x3c/span\x3e')
      b('#br-dp-post-atbr-spinner').removeClass('a-hidden')
      a = { asin: r(), treatment: a }
      c.get('/baby-reg/dp-post-atbr-recommendation', {
        params: a,
        success: function (a) {
          b('#br-dp-post-atbr-spinner').addClass('a-hidden')
          b('#br-dp-post-atbr-recommadation').html(a)
        },
        failure: function () {},
      })
    }
    function K() {
      var a = { asin: r() }
      c.get('/baby-reg/dp-post-atbr-status', {
        params: a,
        success: function (a) {
          b('#br-dp-post-atbr-status-add-to-registry-item-img').attr(
            'src',
            a.result.newAddedItemImgUrl,
          )
          null != a.result.checklistPercent &&
            (b('#dp-br-post-atbr-header-checklist-percent').html(
              a.result.checklistPercent + '\x3cspan class\x3d"smaller"\x3e%\x3c/span\x3e',
            ),
            b('#dp-br-post-atbr-header-checklist-pie').addClass(
              'progress-' + a.result.checklistPercent,
            ),
            b('#dp-br-post-atbr-header-checklist-pie').removeClass('progress-0'),
            b('#dp-br-post-atbr-header-checklist-text-circle').removeClass('a-hidden'))
          b('#dp-br-post-atbr-header-checklist-link').attr('href', a.result.checklistLink)
          b('#dp-br-post-atbr-header-registry-link').attr('href', a.result.registryLink)
          if (a.result.hasMustHave) {
            x = !0
            var c = f('#br_dp_post_atbr_manage_must_have_item')
            c.show()
            a.result.isMustHaveItem && c.check()
          }
          a.result.hasGroupGifting &&
            ((z = !0),
            (c = f('#br_dp_post_atbr_manage_group_gifting_item')),
            c.show(),
            (w = a.result.helpInfoLinkGroupGifting),
            a.result.isGroupGiftingItem && c.check())
          a.result.hasPrivate &&
            ((y = !0),
            (c = f('#br_dp_post_atbr_manage_private_item')),
            c.show(),
            a.result.isPrivateItem && c.check())
          a = a.result.itemRequestedCount
          !Number.isInteger(a) ||
            0 >= a ||
            (10 < a
              ? ((a = e
                  .getSelect('br-dp-post-atbr-header-registry-request')
                  .getOption('br-dp-post-atbr-dropdown-tenPlusOpt')),
                a.info()[0] === t
                  ? e.getSelect('br-dp-post-atbr-header-registry-request').appendOption({
                      text: '10+',
                      value: '10+Opt',
                      native_id: 'br-dp-post-atbr-dropdown-tenPlusOpt',
                      selected: 'true',
                      css_class: 'br-dp-post-atbr-dropdown-option-disabled',
                      native_css_class: 'br-dp-post-atbr-dropdown-option-disabled',
                    })
                  : a.update({ selected: 'true', text: '10+' }))
              : (e
                  .getSelect('br-dp-post-atbr-header-registry-request')
                  .getOption(a - 1)
                  .update({ selected: 'true', text: a }),
                A()))
        },
        error: function () {},
      })
    }
    function A() {
      e.getSelect('br-dp-post-atbr-header-registry-request').removeOption(
        'br-dp-post-atbr-dropdown-tenPlusOpt',
      )
    }
    var b = c.$,
      z = !1,
      x = !1,
      y = !1,
      w = '',
      m = (c.state('atbrState') || {}).token
    c.declarative('dpx-add-to-baby-registry-action', ['click'], function (a) {
      H()
    })
    c.declarative('br_dp_post_atbr_close', ['click'], function (a) {
      document
        .getElementById('br-dp-post-atbr-container')
        .classList.remove('br-dp-post-atbr-container-show')
      document
        .getElementById('br-dp-post-atbr-container')
        .classList.add('br-dp-post-atbr-container-hide')
      document.getElementById('br-dp-post-atbr-light-box').classList.add('a-hidden')
      document.body.classList.remove('br-dp-post-atbr-no-scroll')
      c.get('/baby-reg/dp-post-atbr-close/ref\x3dbr_dsk_dpx_patr_hdr_close', {})
    })
    c.declarative('br-dp-post-atbr-status-manage-info-popover', ['click'], function (a) {
      p.create(a.$target, {
        inlineContent: a.data.popoverContent,
        position: 'triggerBottom',
        activate: 'onclick',
      }).show()
      !1 === x &&
        (b('#br-manage-popover-content-section-title-must-have').addClass('a-hidden'),
        b('#br-manage-popover-content-section-content-must-have').addClass('a-hidden'))
      !1 === z
        ? (b('#br-manage-popover-content-section-title-group').addClass('a-hidden'),
          b('#br-manage-popover-content-section-content-group').addClass('a-hidden'))
        : b('#br-manage-popover-content-section-content-group-link').attr('href', w)
      !1 === y &&
        (b('#br-manage-popover-content-section-title-private').addClass('a-hidden'),
        b('#br-manage-popover-content-section-content-private').addClass('a-hidden'))
      c.get('/baby-reg/dp-post-atbr-manage-help-info/ref\x3dbr_dsk_dpx_patr_mgmt_info', {})
    })
    c.declarative('post-atbr-item-atbr-button-action', ['click'], function (a) {
      var d = a.data.reftag,
        g = a.data.asin
      a = a.data.sid
      var k = {}
      k.asin = g
      k.sid = a
      k.vendorId = 'website.dpx.post-atbr'
      c.post('/baby-reg/button-action/atbr-dpx/ref\x3d' + d, {
        params: k,
        timeout: 5e3,
        success: function (a) {
          a !== t && 'failure' !== a.result
            ? (b('#post-atbr-item-atbr-success-' + g).removeClass('a-hidden'),
              b('#post-atbr-item-button-' + g).addClass('a-hidden'),
              b('#post-atbr-item-atbr-failure-' + g).addClass('a-hidden'))
            : b('#post-atbr-item-atbr-failure-' + g).removeClass('a-hidden')
        },
        error: function () {
          b('#post-atbr-item-atbr-failure-' + g).removeClass('a-hidden')
        },
      })
    })
    c.declarative('post-atbr-item-see-all-button-action', ['click'], function (a) {
      g.location.href = a.data.link
    })
    c.declarative('br_dp_post_atbr_manage_must_have_item_action', 'change', function (a) {
      a.$event.preventDefault()
      a = {
        isMustHaveItem: b('#br_dp_post_atbr_manage_must_have_item').is(':checked'),
        asin: r(),
        token: m,
      }
      c.post('/baby-reg/dp-post-atbr-status-manage-must-have/ref\x3dbr_dsk_dpx_patr_mgmt_mh', {
        params: a,
        success: function (a) {},
        error: function (a) {},
      })
    })
    c.declarative('br_dp_post_atbr_manage_group_gifting_item_action', 'change', function (a) {
      a.$event.preventDefault()
      a = {
        isGroupGiftingItem: b('#br_dp_post_atbr_manage_group_gifting_item').is(':checked'),
        asin: r(),
        token: m,
      }
      c.post('/baby-reg/dp-post-atbr-status-manage-group-gifting/ref\x3dbr_dsk_dpx_patr_mgmt_gg', {
        params: a,
        success: function (a) {},
        error: function (a) {},
      })
    })
    c.declarative('br_dp_post_atbr_manage_private_item_action', 'change', function (a) {
      a = {
        isPrivateItem: b('#br_dp_post_atbr_manage_private_item').is(':checked'),
        asin: r(),
        token: m,
      }
      c.post('/baby-reg/dp-post-atbr-status-manage-private/ref\x3dbr_dsk_dpx_patr_mgmt_pvt', {
        params: a,
        success: function (a) {},
        error: function (a) {},
      })
    })
    c.declarative('br_dp_post_atbr_manage_request_quantity_item_action', 'change', function (a) {
      a = {
        requestQuantity: b('#br-dp-post-atbr-header-registry-request').val(),
        asin: r(),
        token: m,
      }
      c.post(
        '/baby-reg/dp-post-atbr-status-manage-request-quantity/ref\x3dbr_dsk_dpx_patr_mgmt_qty',
        {
          params: a,
          success: function (a) {
            A()
          },
          error: function (a) {},
        },
      )
    })
    return { addToBabyRegistryFromDPX: H }
  })
  ;('use strict')
  n.when('A', 'a-button', 'a-modal', 'ready').register(
    'dpx-modal-add-to-wr-declarative-actions',
    function (c, G, p) {
      var f = c.$,
        e = c.state('modal-add-to-wedding-registry-status')
      if (e && e.weddingButtonId && f('#' + e.weddingButtonId).length) {
        var r = { name: 'wr-modal-add-to-reg-wedding-registry', header: e.modalHeader, url: '' }
        f(document).delegate('#' + e.weddingButtonId, 'click', function (c) {
          c.preventDefault()
          if (e.userSignedIn) {
            var d = f('#quantity').val()
            d || (d = 1)
            c = p.create(f('#' + e.weddingButtonId), r)
            var v = encodeURIComponent(f('#ASIN').val()),
              d = encodeURIComponent(d),
              G = e.token ? '\x26token\x3d' + encodeURIComponent(e.token) : ''
            e.hasWeddingRegistry
              ? (c
                  .update({
                    cache: !1,
                    url:
                      '/wedding/modal/external-add-to-registry?asin\x3d' +
                      v +
                      '\x26quantity\x3d' +
                      d +
                      G +
                      '\x26ref_\x3dhit_wr_dp_dp_mdl_pop',
                  })
                  .show(),
                'undefined' !== typeof g.ue &&
                  g.ue.count('wrAddToRegModalPopup', (g.ue.count('wrAddToRegModalPopup') || 0) + 1))
              : (g.location.href =
                  '/wedding/new-registry?asin.' +
                  v +
                  '\x3d' +
                  d +
                  '\x26vendorId\x3dgr-dpx-new-reg\x26associateId\x3d\x26associateSubId\x3d')
          } else g.location.href = '/wedding/nosignin'
        })
        c.declarative('wr-modal-add-to-reg-rec-add-to-registry-action', 'click', function (e) {
          var d = e.data
          e = f('#wr-modal-add-to-reg-wrapper').data('token')
          var p = G('#wr-modal-add-to-reg-add-to-wr-' + d.recItemAsin)
          p.isEnabled() &&
            (p.disable(),
            !0 ===
            f('#wr-modal-add-to-reg-rec-product-card-' + d.recItemAsin).data('exist-in-registry')
              ? (p.hide(),
                f('#wr-modal-add-to-reg-item-exist-message-' + d.recItemAsin).removeClass(
                  'aok-hidden',
                ))
              : ((e = {
                  items: JSON.stringify([{ asin: d.recItemAsin, requestedQuantity: 1 }]),
                  token: e,
                }),
                c.post('/wedding/registry-items/addItems?ref_\x3dhit_wr_dp_dp_mdl_sa', {
                  params: e,
                  contentType: 'application/x-www-form-urlencoded; charset\x3dUTF-8',
                  success: function (c) {
                    p.hide()
                    c.success
                      ? f('#wr-modal-add-to-reg-item-added-message-' + d.recItemAsin).removeClass(
                          'aok-hidden',
                        )
                      : 'ITEM_ALREADY_EXIST' === c.errorCode
                        ? f('#wr-modal-add-to-reg-item-exist-message-' + d.recItemAsin).removeClass(
                            'aok-hidden',
                          )
                        : f('#wr-modal-add-to-reg-item-added-error-' + d.recItemAsin).removeClass(
                            'aok-hidden',
                          )
                  },
                  error: function () {
                    f('#wr-modal-add-to-reg-item-added-error-' + d.recItemAsin).removeClass(
                      'aok-hidden',
                    )
                    'undefined' !== typeof g.ue &&
                      g.ue.count(
                        'wrAddToRegModalAddFromSimilaritiesError',
                        (g.ue.count('wrAddToRegModalAddFromSimilaritiesError') || 0) + 1,
                      )
                  },
                })),
            'undefined' !== typeof g.ue &&
              g.ue.count(
                'wrAddToRegModalAddFromSimilarities',
                (g.ue.count('wrAddToRegModalAddFromSimilarities') || 0) + 1,
              ))
        })
        c.on('a:popover:beforeHide:wr-modal-add-to-reg-wedding-registry', function () {
          'undefined' !== typeof g.ue &&
            g.ue.count(
              'wrAddToRegModalDismissed',
              (g.ue.count('wrAddToRegModalDismissed') || 0) + 1,
            )
        })
        c.declarative('wr-modal-add-to-reg-view-registry-action', 'click', function (c) {
          'undefined' !== typeof g.ue &&
            g.ue.count(
              'wrAddToRegModalViewRegistry',
              (g.ue.count('wrAddToRegModalViewRegistry') || 0) + 1,
            )
          g.location.href = '/wedding/organize-registry?ref_\x3dhit_wr_dp_dp_mdl_vr'
        })
      }
    },
  )
  ;('use strict')
  var B =
    'function' === typeof Symbol && 'symbol' === typeof Symbol.iterator
      ? function (c) {
          return typeof c
        }
      : function (c) {
          return c &&
            'function' === typeof Symbol &&
            c.constructor === Symbol &&
            c !== Symbol.prototype
            ? 'symbol'
            : typeof c
        }
  n.when(
    'A',
    'a-button',
    'a-modal',
    'a-dropdown',
    'a-splitdropdown',
    'dpx-gift-tag-modal',
    'add-to-br-util',
    'ready',
  ).register('ggr-add-to-registry-desktop-util', function (c, G, p, f, e, r, H) {
    function d() {
      l.ajax({
        dataType: 'json',
        url:
          '/registries/dpx/desktop/list-registry?' +
          l.param({ asin: encodeURIComponent(l('#ASIN').val()) }),
        cache: !1,
      })
        .done(function (a) {
          b(a)
        })
        .fail(y)
    }
    function v() {
      null == n
        ? l
            .ajax({
              dataType: 'json',
              url:
                '/registries/dpx/desktop/list-registry?' +
                l.param({ asin: encodeURIComponent(l('#ASIN').val()) }),
              cache: !1,
            })
            .done(function (a) {
              n = a
              b(a)
            })
            .fail(y)
        : b(n)
    }
    function K() {
      var a = f.getSelect(h.registryDropdownId).getOptions().options.elements
      l.each(a, function (a, b) {
        f.getSelect(h.registryDropdownId).removeOption(b)
      })
    }
    function A() {
      var a = e.getSelect(u.oneClickSplitDropdown),
        b = a.getOptions().options.elements
      l.each(b, function (b, c) {
        a.removeOption(c)
      })
    }
    function b(a) {
      a = z(a)
      if (null === a) y()
      else {
        if (h.showOneClickSplitDropdown)
          return (
            A(),
            L({
              html_content: document.getElementById(h.registryDropdownCreateRegistryTemplateId)
                .innerHTML,
              css_class: t.registryDropdownItemWrapper,
              native_id: C.newRegistryType,
              value: JSON.stringify({ regType: C.newRegistryType }),
            }),
            L({
              html_content: x(a[0]),
              text: q(a[0].name),
              value: JSON.stringify({ regType: a[0].type, regName: a[0].name, regId: a[0].id }),
              css_class: t.registryDropdownItemWrapper,
            }),
            e.getSelect(u.oneClickSplitDropdown).getOption('defaultSpinner').remove(),
            null != document.getElementById(D.splitDropdownAnnounce) &&
              'true' ===
                document
                  .getElementById(D.splitDropdownAnnounce)
                  .getAttribute(C.ariaPressedProperty) &&
              document.getElementById(D.splitDropdownAnnounce).click(),
            e.getSelect(u.oneClickSplitDropdown).setValue(''),
            !1
          )
        K()
        k({
          html_content: document.getElementById(h.registryDropdownCreateRegistryTemplateId)
            .innerHTML,
          css_class: t.registryDropdownItemWrapper,
          native_id: C.newRegistryType,
          value: JSON.stringify({ regType: C.newRegistryType }),
        })
        var b = []
        h.babyEnabled || b.push(F.BABY)
        h.weddingEnabled || b.push(F.WEDDING)
        h.ggrEnabled ||
          b.push(F.BIRTHDAY, F.CUSTOM, F.HOLIDAY, F.PET, F.GRADUATION, F.HOUSE_WARMING)
        l.each(a, function (a, c) {
          b.includes((c.type || '').toLowerCase()) ||
            k({
              html_content: x(c),
              text: q(c.name),
              value: JSON.stringify({ regType: c.type, regName: c.name, regId: c.id }),
              css_class: t.registryDropdownItemWrapper,
            })
        })
        l(l(u.registryDropdownSpinnerId)).addClass('aok-hidden')
        f.getSelect(u.registryDropdownId).getOption('defaultSpinner').remove()
        l(u.registryDropdownId)[0].click()
      }
    }
    function z(a) {
      var b = void 0
      if ('object' === ('undefined' === typeof a ? 'undefined' : B(a))) b = a.result
      else
        try {
          b = c.parseJSON(a)
        } catch (d) {
          b = null
        }
      return l.isArray(b) ? b : null
    }
    function x(a) {
      var b = document.getElementById(h.registryDropdownItemTemplateId).innerHTML,
        b = b.replace('{imgTag}', C.imgTag),
        c = { registryType: a.typeText, registryName: a.name, imgUrl: a.imageUrl }
      return b.replace(/\{([\w]*)\}/g, function (b, d) {
        b = c[d]
        if ('undefined' !== typeof b && null !== b) a = b
        else return ''
        return a
      })
    }
    function y() {
      l(u.registryDropdownSpinnerId).addClass('aok-hidden')
      w(u.registryDropdownErrorBoxId)
    }
    function w(a) {
      l(a).removeClass('aok-hidden')
    }
    function m(b) {
      var c = l('#quantity').val() || 1,
        d = JSON.parse(b.value)
      if (d.regId || d.regType) {
        b = d.regType
        var k = d.regId,
          e = d.regName,
          d = encodeURIComponent(l('#ASIN').val()),
          c = encodeURIComponent(c),
          f = encodeURIComponent(h.sessionId)
        E(J.dropdownItemClicked + ':' + b.toLowerCase())
        b === C.newRegistryType
          ? (g.location.href =
              '/registries?ref\x3ddpx_create_registry_desktop\x26sessionId\x3d' + f)
          : 'Wedding' === b
            ? ((e = {
                name: D.popoverModalName,
                header:
                  !0 === u.internationalGiftTaggingEnabled
                    ? C.addToRegistryModalHeaderText
                    : h.weddingModalHeader,
                url: '',
              }),
              (f = p.get(e.name)) || (f = p.create(l('#GR-DROPDOWN-MODAL-TRIGGER'), e)),
              f.update(a(b, e.header, k, d, c, h.token)).show())
            : 'Baby' === b
              ? H.addToBabyRegistryFromDPX(C.addToBabyRegistryVendorId)
              : ((f = {
                  name: D.popoverModalName,
                  header: {
                    Birthday: h.birthdayModalHeader,
                    Custom: h.customModalHeader,
                    Holiday: h.holidayModalHeader,
                    Pet: h.petModalHeader,
                  }[b],
                  url: '',
                }),
                !0 === u.internationalGiftTaggingEnabled
                  ? r.renderDPXGiftTagModal(
                      b,
                      k,
                      e,
                      d,
                      c,
                      h.token,
                      u.internationalGiftTaggingEnabled,
                    )
                  : (g.ue &&
                      ue.trigger(
                        'HIT_GGR_PETS_DPX_GIFT_TAGS_636549',
                        u.cglBglPetsGiftTagEnabled ? 'T1' : 'C',
                      ),
                    ('Custom' !== b && 'Birthday' !== b && 'Pet' !== b) ||
                    u.cglBglPetsGiftTagEnabled
                      ? r.renderDPXGiftTagModal(
                          b,
                          k,
                          e,
                          d,
                          c,
                          h.token,
                          u.internationalGiftTaggingEnabled,
                        )
                      : ((e = p.get(f.name)) || (e = p.create(l('#GR-DROPDOWN-MODAL-TRIGGER'), f)),
                        e.update(a(b, f.header, k, d, c, h.token)).show())))
      }
    }
    function a(a, b, c, d, e, k) {
      var f = 'Wedding' === a ? a : 'GGR'
      a = {
        Wedding: '/wedding/modal/external-add-to-registry',
        GGR: '/registries/dpx-add-to-registry/' + a.toLowerCase() + '/' + c,
      }
      k = k ? '\x26token\x3d' + encodeURIComponent(k) : ''
      d = a[f] + '?asin\x3d' + d + '\x26quantity\x3d' + e + k + '\x26ref_\x3dhit_wr_dp_dp_mdl_pop'
      'Wedding' === f
        ? (d += '\x26sourceVendorId\x3damazon.wedding_registry.add.dpx.desktop')
        : 'GGR' === f && (d += '\x26sourceid\x3damazon.ggr.add.dpx.desktop')
      return { header: b, cache: !1, url: d }
    }
    function q(a) {
      var b = document.createElement('textarea')
      b.innerHTML = a
      return b.value
    }
    function E(a) {
      a = J.deviceType + ':' + a
      g.ue && g.ue.count(a, (g.ue.count(a) || 0) + 1)
    }
    function k(a) {
      f.getSelect(h.registryDropdownId).addOption(a)
    }
    function L(a) {
      e.getSelect(h.oneClickDropdownSubmitId).addOption(a)
    }
    function I() {
      h.showOneClickSplitDropdown ? c.delay(v, 0) : c.delay(d, 0)
      E(J.dropdownClicked)
      return !1
    }
    function M() {
      h.showOneClickSplitDropdown
        ? (null != document.getElementById(D.splitDropdownAnnounce) &&
            'true' ===
              document
                .getElementById(D.splitDropdownAnnounce)
                .getAttribute(C.ariaPressedProperty) &&
            I(),
          I())
        : (null != document.getElementById(h.registryDropdownId) &&
            'true' ===
              document.getElementById(h.registryDropdownId).getAttribute(C.ariaPressedProperty) &&
            I(),
          l(u.registryDropdownId)
            .unbind('click')
            .one('click', function () {
              I()
            }))
    }
    var l = c.$,
      h = c.state('modal-add-to-registry-dropdown-state'),
      n = null
    if (h) {
      var J = {
          deviceType: 'desktop',
          dropdownClicked: 'dpx-ggr-dropdown-clicked',
          dropdownItemClicked: 'dpx-ggr-dropdown-item-clicked',
          similarityClicked: 'dpx-ggr-dropdown-similarity-clicked',
        },
        t = { registryDropdownItemWrapper: 'agr-add-to-registry-dropdown-item-wrapper' },
        u = {
          registryDropdownId: '#' + h.registryDropdownId,
          registryDropdownErrorBoxId: '#' + h.registryDropdownErrorBoxId,
          registryDropdownSpinnerId: '#' + h.registryDropdownSpinnerId,
          oneClickSplitDropdownAnnounce: '#add-to-registry-one-click-dropdown-announce',
          oneClickSplitDropdown: '#' + h.oneClickDropdownSubmitId,
          internationalGiftTaggingEnabled: h.internationalGiftTaggingEnabled,
          cglBglPetsGiftTagEnabled: h.cglBglPetsGiftTagEnabled,
        },
        D = {
          addToRegistrySuccessClass: '.gr-add-success-message',
          addToRegistryErrorClass: '.gr-add-error-message',
          addToRegistryDuplicateClass: '.gr-already-exist-message',
          popoverModalName: 'wr-modal-add-to-reg-wedding-registry',
          splitDropdownAnnounce: 'add-to-registry-one-click-dropdown-announce',
        },
        C = {
          newRegistryType: 'new',
          imgTag:
            '\x3cimg src\x3d"{imgUrl}" alt\x3d"{registryName}" class\x3d"agr-add-to-registry-dropdown-registry-icon" /\x3e',
          ariaPressedProperty: 'aria-pressed',
          addToBabyRegistryVendorId: 'amazon.ggr.baby.add.dpx.desktop',
          addToRegistryModalHeaderText: h.addToRegistryModalHeaderText,
        },
        F = {
          BABY: 'baby',
          WEDDING: 'wedding',
          BIRTHDAY: 'birthday',
          CUSTOM: 'custom',
          HOLIDAY: 'holiday',
          GRADUATION: 'graduation',
          PET: 'pet',
          HOUSE_WARMING: 'house_warming',
        }
      c.on('a:dropdown:' + h.registryDropdownId + ':select', function (a) {
        m(a)
        f.getSelect(h.registryDropdownId).setValue('')
      })
      c.on('a:splitdropdown:' + h.oneClickDropdownSubmitId + ':select', function (a) {
        m(a)
      })
      l(document).delegate(
        '.gr-modal-add-to-reg-rec-add-to-registry-action',
        'click',
        function (a) {
          var b = l(a.currentTarget)
          a = b.attr('data-asin')
          var d = G('#gr-modal-add-to-reg-add-to-wr-' + a)
          if (d.isEnabled()) {
            d.disable()
            if (!0 === b.data('exist')) d.hide(), w(b.find(D.addToRegistryDuplicateClass))
            else {
              var e = void 0,
                k = void 0,
                e = b.data('type'),
                k = l('#gr-modal-add-to-reg-wrapper').data('token')
              e && 'Wedding' !== e
                ? ((e = {
                    asin: a,
                    desiredQuantity: 1,
                    registryId: b.data('id'),
                    registryType: b.data('type'),
                    itemType: 'AMAZON_ITEM',
                    vendorId: 'amazon.ggr.add.dpx.desktop',
                    token: k,
                  }),
                  (k = '/registries/registry-products/addProduct'))
                : ((e = { token: k, items: JSON.stringify([{ asin: a, requestedQuantity: 1 }]) }),
                  (k = '/wedding/registry-items/addItems?ref_\x3dhit_wr_dp_dp_mdl_sa'))
              c.post(k, {
                params: e,
                contentType: 'application/x-www-form-urlencoded; charset\x3dUTF-8',
                success: function (a) {
                  d.hide()
                  a.success
                    ? w(b.find(D.addToRegistrySuccessClass))
                    : 'ITEM_ALREADY_EXIST' === a.errorCode &&
                      w(b.find(D.addToRegistryDuplicateClass))
                },
                error: function () {
                  d.hide()
                  w(b.find(D.addToRegistryErrorClass))
                },
              })
            }
            E(J.similarityClicked)
          }
        },
      )
      M()
      c.on('a:pageUpdate', function () {
        M()
      })
      c.declarative('gr-modal-add-to-reg-view-registry-action', 'click', function (a) {
        g.location.href =
          a.data && a.data.type && a.data.id
            ? '/registries/gl/owner-view/' + a.data.id + '?ref_\x3dhit_gr_from_dpx'
            : '/wedding/organize-registry?ref_\x3dhit_wr_dp_dp_mdl_vr'
      })
      c.declarative('wr-modal-add-to-reg-view-registry-action', 'click', function (a) {
        g.location.href = '/wedding/organize-registry?ref_\x3dhit_wr_dp_dp_mdl_vr'
      })
    }
  })
  ;('use strict')
  n.when(
    'A',
    'a-modal',
    'a-button',
    'a-alert',
    'message-render',
    'create-gift-tag-modal',
    'ready',
  ).register('dpx-gift-tag-modal', function (c, g, p, f, e, r) {
    var n, d, v, t, A, b
    function z() {
      m(q.giftTagErrorBoxId).removeClass('aok-hidden')
    }
    function x(b) {
      m(a.tagListWrapper).html('')
      m(a.tagListWrapper).html(b)
    }
    function y(a, b, c, d, e, g, f, q) {
      a = '/registries/dpx-add-to-registry/' + a.toLowerCase() + '/' + c
      q = q ? '\x26token\x3d' + encodeURIComponent(q) : ''
      d =
        a +
        '?asin\x3d' +
        g +
        '\x26quantity\x3d' +
        f +
        '\x26tagId\x3d' +
        d +
        '\x26tagName\x3d' +
        encodeURIComponent(e) +
        q +
        '\x26ref_\x3dhit_wr_dp_dp_mdl_pop'
      return { header: b, cache: !1, url: d + '\x26sourceid\x3damazon.ggr.add.dpx.desktop' }
    }
    function w(c, f, q, p, l, h, r) {
      n = c
      d = f
      v = p
      t = l
      A = h
      b = r
      f = !0 === b ? E.addToGiftListModalHeaderText : E.hglGiftTagHeader + ' ' + q
      c = g.get('dpxTagModal')
      c ||
        ((c = a.tagModalTrigger),
        (f = {
          name: 'dpxTagModal',
          width: 800,
          cache: !1,
          header: f,
          inlineContent: m(a.tagModalContent),
        }),
        (c = g.create(c, f)))
      f = n
      q = d
      f && q
        ? m
            .ajax({ url: '/registries/' + f + '/' + q + '/dpx-get-registry-tags', timeout: 5e3 })
            .done(x)
            .fail(z)
        : e.showChangeOver(a.tagModalChangeover, void 0)
      c.show()
    }
    var m = c.$
    if ((c = c.state('modal-view-gift-tags-state'))) {
      b = A = t = v = d = n = ''
      var a = {
          tagModalTrigger: '.gr-dpx-tag-modal-trigger',
          tagModalContent: '.gr-dpx-tag-modal',
          tagTextContent: '#gr-tag-modal-name-input',
          tagListContainer: '.gr-dpx-tag-modal-your-tags-container',
          tooManyTagsAlert: '#gr-tag-modal-too-many-tags-alert',
          invalidInputAlert: '#gr-tag-modal-invalid-input-alert',
          hiddenClass: 'aok-hidden',
          tagListWrapper: '.gr-dpx-tag-modal-taglist-wrapper',
          tagModalChangeover: '#tagModalChangeover',
          tagHeading: '.gr-tag-modal-your-tags-header',
          closeButton: '.gr-tag-modal-back-button',
          saveButton: '.gr-dpx-tag-modal-save-wrapper',
        },
        q = {
          registryTitleComponent: '.gr-dpx-tag-modal-header-main',
          giftTagErrorBoxId: '#' + c.giftTagErrorBoxId,
          popoverModalName: 'wr-modal-add-to-reg-wedding-registry',
        },
        E = {
          hglGiftTagHeader: c.giftTagModalHeaderText,
          holidayModalHeader: c.addToHGLModalHeaderText,
          addToGiftListModalHeaderText: c.addToGiftListModalHeaderText,
        }
      m(document).delegate('.gr-dpx-add-new-tag', 'click', function (a) {
        r.renderCreateTagModal(n, d)
      })
      m(document).delegate('.gr-tag-modal-back-button', 'click', function (a) {
        ;(a = g.get('dpxTagModal')) && a.show()
      })
      m(document).delegate('.gr-dpx-tag-modal-your-tags-wrapper', 'click', function (a) {
        a = m(this).attr('tagid')
        var c = m(this).text(),
          e = {
            name: q.popoverModalName,
            header: !0 === b ? E.addToGiftListModalHeaderText : E.holidayModalHeader,
            url: '',
          },
          f = g.get(e.name)
        f || (f = g.create(m('#GR-DROPDOWN-MODAL-TRIGGER'), e))
        f.update(y(n, e.header, d, a, c, v, t, A)).show()
      })
      return { renderDPXGiftTagModal: w }
    }
  })
  ;('use strict')
  n.when('A', 'a-modal', 'a-button', 'a-alert', 'message-render', 'ready').register(
    'create-gift-tag-modal',
    function (c, g, p, f, e) {
      function r(a, e) {
        c.get('/registries/' + a + '/' + e + '/dpx-get-registry-tags', {
          cache: !1,
          success: function (a) {
            d(b.renderModalTagListWrapper).html('')
            d(b.renderModalTagListWrapper).html(a)
          },
          error: function () {
            y(z.ADD_TAG_FAILURE)
          },
        })
      }
      function n(a, c) {
        B = a
        v = c
        var e = g.get('tagModal')
        if (!e)
          var e = b.tagModalTrigger,
            f = {
              name: 'tagModal',
              width: 800,
              cache: !1,
              hideHeader: !0,
              inlineContent: d(b.tagModalContent),
            },
            e = g.create(e, f)
        w({ updateType: x.render, token: A }, a, c)
        m()
        e.show()
      }
      var d = c.$,
        v = '',
        B = '',
        A = c.state('modal-add-to-registry-dropdown-state')
          ? c.state('modal-add-to-registry-dropdown-state').token
          : t,
        b = {
          tagModalTrigger: '.gr-tag-modal-trigger',
          tagModalContent: '.gr-tag-modal-container',
          tagModalMainContent: '.gr-tag-modal',
          tagModalDeleteContent: '.gr-tag-modal-delete-flow',
          tagTextContent: '#gr-tag-modal-name-input',
          tagListContainer: '.gr-tag-modal-your-tags-container',
          tooManyTagsAlert: '#gr-tag-modal-too-many-tags-alert',
          invalidInputAlert: '#gr-tag-modal-invalid-input-alert',
          hiddenClass: 'aok-hidden',
          tagListWrapper: '.gr-tag-modal-taglist-wrapper',
          tagModalChangeover: '#tagModalChangeover',
          deleteFlowReplacementSelector: '.gr-tag-modal-delete-this-tag',
          deleteFlowButtonReplacementSelector: '.gr-tag-modal-delete-this-button',
          deleteFlowDeleteButton: '.gr-tag-modal-delete-confirm',
          onOwnerViewSelector: '.gr-tag-summary-container-owner',
          productListExpander: '.gr-product-list-expander',
          productListExpanderSection: 'gr-product-list-expander-section',
          tagSectionTemplate: '#gr-product-list-section-template',
          tagIdFinderSelector: '.gr-tag-modal-your-tags-tag',
          renderModalTagListWrapper: '.gr-dpx-tag-modal-taglist-wrapper',
        },
        z = {
          ADD_TAG_SUCCESS: 'ADD_TAG_SUCCESS',
          REMOVE_TAG_SUCCESS: 'REMOVE_TAG_SUCCESS',
          ADD_TAG_FAILURE: 'ADD_TAG_FAILURE',
          REMOVE_TAG_FAILURE: 'REMOVE_TAG_FAILURE',
        },
        x = { add: 'add', remove: 'remove', render: 'render' },
        y = function (a) {
          var d = ''
          'ADD_TAG_SUCCESS' === a
            ? (d = c.state('tagModalChangeoverStrings').addSuccess)
            : 'REMOVE_TAG_SUCCESS' === a
              ? (d = c.state('tagModalChangeoverStrings').removeSuccess)
              : 'ADD_TAG_FAILURE' === a
                ? (d = c.state('tagModalChangeoverStrings').addFailure)
                : 'REMOVE_TAG_FAILURE' === a &&
                  (d = c.state('tagModalChangeoverStrings').removeFailure)
          e.showChangeOver(b.tagModalChangeover, d)
        },
        w = function (a, e, f, g, p) {
          e && f
            ? ((a.ref_ = 'gr-dpx-modal'),
              c.post('/registries/' + e + '/' + f + '/update-tag', {
                params: a,
                timeout: 5e3,
                cache: !1,
                success: function (c) {
                  g && y(g)
                  if (a.updateType === x.remove) r(e, f), n(e, f)
                  else if ((d(b.tagListWrapper).html(c), a.updateType === x.add)) {
                    r(e, f)
                    var p = a.tagName,
                      l = d(d(b.tagSectionTemplate).html()).clone()
                    c = d(c).find(b.tagIdFinderSelector).last().attr('id')
                    l.attr('data-section-id', c)
                    l.find('.gr-product-list-expander-section-name').text(p)
                    d(b.productListExpander).append(l)
                  }
                },
                error: function () {
                  y(p)
                },
              }))
            : y(p)
        },
        m = function () {
          d(b.tooManyTagsAlert).hasClass(b.hiddenClass) ||
            d(b.tooManyTagsAlert).addClass(b.hiddenClass)
          d(b.invalidInputAlert).hasClass(b.hiddenClass) ||
            d(b.invalidInputAlert).addClass(b.hiddenClass)
          d(b.tagModalMainContent).hasClass(b.hiddenClass) &&
            d(b.tagModalMainContent).removeClass(b.hiddenClass)
          d(b.tagModalDeleteContent).hasClass(b.hiddenClass) ||
            d(b.tagModalDeleteContent).addClass(b.hiddenClass)
          d(b.tagTextContent).val() && d(b.tagTextContent).val('')
          e.closeChangeOver(b.tagModalChangeover)
        }
      d(document).delegate('.gr-tag-modal-create-button', 'click', function (a) {
        a.preventDefault()
        a = d(b.tagTextContent).val()
        m()
        15 <= d(b.tagListContainer).children().length
          ? d(b.tooManyTagsAlert).removeClass(b.hiddenClass)
          : a
            ? w(
                { updateType: x.add, tagName: a, token: A },
                B,
                v,
                z.ADD_TAG_SUCCESS,
                z.ADD_TAG_FAILURE,
              )
            : d(b.invalidInputAlert).removeClass(b.hiddenClass)
      })
      d(document).delegate('.gr-tag-modal-your-tags-tag', 'click', function (a) {
        a.preventDefault()
        a = d(this).attr('id')
        var c = d(this).text()
        d(b.deleteFlowDeleteButton).attr('id', a)
        d(b.deleteFlowReplacementSelector).text(c)
        d(b.deleteFlowButtonReplacementSelector).text(c)
        d(b.tagModalMainContent).addClass(b.hiddenClass)
        d(b.tagModalDeleteContent).removeClass(b.hiddenClass)
      })
      d(document).delegate('.gr-tag-modal-delete-go-back', 'click', function (a) {
        a.preventDefault()
        d(b.tagModalDeleteContent).addClass(b.hiddenClass)
        d(b.tagModalMainContent).removeClass(b.hiddenClass)
      })
      d(document).delegate('.gr-tag-modal-delete-confirm', 'click', function (a) {
        a.preventDefault()
        a = d(this).attr('id')
        w(
          { updateType: x.remove, tagId: a, token: A },
          B,
          v,
          z.REMOVE_TAG_SUCCESS,
          z.REMOVE_TAG_FAILURE,
        )
        d(b.tagModalDeleteContent).addClass(b.hiddenClass)
        d(b.tagModalMainContent).removeClass(b.hiddenClass)
      })
      d(document).delegate('.gr-tag-modal-back-button', 'click', function (a) {
        a.preventDefault()
        if ((a = g.get('tagModal'))) m(), a.hide()
      })
      return { renderCreateTagModal: n }
    },
  )
  ;('use strict')
  n.when('A', 'ready').register('message-render', function (c) {
    var g = c.$
    return {
      showChangeOver: function (c, f, e) {
        c = g(c)
        c.stop(!0, !0)
        c.find('strong').text(f)
        c.is(':visible') || c.fadeIn(400)
        c.delay(2e3).fadeOut(800, function () {
          e && e()
        })
      },
      closeChangeOver: function (c) {
        g(c).hide()
      },
    }
  })
})
/* ******** */
;(function (g) {
  var n = window.AmazonUIPageJS || window.P,
    v = n._namespace || n.attributeErrors,
    b = v ? v('ProductAdsDetailPageAssets', '') : n
  b.guardFatal
    ? b.guardFatal(g)(b, window)
    : b.execute(function () {
        g(b, window)
      })
})(function (g, n, v) {
  g.when('A', 'a-carousel-framework', 'a-carousel-ajax-standard').register(
    'AmazonClicks',
    function (b, n, t) {
      function q(c, a, k, f) {
        var l = c.getAttr('pageNumber'),
          w
        w = c.getAttr('initialSeenAsins')
        for (var r = c.getAttr('fetchedItems').slice(w.length), p = 0; p < r.length; p++)
          r[p] && r[p].oid && w.push(r[p].oid)
        r = c.getAttr('filteredItems')
        for (p = 0; p < r.length; p++) r[p] && w.push(r[p])
        w = w.join('')
        k.pg = l
        k.tot = c.getAttr('set_size')
        k.start = k.offset
        k.num = k.count
        k.cc = 1 === l ? 0 : k.offset
        k.oData = w
        l = c.getAttr('ajax')
        c.setAttr('requestTimer', b.delay(d, l.fetch_delay, c, a, k, f))
      }
      function d(c, a, k, f) {
        c.triggerEvent('beforeAjax', { url: a, params: k })
        b.get(a, {
          cache: !1,
          success: function (l) {
            l = C(l, a)
            if (null === l)
              g.error(
                'Invalid JSON returned to carousel from ' +
                  a +
                  ' - see http://tiny/c1mr5h0u for details.',
                'a-carousel-ajax-standard',
                'sendRequest',
              )
            else {
              k.needSetSize &&
                ((l && l.length) ||
                  g.error(
                    'Carousel requires a set_size and none was returned by the fallback AJAX request at: ' +
                      a,
                    'a-carousel-ajax-standard',
                    'sendRequest',
                  ),
                c.setAttr('set_size', l[0].setSize ? l[0].setSize : l.length))
              for (
                var f = c.getAttr('fetchedItems'),
                  r = c.getAttr('filteredItems'),
                  p = c.getAttr('ajax'),
                  d = [],
                  e,
                  h = l.length,
                  m = 0;
                h--;

              )
                (e = l[h]),
                  null === e && d.push(h),
                  e && e.isFilteredItem && 'true' === e.isFilteredItem
                    ? (r.push(e.oid), m++)
                    : (e &&
                        (e.content || '' === e.content
                          ? (e.content = b.trim(e.content))
                          : (e = b.trim(e))),
                      (f[k.offset + h] = e))
              z = (1 * m) / l.length
              p.remove_nulls &&
                p.id_list &&
                d.length &&
                (b.each(d, function (c) {
                  p.id_list.splice(k.offset + c, 1)
                }),
                c.setAttr('ajax', p))
              k.needSetSize && c.init()
              c.setAttr('fetchedItems', f)
              c.setAttr('filteredItems', r)
              c.setAttr('ajaxLock', !1)
              c.getAttr('pageSize') * c.getAttr('pageNumber') >= f.length &&
                c.strategies.ajax.wantCurrentPage(c)
              c.triggerEvent('ajaxSuccess', { url: a, params: k })
            }
          },
          error: function () {
            b.delay(function () {
              var a = b.$('#' + c.dom.$container[0].id + ' li.a-carousel-card-empty')
              0 < a.length &&
                (c.setAttr('set_size', a[0].getAttribute('aria-posinset') - 1),
                a.removeClass('a-carousel-card-empty'))
            }, 200)
          },
          params: k,
          headers: f,
        })
      }
      function C(c, a) {
        return b.isArray(c)
          ? c
          : c !== v &&
              null !== c &&
              !b.objectIsEmpty(c) &&
              c.hasOwnProperty('data') &&
              b.isArray(c.data)
            ? c.data
            : null
      }
      function e(c, B) {
        Array.isArray(c) &&
          b.each(c, function (c) {
            a[c] = B
          })
      }
      function h(c) {
        b.each(a, function (b, k) {
          b === c && delete a[k]
        })
      }
      var A = {},
        a = {},
        m = {},
        u = {},
        y = [],
        z = 0,
        x = b.extend([], t),
        D = function (c, b, a) {
          return function () {
            c.apply(b, a)
          }
        }
      x.init = function (c) {
        var a = c.getAttr('ajax')
        if (a && a.params) {
          var k = a.params
          if ((a = c.getAttr('fetchedItems')) && a.length !== k.start) {
            var f = 0
            a.forEach(function (c) {
              c && f++
            })
            var l = []
            c.dom.$carousel.children('li').each(function (c, a) {
              if (c >= k.start) return !1
              l.push(b.trim(a.innerHTML))
            })
            f !== l.length && ((k.offset = l.length), c.setAttr('fetchedItems', l))
          }
        }
        t.init(c)
      }
      x.getItems = function (c, a, k, f) {
        var l = !1,
          e = c.getAttr('name')
        b.each(u, function (c, a) {
          a !== e && (l = l || c)
        })
        c = D(q, this, [c, a, k, f])
        ;(a = m[e] !== v) && l ? y.push(c) : (a && (u[e] = !0), c())
      }
      x.want = function (c, a, b) {
        var f = Math.ceil(10 * z)
        b = Math.max(b, c.getAttr('pageSize') * f)
        b = Math.min(b, 30)
        if (!c.getAttr('ajaxLock')) {
          if ((f = c.getAttr('requestTimer'))) clearTimeout(f), c.setAttr('requestTimer', null)
          var f = c.getAttr('ajax'),
            e = c.getAttr('set_size')
          if (f.url) {
            var d = c.getAttr('fetchedItems'),
              h = f.id_list
            h || (h = [])
            var p = -1 < a ? a : 0
            a = a + b - 1
            var m = f.params || {},
              g = f.headers || {},
              u = [],
              q = []
            0 === e && (h.length && (e = h), (m.needSetSize = 'true'), c.setAttr('ajaxLock', !0))
            for (-1 === b && e && (a = e); p <= a; )
              d[p] || ((b = h[p]) && u.push(b), q.push(p)), p++
            c.setAttr('fetchedItems', d, { silent: !0 })
            m.count = q.length
            m.offset = q[0] || 0
            0 < u.length && (m[f.id_param_name] = u.join(','))
            ;(0 < q.length || m.needSetSize) && this.getItems(c, f.url, m, g)
          }
        }
      }
      n.registerStrategy('ajax', 'clicksCustomAjax', x)
      return {
        registerFeedbackEvents: function (c, a, e, f, l) {
          var d = !0,
            h = function () {
              b.$('#' + a).text(f)
              d = !1
              b.$('.' + l).each(function () {
                b.$(this).show()
              })
            },
            m = function () {
              b.$('#' + a).text(e)
              d = !0
              b.$('.' + l).each(function () {
                b.$(this).hide()
              })
            }
          b.$('#' + a).click(function () {
            d ? h() : m()
          })
          b.on('a:carousel:' + c + ':change:pageNumber', m)
          m()
        },
        registerFeedbackEventsWithSponsoredLabel: function (a, e, k, f) {
          var d = !0,
            h = function () {
              b.$('#' + k).show()
              d = !1
              b.$('.' + f).each(function () {
                b.$(this).show()
              })
            },
            m = function () {
              b.$('#' + k).hide()
              d = !0
              b.$('.' + f).each(function () {
                b.$(this).hide()
              })
            }
          b.$('#' + e).click(function () {
            d ? h() : m()
          })
          b.on('a:carousel:' + a + ':change:pageNumber', m)
          m()
        },
        truncateTitles: function (a) {
          b.$('.' + a).each(function () {
            var e = b.$(this)
            if ('hidden' === e.css('overflow')) {
              var d = e.html(),
                f = b
                  .$(this.cloneNode(!0))
                  .hide()
                  .css('position', 'absolute')
                  .css('overflow', 'visible')
                  .width(e.width())
                  .height('auto')
              e.after(f)
              for (f.html(d); 0 < d.length && f.height() > e.height(); )
                (d = d.substr(0, d.length - 1)), f.html(d + '\x26#133;')
              e.html(f.html()).height('auto').removeClass(a)
              f.remove()
            }
          })
        },
        preventSpinners: function (a, e) {
          A[a] === v &&
            (b.on('a:carousel:' + a + ':ajaxSuccess', function (a) {
              b.delay(function () {
                var c = b.$('#' + e + ' li.a-carousel-card-empty')
                0 < c.length &&
                  (a.carousel.setAttr('set_size', c[0].getAttribute('aria-posinset') - 1),
                  c.removeClass('a-carousel-card-empty'))
              }, 200)
            }),
            (A[a] = 'defined'))
        },
        registerCarouselToSaveAsins: function (a, d, k) {
          h(a)
          e(k, a)
          u[a] = !1
          m[a] === v &&
            (b.on('a:carousel:' + a + ':ajaxSuccess', function (d) {
              var h = d.carousel.getAttr('fetchedItems').slice(-1 * d.params.count),
                m = []
              b.each(h, function (a) {
                m.push(a.oid)
              })
              e(m, a)
              u[d.carousel.getAttr('name')] = !1
              0 < y.length && y.shift()()
            }),
            (m[a] = d))
        },
      }
    },
  )
  ;(function (b, n, t) {
    function q() {
      return b.P && b.P.AUI_BUILD_DATE
    }
    q()
      ? (g.when('jQuery').register('sponsored-products-truncator-jQuery', function (b) {
          return b
        }),
        g.when('ready').register('sponsored-products-truncator-ready', function () {}))
      : b.amznJQ &&
        (b.amznJQ.available('jQuery', function () {
          g.register('sponsored-products-truncator-jQuery', function () {
            return b.amznJQ.jQuery
          })
        }),
        b.amznJQ.onReady('jQuery', function () {
          g.register('sponsored-products-truncator-ready', function () {})
        }),
        b.amznJQ.available('amazonShoveler', function () {
          g.register('sponsored-products-truncator-amznJQ-shoveler', function () {})
        }))
    g.register('sponsored-products-truncator-util', function () {
      function d(b, d) {
        g({
          logLevel: b,
          attribution: 'ProductAdsDetailPageAssets',
          message: '[sponsored-products-truncator] ' + d,
        })
      }
      var g = b.ueLogError
      'function' !== typeof g &&
        (g = function (b, d) {
          if (d && d.message) throw Error(d.message)
          if (b && b.message) throw Error(b.message)
        })
      return {
        constants: { FEATURE_NAME: 'SponsoredProductsTitleTruncation' },
        count: (b.ue && b.ue.count) || function () {},
        isAUI: q,
        log: {
          warn: function (b) {
            d('WARN', b)
          },
          error: function (b) {
            d('ERROR', b)
          },
        },
      }
    })
  })(n, document)
  ;(function (b, n, t) {
    g.when(
      'A',
      'sponsored-products-truncator-jQuery',
      'sponsored-products-truncator-util',
    ).register('sponsored-products-truncator-line-truncator', function (b, d, g) {
      function e(a) {
        this.$element = a
        this.$experimentElement = d('\x3cdiv\x3e').addClass(
          'sponsored-products-truncator-offscreen-truncate',
        )
        this.maxRows = a.attr('data-rows')
        this.text = a.attr('data-fulltext') ? a.attr('data-fulltext') : this.$element.html()
        this.lineHeight = this.getLineHeight()
        this.maxRows || g.log.error('Truncation element missing necessary line number data')
      }
      var h, n
      h =
        /(?=[ \-\/])|(?=[\u3105-\u312F])|(?=[\u31A0-\u31BA])|(?=[\u4E00-\u9FD5])|(?=[\u3400-\u4DB5])|(?=[\uF900-\uFAFF])|(?=[\u3040-\u309F])|(?=[\u30A0-\u30FF])|(?=[\u3190-\u319F])/
      n = /[^\/\-\[\]():\s]/
      e.prototype.truncate = function () {
        var a = this.text,
          b,
          a = d.trim(a)
        this.$element.append(this.$experimentElement)
        this.checkLineFit(a)
          ? this.text !== this.$element.html() && this.$element.html(a)
          : (b = this.truncateByToken(a))
            ? (this.$element.html(b), this.$element.attr({ title: a }))
            : g.log.error('Unable to successfully truncate line ' + a)
        this.$experimentElement.remove()
      }
      e.prototype.getLineHeight = function () {
        var a = this.$element.html(),
          b
        this.$element.html('\x26hellip;')
        b = this.$element.innerHeight()
        this.$element.html(a)
        return b
      }
      e.prototype.checkLineFit = function (a) {
        this.$experimentElement.html(a)
        a = this.$experimentElement.get(0).clientHeight / this.lineHeight
        return Math.round(a) <= this.maxRows
      }
      e.prototype.truncateByToken = function (a) {
        a = a.split(this.getTokenSeparatorRegex())
        var b = a.length,
          d = 0,
          e,
          h,
          g
        for (g = 1; g !== b; )
          if (
            ((e = Math.floor((b + g) / 2)),
            (h = a.slice(0, e).join('') + '\x26hellip;'),
            this.checkLineFit(h))
          ) {
            if (1 >= b - e) {
              for (d = e; 0 < d && !n.test(a[d - 1]); ) d--
              break
            }
            g = e
          } else b = e
        if (0 !== d) return a.slice(0, d).join('') + '\x26hellip;'
      }
      e.prototype.getTokenSeparatorRegex = function () {
        return this.$element.attr('data-truncate-by-character') ? '' : h
      }
      return {
        truncateLines: function (a) {
          a.find(
            '.sponsored-products-truncator-truncate:visible, .sponsored-products-truncator-truncate-medium:visible',
          ).each(function () {
            new e(d(this)).truncate()
            d(this)
              .addClass('sponsored-products-truncator-truncated')
              .removeClass(
                'sponsored-products-truncator-truncate sponsored-products-truncator-truncate-medium',
              )
            d(this).removeClass(function (a, b) {
              return (b.match(/sponsored-products-truncator-line-clamp-\d/g) || []).join(' ')
            })
          })
          b.trigger('sponsored-products-truncator:linestruncated')
        },
      }
    })
    g.when(
      'jQuery',
      'A',
      'sponsored-products-truncator-line-truncator',
      'a-carousel-framework',
    ).register('sp-dp-carousel-truncation', function (b, d, g, e) {
      function h(a) {
        'string' === typeof a
          ? (g.truncateLines(d.$('#' + a)),
            e.getCarouselByName(a + '_carousel') &&
              d.trigger('spTruncationComplete', e.getCarouselByName(a + '_carousel')))
          : (g.truncateLines(a.carousel.dom.$container),
            d.trigger('spTruncationComplete', a.carousel))
      }
      var n =
        'sp_detail sp_detail2 sp_detail_thematic sp_phone_detail sp_phone_detail2 sp_phoneapp_detail sp_phoneapp_detail2 sp_phone_detail_thematic sp_phoneapp_detail_thematic'.split(
          ' ',
        )
      d.on('spCarouselNoTruncationRegistration', function () {
        var a = d.state('spTruncatorStatus')
        if (!a || !a.truncationInitialized) {
          for (a = n.length - 1; 0 <= a; a--)
            h(n[a]),
              d.on('a:carousel:' + n[a] + '_carousel:change:animating', h),
              d.on('a:carousel:' + n[a] + '_carousel:change:loading', h),
              d.on('a:carousel:' + n[a] + '_carousel:change:pageSize', h)
          d.state('spTruncatorStatus', { truncationInitialized: !0 })
        }
      })
      d.on('spMobileCarouselAjaxComplete', h)
      return {
        setUpTruncation: function (a) {
          h(a)
          d.on('a:carousel:' + a + '_carousel:change:animating', h)
          d.on('a:carousel:' + a + '_carousel:change:loading', h)
          d.on('a:carousel:' + a + '_carousel:change:pageSize', h)
        },
      }
    })
  })(n, document)
  g.execute('ClickLoggingUrlParamRemover', function () {
    if (history && history.replaceState) {
      var b = n.location.href,
        b = b.split('?')
      if (2 <= b.length) {
        for (
          var g = encodeURIComponent('spc') + '\x3d', t = b[1].split(/[&;]/g), q = t.length;
          0 < q--;

        )
          -1 !== t[q].lastIndexOf(g, 0) && t.splice(q, 1)
        b = b[0] + (0 < t.length ? '?' + t.join('\x26') : '')
        n.history.replaceState({}, document.title, b)
      }
    }
  })
})
/* ******** */
;(function (d) {
  var f = window.AmazonUIPageJS || window.P,
    r = f._namespace || f.attributeErrors,
    b = r ? r('SponsoredProductsViewabilityAssets', '') : f
  b.guardFatal
    ? b.guardFatal(d)(b, window)
    : b.execute(function () {
        d(b, window)
      })
})(function (d, f, r) {
  d.when('A', 'SponsoredProductsEventBatcher', 'SPHAT').register(
    'SponsoredProductsViewability',
    function (b, l, h) {
      function k(c, a) {
        c = 'SPView-' + a + '-' + c
        f.ue && f.ue.count(c, (f.ue.count(c) || 0) + 1)
      }
      function n(c) {
        return {
          qualifier: a('qualifier', c),
          id: a('id', c),
          widgetName: a('widgetName', c),
          adId: a('adId', c),
          adIndex: a('adIndex', c),
          eventType: a('eventType', c),
        }
      }
      function a(c, a) {
        return (c = new RegExp('[?\x26]' + c + '(\x3d([^\x26#]*)|\x26|#|$)').exec(a)) && c[2]
          ? decodeURIComponent(c[2].replace(/\+/g, ' '))
          : ''
      }
      function e(c) {
        g[c.selector].viewHandler = b.delay(function () {
          if (c) {
            var a = c.data('viewpixelurl')
            a &&
              -1 === d.indexOf(a) &&
              (l.sendRequest(n(a + '\x26eventType\x3d1')),
              d.push(a),
              g[c.selector] &&
                ((g[c.selector].viewState = 'VIEWED'),
                k('viewUrlSuccess', g[c.selector].placementId)),
              p())
          }
        }, 500)
      }
      function p() {
        for (var c in g)
          if ('VIEWED' === g[c].viewState) delete g[c]
          else {
            var a = b.$(c),
              m = g[a.selector].viewState
            'VIEWED' !== m &&
              (b.onScreen(a, -0.15 * a.height())
                ? 'OFF' === m && ((g[a.selector].viewState = 'ON'), e(a))
                : 'ON' === m &&
                  ((g[a.selector].viewState = 'OFF'), clearTimeout(g[a.selector].viewHandler)))
          }
      }
      var g = {},
        d = [],
        q = [],
        m = []
      b.on('spViewTrackingElementLoaded', p)
      return {
        registerViewTrackingElement: function (a, e) {
          ;-1 === d.indexOf(a.data('viewpixelurl')) &&
            (k('totalAds', e),
            (g[a.selector] = { viewState: 'OFF', viewHandler: null, placementId: e }),
            b.trigger('spViewTrackingElementLoaded'))
        },
        registerAuiEvents: function (a) {
          Array.isArray(a) &&
            a.forEach(function (a) {
              if (-1 === m.indexOf(a)) b.on(a, p)
            })
        },
        loadImagePixel: function (a, b, e, m) {
          !h.checkForHiddenElementsWithTargetList(b, e, m) &&
            Array.isArray(q) &&
            -1 === q.indexOf(a) &&
            (q.push(a), l.sendRequest(n(a)))
        },
      }
    },
  )
  d.when('A', 'SponsoredProductsViewabilityConfig').register(
    'SponsoredProductsEventBatcher',
    function (b, l) {
      function h(a, c) {
        a || ((q += 1), (g += c))
        p += c
        t += 1
        k('avgRequestFailurePerPage', q / t)
        k('avgEventFailurePerPage', g / p)
      }
      function k(a, c) {
        f.ue && f.ue.count('SPBatch-' + a, c)
      }
      function n(a) {
        var c = []
        b.each(a, function (a) {
          c.push({ data: a })
        })
        return { events: c }
      }
      function a() {
        if (0 < e.length) {
          var a = e.length,
            c = n(e)
          e = []
          var g =
            /unagi-\w\w.amazon.com\/1\/events\/com.amazon.eel.SponsoredProductsEventTracking.(prod|gamma)/
          l.eelEndpoint !== r && g.test(l.eelEndpoint)
            ? b.ajax(l.eelEndpoint, {
                method: 'post',
                params: c,
                paramsFormat: 'json',
                contentType: 'application/json',
                accepts: 'application/json',
                success: function (c, b, e) {
                  h(!0, a)
                  k('batchSuccess', a)
                },
                error: function (c, b, e) {
                  d.log(
                    'Warning -- sushi response: ' +
                      e +
                      ' | StatusText: ' +
                      b +
                      ' | xhrStatusCode: ' +
                      (c.http ? c.http.status : 'could not get xhr status code. ') +
                      ' | url: ' +
                      l.eelEndpoint,
                    'WARN',
                    'SponsoredProductsViewabilityAssets',
                  )
                  h(!1, a)
                  k('batchError', a)
                },
              })
            : (h(!1, a),
              k('batchError', a),
              d.log(
                'Warning -- sushi endpoint incorrectly configured with: ' + l.eelEndpoint,
                'WARN',
                'SponsoredProductsViewabilityAssets',
              ))
        }
      }
      var e = [],
        p = 0,
        g = 0,
        t = 0,
        q = 0
      b.interval(function () {
        a()
      }, 250)
      f.addEventListener('beforeunload', function () {
        a()
      })
      return {
        sendRequest: function (b) {
          e.push(b)
          15 < e.length && a()
        },
        _batchRequest: function () {
          a()
        },
      }
    },
  )
  d.when('A', 'SponsoredProductsEventBatcher').register('SPHAT', function (b, d) {
    function h(a, b) {
      a && f.ue && f.ue.count && f.ue.count(a, (f.ue.count(a) || 0) + b ? 1 : 0)
    }
    function k(a, e) {
      return a && e
        ? 0 <
            b
              .$(a)
              .find(e.join(','))
              .filter(function () {
                return (
                  'hidden' === b.$(this).css('visibility') ||
                  '0' === b.$(this).css('opacity') ||
                  b.$(this).is(':hidden')
                )
              }).length
        : !1
    }
    function n(a, e) {
      var d = ':hidden'
      b.$.each(e, function (a, b) {
        d += ':not(' + b + ')'
      })
      return 0 < b.$(a).children(d).length
    }
    return {
      checkForHiddenElementsWithTargetList: function (a, b, d) {
        a = k(a, b)
        h(d, a)
        return a
      },
      checkForHiddenElements: function (a, b, d) {
        a = n(a, b)
        h(d, a)
        return a
      },
    }
  })
  d.when('A', 'ready').register('SponsoredProductsViewabilityConfigInitializer', function (b) {
    function f(b) {
      d.register('SponsoredProductsViewabilityConfig', function () {
        return {
          eelEndpoint: b,
          updateEelEndpoint: function (a) {
            this.eelEndpoint = a
          },
        }
      })
    }
    var h = b.state('SpViewabilityConfigState'),
      k = !1
    'undefined' !== typeof h &&
      null !== h &&
      'undefined' !== typeof h.eelEndpoint &&
      null !== h.eelEndpoint &&
      ((k = !0), f(h.eelEndpoint))
    b.state.bind('SpViewabilityConfigState', function (b, a) {
      a.eelEndpoint &&
        'undefined' !== typeof b.eelEndpoint &&
        null !== b.eelEndpoint &&
        (k
          ? d.when('SponsoredProductsViewabilityConfig').execute(function (a) {
              a.updateEelEndpoint(b.eelEndpoint)
            })
          : ((k = !0), f(b.eelEndpoint)))
    })
  })
})
/* ******** */
;(function (b) {
  var e = window.AmazonUIPageJS || window.P,
    g = e._namespace || e.attributeErrors,
    d = g ? g('SponsoredProductsAddToCartAssets', '') : e
  d.guardFatal
    ? d.guardFatal(b)(d, window)
    : d.execute(function () {
        b(d, window)
      })
})(function (b, e, g) {
  b.when('A').register('sp-atc-config', function () {
    return {
      getClientID: function () {
        return 'sspa-dp-desktop'
      },
    }
  })
  ;('use strict')
  b.when('sp-atc-config', 'fresh-add-to-cart', 'A').execute(function (d, b, k) {
    var h = {},
      f = function (a, c) {
        var b = k.capabilities.mobile ? 'mobile' : 'desktop'
        a = 'spF3Atc.' + b + '.' + a + '.' + c
        e.ue && e.ue.count(a, (ue.count(a) || 0) + 1)
      },
      l = function (a) {
        var c = a && a.additionalParams ? a.additionalParams.loggingUrl : g
        c && !h[c]
          ? k.post(c, {
              success: function (a) {
                h[c] = !0
                f('logClick', 'success')
              },
              error: function (a, c, b) {
                f('logClick', 'failure')
              },
            })
          : h[c]
            ? f('logClick', 'duplicate')
            : c || f('logClick', 'missingData')
      }
    b.addToFreshCart({
      clientID: d.getClientID(),
      success: function (a, c) {
        l(a.data)
        f('addToCart', 'success')
      },
      error: function (a, c, b, d) {
        f('addToCart', 'failure')
      },
    })
  })
})
/* ******** */
;(function (d) {
  var c = window.AmazonUIPageJS || window.P,
    a = c._namespace || c.attributeErrors,
    b = a ? a('DetailPageOffersMulticlickAssets', '') : c
  b.guardFatal
    ? b.guardFatal(d)(b, window)
    : b.execute(function () {
        d(b, window)
      })
})(function (d, c, a) {
  d.when('A', 'preventMulticlick:forceFormSubmit', 'atf').execute(function (b, d) {
    function e(b) {
      c.ue && c.ue.count && c.ue.count(b, 1)
    }
    var f = !1,
      a = function (c) {
        var a = b.$(document)
        a &&
          a.delegate(c, 'click', function () {
            var a = b.$(c)
            if (!a || 'submit' !== a.prop('type')) return !0
            if (f) return e('oneClickDisableOneClickButton'), a.attr('disabled', !0), !1
            e('oneClickTriggerOneClickFormSubmit')
            d(a)
            f = !0
            setTimeout(function () {
              e('oneClickEnableOneClickButtonAfterTimeout')
              f = !1
              a.attr('disabled', !1)
            }, 3e4)
            return !0
          })
      }
    b.on('mash:willReappear', function () {
      e('oneClickEnableOneClickButtonOnMashReappear')
      f = !1
    })
    a('#one-click-button')
    a('#oneClickBuyButton')
    a('#prime-toggle-main')
    e('oneClickPreventMultiClickModuleCalled')
  })
  ;('use strict')
  d.when('A', 'atf').register('preventMulticlick:forceFormSubmit', function (a) {
    return function (a) {}
  })
})
/* ******** */
;(function (m) {
  var p = window.AmazonUIPageJS || window.P,
    q = p._namespace || p.attributeErrors,
    a = q ? q('DetailPageDesktopOffersAssets', '') : p
  a.guardFatal
    ? a.guardFatal(m)(a, window)
    : a.execute(function () {
        m(a, window)
      })
})(function (m, p, q) {
  m.when('A').register('add-to-form', function (a) {
    return {
      addInputToForm: function (a, d, k, b) {
        var e = document.createElement('input')
        e.id = a
        e.type = 'hidden'
        e.name = k
        e.value = b
        d.appendChild(e)
      },
    }
  })
  ;('use strict')
  m.when(
    'A',
    'add-to-cart-parameter-name',
    'add-to-cart-constants',
    'add-to-form',
    'afterLoad',
  ).execute('giftOptions-autoUpdate', function (a, f, d, k) {
    var b = a.$
    b("input[type\x3d'checkbox'][id\x3d'gift-wrap']").each(function () {
      if (b(this).is(':checked')) {
        var a = f.constructParameterName(d.ITEM_TYPES.BASE, 0, d.PARAMETER_PATHS.GIFTOPTIONS),
          g = b(this).get(0).form
        g && k.addInputToForm('giftCheckBoxInput', g, a, 'true')
      }
    })
  })
  ;('use strict')
  m.when('A', 'add-to-cart-parameter-name', 'add-to-cart-constants', 'add-to-form').execute(
    'giftOptions-update',
    function (a, f, d, k) {
      function b() {
        e("input[type\x3d'checkbox'][id\x3d'gift-wrap']").each(function () {
          e(this).change(function () {
            if (e(this).is(':checked')) {
              var a = f.constructParameterName(d.ITEM_TYPES.BASE, 0, d.PARAMETER_PATHS.GIFTOPTIONS),
                b = e(this).get(0).form
              b && k.addInputToForm('giftCheckBoxInput', b, a, 'true')
            } else (a = e('[id\x3d"giftCheckBoxInput"]')) && a.remove()
          })
        })
      }
      var e = a.$
      b()
      a.on('a:pageUpdate', function () {
        b()
      })
    },
  )
  ;('use strict')
  m.when(
    'A',
    'add-to-cart-parameter-name',
    'add-to-cart-constants',
    'dp-get-offerDisplay-container',
  ).execute('quantity-update', function (a, f, d, k) {
    function b(c) {
      if (c && c.value !== q && c.nativeItemNode && c.nativeItemNode.form !== q) {
        var a = g(c.nativeItemNode.form)
        a && (a = a.find(h)) && a.val(c.value)
        a = k.getOfferDisplayContainerByElement(g(c.nativeItemNode))
        e(a, 'form#addToCart', l, c.value)
        e(a, 'form#buyNow', 'quantity', c.value)
      }
    }
    function e(a, b, d, e) {
      0 < a.length &&
        b &&
        ((a = a.find(b + " input[name\x3d'" + d + "']")), 0 < a.length && a.val(e))
    }
    var g = a.$,
      l = f.constructParameterName(d.ITEM_TYPES.BASE, 0, d.PARAMETER_PATHS.QUANTITY),
      h = 'input[name\x3d"' + l + '"]'
    a.on('addToCartQuantityChange', b)
    a.on('a:dropdown:quantity:select', b)
  })
  ;('use strict')
  m.when('jQuery', 'a-popover', 'A', 'a-dropdown', 'moq-core', 'ready').register(
    'moq',
    function (a, f, d, k, b) {
      function e(n, c) {
        0 === k.getSelect(c).val().length
          ? b.lockSubmission(n, a.noop, u)
          : b.unlockSubmission(n, m)
      }
      function g(n) {
        n = b.findMoqOfferContainerWithDomElement(n.nativeItemNode)
        if (null !== n) {
          var a = n.find('#quantity, #rcxsubsQuan')
          e(n, a)
          b.tweakDisplayTextForMoqQuantityDropdown(a)
        }
      }
      function l(n) {
        return b
          .findMoqOfferContainerWithDomElement(n.popover.$trigger[0])
          .find('#quantity, #rcxsubsQuan')
      }
      function h() {
        t ||
          (d.on('a:popover:beforeShow:moqAtcPopover', function (n) {
            var a = l(n)
            0 !== a.length &&
              (q(a),
              setTimeout(function () {
                a.addClass('highlightQuantityDropdownBorder')
              }, 20))
          }),
          d.on('a:popover:afterHide:moqAtcPopover', function (a) {
            a = l(a)
            0 !== a.length && (a.removeClass('highlightQuantityDropdownBorder'), p(a))
          }),
          d.on('a:popover:beforeShow:MOQPreLoadPopOver', function (a) {
            a = l(a)
            0 !== a.length && q(a)
          }),
          d.on('a:popover:afterHide:MOQPreLoadPopOver', function (a) {
            a = l(a)
            0 !== a.length && p(a)
          }),
          d.on('a:dropdown:rcxsubsQuan:select', g),
          d.on('a:dropdown:quantity:select', g),
          (t = !0))
      }
      function c(a) {
        var c = a.parent().parent('div').innerWidth() - a.prev('label').outerWidth() - 5
        100 < c && a.width(c)
      }
      function u(a) {
        if (null === f.get(a)) {
          var c = b.findMoqOfferContainerWithDomElement(a[0]).find('script#moqPopoverContent')
          0 !== c.length &&
            ((c = c.html()),
            a.addClass('cursorDisabled'),
            f.create(a, {
              name: 'moqAtcPopover',
              position: 'triggerLeft',
              closeButton: 'false',
              inlineContent: c,
            }))
        }
      }
      function m(a) {
        null !== f.get(a) && (a.removeClass('cursorDisabled'), f.remove(a))
      }
      function p(a) {
        setTimeout(function () {
          r--
          0 < r || (a.prop('disabled', !1), a.removeClass('quantityBarGrayOut'))
        }, 370)
      }
      function q(a) {
        r++
        0 === k.getSelect(a).val().length &&
          (a.prop('disabled', !0), a.addClass('quantityBarGrayOut'))
      }
      function v(a) {
        var b = a.find('#quantity, #rcxsubsQuan')
        0 === b.length ||
          b.hasClass('aok-hidden') ||
          (k.getSelect(b).setValue(''), c(b), w(a), e(a, b))
      }
      function w(a) {
        if (0 !== a.length) {
          var b = a.find('#quantity, #rcxsubsQuan')
          a.click(function () {
            setTimeout(function () {
              c(b)
            }, 20)
          })
        }
      }
      var t = !1,
        r = 0
      return {
        initializeQuantitySelect: function () {
          var a = b.findMoqOfferContainers()
          0 !== a.length && (a.forEach(v), h())
        },
      }
    },
  )
  ;('use strict')
  m.when('dp-click-counter').execute('dp-desktop-atc-click-counter', function (a) {
    var f = document.getElementById('add-to-cart-button')
    f && a.record(f, 'dp-desktop-atc')
  })
  ;('use strict')
  m.when('A', 'ready').execute(function (a) {
    function f() {
      for (var c = a.$('.offersConsistencyEnabled'), b = [], d = 0; d < c.length; d++)
        'undefined' != typeof c[d] && null != c[d] && b.push(c[d].children)
      return b
    }
    function d(c) {
      c.length && ((e = a.$('#buybox .a-accordion-active')), e.length && (g = e.index()))
      g = k(g)
    }
    function k(c) {
      var b = a.$('#offerDisplayGroupTabSet #tab_heading_desktop_buybox_group_2')
      b.length && 0 === b.index() && (c += 1)
      return c
    }
    function b() {
      var c = a.$('#offerDisplayGroupTabSet #tab_heading_desktop_buybox_group_2')
      c.length &&
        h.length &&
        ((c = c.index()), h[0].length && (0 === c ? (l = 0) : (l = h[0].length - 1)))
    }
    var e,
      g = 0,
      l = 0,
      h = f()
    d(h)
    b()
    a.on('a:pageUpdate', function () {
      h = f()
      d(h)
      b()
    })
    a.on('a:accordion:buybox-accordion:select', function (c) {
      c = a.$(c.selectedRow.$row).index()
      c = k(c)
      for (var b = 0; b < h.length; b++)
        (h[b][g].style.display = 'none'), (h[b][c].style.display = 'block')
      g = c
    })
    a.on('a:tabs:offerDisplayGroup_tabs:select', function (b) {
      b = a.$(b.selectedTab.$tab).index()
      for (var c = 0; c < h.length; c++)
        (h[c][0 === l ? l : g].style.display = 0 === b ? 'block' : 'none'),
          (h[c][0 === l ? g : l].style.display = 0 === b ? 'none' : 'block')
    })
  })
  m.when('A', 'ready').execute('quantity-selector-metrics', function (a) {
    function f(a) {
      p.ue && p.ue.count(a, (ue.count(a) || 0) + 1)
    }
    a.on('a:dropdown:select', function (a) {
      try {
        var d = a.name,
          b = a.value
        if ('quantity' === d || 'rcxsubsQuan' === d)
          f('desktop:quantitySelected_' + b), 1 < b && f('desktop:quantitySelected:moreThanOne')
      } catch (e) {
        f('desktop:quantitySelected:error')
      }
    })
  })
})
/* ******** */
;(function (f) {
  var h = window.AmazonUIPageJS || window.P,
    n = h._namespace || h.attributeErrors,
    b = n ? n('GoldboxUDPAssets', '') : h
  b.guardFatal
    ? b.guardFatal(f)(b, window)
    : b.execute(function () {
        f(b, window)
      })
})(function (f, h, n) {
  f.when('A').execute('dealsx-constants', function (b) {
    h.DealsX || (h.DealsX = {})
    DealsX.constants = {
      AAPI_V1_QUANTITY_RESTRICTION_VIOLATION_ERROR:
        'deal.claim.quantity-restriction-violation.error/v1',
      AAPI_V1_ERROR_TYPE: 'error/v1',
    }
    DealsX.CustomerStates = {
      NONE: 'NONE',
      IN_CART: 'IN_CART',
      PENDING_ADD_TO_CART: 'PENDING_ADD_TO_CART',
      CLAIMED: 'CLAIMED',
      EXPIRED: 'EXPIRED',
      UNKNOWN: 'UNKNOWN',
    }
    DealsX.DealStates = {
      AVAILABLE: 'AVAILABLE',
      UPCOMING: 'UPCOMING',
      WAITLISTFULL: 'WAITLISTFULL',
      UNKNOWN: 'UNKNOWN',
    }
    DealsX.Events = { DEAL_TIMER_EXPIRED: 'dealsx:gsod:buybox:deal-timer-expired' }
    DealsX.ApiNames = {
      CLAIM_AND_ADD_TO_CART: 'ClaimAndAddToCart',
      CART_COUNT: 'CartCount',
      CART_ADD_ITEMS: 'CartAddToCart',
    }
    DealsX.RenderingPlatform = {
      MOBILE_WEB: 'MOBILE_WEB',
      SHOPPING_APP: 'SHOPPING_APP',
      DESKTOP: 'DESKTOP',
    }
    DealsX.AppAccessRenderingComponent = {
      APP_DOWNLOAD_BUTTON: 'APP_DOWNLOAD_BUTTON',
      LEARN_MORE_MESSAGE: 'LEARN_MORE_MESSAGE',
      NOTHING: 'NOTHING',
    }
    DealsX.DeviceAttributes = {
      SHOPPING_APP: 'APP,APP_MASH',
      MOBILE_WEB: 'MOBILE',
      DESKTOP: 'DESKTOP',
    }
  })
  f.when('A').execute('dealsx-timer-ticker', function (b) {
    b.interval(function () {
      b.trigger('dealsx-timer-tick')
    }, 1e3)
  })
  f.when('A').register('dealsx-productv2-service', function (b) {
    return b.createClass({
      endpointUrl: null,
      offerListingID: null,
      headers: null,
      _request: null,
      setup: function (b) {
        this.abortRequest()
        this.endpointUrl = b.aapiEndpoint
        this.offerListingId = b.offerListingId
        this.headers = this.getHeaders(b)
      },
      callProductV2: function (c, a, d) {
        var e = this
        e._request = b.$.ajax({
          url:
            this.endpointUrl +
            '?buyingOptionTypes\x3dLIGHTNING_DEAL\x26offerListingId\x3d' +
            this.offerListingId,
          type: 'GET',
          headers: this.headers,
          xhrFields: { withCredentials: !0 },
          success: c,
          error: a,
          complete: function () {
            e._request = null
            d && d()
          },
        })
      },
      abortRequest: function () {
        this._request && this._request.abort()
      },
      getDeviceAttributes: function (b) {
        return b.app
          ? DealsX.DeviceAttributes.SHOPPING_APP
          : b.mobile
            ? DealsX.DeviceAttributes.MOBILE_WEB
            : DealsX.DeviceAttributes.DESKTOP
      },
      getHeaders: function (b) {
        var a = {
          'Accept-Language': b.languageOfPreference,
          Accept:
            'application/vnd.com.amazon.api+json; type\x3d"product/v2"; expand\x3d"buyingOptions[].dealDetails(product.deal-details/v1),buyingOptions[].callToAction(product.call-to-action/v1),buyingOptions[].dealCustomerStatus(product.deal-customer-status/v1)"',
          'x-api-csrf-token': b.aapiCsrfToken,
          'x-amzn-device-attributes': this.getDeviceAttributes(b),
        }
        b.slateToken && (a['x-amzn-encrypted-slate-token'] = b.slateToken)
        return a
      },
    })
  })
  f.when('A', 'dealsx-productv2-service').register('dealsx-poller-service', function (b, c) {
    return b.createClass({
      statusCallbackHandler: null,
      productV2Service: null,
      pollingIntervalMs: null,
      continuePolling: !0,
      init: function () {
        this.productV2Service = new c()
      },
      setup: function (a) {
        this.productV2Service.setup(a)
        this.pollingIntervalMs = a.pollingIntervalMs
        this.continuePolling = !0
      },
      callProductV2: function (a, b) {
        var d = this
        d.productV2Service.callProductV2(function (b) {
          d.provideBuyingOptionToSuccessCallback(b, a)
        }, b)
      },
      connect: function (a, d, e) {
        var g = this,
          c = function () {
            g.productV2Service.callProductV2(
              function (b) {
                g.provideBuyingOptionToSuccessCallback(b, a)
              },
              function (a) {
                d && d(a)
              },
              function () {
                e && e()
                g.continuePolling && (g.statusCallbackHandler = b.delay(c, g.pollingIntervalMs))
              },
            )
          }
        c()
      },
      disconnect: function () {
        this.continuePolling = !1
        null !== this.statusCallbackHandler &&
          (clearTimeout(this.statusCallbackHandler), (this.statusCallbackHandler = null))
      },
      provideBuyingOptionToSuccessCallback: function (a, b) {
        a = this.extractLightningDealBuyingOption(a)
        b && b(a)
      },
      extractLightningDealBuyingOption: function (a) {
        if (a && a.entity && a.entity.buyingOptions)
          for (var b = 0; b < a.entity.buyingOptions.length; b++) {
            var e = a.entity.buyingOptions[b]
            if ('LIGHTNING_DEAL' === e.type) return e
          }
        return null
      },
    })
  })
  f.when(
    'A',
    'dealsx-model',
    'dealsx-deal-redemption-service',
    'dealsx-redemption-view',
    'dealsx-quantity-view',
    'dealsx-progress-view',
    'dealsx-timer-view',
    'dealsx-header-view',
    'dealsx-prime-access-view',
    'dealsx-app-access-view',
    'dealsx-cart-aapi-service',
    'dealsx-warranty-view',
  ).register('dealsx-deal-controller', function (b, c, a, d, e, g, m, k, l, h, p, q) {
    return b.createClass({
      dealPollerController: null,
      dealRedemptionService: null,
      views: [],
      headerView: null,
      redemptionView: null,
      quantityView: null,
      timerView: null,
      primeAccessView: null,
      appAccessView: null,
      warrantyView: null,
      dealModel: null,
      buying: !1,
      cartAAPIService: null,
      init: function (a) {},
      getSlateToken: function () {
        var a = b.$('meta[name\x3d"encrypted-slate-token"]')
        if (a.length && a.attr('content')) return a.attr('content')
        DealsX.recordAPIMetrics({ apiName: 'getSlateToken', isSuccess: !1 })
      },
      setup: function (b) {
        if (b) {
          b.slateToken = this.getSlateToken()
          var d = b.systemTime ? Date.now() - b.systemTime : 0
          this.dealModel = new c({ setupData: b, clockOffset: d })
          this.setupDealPollerController(b)
          this.dealRedemptionService = new a(b)
          this.cartAAPIService = new p(b)
          this.setupBuyboxViews(b)
          this.onModelUpdate(this.dealModel)
          this.subscribeToAccordionEvents()
        } else
          f.log(
            'No setupData passed for setup method of deal controller',
            'ERROR',
            'DealController',
          )
      },
      setupDealPollerController: function (a) {
        var d = this
        f.when('dealsx-poller-service').execute(function (e) {
          d.dealPollerController
            ? d.dealPollerController.disconnect()
            : (d.dealPollerController = new e())
          d.dealPollerController.setup(a)
          d.dealPollerController.connect(function (a) {
            a
              ? (d.dealModel.updateDealModelContent(a), d.onModelUpdate(d.dealModel))
              : d.headerView &&
                (d.dealPollerController.disconnect(), d.headerView.showDealUnavailableView())
          })
          b.off(DealsX.Events.DEAL_TIMER_EXPIRED)
          b.on(DealsX.Events.DEAL_TIMER_EXPIRED, function () {
            d.dealPollerController.callProductV2(function (a) {
              a
                ? (d.redemptionView.hideProcessingView(),
                  d.dealModel.updateDealModelContent(a),
                  d.onModelUpdate(d.dealModel))
                : d.headerView &&
                  (d.dealPollerController.disconnect(), d.headerView.showDealUnavailableView())
            })
          })
        })
      },
      setupBuyboxViews: function (a) {
        var c = this,
          f = b.$('#dealsAccordionRow')
        f = 0 < f.length ? f : b.$('#dealsx-single-offer-display-box')
        c.primeAccessView = l.getView({ rootContainer: f, dealModel: c.dealModel })
        c.redemptionView = d.getView({ rootContainer: f, setupData: a })
        c.appAccessView = h.getView({ rootContainer: f, dealModel: c.dealModel, setupData: a })
        c.timerView = m.getView({
          rootContainer: f,
          clockOffset: c.dealModel.clockOffset,
          startTime: c.dealModel.dealDetails.startTime,
          endTime: c.dealModel.dealDetails.endTime,
        })
        c.redemptionView.initializeButtons(function (a) {
          if (a) {
            var d = c.quantityView.getQuantity()
            c.buying = !0
            c.dealRedemptionService.claimDeal(
              a.dealId,
              a.itemId,
              a.purchaseReferenceTag,
              d,
              function (a, d) {
                a &&
                  (a &&
                    a.dealAsinState &&
                    a.customerState &&
                    (c.dealModel.translateClaimDealResponse({
                      customerState: a.customerState,
                      itemState: a.dealAsinState,
                      msToCustomerStateExpiry: a.msUntilExpiration,
                    }),
                    (c.buying = !1)),
                  c.redemptionView.hideProcessingView(),
                  c.updateNavigationCartQuantity(),
                  c.onModelUpdate(c.dealModel),
                  b.trigger('deals_claimDealSuccess'))
              },
              function (a, d) {
                c.redemptionView.hideProcessingView()
                d === DealsX.constants.AAPI_V1_QUANTITY_RESTRICTION_VIOLATION_ERROR
                  ? ((c.dealModel.canCustomerClaimPrimeOnlyDOTD = !1),
                    c.redemptionView.showPodotdQuantityLimitExceeded())
                  : c.redemptionView.showRedemptionFailed()
                b.trigger('deals_claimDealError')
              },
            )
          }
        })
        c.quantityView = e.getView({ rootContainer: f, setupData: a })
        c.headerView = k.getView({ rootContainer: f })
        c.progressView = g.getView({ rootContainer: f })
        c.warrantyView = q.getView({ rootContainer: f })
        c.addView(c.headerView)
        c.addView(c.progressView)
        c.addView(c.primeAccessView)
        c.addView(c.quantityView)
        c.addView(c.timerView)
        c.addView(c.redemptionView)
        c.addView(c.appAccessView)
        c.addView(c.warrantyView)
      },
      onModelUpdate: function (a) {
        this.buying ||
          this.views.forEach(function (b) {
            return b.onModelUpdate(a)
          })
      },
      updateNavigationCartQuantity: function () {
        var a = this
        a.cartAAPIService.getCount(
          function (b, d) {
            ;(b = a.retrieveQuantity(b)) && a.displayQuantity(b)
          },
          function (a) {},
        )
      },
      retrieveQuantity: function (a) {
        return a && a.entity ? a.entity.items : null
      },
      displayQuantity: function (a) {
        f.when('nav.setCartCount').execute(function (b) {
          b(a)
        })
        f.when('mash').execute(function (b) {
          b.cart.didUpdate({ newCartQuantity: parseInt(a, 10) })
        })
      },
      addView: function (a) {
        null !== a && this.views.push(a)
      },
      subscribeToAccordionEvents: function () {
        b.on('a:accordion:buybox-accordion:select', function (a) {
          a &&
            a.selectedRow &&
            ('dealsAccordionRow' === a.selectedRow.rowName
              ? b.trigger('deals_onSelectLDBuybox')
              : b.trigger('deals_onSelectRegularBuybox'))
        })
      },
      addItemsToCart: function (a, b) {
        var d = this
        d.cartAAPIService.addItems(
          a,
          b,
          function (a, b) {
            a &&
              'cart.add-items/v1' === a.type &&
              (a = a.entity.count.entity.items) &&
              d.displayQuantity(a)
          },
          function (a) {},
        )
      },
    })
  })
  f.when('A').register('dealsx-model', function (b) {
    var c = b.$
    return b.createClass({
      callToAction: null,
      dealDetails: null,
      dealCustomerStatus: null,
      deviceType: null,
      canCustomerClaimPrimeOnlyDOTD: !0,
      hasPrimeSavingsBenefit: !1,
      clockOffset: 0,
      init: function (a) {
        if (a && a.setupData) {
          var b = a.setupData.itemCustomerState
          b &&
            (b.dealDetails && (this.dealDetails = JSON.parse(b.dealDetails)),
            b.dealCustomerStatus && (this.dealCustomerStatus = JSON.parse(b.dealCustomerStatus)),
            b.callToAction && (this.callToAction = JSON.parse(b.callToAction)))
          this.hasPrimeSavingsBenefit = a.setupData.hasPrimeSavingsBenefit || !1
          this.clockOffset = a.clockOffset
          this.deviceType = { isMobile: a.setupData.mobile, isApp: a.setupData.app }
        }
      },
      updateDealModelContent: function (a) {
        this.callToAction = a.callToAction ? a.callToAction.entity : null
        this.dealDetails = a.dealDetails ? a.dealDetails.entity : null
        this.dealCustomerStatus = a.dealCustomerStatus ? a.dealCustomerStatus.entity : null
      },
      translateClaimDealResponse: function (a) {
        a &&
          (c.extend(this.dealDetails, this.buildDealState(a)),
          c.extend(this.dealCustomerStatus, this.buildDealCustomerState(a)),
          this.isCustomerStateIsEqualTo('IN_CART') && (this.callToAction = {}))
      },
      buildDealCustomerState: function (a) {
        if (!a.customerState) return {}
        var b = new Date(new Date().getTime() + parseInt(a.msToCustomerStateExpiry))
        return {
          state: this.convertClaimDealCustomerStateToProductV2CompatibleCustomerState(
            a.customerState,
          ),
          expiryTime: b.toISOString(),
        }
      },
      buildDealState: function (a) {
        return { state: this.convertClaimDealDealStateToProductV2CompatibleDealState(a) }
      },
      isCustomerStateInCart: function () {
        return this.isCustomerStateIsEqualTo(DealsX.CustomerStates.IN_CART)
      },
      isCustomerStatePendingATC: function () {
        return this.isCustomerStateIsEqualTo(DealsX.CustomerStates.PENDING_ADD_TO_CART)
      },
      isDealStateIsEqualTo: function (a) {
        return this.dealDetails ? this.dealDetails.state === a : !1
      },
      isCustomerStateIsEqualTo: function (a) {
        return this.dealCustomerStatus ? this.dealCustomerStatus.state === a : !1
      },
      getCurrentServerTime: function () {
        return new Date(Date.now() - this.clockOffset)
      },
      isDealInPrimeEarlyAccessWindowForPrimeCustomer: function () {
        if (
          !this.dealDetails ||
          !this.dealDetails.startTime ||
          null === this.dealDetails.earlyAccessDurationInMilliseconds
        )
          return !1
        var a = this.getCurrentServerTime(),
          b = Date.parse(this.dealDetails.startTime),
          c = b + this.dealDetails.earlyAccessDurationInMilliseconds
        a = b <= a && a < c
        return this.isDealPrimeEarlyAccess() && a
      },
      isDealInPrimeEarlyAccessWindowForNonPrimeCustomer: function () {
        if (
          !this.dealDetails ||
          !this.dealDetails.startTime ||
          null === this.dealDetails.earlyAccessDurationInMilliseconds
        )
          return !1
        var a = this.getCurrentServerTime(),
          b = Date.parse(this.dealDetails.startTime)
        a = b - this.dealDetails.earlyAccessDurationInMilliseconds <= a && a < b
        return this.isDealPrimeEarlyAccess() && a
      },
      isDealInPrimeEarlyAccessWindow: function () {
        return this.hasPrimeSavingsBenefit
          ? this.isDealInPrimeEarlyAccessWindowForPrimeCustomer()
          : this.isDealInPrimeEarlyAccessWindowForNonPrimeCustomer()
      },
      isDealPrimeEarlyAccess: function () {
        return this.dealDetails && 'PRIME_EARLY_ACCESS' === this.dealDetails.accessBehavior
      },
      isDealAppOnly: function () {
        return this.dealDetails && 'APP_ONLY_LD' === this.dealDetails.accessBehavior
      },
      isDealPrimeOnly: function () {
        return this.dealDetails && 'PRIME_ONLY' === this.dealDetails.accessBehavior
      },
      isDealPrimeOnlyDotd: function () {
        return this.isDealPrimeOnly() && 'DEAL_OF_THE_DAY' === this.dealDetails.type
      },
      isDealAccessibleToCustomer: function () {
        return (
          this.hasPrimeSavingsBenefit ||
          (!this.isDealInPrimeEarlyAccessWindowForNonPrimeCustomer() && !this.isDealPrimeOnly())
        )
      },
      getCustomerStateExpiryTime: function () {
        return this.dealCustomerStatus ? this.dealCustomerStatus.expiryTime : null
      },
      convertClaimDealCustomerStateToProductV2CompatibleCustomerState: function (a) {
        switch (a) {
          case 'NONE':
            return DealsX.CustomerStates.NONE
          case 'INCART':
            return DealsX.CustomerStates.IN_CART
          case 'PENDINGATC':
            return DealsX.CustomerStates.PENDING_ADD_TO_CART
          case 'CLAIMED':
            return DealsX.CustomerStates.CLAIMED
          case 'EXPIRED':
            return DealsX.CustomerStates.EXPIRED
          default:
            return DealsX.CustomerStates.UNKNOWN
        }
      },
      convertClaimDealDealStateToProductV2CompatibleDealState: function (a) {
        switch (a) {
          case 'AVAILABLE':
            return DealsX.DealStates.AVAILABLE
          case 'UPCOMING':
            return DealsX.DealStates.UPCOMING
          case 'WAITLISTFULL':
            return DealsX.DealStates.WAITLISTFULL
          default:
            return DealsX.DealStates.UNKNOWN
        }
      },
      getRenderingPlatform: function () {
        return this.deviceType.isApp
          ? DealsX.RenderingPlatform.SHOPPING_APP
          : this.deviceType.isMobile
            ? DealsX.RenderingPlatform.MOBILE_WEB
            : DealsX.RenderingPlatform.DESKTOP
      },
    })
  })
  f.when('A').register('dealsx-prime-access-view', function (b) {
    var c = b.createClass({
      primeAccessMessageView: null,
      init: function (a) {
        this.primeAccessMessageView = a.rootContainer.find('#dealsx_prime_access_view')
      },
      onModelUpdate: function (a) {
        a.isDealInPrimeEarlyAccessWindow()
          ? b.show(this.primeAccessMessageView)
          : b.hide(this.primeAccessMessageView)
      },
    })
    return {
      getView: function (a) {
        return a.dealModel.isDealPrimeEarlyAccess() ? new c(a) : null
      },
    }
  })
  f.when('A').register('dealsx-app-access-view', function (b) {
    var c = b.createClass({
      learnMoreMessage: null,
      appDownloadButton: null,
      addToCartButton: null,
      renderingPlatform: null,
      init: function (a) {
        this.appDownloadButton = a.rootContainer.find('#app-download-button')
        this.learnMoreMessage = a.rootContainer.find('#app-only-deal-learn-more-message')
        this.addToCartButton = a.rootContainer.find('#dealsx_atc_btn')
        this.renderingPlatform = a.dealModel.getRenderingPlatform()
      },
      onModelUpdate: function (a) {
        a = this.getRenderingComponent()[this.renderingPlatform](a)
        this.renderComponent(a)
      },
      renderComponent: function (a) {
        switch (a) {
          case DealsX.AppAccessRenderingComponent.APP_DOWNLOAD_BUTTON:
            b.show(this.appDownloadButton)
            b.hide(this.learnMoreMessage)
            b.hide(this.addToCartButton)
            break
          case DealsX.AppAccessRenderingComponent.LEARN_MORE_MESSAGE:
            b.show(this.learnMoreMessage)
            b.hide(this.appDownloadButton)
            break
          default:
            b.hide(this.appDownloadButton), b.hide(this.learnMoreMessage)
        }
      },
      getRenderingComponent: function () {
        return {
          SHOPPING_APP: function () {
            return DealsX.AppAccessRenderingComponent.LEARN_MORE_MESSAGE
          },
          MOBILE_WEB: function (a) {
            return a.isCustomerStateIsEqualTo(DealsX.CustomerStates.IN_CART)
              ? DealsX.AppAccessRenderingComponent.LEARN_MORE_MESSAGE
              : DealsX.AppAccessRenderingComponent.APP_DOWNLOAD_BUTTON
          },
          DESKTOP: function (a) {
            return a.isCustomerStateIsEqualTo(DealsX.CustomerStates.IN_CART)
              ? DealsX.AppAccessRenderingComponent.NOTHING
              : DealsX.AppAccessRenderingComponent.APP_DOWNLOAD_BUTTON
          },
        }
      },
    })
    return {
      getView: function (a) {
        return a.setupData.showAppOnlyDealCx ? new c(a) : null
      },
    }
  })
  f.when('A', 'dealsx-processing-view', 'dealsx-redemption-countdown-timer', 'a-button').register(
    'dealsx-redemption-view',
    function (b, c, a, d) {
      var e = b.createClass({
        addToCartButton: null,
        processingView: null,
        inCartView: null,
        inCartTimer: null,
        pendingAddToCartView: null,
        pendingAddToCartTimer: null,
        waitlistFullMessageView: null,
        itemQuantityView: null,
        podotdQuantityLimitMessageView: null,
        redemptionFailedMessageView: null,
        pushNotificationInfo: null,
        init: function (d) {
          var e = d.rootContainer,
            g = this
          g.processingView = c.getView(d)
          g.inCartView = e.find('#dealsx_incart')
          g.pendingAddToCartView = e.find('#dealsx_pending_atc')
          g.waitlistFullMessageView = e.find('#dealsx_waitlist_full_message')
          g.itemQuantityView = e.find('#dealsx_quantity_view')
          g.redemptionFailedMessageView = e.find('#dealsx_redemption_failed')
          g.podotdQuantityLimitMessageView = e.find('#dealsx_podotd_quantitylimit_message')
          g.inCartTimer = a.getView({
            timerView: e.find('#dealsx_checkout_timer'),
            onTimeoutCallback: function () {
              g.processingView.showClaimingProgress()
              b.hide(g.inCartView)
              b.delay(function () {
                b.trigger(DealsX.Events.DEAL_TIMER_EXPIRED)
              }, 1e3)
            },
          })
          this.pendingAddToCartTimer = a.getView({
            timerView: e.find('#dealsx_pending_atc_timer'),
            onTimeoutCallback: function () {
              b.hide(g.pendingAddToCartView)
            },
          })
        },
        initializeButtons: function (a) {
          var c = this
          c.addToCartButton = d('#dealsx_atc_btn')
          c.addToCartButton.enable()
          b.declarative('dealsx-addtocart-button-action', 'click', function (b) {
            b.data &&
              b.data.actionEnabled &&
              (delete b.data.actionEnabled,
              c.addToCartButton.hide(),
              c.processingView.showClaimingProgress(),
              a(b.data))
          })
        },
        onModelUpdate: function (a) {
          var c = !0
          a.dealCustomerStatus && 'IN_CART' === a.dealCustomerStatus.state
            ? (this.inCartTimer.targetDate ||
                ((c = new Date(Date.parse(a.dealCustomerStatus.expiryTime))),
                this.inCartTimer.setTargetDate(c)),
              b.show(this.inCartView),
              (c = !1))
            : (this.inCartTimer.stop(), b.hide(this.inCartView))
          a.dealCustomerStatus && 'PENDING_ADD_TO_CART' === a.dealCustomerStatus.state
            ? (b.show(this.pendingAddToCartView),
              this.pendingAddToCartTimer.targetDate ||
                ((c = new Date(Date.parse(a.dealCustomerStatus.expiryTime))),
                this.pendingAddToCartTimer.setTargetDate(c)),
              (c = !0))
            : (this.pendingAddToCartTimer.stop(), b.hide(this.pendingAddToCartView))
          a.dealDetails && 'WAITLISTFULL' === a.dealDetails.state && a.isDealAccessibleToCustomer()
            ? (b.show(this.waitlistFullMessageView), (c = !1))
            : b.hide(this.waitlistFullMessageView)
          a.callToAction && a.callToAction.addToCart
            ? this.addToCartButton.show()
            : this.addToCartButton.hide()
          c ? b.show(this.itemQuantityView) : b.hide(this.itemQuantityView)
        },
        showRedemptionFailed: function () {
          b.show(this.redemptionFailedMessageView)
        },
        showPodotdQuantityLimitExceeded: function () {
          b.show(this.podotdQuantityLimitMessageView)
        },
        hideProcessingView: function () {
          this.processingView.hide()
        },
      })
      return {
        getView: function (a) {
          return new e(a)
        },
      }
    },
  )
  f.when('A').register('dealsx-redemption-countdown-timer', function (b) {
    var c = b.createClass({
      targetDate: null,
      timerView: null,
      onTimeoutCallback: null,
      init: function (a) {
        var c = this
        c.timerView = a.timerView
        c.targetDate = a.targetDate
        c.onTimeoutCallback = a.onTimeoutCallback
        b.on('dealsx-timer-tick', function () {
          c.render()
        })
      },
      setTargetDate: function (a) {
        this.targetDate = a
        this.render()
      },
      stop: function () {
        this.targetDate = null
      },
      render: function () {
        if (this.targetDate) {
          var a = this.targetDate.getTime() - new Date().getTime(),
            b = Math.floor((a / 6e4) % 60)
          a = Math.floor((a / 1e3) % 60)
          var c = b + ':' + ('0' + a).slice(-2)
          this.timerView && this.timerView.html(c)
          if (0 === b && 0 == a) {
            if (this.onTimeoutCallback) this.onTimeoutCallback()
            this.stop()
          }
        }
      },
    })
    return {
      getView: function (a) {
        return new c(a)
      },
    }
  })
  f.when('A').register('dealsx-quantity-view', function (b) {
    var c = b.createClass({
      quantity: 1,
      init: function (a) {
        this.subscribeToQuantityChangeEvents()
      },
      getQuantity: function () {
        return this.quantity
      },
      onModelUpdate: function (a) {},
      subscribeToQuantityChangeEvents: function () {
        var a = this
        b.on('a:dropdown:selected:dealx_quantity_dropdown', function (b) {
          a.quantity = b.value
        })
      },
    })
    return {
      getView: function (a) {
        return new c(a)
      },
    }
  })
  f.when('A').register('dealsx-processing-view', function (b) {
    var c = b.createClass({
      processingView: null,
      processingMessage: null,
      init: function (a) {
        this.processingView = a.rootContainer.find('#dealsx_processing_view')
        this.processingMessage = this.processingView.find('#dealsx_processing_msg')
      },
      hide: function () {
        b.hide(this.processingView)
        b.hide(this.processingMessage)
      },
      showClaimingProgress: function () {
        b.show(this.processingMessage)
        b.show(this.processingView)
      },
    })
    return {
      getView: function (a) {
        return new c(a)
      },
    }
  })
  f.when('A', 'dealsx-timer-countdown').register('dealsx-timer-view', function (b, c) {
    var a = b.$,
      d = b.createClass({
        startTimerView: null,
        endTimerView: null,
        clockOffset: 0,
        startTime: null,
        endTime: null,
        init: function (a) {
          this.clockOffset = a.clockOffset
          this.startTime = Date.parse(a.startTime)
          this.endTime = Date.parse(a.endTime)
          var d = b.$(a.rootContainer)
          this.isDealStarted() ||
            (this.startTimerView = c.getView({
              timerView: d.find('#dealsx-start-timer'),
              targetTime: Date.parse(a.startTime),
              clockOffset: a.clockOffset,
              onTimerExpired: this.onTimerExpired,
            }))
          this.endTimerView = c.getView({
            timerView: d.find('#dealsx-end-timer'),
            targetTime: Date.parse(a.endTime),
            clockOffset: a.clockOffset,
            onTimerExpired: this.onTimerExpired,
          })
        },
        onTimerExpired: function () {
          b.delay(function () {
            b.trigger(DealsX.Events.DEAL_TIMER_EXPIRED)
          }, 1e3)
        },
        onModelUpdate: function (b) {
          b.dealDetails &&
            (b.isCustomerStateInCart() || b.isCustomerStatePendingATC()
              ? this.endTimerView.hide()
              : this.startTimerView
                ? (a('#dealsx-start-timer').addClass('a-color-success'),
                  this.isDealStarted() && (this.startTimerView.hide(), this.endTimerView.show()))
                : (this.endTimerView.show(),
                  this.isDealEnding() && a('#dealsx-end-timer').addClass('a-color-success')))
        },
        isDealStarted: function () {
          return Date.now() - this.clockOffset > this.startTime
        },
        isDealEnding: function () {
          var a = Date.now() - this.clockOffset
          return 18e5 > this.endTime - a
        },
      })
    return {
      getView: function (a) {
        return new d(a)
      },
    }
  })
  f.when('A', 'dealsx-polyfills').register('dealsx-timer-countdown', function (b, c) {
    c.padStart()
    var a = b.createClass({
      init: function (a) {
        this.timerView = a.timerView
        this.targetTime = a.targetTime
        this.clockOffset = a.clockOffset
        this.onTimerExpired = a.onTimerExpired
        var c = this
        b.on(
          'dealsx-timer-tick',
          b.$.proxy(function () {
            c.countdown()
          }, this),
        )
      },
      countdown: function () {
        var a = Date.now() - this.clockOffset
        a = ((this.targetTime - a) / 1e3) | 0
        if (!(0 > a))
          if (0 === a) this.onTimerExpired()
          else {
            var b = Math.floor(a / 86400),
              c = Math.floor(a / 3600),
              f = Math.floor((a / 60) % 60),
              k = Math.floor(a % 60)
            a = this.timerView.find('.timer-days')
            var l = this.timerView.find('.timer-precise')
            if (0 < b)
              (c = a.find('.singular')),
                (f = a.find('.plural')),
                (k = f.find('.value')),
                a.show(),
                l.hide(),
                1 === b ? (c.show(), f.hide()) : (c.hide(), f.show(), k.text(b))
            else {
              b = l.find('.timer-hours \x3e .value')
              var h = l.find('.timer-minutes \x3e .value'),
                p = l.find('.timer-seconds \x3e .value')
              a.hide()
              l.show()
              b.text(c.toString().padStart(2, '0'))
              h.text(f.toString().padStart(2, '0'))
              p.text(k.toString().padStart(2, '0'))
            }
          }
      },
      hide: function () {
        b.hide(this.timerView)
      },
      show: function () {
        b.show(this.timerView)
      },
    })
    return {
      getView: function (b) {
        return new a(b)
      },
    }
  })
  f.when('A').register('dealsx-progress-view', function (b) {
    var c = b.createClass({
      progressView: null,
      progressBarBase: null,
      progressBarTick: null,
      claimedMessage: null,
      init: function (a) {
        a = a.rootContainer
        this.progressView = a.find('#dealsx_progress_view')
        this.progressBarBase = a.find('#dealsx_progress_bar \x3e .progbar')
        this.progressBarTick = a.find('#dealsx_progress_bar \x3e .progbartick')
        this.claimedMessage = a.find('#dealsx_percent_message')
      },
      onModelUpdate: function (a) {
        if (
          a.dealDetails &&
          null != a.dealDetails.percentClaimed &&
          a.dealDetails.percentClaimedMessage
        ) {
          !a.dealCustomerStatus ||
          ('IN_CART' !== a.dealCustomerStatus.state &&
            'PENDING_ADD_TO_CART' !== a.dealCustomerStatus.state)
            ? b.show(this.progressView)
            : b.hide(this.progressView)
          var c = a.dealDetails.percentClaimed
          this.progressBarBase.css('width', c + '%')
          this.progressBarTick.css('width', c + '%')
          this.claimedMessage.text(a.dealDetails.percentClaimedMessage)
          89 >= c
            ? this.claimedMessage
                .removeClass('a-color-error')
                .removeClass('a-color-success')
                .addClass('a-color-base')
            : 99 >= c
              ? this.claimedMessage
                  .removeClass('a-color-base')
                  .removeClass('a-color-error')
                  .addClass('a-color-success')
              : this.claimedMessage
                  .removeClass('a-color-base')
                  .removeClass('a-color-success')
                  .addClass('a-color-error')
        }
      },
    })
    return {
      getView: function (a) {
        var b = a.rootContainer
        return b.find('#dealsx_progress_view').length &&
          b.find('#dealsx_progress_bar \x3e .progbar').length &&
          b.find('#dealsx_progress_bar \x3e .progbartick').length &&
          b.find('#dealsx_percent_message').length
          ? new c(a)
          : null
      },
    }
  })
  f.when('A').register('dealsx-header-view', function (b) {
    var c = b.createClass({
      dealUnavailableView: null,
      claimedMessageView: null,
      headerStateView: null,
      init: function (a) {
        a = a.rootContainer
        this.headerStateView = a.find('#dealsx_header_message')
        this.claimedMessageView = a.find('#dealsx-claimed-message')
        this.dealUnavailableView = a.find('#dealsx-unavailable-message')
      },
      onModelUpdate: function (a) {
        a.isCustomerStateIsEqualTo(DealsX.CustomerStates.CLAIMED) &&
          this.claimedMessageView &&
          (b.show(this.claimedMessageView), b.hide(this.claimedMessageView.siblings()))
        this.updateHeaderStateMessage(a)
      },
      showDealUnavailableView: function () {
        this.dealUnavailableView &&
          (b.show(this.dealUnavailableView), b.hide(this.dealUnavailableView.siblings()))
      },
      updateHeaderStateMessage: function (a) {
        a.isCustomerStateIsEqualTo(DealsX.CustomerStates.IN_CART)
          ? this.hideHeaderStateViewChildrenExceptProvidedView(
              this.headerStateView.find('#dealsx_header_message_incart'),
            )
          : a.isCustomerStateIsEqualTo(DealsX.CustomerStates.PENDING_ADD_TO_CART)
            ? this.hideHeaderStateViewChildrenExceptProvidedView(
                this.headerStateView.find('#dealsx_header_message_pendingatc'),
              )
            : a.isCustomerStateIsEqualTo(DealsX.CustomerStates.CLAIMED)
              ? this.hideHeaderStateViewChildrenExceptProvidedView(
                  this.headerStateView.find('#dealsx_header_message_claimed'),
                )
              : a.isDealStateIsEqualTo(DealsX.DealStates.WAITLISTFULL)
                ? this.hideHeaderStateViewChildrenExceptProvidedView(
                    this.headerStateView.find('#dealsx_header_message_waitlistfull'),
                  )
                : this.hideHeaderStateViewChildrenExceptProvidedView(null)
      },
      hideHeaderStateViewChildrenExceptProvidedView: function (a) {
        a ? (b.show(a), b.hide(a.siblings())) : b.hide(this.headerStateView.children())
      },
    })
    return {
      getView: function (a) {
        return a.rootContainer.find('#dealsx_header_message').length ? new c(a) : null
      },
    }
  })
  f.when('A').register('dealsx-warranty-view', function (b) {
    var c = b.createClass({
      warrantyViewSelector: null,
      init: function (a) {
        a = a.rootContainer
        this.isMobile()
          ? (this.warrantyViewSelector = a.find('#warrantyCheckBoxLD'))
          : (this.warrantyViewSelector = a.find('#abbWrapper'))
      },
      onModelUpdate: function (a) {
        null !== this.warrantyViewSelector &&
          (a.dealCustomerStatus && a.dealCustomerStatus.state === DealsX.CustomerStates.IN_CART
            ? b.hide(this.warrantyViewSelector)
            : this.warrantyViewSelector.removeClass('a-hidden'))
      },
      isMobile: function () {
        var a = b.$
        return (
          0 <
          a('#warrantyCheckBoxLD_feature_div').find('input[name\x3d"mbba-ld"][type\x3d"checkbox"]')
            .length
        )
      },
    })
    return {
      getView: function (a) {
        return new c(a)
      },
    }
  })
  f.when('A').execute('dealsx-metrics-utilities', function (b) {
    DealsX.incrementCounter = function (b) {
      b && h.ue && 'function' === typeof h.ue.count && ue.count(b, (ue.count(b) || 0) + 1)
    }
    DealsX.setCounter = function (b, a) {
      b && h.ue && 'function' === typeof h.ue.count && ue.count(b, a)
    }
    DealsX.generateAPIMetricName = function (b) {
      if (!b) return null
      var a = 'dealsx'
      b.apiName && ((a += ':' + b.apiName), b.apiVersion && (a += ':' + b.apiVersion))
      a += ':' + (b.isSuccess ? 'success' : 'error')
      b.clientId && (a += ':' + b.clientId)
      b.errorCode && (a += ':' + b.errorCode)
      b.isRobot && (a += ':robot')
      return a.toLowerCase()
    }
    DealsX.recordAPIMetrics = function (b) {
      if (b) {
        var a = DealsX.generateAPIMetricName(b)
        DealsX.incrementCounter(a)
        b.latency && DealsX.setCounter(a + ':time', b.latency)
      }
    }
    DealsX.callIfFunctionWithMetrics = function () {
      if (!(2 > arguments.length)) {
        var b = []
        Array.prototype.push.apply(b, arguments)
        var a = b.shift(),
          d = b.shift()
        'function' == typeof d
          ? (DealsX.recordAPIMetrics(a), d.apply(null, b))
          : ((a.isRobot = !0), DealsX.recordAPIMetrics(a))
      }
    }
  })
  f.when('A').register('dealsx-polyfills', function () {
    return {
      padStart: function (b) {
        ;(!b && String.prototype.padStart) ||
          Object.defineProperty(String.prototype, 'padStart', {
            configurable: !0,
            writable: !0,
            value: function (b, a) {
              a = a || ' '
              if (this.length >= b) return String(this)
              b -= this.length
              for (var c = '', e = 0; e < b; e += a.length) c += a
              return c.slice(0, b) + String(this)
            },
          })
      },
    }
  })
  f.when('A').register('deals-custom-integration-base', function (b) {
    return b.createClass({
      isActive: !1,
      init: function () {
        this.isIntegrationActive()
      },
      isIntegrationActive: function () {
        throw Error('isIntegrationActive called from base')
      },
      appendArgumentsToEndpoint: function () {
        throw Error('appendArgumentsToEndpoint called from base')
      },
      handleClaimDealSuccess: function () {
        throw Error('handleClaimDealSuccess called from base')
      },
      handleClaimDealError: function () {
        throw Error('handleClaimDealError called from base')
      },
      handleClaimDealRetry: function () {
        throw Error('handleClaimDealRetry called from base')
      },
      handleLDBuyBoxSelected: function () {
        throw Error('handleLDBuyBoxSelected called from base')
      },
      handleRegularBuyBoxSelected: function () {
        throw Error('handleRegularBuyBoxSelected called from base')
      },
    })
  })
  f.when('A', 'deals-custom-integration-base').register(
    'deals-custom-integration-installments',
    function (b, c) {
      var a = b.$
      return c.extend({
        init: function () {
          this._super()
        },
        isIntegrationActive: function () {
          var b = a(
              '.installments-checkbox-wrapper input[name\x3d"installments-payment-checkbox"]',
            ),
            c = a('.installments-checkbox-wrapper input[name\x3d"installments-programId"]')
          this.isActive = b.length && c.length
        },
        appendArgumentsToEndpoint: function () {
          var b = '',
            c = a('.installments-checkbox-wrapper input[name\x3d"installments-payment-checkbox"]'),
            g = a('.installments-checkbox-wrapper input[name\x3d"installments-programId"]')
          g.length &&
            c.length &&
            c.is(':checked') &&
            (b = '\x26installmentsProgramId\x3d' + g.val())
          return b
        },
        getRequestDataParameter: function () {
          var b = {},
            c = a('.installments-checkbox-wrapper input[name\x3d"installments-payment-checkbox"]'),
            g = a('.installments-checkbox-wrapper input[name\x3d"installments-programId"]')
          g.length && c.length && c.is(':checked') && (b = { installmentsProgramId: g.val() })
          return b
        },
        handleClaimDealSuccess: function () {
          a('.installments-checkbox-wrapper').hide()
        },
        handleClaimDealError: function () {},
        handleClaimDealRetry: function () {},
        handleLDBuyBoxSelected: function () {
          var b = a('.installments-deal-breakdown')
          b.length && b.addClass('aok-hidden')
          b = a('.price-installment-payment')
          b.length && b.removeClass('aok-hidden')
        },
        handleRegularBuyBoxSelected: function () {
          var b = a('.installments-deal-breakdown')
          b.length && b.removeClass('aok-hidden')
          b = a('.price-installment-payment')
          b.length && b.addClass('aok-hidden')
        },
      })
    },
  )
  f.when('A', 'deals-custom-integration-base').register(
    'dealsx-deal-custom-integration-preRegistration',
    function (b, c) {
      function a() {
        var a = d('#preRegistration-container-deals input[name\x3d"account-linking-deals"]'),
          b = d('#preRegistration-container-mobile-deals input[name\x3d"account-linking-deals"]')
        return 0 < a.length ? a : 0 < b.length ? b : null
      }
      var d = b.$
      return c.extend({
        init: function () {
          this._super()
        },
        isIntegrationActive: function () {
          this.isActive = null !== a()
        },
        appendArgumentsToEndpoint: function () {
          var b = '',
            c = a()
          null !== c &&
            (b =
              c.is(':checked') && !c.prop('disabled')
                ? '\x26isDevicePreRegistered\x3dtrue'
                : '\x26isDevicePreRegistered\x3dfalse')
          return b
        },
        getRequestDataParameter: function () {
          var b = {},
            c = a()
          0 < c.length && (b = { devicePreRegistered: c.is(':checked') && !c.prop('disabled') })
          return b
        },
        handleClaimDealSuccess: function () {
          h.dealController &&
            h.dealController.dealModel &&
            !h.dealController.dealModel.isDealPrimeOnlyDotd() &&
            (d('#preRegistration-container-deals').hide(),
            d('#preRegistration-container-mobile-deals').hide())
        },
        handleClaimDealError: function () {},
        handleClaimDealRetry: function () {},
        handleLDBuyBoxSelected: function () {},
        handleRegularBuyBoxSelected: function () {},
      })
    },
  )
  f.when('A', 'deals-custom-integration-base', 'ready').register(
    'dealsx-deal-custom-integration-warranty',
    function (b, c) {
      function a() {
        var a = e(
            'div[id\x3d"warrantyCheckBoxLD_feature_div"] input[name\x3d"mbba-ld"][type\x3d"checkbox"]',
          ),
          b = document.querySelectorAll(
            'div[id\x3d"mbbLD_feature_div"] [id^\x3d"mbb-offeringID-3"]',
          )
        return 0 < a.length ? a : b
      }
      function d() {
        return (
          0 <
          e(
            'div[id\x3d"warrantyCheckBoxLD_feature_div"] input[name\x3d"mbba-ld"][type\x3d"checkbox"]',
          ).length
        )
      }
      var e = b.$
      return c.extend({
        init: function () {
          this._super()
        },
        isIntegrationActive: function () {
          this.isActive = 0 < a().length
        },
        appendArgumentsToEndpoint: function () {},
        getRequestDataParameter: function () {},
        handleClaimDealSuccess: function () {
          var c = a()
          if (0 < c.length) {
            if (d()) {
              if (c.prop('checked')) {
                var f = e(
                  'div[id\x3d"warrantyCheckBoxLD_feature_div"] input[name\x3d"mbba-ld"]',
                ).val()
                var k = e(
                  'div[id\x3d"warrantyCheckBoxLD_feature_div"] input[name\x3d"mbboid-ld"]',
                ).val()
              }
            } else
              for (var l = 0; l < c.length; l++)
                if (c[l].checked) {
                  f = e('div[id\x3d"mbbLD_feature_div"] input[name\x3d"asin.3' + l + '"]').val()
                  k = e(
                    'div[id\x3d"mbbLD_feature_div"] input[name\x3d"offeringID.3' + l + '"]',
                  ).val()
                  break
                }
            f !== n &&
              k !== n &&
              ((c = k),
              (k = d()
                ? b.state('hlcx-mbb-state').baseAsin
                : e('#ASIN,input[name\x3d"items[0.base][asin]"]').val()),
              (c = {
                asin: f,
                offerListingId: c,
                quantity: Number(e('#dealx_quantity_dropdown').val()) || 1,
                additionalParameters: {
                  itemAssociation: {
                    associatedItemId: k,
                    renderType: 'renderAll',
                    programType: 'AmazonProtect',
                    deleteConstraint: { mutuallyInclusive: !1 },
                  },
                },
              }),
              (k = (d() ? 'wty_ld_m_mbb' : 'wty_ld_d_mbb') + '_' + k + '_' + f),
              h.dealController.addItemsToCart([c], k))
          }
        },
        handleClaimDealError: function () {},
        handleClaimDealRetry: function () {},
        handleLDBuyBoxSelected: function () {
          var a = e('.a-section.mbb__tld')
          a.length && a.removeClass('a-hidden')
        },
        handleRegularBuyBoxSelected: function () {
          var a = e('.a-section.mbb__tld')
          a.length && a.addClass('a-hidden')
        },
      })
    },
  )
  f.when('A').register('dealsx-cart-aapi-service', function (b) {
    return b.createClass({
      countEndpointUrl: null,
      addItemsEndpointUrl: null,
      headers: null,
      init: function (b) {
        this.countEndpointUrl = b.cartCountAapiEndpoint
        this.addItemsEndpointUrl = b.cartAddItemsAapiEndpoint
        this.headers = {
          'Accept-Language': b.languageOfPreference,
          'x-api-csrf-token': b.aapiCsrfToken,
        }
        b.slateToken && (this.headers['x-amzn-encrypted-slate-token'] = b.slateToken)
      },
      getCount: function (c, a) {
        var d = this,
          e = { apiName: DealsX.ApiNames.CART_COUNT }
        d._request = b.$.ajax({
          url: this.countEndpointUrl,
          type: 'GET',
          dataType: 'json',
          headers: b.$.extend({}, d.headers, {
            Accept: 'application/vnd.com.amazon.api+json; type\x3d"cart.count/v1"',
            'Content-Type': 'application/vnd.com.amazon.api+json; type\x3d"cart.count.request/v1"',
          }),
          xhrFields: { withCredentials: !0 },
          success: function (a) {
            e.isSuccess = !0
            DealsX.recordAPIMetrics(e)
            c(a, d._request)
          },
          error: function (b) {
            e.isSuccess = !1
            DealsX.recordAPIMetrics(e)
            e.errorCode = JSON.parse(b.responseText).entity.status
            DealsX.recordAPIMetrics(e)
            a(b)
          },
          complete: function () {
            d._request = null
          },
        })
      },
      addItems: function (c, a, d, e) {
        var f = this,
          m = { apiName: DealsX.ApiNames.CART_ADD_ITEMS }
        f._request = b.$.ajax({
          url: this.addItemsEndpointUrl + '?ref\x3d' + a,
          type: 'POST',
          dataType: 'json',
          headers: b.$.extend({}, f.headers, {
            Accept: 'application/vnd.com.amazon.api+json; type\x3d"cart.add-items/v1"',
            'Content-Type':
              'application/vnd.com.amazon.api+json; type\x3d"cart.add-items.request/v1"',
          }),
          data: JSON.stringify({ items: c }),
          xhrFields: { withCredentials: !0 },
          success: function (a) {
            m.isSuccess = !0
            DealsX.callIfFunctionWithMetrics(m, d, a, f._request)
          },
          error: function (a) {
            m.isSuccess = !1
            DealsX.recordAPIMetrics(m)
            if (a.hasOwnProperty('responseText')) {
              var b = JSON.parse(a.responseText)
              b.hasOwnProperty('type') &&
                b.type === DealsX.constants.AAPI_V1_ERROR_TYPE &&
                (m.errorCode = b.entity.status)
            }
            m.errorCode || (m.errorCode = a.status)
            DealsX.callIfFunctionWithMetrics(m, e, a)
          },
          complete: function () {
            f._request = null
          },
        })
      },
    })
  })
  f.when('A', 'dealsx-deal-custom-integration-service').register(
    'dealsx-deal-redemption-service',
    function (b, c) {
      return b.createClass({
        endPoint: null,
        dealCustomIntegrationService: null,
        init: function (a) {
          this.dealCustomIntegrationService = new c()
          this.endPoint = a.claimDealAapiEndpoint
          this.headers = {
            'Accept-Language': a.languageOfPreference,
            Accept: 'application/vnd.com.amazon.api+json; type\x3d"deals.claim.response/v1"',
            'x-api-csrf-token': a.aapiCsrfToken,
          }
          a.slateToken && (this.headers['x-amzn-encrypted-slate-token'] = a.slateToken)
        },
        claimDeal: function (a, c, f, g, m, k) {
          var d = this,
            e = { apiName: DealsX.ApiNames.CLAIM_AND_ADD_TO_CART, isRetry: !1 }
          d._request = b.$.ajax({
            url: d.endPoint + a + '/claim-and-add-to-cart',
            type: 'POST',
            dataType: 'json',
            data: d.generateRequestData(c, g),
            contentType: 'application/vnd.com.amazon.api+json; type\x3d"deals.claim.request/v1"',
            headers: d.headers,
            xhrFields: { withCredentials: !0 },
            success: function (a) {
              e.isSuccess = !0
              DealsX.callIfFunctionWithMetrics(e, m, a.entity, d._request)
            },
            error: function (a) {
              e.isSuccess = !1
              DealsX.recordAPIMetrics(e)
              var b = null
              if (a.hasOwnProperty('responseText') && '' !== a.responseText) {
                var c = JSON.parse(a.responseText)
                c.hasOwnProperty('type') &&
                  ((b = c.type),
                  b === DealsX.constants.AAPI_V1_QUANTITY_RESTRICTION_VIOLATION_ERROR ||
                    b === DealsX.constants.AAPI_V1_ERROR_TYPE) &&
                  (e.errorCode = c.entity.status)
              }
              e.errorCode || (e.errorCode = a.status)
              DealsX.callIfFunctionWithMetrics(e, k, a, b)
            },
            complete: function () {
              d._request = null
            },
          })
        },
        generateRequestData: function (a, b) {
          var c = this.dealCustomIntegrationService.getRequestDataParameters()
          c.asin = a
          c.quantity = parseInt(b)
          return JSON.stringify(c)
        },
      })
    },
  )
  f.when(
    'A',
    'deals-custom-integration-installments',
    'dealsx-deal-custom-integration-preRegistration',
    'dealsx-deal-custom-integration-warranty',
  ).register('dealsx-deal-custom-integration-service', function (b, c, a, d) {
    var e = b.$
    return b.createClass({
      requiredFunctions:
        'isIntegrationActive appendArgumentsToEndpoint handleClaimDealSuccess handleClaimDealError handleClaimDealRetry handleLDBuyBoxSelected handleRegularBuyBoxSelected'.split(
          ' ',
        ),
      registeredIntegrations: [new c(), new a(), new d()],
      init: function () {
        this.bindEvents()
      },
      bindEvents: function () {
        b.on(
          'deals_claimDealSuccess',
          e.proxy(function () {
            this.executeEventHandler('handleClaimDealSuccess')
          }, this),
        )
        b.on(
          'deals_claimDealError',
          e.proxy(function () {
            this.executeEventHandler('handleClaimDealError')
          }, this),
        )
        b.on(
          'deals_claimDealRetry',
          e.proxy(function () {
            this.executeEventHandler('handleClaimDealRetry')
          }, this),
        )
        b.on(
          'deals_onSelectLDBuybox',
          e.proxy(function () {
            this.executeEventHandler('handleLDBuyBoxSelected')
          }, this),
        )
        b.on(
          'deals_onSelectRegularBuybox',
          e.proxy(function () {
            this.executeEventHandler('handleRegularBuyBoxSelected')
          }, this),
        )
      },
      appendCustomArgumentsToEndpoint: function (a) {
        var b = a
        e.each(this.registeredIntegrations, function (a, c) {
          c.isIntegrationActive()
          c.isActive && (b += c.appendArgumentsToEndpoint())
        })
        return b
      },
      getRequestDataParameters: function () {
        var a = {}
        e.each(this.registeredIntegrations, function (b, c) {
          c.isIntegrationActive()
          if (c.isActive) {
            b = c.getRequestDataParameter()
            for (var d in b) a[d] = b[d]
          }
        })
        return a
      },
      executeEventHandler: function (a) {
        e.each(this.registeredIntegrations, function (b, c) {
          c.isIntegrationActive()
          if (c.isActive) c[a]()
        })
      },
    })
  })
})
/* ******** */
;(function (b) {
  var c = window.AmazonUIPageJS || window.P,
    e = c._namespace || c.attributeErrors,
    a = e ? e('DigitalDashDetailPageAssets', '') : c
  a.guardFatal
    ? a.guardFatal(b)(a, window)
    : a.execute(function () {
        b(a, window)
      })
})(function (b, c, e) {
  b.register('DigitalDashUtils', function () {
    return {
      redirect: function (a) {
        if (!a) throw 'Must pass a target URL.'
        c.location.href = a
      },
    }
  })
  ;('use strict')
  b.when('A', 'DigitalDashCreateForm').register('DigitalDashAddListeners', function (a, b) {
    a.declarative('digital-dash-create', 'click', function (a) {
      a.$event.preventDefault()
      if (a.$target.data('DigitalDashCreateForm')) var d = a.$target.data('DigitalDashCreateForm')
      else
        (d = new b({ el: a.data.el, href: a.data.href })),
          a.$target.data('DigitalDashCreateForm', d)
      d.submit(a.data.data)
      return !1
    })
    a.on('digital-dash:auto-create', function (a) {
      new b({ el: a.el, href: a.href }).submit(a.data)
    })
  })
  ;('use strict')
  b.when('A', 'DigitalDashUtils', 'a-alert').register('DigitalDashCreateForm', function (a, g, c) {
    function d(a) {
      f.extend(this, h, a)
      if (!this.el) throw 'Must specify an el'
      if (!this.href) throw 'Must specify an href to post to'
      this.$el = f(this.el)
      this.$el.find(this.errorAlertSelector).removeClass('aok-hidden').end()
      this.$errorAlert = c(this.$el.find(this.errorAlertSelector))
      this.baseErrorText = this.$errorAlert.text()
      this.$changeover = this.$el.find(this.changeoverSelector)
      this.$updatingEls = Array.prototype.slice.call(
        document.querySelectorAll(this.buttonSuccessClass),
      )
    }
    var f = a.$,
      h = {
        errorAlertSelector: '#digital-dash-create-error-message',
        ajaxFieldName: 'isAjax',
        changeoverSelector: '#digital-dash-create-success-changeover',
        buttonSuccessClass: '.digital-dash-create-button-success-display',
      }
    d.prototype.submit = function (b) {
      this.$updatingEls.forEach(function (a) {
        a.classList.remove('success')
        a.classList.remove('error')
      })
      b[this.ajaxFieldName] = !0
      a.ajax(this.href, {
        method: 'POST',
        params: b,
        success: f.proxy(this.handleAjaxSuccess, this),
        error: f.proxy(this.handleAjaxError, this),
      })
    }
    d.prototype.handleAjaxSuccess = function (a) {
      a.success || 510 === a.error.errorCode
        ? (this.$changeover.show(),
          this.$updatingEls.forEach(function (a) {
            a.classList.add('success')
          }))
        : (a.error.errorTitle && this.$errorAlert.heading(a.error.errorTitle),
          a.error.errorMessage
            ? this.$errorAlert.text(a.error.errorMessage)
            : this.$errorAlert.text(this.baseErrorText),
          this.$updatingEls.forEach(function (a) {
            a.classList.add('error')
          }))
    }
    d.prototype.handleAjaxError = function (a) {
      if (401 === a.http.status)
        try {
          return g.redirect(a.http.responseText)
        } catch (k) {
          b.log('Error parsing unauth response: ' + k, 'ERROR', 'DigitalDashCreateForm')
        }
      else
        b.log(
          'Create dash button call failed, could not recognize response from server.',
          'FATAL',
          'DigitalDashCreateForm',
        )
      this.$updatingEls.forEach(function (a) {
        a.classList.add('error')
      })
    }
    return d
  })
  ;('use strict')
  b.when('A', 'DigitalDashAddListeners', 'load').execute('DigitalDashAutoAction', function (a) {
    var b = a.state('digital-dash-auto-action')
    if (b) a.trigger(b.actionName, b.data)
    else
      a.on('a:state:update:digital-dash-auto-action', function (c) {
        a.trigger(b.actionName, a.state('digital-dash-auto-action').data)
      })
  })
  ;('use strict')
  b.when('A', 'a-popover').execute('DigitalDashPopoverManager', function (a, c) {
    var e = a.$,
      d = a.throttle(
        function (a) {
          a.updatePosition()
        },
        500,
        { trailing: !1 },
      )
    a.on('a:popover:ajaxContentLoaded:dd-create-learn-more', function (a) {
      var c = a.popover
      a = e(c.getContent())
      a.html()
        ? a.find('img').each(function () {
            e(this).bind('load', function () {
              d(c)
            })
          })
        : b.log(
            'dd-create-learn-more lazyPositionPopover popover content not ready',
            'WARN',
            'DigitalDashPopoverManager',
          )
    })
  })
})
/* ******** */
;(function (l) {
  var e = window.AmazonUIPageJS || window.P,
    m = e._namespace || e.attributeErrors,
    f = m ? m('AudibleSamplePlayerAssets', '') : e
  f.guardFatal
    ? f.guardFatal(l)(f, window)
    : f.execute(function () {
        l(f, window)
      })
})(function (l, e, m) {
  'use strict'
  l.when('A', 'jQuery').register('AudibleAudioPlayer', function (f, h) {
    function w(b) {
      b.startedListen ||
        (m(b, 'StartListening', b.playingStartTimestamp, null), (b.startedListen = 1))
      b.isPlaying || m(b, 'Listening', b.playingStartTimestamp, b.playingEndTimestamp)
      b.isEnded && m(b, 'MarkAsFinished', b.playingEndTimestamp, null)
    }
    function m(b, k, a, p) {
      var d = {}
      d.eventType = k
      d.asin = b.asin
      d.eventTimeStamp = a
      p && (d.eventEndTimeStamp = p)
      h.ajax('/hz/audible/sampleplayer/stats', {
        type: 'POST',
        data: d,
        success: function (a) {},
        error: function (a) {},
      })
    }
    function l(b, k) {
      var a = 'adbl_smpl_'
      'Play' === k
        ? b.logFirstPlay
          ? ((b.logFirstPlay = 0), (k = 'FirstPlay'), (a += 'frst_play'))
          : (a += 'play')
        : 'Paused' === k
          ? (a += 'paus')
          : 'Ended' === k && (a += 'endd')
      h.post('/hz/audible/sampleplayer?s\x3d' + k + '\x26ref\x3d' + a)
    }
    function u(b) {
      h.post('/hz/audible/sampleplayer?s\x3d' + b + '\x26ref\x3dinit')
    }
    function e(b) {
      function k() {
        a.audioObj.addEventListener('ended', function () {
          a.audioId.trigger('audioEnded')
          a.isPlaying = 0
          a.isEnded = 1
          a.playingEndTimestamp = Date.now()
          l(a, 'Ended')
          w(a)
        })
        a.audioObj.addEventListener('playing', function () {
          a.audioId.trigger('audioPlaying')
          a.isPlaying = 1
          a.playingStartTimestamp = Date.now()
          l(a, 'Play')
          w(a)
        })
        a.audioObj.addEventListener('pause', function () {
          a.audioId.trigger('audioPaused')
          a.isPlaying = 0
          a.playingEndTimestamp = Date.now()
          l(a, 'Paused')
          w(a)
        })
        a.audioObj.addEventListener('loadstart', function () {
          a.audioId.trigger('audioLoad')
          a.isPlaying = 0
        })
      }
      var a = {
        initializePlayer: function (b) {
          a.options = b
          a.isFirstPlay = 1
          a.logFirstPlay = 1
          a.startedListen = 0
          a.asin = b.asin
        },
        play: function () {
          if (a.isFirstPlay) {
            var p = a.options,
              d = h('\x3caudio /\x3e')
            d.attr('id', p.audioId)
            d.attr('src', p.audioSrc)
            h('body').append(d)
            a.audioObj = h('#' + p.audioId).get(0)
            a.audioId = h('#' + p.audioId)
            k()
            'function' === typeof b.bindEventsCallback && b.bindEventsCallback(a.audioId)
            a.isFirstPlay = 0
            q.push(a)
          }
          a.audioObj.play()
        },
        pause: function () {
          a.audioObj.pause()
        },
      }
      return a
    }
    var q = []
    return function () {
      var b = {
        init: function (k) {
          if (
            'undefined' !== typeof k.audioSrc &&
            'undefined' !== typeof k.audioId &&
            'undefined' !== typeof k.audioControllerId
          ) {
            var a = k.audioSrc,
              h = document.createElement('audio'),
              d,
              a = a.match('[^.]+$')
            null !== a &&
              0 < a.length &&
              ((a = a[0]),
              'mp3' === a
                ? (d = 'audio/mpeg')
                : 'ogg' === a
                  ? (d = 'audio/ogg')
                  : 'wav' === a && (d = 'audio/wav'))
            a = 0
            h && h.canPlayType && h.canPlayType(d) && h.canPlayType(d).replace(/no/, '') && (a = 1)
            a
              ? (u('HTML5Player'),
                (b.player = new e(k)),
                b.player.initializePlayer(k),
                (b.isPlayerAvailable = 1))
              : u('InvalidPlayerType')
          } else u('MissingInitParams')
        },
        pause: function () {
          'undefined' !== typeof b.player && b.player.pause()
        },
        play: function () {
          if ('undefined' !== typeof b.player) {
            b.player.play()
            for (var h = b.player.options.audioId, a = 0; a < q.length; a++) {
              var f = q[a]
              h !== f.options.audioId && f.pause()
            }
          }
        },
      }
      return b
    }
  })
  ;('use strict')
  l.when('A', 'jQuery', 'AudibleAudioPlayer', 'a-popover').register(
    'AudibleSamplePlayer',
    function (f, h, w, l) {
      function F() {
        if (t) {
          var a = Math.round((f.now() - t) / 1e3)
          t = f.now()
          q('adbl-smpl-played-seconds', a)
        } else t = f.now()
      }
      function u(a) {
        var b = C(v.duration - v.currentTime)
        h(a + ' .time-remaining_text').html(b)
        var b = 1 - (v.duration - v.currentTime) / v.duration,
          d = 42 * Math.PI
        h(a + ' .progressCircle').attr('stroke-dashoffset', (1 - b) * d)
        h(a + ' .activeProgressBar').attr('x2', 100 * b + '%')
      }
      function C(a) {
        var b = Math.round(a % 60)
        return (Math.floor(a / 60) % 60) + ':' + (10 > b ? '0' + b : b)
      }
      function q(a, b) {
        d && d.count && d.count(a, (d.count(a) || 0) + (b || 1))
      }
      function b(a, b, d) {
        a.player.removeClass('audioPlaySample audioPlaying audioLoading audioPaused')
        a.player.addClass(b)
        d.isAOASamplePlayer
          ? (a.aoaSamplePlayerSprite.removeClass(
              'sampleAudioListen sampleAudioPlaying sampleAudioLoading sampleAudioPaused',
            ),
            d.isAOAMFPDPVirtualVoiceAsin &&
              ('audioPlaySample' === b
                ? (a.aoaMFPDPVirtualVoiceAsinSampleIcon.attr('width', '50px'),
                  a.aoaMFPDPVirtualVoiceAsinSampleIcon.attr('margin-left', '-50px'))
                : (a.aoaMFPDPVirtualVoiceAsinSampleIcon.attr('width', '66px'),
                  a.aoaMFPDPVirtualVoiceAsinSampleIcon.attr('margin-left', '-66px'))))
          : d.isSamplePlayerForBooksAsin
            ? a.sampleTextLong.addClass('a-hidden')
            : (a.playSampleText.addClass('a-hidden'),
              a.playingSampleText.addClass('a-hidden'),
              a.pausedSampleText.addClass('a-hidden'))
      }
      function k(a, b) {
        a.aoaPlaySampleText.addClass('a-hidden')
        a.aoaPlayingSampleText.addClass('a-hidden')
        a.aoaPausedSampleText.addClass('a-hidden')
        a.aoaLoadingSampleText.addClass('a-hidden')
        b.removeClass('a-hidden')
      }
      function a(a, d) {
        b(a, 'audioPlaySample', d)
        d.isAOASamplePlayer
          ? (a.aoaSamplePlayerSprite.addClass('sampleAudioListen'), k(a, a.aoaPlaySampleText))
          : (a.playButton.removeClass('a-hidden'),
            a.pauseButton.addClass('a-hidden'),
            a.loadingSpinner.addClass('a-hidden'),
            a.progressBar.addClass('a-hidden'),
            a.timeRemainingText.addClass('a-hidden'),
            a.statusButtonContainer.removeClass('status-container-margin'),
            a.buttonWithData.attr('data-test', 'sampleAudioListen'),
            a.buttonWithData.attr('aria-label', a.buttonWithData.attr('data-init-text')),
            d.isSamplePlayerForBooksAsin
              ? (a.audibleMediaControlHeightLong.removeClass('a-hidden'),
                a.audibleMediaControlHeightShort.removeClass('a-hidden'),
                a.sampleTextLong.removeClass('a-hidden'))
              : a.playSampleText.removeClass('a-hidden'))
      }
      var p = [],
        d = e.ue,
        t = null,
        v = null
      'object' === typeof d &&
        'function' === typeof d.count &&
        d.count('audible-sample-player-js', 1)
      var x = ''
      return {
        init: function (f) {
          if (f && f.flashPlayerUrl && f.container) {
            var e = h(f.container),
              B = f.container,
              D = f.pauseCallback,
              E = f.playCallback,
              y,
              z
            e.each(function () {
              var g = h(this)
              if ('undefined' !== typeof g) {
                var e = new w()
                p.push(e)
                var r = {},
                  A = g.prev()
                r.audioSrc = A.data('audiosource')
                r.audioId = A.data('audioid')
                r.asin = A.data('asin')
                r.flashPlayerUrl = f.flashPlayerUrl
                r.audioControllerId = g
                A = C(0)
                h(B + ' .time-remaining_text').html(A)
                var c = {
                    player: g.find('.clickablePlayer'),
                    sampleTextLong: g.find('#sampleTextLong'),
                    playSampleText: g.find('#playSampleText'),
                    playingSampleText: g.find('#playingSampleText'),
                    pausedSampleText: g.find('#pausedSampleText'),
                    playButton: g.find('#audioSamplePlayButton'),
                    pauseButton: g.find('#audioSamplePauseButton'),
                    loadingSpinner: g.find('#audioSampleLoadingSpinner'),
                    progressBar: g.find('.status-bar-container'),
                    timeRemainingText: g.find('.time-remaining_text'),
                    statusButtonContainer: g.find('.status-button-container'),
                    buttonWithData: g.find('.a-button-input'),
                    audibleMediaControlHeightLong: g.find('.audibleMediaControlHeightLong'),
                    audibleMediaControlHeightShort: g.find('.audibleMediaControlHeightShort'),
                    aoaSamplePlayerSprite: g.find('#samplePlayerSprite'),
                    aoaPlaySampleText: g.find('#aoaPlaySampleText'),
                    aoaPlayingSampleText: g.find('#aoaPlayingSampleText'),
                    aoaPausedSampleText: g.find('#aoaPausedSampleText'),
                    aoaLoadingSampleText: g.find('#aoaLoadingSampleText'),
                    aoaMFPDPVirtualVoiceAsinSampleIcon: g.find(
                      '#mfpdpSampleIconForVirtualVoiceAsin',
                    ),
                  },
                  n = {
                    isSamplePlayerForBooksAsin: 0 < g.find('#evoExpBooksSamplePlayerID').length,
                    isAOASamplePlayer: c.aoaPlaySampleText !== m && 0 < c.aoaPlaySampleText.length,
                    isAOAMFPDPVirtualVoiceAsin:
                      c.aoaMFPDPVirtualVoiceAsinSampleIcon !== m &&
                      0 < c.aoaMFPDPVirtualVoiceAsinSampleIcon.length,
                  }
                n.isAOASamplePlayer && (c.player = g.find('.audioPlayer'))
                x = c.player.attr('data-scope')
                r.bindEventsCallback = function (e) {
                  e.bind('audioEnded', function () {
                    a(c, n)
                    f.showPopover && l.remove(g)
                    q('adbl-smpl-play-ended')
                    d && d.tag && d.tag('FinishedAudibleSample')
                    y && ((t = null), clearInterval(y))
                    z && clearInterval(z)
                    var b = C(0)
                    h(B + ' .time-remaining_text').html(b)
                  })
                  e.bind('audioPlaying', function () {
                    b(c, 'audioPlaying', n)
                    n.isAOASamplePlayer
                      ? (c.aoaSamplePlayerSprite.addClass('sampleAudioPlaying'),
                        k(c, c.aoaPlayingSampleText))
                      : (c.playButton.addClass('a-hidden'),
                        c.pauseButton.removeClass('a-hidden'),
                        c.loadingSpinner.addClass('a-hidden'),
                        c.progressBar.removeClass('a-hidden'),
                        c.timeRemainingText.removeClass('a-hidden'),
                        c.statusButtonContainer.addClass('status-container-margin'),
                        c.buttonWithData.attr('data-test', 'sampleAudioPlaying'),
                        c.buttonWithData.attr(
                          'aria-label',
                          c.buttonWithData.attr('data-playing-text'),
                        ),
                        n.isSamplePlayerForBooksAsin
                          ? (c.audibleMediaControlHeightLong.removeClass('a-hidden'),
                            c.audibleMediaControlHeightShort.removeClass('a-hidden'))
                          : c.playingSampleText.removeClass('a-hidden'))
                    if (f.showPopover) {
                      var a = f.popoverOptions
                      g &&
                        a &&
                        a.inlineContent &&
                        ((a.inlineContent = a.inlineContent.replace(
                          /\/dp\/[a-zA-Z0-9]*\//g,
                          '/dp/' + g.data('asin') + '/',
                        )),
                        (a = l.create(g, a)) && a.show())
                    }
                    q('adbl-smpl-play')
                    d && d.tag && d.tag('PlayedAudibleSample')
                    y = setInterval(F, 5e3)
                    v = this
                    u(B)
                    z = setInterval(u.bind(null, B), 1e3)
                  })
                  e.bind('audioPaused', function () {
                    b(c, 'audioPaused', n)
                    n.isAOASamplePlayer
                      ? (c.aoaSamplePlayerSprite.addClass('sampleAudioPaused'),
                        k(c, c.aoaPausedSampleText))
                      : (c.playButton.removeClass('a-hidden'),
                        c.pauseButton.addClass('a-hidden'),
                        c.loadingSpinner.addClass('a-hidden'),
                        c.progressBar.removeClass('a-hidden'),
                        c.timeRemainingText.removeClass('a-hidden'),
                        c.buttonWithData.attr(
                          'aria-label',
                          c.buttonWithData.attr('data-paused-text'),
                        ),
                        c.statusButtonContainer.addClass('status-container-margin'),
                        n.isSamplePlayerForBooksAsin
                          ? (c.audibleMediaControlHeightLong.removeClass('a-hidden'),
                            c.audibleMediaControlHeightShort.removeClass('a-hidden'))
                          : c.pausedSampleText.removeClass('a-hidden'))
                    f.showPopover && l.remove(g)
                    q('adbl-smpl-pause')
                    y && ((t = null), clearInterval(y))
                    z && clearInterval(z)
                  })
                  e.bind('audioLoad', function () {
                    b(c, 'audioLoading', n)
                    n.isAOASamplePlayer
                      ? (c.aoaSamplePlayerSprite.addClass('sampleAudioLoading'),
                        k(c, c.aoaLoadingSampleText))
                      : (c.playButton.addClass('a-hidden'),
                        c.pauseButton.addClass('a-hidden'),
                        c.loadingSpinner.removeClass('a-hidden'),
                        c.progressBar.addClass('a-hidden'),
                        c.timeRemainingText.addClass('a-hidden'),
                        c.statusButtonContainer.removeClass('status-container-margin'),
                        n.isSamplePlayerForBooksAsin &&
                          (c.audibleMediaControlHeightLong.addClass('a-hidden'),
                          c.audibleMediaControlHeightShort.addClass('a-hidden')))
                    f.showPopover && l.remove(g)
                    q('adbl-smpl-audio-loaded')
                  })
                }
                e.init(r)
                e &&
                  e.isPlayerAvailable &&
                  (a(c, n),
                  g.removeClass('a-hidden'),
                  g.children().click(function () {
                    e.player.isPlaying
                      ? (e.pause(), 'undefined' !== typeof D && D())
                      : (e.play(), 'undefined' !== typeof E && E())
                  }))
              }
            })
            x !== m &&
              0 < x.length &&
              ('function' === typeof uet && uet('cf', x, { wb: 1 }),
              'function' === typeof uex && uex('ld', x, { wb: 1 }))
          }
        },
        pause: function () {
          p.forEach(function (a) {
            a.player.isPlaying && a.pause()
          })
        },
      }
    },
  )
  ;('use strict')
  l.when('A', 'jQuery', 'AudibleSamplePlayer').execute(
    'AudibleEvoSamplePlayerDynamicSizing',
    function (f, h, e) {
      f = 150
      e = h('.audible-sample-evo-container .audioPlaySample .sample-player-width')
      e !== m &&
        0 < e.length &&
        e[0].style !== m &&
        ((e[0].style.width = 'fit-content'), (f = Math.max(f, e[0].offsetWidth)))
      f += 1
      h = h('.sample-player-width')
      for (e = 0; e < h.length; e++) h[e].style.width = f + 'px'
    },
  )
})
/* ******** */
;(function (m) {
  var A = window.AmazonUIPageJS || window.P,
    C = A._namespace || A.attributeErrors,
    b = C ? C('ProductBundleUIAssets', '') : A
  b.guardFatal
    ? b.guardFatal(m)(b, window)
    : b.execute(function () {
        m(b, window)
      })
})(function (m, A, C) {
  m.when(
    'A',
    'bundle-constants',
    'bundle-logger',
    'a-carousel-framework',
    'a-carousel-constants',
    'p-detect',
  ).register('bundles-card', function (b, d, e, c, a, h) {
    function x(a) {
      var c = a.getAttr(u.ATTR_MAX_HEIGHT)
      ;(c && b.isFiniteNumber(c)) || (c = 1)
      var p = c
      a.dom.$carousel
        .children('li')
        .not('.' + u.EMPTY_CARD_CLASS)
        .each(function (a, c) {
          a = r(c).outerHeight()
          p = Math.max(a, p)
        })
      p > c &&
        (a.setAttr(u.ATTR_MAX_HEIGHT, p),
        h.capabilities.transition
          ? 1 === c
            ? a.dom.$viewport.height(p)
            : b.animate(
                a.dom.$viewport,
                { height: p },
                a.getAttr(u.ATTR_HEIGHT_ANIMATION_SPEED),
                'linear',
              )
          : a.dom.$viewport.height(p),
        a.updateDimensionsCache({ viewport: { height: p, outerHeight: p } }))
    }
    function q(c) {
      var r = c.getAttr(a.PAGE_NUMBER),
        p = c.getAttr(a.TOTAL_PAGES),
        v = c.dom.$container.find(u.prevButton)
      c = c.dom.$container.find(u.nextButton)
      v.css('visibility', 1 === r ? 'hidden' : 'visible')
      c.css('visibility', r >= p ? 'hidden' : 'visible')
    }
    function t() {
      c.onInit('bundle-drawer-carousel', function (a) {
        x(a)
        q(a)
        b.on(u.pageChangeEvent, function (a) {
          y ||
            ((y = !0),
            e.logCount(f.SCROLL, 1),
            l.isDevices && e.logRefTag(g.INGRESS_SCROLLED + l.landingAsin))
          q(a.carousel)
        })
        b.on(u.repaintEvent, function (a) {
          q(a.carousel)
        })
      })
    }
    function m() {
      var a = r(w.bundlesCardBundles),
        c = 0,
        p = 0,
        v = 0
      b.each(a, function (a, b) {
        a = r(a)
        b = a.find(w.bundleTitle)
        b.height() > c && (c = b.height())
        b = a.find(w.bundleImage)
        b.height() > p && (p = b.height())
        a = a.find(w.bundleSavings)
        a.height() > v && (v = a.height())
      })
      b.each(a, function (a, b) {
        r(a).find(w.bundleTitle).height(c)
        r(a).find(w.bundleImage).height(p)
        r(a).find(w.bundleSavings).height(v)
      })
    }
    var r = b.$,
      l = {},
      y = !1,
      u = {
        pageChangeEvent: 'a:carousel:bundle-drawer-carousel:change:pageNumber',
        repaintEvent: 'a:carousel:bundle-drawer-carousel:repaint',
        prevButton: '.a-carousel-goto-prevpage',
        nextButton: '.a-carousel-goto-nextpage',
        ATTR_MAX_HEIGHT: 'maxHeight',
        ATTR_HEIGHT_ANIMATION_SPEED: 'height_animation_speed',
        EMPTY_CARD_CLASS: 'a-carousel-card-empty',
      },
      w = {
        alexaBadgeContainer: '.amazon-certified-badge-container',
        bundlesBottomDivider: '.bundles-bottom-divider',
        bundlesCardCarousel: '#bundles-card .a-carousel-viewport',
        bundlesCardBundles: '.bundles-carousel .bundle',
        bundlesCardState: '#bundles-card-state',
        bundlesFeature: '#bundles-feature',
        bundleSavings: '.bundle-savings-line',
        bundleImage: '.bundle-image',
        bundleTitle: '.bundle-title',
        inlineTwister: '#twister-plus-mobile-inline-twister-container',
        vas: '#vas-ppd-fake-twister-mobile',
        kso: '#special-offers-information',
        devices_mc6: '#atfCenter10_feature_div',
      },
      f = {
        SCROLL: 'bundlesCard.desktop.ingress.scroll',
        WIDGET_SHOWN: 'bundlesCard.desktop.ingress.shown',
      },
      g = {
        INGRESS_SHOWN: 'amzdv_tplus_dp_dsk_imp_',
        INGRESS_SCROLLED: 'amzdv_tplus_dp_dsk_scroll_',
      }
    b.on(d.BUNDLES_CARD_READY, function () {
      y = !1
      var a = r(w.bundlesCardState)
      l.currency = a.data('currencysymbol')
      l.aapiEndpoint = a.data('aapiendpoint')
      l.language = a.data('language')
      l.csrfToken = a.data('csrftoken')
      l.marketplaceId = a.data('marketplaceid')
      l.sessionId = a.data('sessionid')
      l.landingAsin = a.data('landingasin')
      l.isDevices = a.data('isdevices')
      l.currencyOfPreference = a.data('currencyofpreference')
      l.isUnifiedCxView = a.data('isunifiedcxview')
      m()
      t()
      e.logCount(f.WIDGET_SHOWN, 1)
      l.isDevices && e.logRefTag(g.INGRESS_SHOWN + l.landingAsin)
      r(w.alexaBadgeContainer).length && r(w.bundlesBottomDivider).addClass('aok-hidden')
    })
    return l
  })
  ;('use strict')
  m.when('A').register('aapi-add-to-cart-helper', function (b) {
    var d = b.$,
      e = ['true', 'false'],
      c = b.createClass({
        init: function (a, c, b) {
          this.csrfToken = a || ''
          this.marketplace = c || ''
          this.ajaxEndpoint = b || ''
          this.asinDataList = []
          this.refTag = ''
        },
        setAsinDataList: function (a) {
          if (Array.isArray(a)) return (this.asinDataList = a), this
        },
        addSingleAsinData: function (a) {
          if (a.asin && a.offerId && a.quantity) return this.asinDataList.push(a), this
          m.log('asin, offerListingId or quantity of single asinData is empty', 'WARN')
        },
        setRefTag: function (a) {
          this.refTag = a
          return this
        },
        sendRequest: function (a, c) {
          var b = this
          this.asinDataList.length
            ? d.ajax({
                url: this.constructAjaxUrl(),
                type: 'POST',
                data: this.constructAddToCartRequest(this.asinDataList),
                xhrFields: { withCredentials: !0 },
                headers: {
                  'Content-Type':
                    'application/vnd.com.amazon.api+json; type\x3d"cart.add-items.request/v1"',
                  Accept: 'application/vnd.com.amazon.api+json; type\x3d"cart.add-items/v1"',
                  'Accept-Language': 'en-US',
                  'x-api-csrf-token': this.csrfToken,
                  'x-amzn-encrypted-slate-token': d('meta[name\x3d"encrypted-slate-token"]').prop(
                    'content',
                  ),
                },
                success: function (d) {
                  b.verifyCartApiResponse(d) ? a(d) : c()
                },
                error: c,
              })
            : (m.log('Invalid request with an empty asin list to CartAPI', 'WARN'), c())
        },
        verifyCartApiResponse: function (a) {
          return (
            'cart.add-items/v1' === a.type &&
            'items' in a.entity &&
            0 < a.entity.items.length &&
            'id' in a.entity.items[0] &&
            this.isCartCountResponseValid(a.entity.count)
          )
        },
        isCartCountResponseValid: function (a) {
          return a && 'cart.count/v1' === a.type && 'items' in a.entity
        },
        constructAjaxUrl: function () {
          var a =
            'https://' +
            this.ajaxEndpoint +
            '/api/marketplaces/' +
            this.marketplace +
            '/cart/carts/retail/items'
          this.refTag && (a += '?ref_\x3d' + this.refTag)
          return a
        },
        constructAddToCartRequest: function (a) {
          for (var c = [], b = 0; b < a.length; b++) {
            var d = a[b],
              e = { asin: d.asin, offerListingId: d.offerId, quantity: d.quantity },
              d = this.formatBooleanParams(d)
            e.additionalParameters = this.constructAdditionalParameters(d)
            c.push(e)
          }
          return JSON.stringify({ items: c })
        },
        constructAdditionalParameters: function (a) {
          var c = {}
          a.hasOwnProperty('isToBeGiftWrapped') &&
            'boolean' === typeof a.isToBeGiftWrapped &&
            (c.giftOptions = { includeGiftReceipt: a.isToBeGiftWrapped })
          a.hasOwnProperty('isDevicePreRegistered') &&
            'boolean' === typeof a.isDevicePreRegistered &&
            (c.devicePreregistration = { selected: a.isDevicePreRegistered })
          a.hasOwnProperty('programId') &&
            a.programId.length &&
            (c.installments = { programId: a.programId })
          a.hasOwnProperty('incentivizedCart') &&
            a.incentivizedCart.length &&
            (c.incentivizedCart = a.incentivizedCart)
          a.hasOwnProperty('paymentOfferInfo') &&
            a.paymentOfferInfo.length &&
            (c.paymentOfferInfo = a.paymentOfferInfo)
          return c
        },
        formatBooleanParams: function (a) {
          for (var c in a)
            if (a.hasOwnProperty(c) && 'string' === typeof a[c]) {
              var b = a[c].toLowerCase()
              ;-1 !== e.indexOf(b) && (a[c] = 'true' === b)
            }
          return a
        },
      })
    return {
      createRequest: function (a, b, d) {
        return new c(a, b, d)
      },
    }
  })
  ;('use strict')
  m.when('A', 'bundles-card').register('bundles-secondary-view-item-models', function (b, d) {
    function e(a) {
      try {
        var c = x.grep(a.entity.images, function (a) {
          return 'MAIN' === a.variant
        })
        ;(c && c.length) || (c = a.entity.images)
        return (
          'https://m.media-amazon.com/images/I/' +
          c[0].lowRes.physicalId +
          '.' +
          c[0].lowRes.extension
        )
      } catch (b) {
        m.log('Unable to fetch main image for asin', 'ERROR')
      }
    }
    function c(a) {
      try {
        return a.entity.displayString
      } catch (c) {
        m.log('Unable to fetch title for asin', 'ERROR')
      }
    }
    function a(a, c) {
      try {
        if (a[0].price && a[0].price.entity['' + c]) {
          var b = a[0].price.entity['' + c]
          if (b) return b.moneyValueOrRange.value.amount
        }
      } catch (d) {
        m.log('Unable to fetch ' + JSON.stringify(c) + ' price for asin', 'ERROR')
      }
    }
    function h(a, c) {
      q || (q = new Intl.NumberFormat(a, { style: 'currency', currency: c }))
      return q
    }
    var x = b.$,
      q,
      t = function (a, c) {
        try {
          return 'stars' === c
            ? a.rating.hasHalfStar
              ? a.rating.fullStarCount + 0.5
              : a.rating.fullStarCount
            : a.count.displayString
        } catch (b) {
          m.log('Unable to fetch star rating/review count for asin', 'ERROR')
        }
      },
      z = function (a, c, b) {
        a = a.parameters
        if (a.length) for (var d = 0; d < a.length; d++) if (a[d].name === c) return a[d].value
        return b
      }
    return {
      validateProductV2Entity: function (a) {
        return a.asin &&
          a.productImages.entity.images.length &&
          a.title.entity.displayString &&
          a.buyingOptions.length
          ? !0
          : !1
      },
      componentData: function (b, l) {
        this.detailPageUrl = '/dp/' + b.asin
        this.imageUrl = e(b.productImages)
        this.itemTitle = c(b.title)
        if ((l = a(b.buyingOptions, 'basisPrice')))
          this.basisPrice = h(d.language, d.currencyOfPreference).format(l)
        b.customerReviewsSummary &&
          ((this.starRating = t(b.customerReviewsSummary.entity, 'stars')),
          (this.ratingCount = t(b.customerReviewsSummary.entity, 'count')))
      },
      recommendationItemData: function (b, l) {
        this.asin = b.asin
        this.detailPageUrl = '/dp/' + b.asin
        this.imageUrl = e(b.productImages)
        this.itemTitle = c(b.title)
        b.customerReviewsSummary &&
          ((this.starRating = t(b.customerReviewsSummary.entity, 'stars')),
          (this.ratingCount = t(b.customerReviewsSummary.entity, 'count')))
        l = a(b.buyingOptions, 'basisPrice')
        var q = h(d.language, d.currencyOfPreference)
        l && (this.basisPrice = q.format(l))
        this.buyingPrice = q.format(a(b.buyingOptions, 'priceToPay'))
        b.featureBullets && (this.featureBullets = b.featureBullets.entity.featureBullets)
        b.buyingOptions[0].callToAction &&
          b.buyingOptions[0].callToAction.entity &&
          b.buyingOptions[0].callToAction.entity.addToCart &&
          b.buyingOptions[0].callToAction.entity.addToCart.data &&
          ((l = b.buyingOptions[0].callToAction.entity.addToCart.data),
          (this.canAddToCart = z(l, 'canAddToCart', !1)),
          (this.offerListingId = z(l, 'offerListingId', '')))
        b.buyingOptions[0].quantity &&
          b.buyingOptions[0].quantity.entity &&
          (this.quantityLimit = b.buyingOptions[0].quantity.entity.maxOrderQuantity)
      },
    }
  })
  ;('use strict')
  m.when('A', 'ready').register('bundle-state', function (b) {
    var d = b.$,
      e = { bundleState: '#bundle-state' }
    return {
      elements: e,
      getBundleASIN: function () {
        var c = d(e.bundleState)
        if (c.length) return c.data('asin')
      },
    }
  })
  ;('use strict')
  m.when('A').register('bundles-aapi-util', function (b) {
    var d = b.$
    return {
      getAAPIProductData: function (b, c, a, h, x, q, m) {
        return d.ajax({
          url: 'https://' + b + '/api/marketplaces/' + q + '/products/' + h,
          type: 'GET',
          headers: {
            Accept: x,
            'x-api-csrf-token': a,
            'Accept-Language': c,
            'x-cc-currency-of-preference': m,
            'x-amzn-encrypted-slate-token': d('meta[name\x3d"encrypted-slate-token"]').prop(
              'content',
            ),
          },
          xhrFields: { withCredentials: !0 },
        })
      },
      getProductV2ResourceInclusions: function (b) {
        return (
          'application/vnd.com.amazon.api+json; type\x3d"collection(product/v2)/v1"; expand\x3d"' +
          b.join(',') +
          '"'
        )
      },
      getCartData: function (b, c, a) {
        return d.ajax({
          cache: !1,
          url: 'https://' + b + '/api/marketplaces/' + a + '/cart/items',
          type: 'GET',
          data: { filter: 'RETAIL' },
          headers: {
            Accept: 'application/vnd.com.amazon.api+json; type\x3d"cart.items/v1"',
            'Content-Type': 'application/vnd.com.amazon.api+json; type\x3d"cart.items.request/v1"',
            'x-api-csrf-token': c,
            'x-amzn-encrypted-slate-token': d('meta[name\x3d"encrypted-slate-token"]').prop(
              'content',
            ),
          },
          xhrFields: { withCredentials: !0 },
        })
      },
      getFullCartCount: function (b, c, a) {
        return d.ajax({
          cache: !1,
          url: 'https://' + b + '/api/marketplaces/' + a + '/cart/count',
          type: 'GET',
          headers: {
            Accept: 'application/vnd.com.amazon.api+json; type\x3d"cart.count/v1"',
            'Content-Type': 'application/vnd.com.amazon.api+json; type\x3d"cart.count.request/v1"',
            'x-api-csrf-token': c,
            'x-amzn-encrypted-slate-token': d('meta[name\x3d"encrypted-slate-token"]').prop(
              'content',
            ),
          },
          xhrFields: { withCredentials: !0 },
        })
      },
      getCartSummary: function (b, c, a) {
        return d.ajax({
          cache: !1,
          url: 'https://' + b + '/api/marketplaces/' + a + '/cart/summary',
          type: 'GET',
          data: { cartTypes: 'RETAIL' },
          headers: {
            Accept: 'application/vnd.com.amazon.api+json; type\x3d"cart.summary/v1"',
            'Content-Type':
              'application/vnd.com.amazon.api+json; type\x3d"cart.summary.request/v1"',
            'x-api-csrf-token': c,
            'x-amzn-encrypted-slate-token': d('meta[name\x3d"encrypted-slate-token"]').prop(
              'content',
            ),
          },
          xhrFields: { withCredentials: !0 },
        })
      },
    }
  })
  ;('use strict')
  m.when('A').register('bundle-logger', function (b) {
    var d = b.$
    b = A.ue || !1
    var e = b.count || !1,
      c = b.log || !1,
      a = A.ueLogError || !1,
      h = function (b, d, e, h) {
        'INFO' !== d && a
          ? (null !== h && 'object' === typeof h
              ? (h.message = '[' + b + '] ' + h.message)
              : (h = { message: '[' + b + ']' }),
            a(h, { logLevel: d, attribution: e, message: b }))
          : 'INFO' === d && c && c(b, e)
      }
    return {
      logCount: function (a, b) {
        if (e) return e(a, b), e(a)
      },
      logInfo: function (a, b) {
        h(a, 'INFO', b, null)
      },
      logWarning: function (a, b, c) {
        h(a, 'WARN', b, c)
      },
      logError: function (a, b, c) {
        h(a, 'ERROR', b, c)
      },
      logFatal: function (a, b, c) {
        h(a, 'FATAL', b, c)
      },
      logRefTag: function (a, b) {
        d.get((b || '/hctp/log/refMarker') + '?ref_\x3d' + a)
      },
    }
  })
  ;('use strict')
  m.when('A').register('bundle-constants', function () {
    return {
      BUNDLE_LISTING_V2_READY_EVENT: 'bundle-listing-V2:widget:ready',
      BUNDLE_LISTING_BOTTOM_SHEET_READY_EVENT: 'bundle-listing:sheet:ready',
      BUNDLES_CARD_READY: 'bundles-card-ready',
      BUNDLES_CARD_SECONDARY_VIEW_READY: 'bundles-card-secondary-view-ready',
      BUNDLES_DRAWER_SIDE_SHEET_READY: 'bundles-drawer-side-sheet-ready',
      BUNDLES_CARD_SECONDARY_VIEW_ATC_READY: 'bundles-card-secondary-view-atc-ready',
      BUNDLES_CARD_RENDER_SECONDARY_VIEW: 'bundles-card-render-secondary-view',
      BUNDLES_COMPONENTS_EXPANDER_READY: 'a:expander:bundle-components-expander',
      BUNDLES_POPOVER_BEFORE_SHOW: 'a:popover:beforeShow:bundles_secondary_view',
      BUNDLES_POPOVER_AFTER_HIDE: 'a:popover:afterHide:bundles_secondary_view',
      BUNDLES_TOGGLE_EXPANDER: 'toggle-bundle-cards-expander',
      AJAX_URL: '/gp/product/ajax/bundlesAjaxExperience?asin\x3d',
    }
  })
  ;('use strict')
  m.when('jQuery').register('list-of-bundles', function (b) {
    var d = b('#pba-lob-carousel-container')
    d.length &&
      (d.removeClass('a-carousel-static'),
      m.when('a-carousel-framework', 'dp-time-to-interactive').execute(function (b, c) {
        c.getClickToCIPromise().then(function () {
          d.addClass('a-carousel-static')
          b.createAll()
        })
      }))
  })
  ;('use strict')
  m.when(
    'A',
    'bundles-card',
    'bundle-constants',
    'bundles-secondary-view-item-models',
    'bundles-aapi-util',
    'bundles-side-sheet-cart-data',
    'a-truncate',
    'bundles-drawer-side-sheet',
    'bundle-logger',
    'ready',
  ).register('bundles-desktop-secondary-view', function (b, d, e, c, a, h, x, q, t) {
    function z(a) {
      q.reset()
      f.post(e.AJAX_URL + a)
        .done(function (a) {
          a = f(E.ajaxDataWrapper).html(a)
          q.initialize(a)
        })
        .done(function () {
          b.trigger(e.BUNDLES_CARD_SECONDARY_VIEW_ATC_READY)
          b.trigger(e.BUNDLES_DRAWER_SIDE_SHEET_READY)
          f(n.bundleTitle).live('click', function () {
            if (d.isDevices) {
              var a = f(this).closest(n.bundleExpander).find(n.bundleAsin).val()
              t.logRefTag(B.BUNDLE_TITLE_CLICKED_DESKTOP + d.landingAsin + v.UNDERSCORE + a)
            }
          })
          f(n.bundleGetDealButton).live('click', function () {
            if (d.isDevices) {
              var a = f(this).closest(n.bundleExpander).find(n.bundleAsin).val()
              t.logRefTag(B.GET_DEAL_BUNDLE_CLICKED_DESKTOP + d.landingAsin + v.UNDERSCORE + a)
            }
          })
        })
        .fail(function () {
          m.log('Fail to render secondary view for ' + a, 'ERROR')
        })
    }
    function r(b, p, h) {
      var e = f(n.bundleComponentsExpander + b),
        m = !1
      e.length &&
        a
          .getAAPIProductData(
            d.aapiEndpoint,
            d.language,
            d.csrfToken,
            p,
            g,
            d.marketplaceId,
            d.currencyOfPreference,
          )
          .done(function (a) {
            a = a.entities
            for (var b = 0; b < a.length; b++) {
              var p = a[b].entity
              if (c.validateProductV2Entity(p)) {
                var h = p.asin,
                  p = new c.componentData(p, d.currency),
                  h = e.find(n.bundleComponentCard + h)
                l(h, p)
                y(h, p)
                h.find(k.productBuyingPriceBase).text() &&
                  p.basisPrice &&
                  h.find(k.productFullPrice).text(p.basisPrice)
              } else {
                m = !0
                break
              }
            }
            e.toggleClass(v.AUI_HIDDEN_CLASS, m)
            q.updateContent(f(n.bundlesSecondaryViewSideSheet).html())
          })
    }
    function l(a, b) {
      a.find(k.productImageUrl).attr('src', b.imageUrl)
      a = a.find(k.productTitle)
      a.attr('href', b.detailPageUrl)
      a.find(k.productTitleText).append(b.itemTitle)
      x.get(a.find(k.productTitleTruncate)).update()
    }
    function y(a, b) {
      if (b.starRating && b.ratingCount) {
        var c = b.starRating.toString().replace('.', '-')
        a.find(k.productRatingStars)
          .removeClass('a-star-0')
          .addClass('a-star-' + c)
        a.find(k.productRatingCount).text(b.ratingCount)
      }
    }
    function u(a, b) {
      var c = f(n.bundlesSecondaryView + ' .primary-bundles').children('div')
      c.length &&
        ((c = c.eq(0).offset().top), (b = b.offset().top), a.animate({ scrollTop: b - c }, 2e3))
    }
    function w(b, e) {
      var u = f(n.bundlesSecondaryView).find(p.upsellRecommendation + b),
        B = 0
      a.getAAPIProductData(
        d.aapiEndpoint,
        d.language,
        d.csrfToken,
        e,
        g,
        d.marketplaceId,
        d.currencyOfPreference,
      )
        .done(function (a) {
          a = a.entities
          for (var b = 0; b < a.length; b++) {
            var e = a[b].entity
            if (c.validateProductV2Entity(e)) {
              var g = new c.recommendationItemData(e, d.currency),
                e = u.find(p.accessoryAtcCard + e.asin)
              l(e, g)
              y(e, g)
              g.buyingPrice && e.find(k.productBuyingPriceBase).text(g.buyingPrice)
              g.fullPrice && e.find(k.productFullPrice).text(g.fullPrice)
              if (g.featureBullets)
                for (var m = 0; m < g.featureBullets.length; m++)
                  e.find(k.featureBullet).append('\x3cli\x3e' + g.featureBullets[m] + '\x3c/li\x3e')
              g.quantityLimit && h.setItemQuantityLimit(g.asin, g.quantityLimit)
              g.offerListingId &&
                g.canAddToCart &&
                (e
                  .find(p.individualRecommendationAtc)
                  .find(p.accessoryOfferListingId)
                  .val(g.offerListingId),
                e.toggleClass(v.AUI_HIDDEN_CLASS),
                B++)
            }
          }
          0 < B &&
            ((a = u.find(p.accessoryAtcHeader)),
            a.text(a.text().replace(v.ITEM_COUNT_PLACEHOLDER, B)),
            a.toggleClass(v.AUI_HIDDEN_CLASS))
          q.updateContent(f(n.bundlesSecondaryViewSideSheet).html())
        })
        .fail(function () {
          u.toggleClass(v.AUI_HIDDEN_CLASS, !0)
          m.log('An error has occurred while getting accessory recommendations sub total', 'WARN')
        })
    }
    var f = b.$,
      g = a.getProductV2ResourceInclusions(
        'productImages(product.product-images/v2) title(product.offer.title/v1) buyingOptions[].price(product.price/v1) customerReviewsSummary(product.customer-reviews-summary/v1) featureBullets(product.offer.feature-bullets/v1) buyingOptions[].quantity(product.quantity/v2) buyingOptions[].callToAction(product.call-to-action/v1)'.split(
          ' ',
        ),
      ),
      k = {
        productImageUrl: '.item-image',
        productTitle: '.item-title',
        productTitleText: '.a-truncate-full',
        productTitleTruncate: '.a-truncate',
        productRatingStars: '.a-star-0',
        productRatingCount: '.component-rating-count',
        productBuyingPriceBase: '.buying-item-price-base',
        productFullPrice: '.full-item-price',
        featureBullet: '.feature-bullet',
      },
      n = {
        bundlesSecondaryView: '#bundles-secondary-view',
        bundleAsin: "[name\x3d'bundle-asin']",
        bundleExpanders: '#bundle-expander-content-',
        bundleExpander: '.secondary-bundle-container',
        bundleExpanderContent: '.bundle-expander-content',
        bundleExpanderHeader: '.bundle-expander-header',
        bundleComponentsExpander: '.bundle-components-expander-',
        bundleComponentsExpanderHeader: '.bundle-components-expander-header',
        bundleComponentsExpanderContent: '.bundle-components-expander-content',
        bundleComponentCard: '.bundle-component-card-',
        componentAsins: "[name\x3d'component-asins']",
        expanderAsins: '.bundles-secondary-expander-asins',
        expanderComponentAsins: '.bundles-secondary-expander-component-asins',
        bundlesSecondaryViewSideSheet: '#bundles-desktop-side-sheet',
        bundleCardAsin: "input[name\x3d'bundle-card-asin']",
        bundleTitle: '.bundle-details-title',
        bundleGetDealButton: '.bundle-get-deal-button',
        relatedBundlesDivider: '.related-bundles-divider',
      },
      p = {
        individualRecommendationAtc: '.bundles-drawer-individual-recommendation-add-to-cart',
        accessoryAtcHeader: '.bundles-drawer-accessory-atc-header',
        accessoryOfferListingId: '[name\x3d"accessory-offer-listing-id"]',
        upsellRecommendation: '#bundle-upsell-recommendations-',
        accessoryAtcCard: '#bundle-upsell-accessory-atc-card-',
        bundleAsin: '.bundles-sideSheet-accessory-atc-asins',
        bundleAccessoryAsins: '.bundles-sideSheet-accessory-atc-recommendation-asins',
      },
      v = {
        AUI_HIDDEN_CLASS: 'aok-hidden',
        SIDE_SHEET: 'side-sheet',
        BUNDLES_CARD_SELECTOR: "div[id^\x3d'bundle-card']",
        ITEM_COUNT_PLACEHOLDER: '{NUM_OF_ITEMS}',
        BUNDLE_EXPANDER_HEADING_HIGHLIGHTED_CLASS: 'bundle-expander-header-highlighted',
        BUNDLE_EXPANDER_HEADING_CLASS: 'bundle-expander-header',
        BUNDLE_CARD_CLICKED_REFTAG: 'amzdv_tplus_dp_dsk_card_clicked_',
        UNDERSCORE: '_',
        INGRESS_CARD_REFTAG: 'amzdv_tplus_dp_dsk_expl_simlr_bdl_',
      },
      E = { ajaxDataWrapper: '\x3cdiv id\x3d"bundles-desktop-side-sheet-wrapper"\x3e\x3c/div\x3e' },
      B = {
        BUNDLE_TITLE_CLICKED_DESKTOP: 'amzdv_tplus_dp_dsk_bdp_',
        GET_DEAL_BUNDLE_CLICKED_DESKTOP: 'amzdv_tplus_dp_dsk_bgd_',
      }
    b.on(e.BUNDLES_CARD_RENDER_SECONDARY_VIEW, function () {
      z(d.landingAsin)
    })
    b.on(e.BUNDLES_DRAWER_SIDE_SHEET_READY, function () {
      var a = f(n.bundlesSecondaryView),
        b = a.find(n.expanderComponentAsins),
        c = a.find(n.expanderAsins)
      b.length &&
        b.each(function (p) {
          r(c[p].textContent.trim(), b[p].textContent.trim(), a)
        })
      var e = a.find(p.bundleAsin),
        h = a.find(p.bundleAccessoryAsins)
      h.length &&
        h.each(function (a) {
          w(e[a].textContent.trim(), h[a].textContent.trim())
        })
      a = f(n.bundlesSecondaryViewSideSheet)
      f('.ingress-card')
        .unbind('click')
        .click(function (b) {
          b.preventDefault()
          d.isDevices && t.logRefTag(v.INGRESS_CARD_REFTAG + d.landingAsin)
          q.show(function () {
            var b = f(n.relatedBundlesDivider)
            u(a, b)
          }, !0)
        })
      d.isUnifiedCxView ||
        f('.bundle-box-link')
          .unbind('click')
          .click(function (b) {
            b.preventDefault()
            var c = f(this).siblings(n.bundleCardAsin).val()
            d.isDevices &&
              ((b = f('.bundle-box-link').index(b.target)),
              t.logRefTag(v.BUNDLE_CARD_CLICKED_REFTAG + b + v.UNDERSCORE + d.landingAsin))
            q.show(
              function (b) {
                var c = f(n.bundlesSecondaryView)
                  .find(".secondary-bundle-container input[value\x3d'" + b + "']")
                  .closest(n.bundleExpander)
                'false' === c.find(n.bundleExpanderContent).attr('aria-expanded') &&
                  c.find(n.bundleExpanderHeader).click()
                'false' === c.find(n.bundleComponentsExpanderContent).attr('aria-expanded') &&
                  c.find(n.bundleComponentsExpanderHeader).click()
                c.find(n.bundleExpanderHeader)
                  .removeClass(v.BUNDLE_EXPANDER_HEADING_CLASS)
                  .addClass(v.BUNDLE_EXPANDER_HEADING_HIGHLIGHTED_CLASS)
                b = a
                  .find(".secondary-bundle-container input[value\x3d'" + b + "']")
                  .closest(n.bundleExpander)
                u(a, b)
              },
              !1,
              c,
            )
          })
    })
  })
  ;('use strict')
  m.when(
    'A',
    'MakoAmazonApiAddToCartHelper',
    'bundle-constants',
    'bundles-aapi-util',
    'bundles-card',
    'bundles-side-sheet-cart-data',
    'bundle-logger',
    'a-checkbox',
  ).execute('register-bundles-add-to-cart-declarative-actions', function (b, d, e, c, a, h, x, q) {
    function t(a) {
      a &&
        a.items &&
        a.items.forEach(function (a) {
          h.setCartItemQuantity(a.asin, a.quantity)
        })
    }
    function z(a) {
      h.setCartTotalCount(a)
      m.when('nav.setCartCount').execute(function (b) {
        b(a)
      })
    }
    function r(a) {
      f(g.postAddToCartContent).find(n.subTotalContainer).toggleClass(k.AUI_HIDDEN_CLASS, !a)
    }
    function l() {
      c.getCartSummary(a.aapiEndpoint, a.csrfToken, a.marketplaceId)
        .done(function (a) {
          r(!0)
          a.entity &&
            a.entity.summary &&
            0 < a.entity.summary.length &&
            f(g.postAddToCartContent)
              .find(n.subTotalPrice)
              .text(a.entity.summary[0].subtotal.displayString)
        })
        .fail(function () {
          r(!1)
          m.log('An error has occurred while getting cart sub total', 'WARN')
        })
    }
    function y(a) {
      var b = a.asin
      if (f(g.atcButton + b).length) {
        var c = q(g.accountLinkingCheckbox + b)
        c && (a.isDevicePreRegistered = c.isChecked())
      }
      f(g.installmentsCheckbox + b).length &&
        (c = q(g.installmentsCheckbox + b)) &&
        c.isChecked() &&
        (a.programId = f(g.installmentsCheckbox + b).val())
      return a
    }
    function u(a) {
      var b = f(g.postAddToCartContent).find(n.proceedToCheckoutText)
      b.text().includes(k.ITEM_COUNT_PLACEHOLDER)
        ? b.text(b.text().replace(k.ITEM_COUNT_PLACEHOLDER, a))
        : b.text(b.text().replace(/\d+/, a))
    }
    function w(a, b, c, d) {
      b.text(c)
      a.toggleClass(k.AUI_HIDDEN_CLASS, !0)
      d.toggleClass(k.AUI_HIDDEN_CLASS, !1)
    }
    var f = b.$,
      g = {
        reachCartLimitMessage: '#bundle-reach-cart-limit-message-',
        atcButton: '#bundle-ajax-atc-button-',
        atcErrorBlock: '#bundle-ajax-atc-error-block-',
        bundlesDrawerSideSheet: '#bundles-desktop-side-sheet',
        natcForm: '#bundles-drawer-natc-form-',
        accountLinkingCheckbox: '#bundles-desktop-side-sheet #bundle-account-linking-',
        accountLinkingHiddenInput: '#bundles-drawer-natc-accountLinking-',
        installmentsCheckbox: '#bundles-desktop-side-sheet #bundle-account-installments-',
        installmentsHiddenInput: '#bundles-drawer-natc-installments-',
        installmentsMessage: '#bundles-desktop-side-sheet #bundles-drawer-installments-message',
        installmentsMessageText:
          '#bundles-desktop-side-sheet #bundles-drawer-installments-message-text',
        bundleExpanders: '#bundle-expander-content-',
        bundleImage: '.bundle-image',
        bundleContent: '#bundles-desktop-side-sheet .bundle-content',
        postAddToCartContent: '#bundles-desktop-side-sheet .post-add-to-cart',
      },
      k = {
        AUI_HIDDEN_CLASS: 'aok-hidden',
        UNDERSCORE: '_',
        HIDDEN_TYPE: 'hidden',
        BUNDLE_AJAX_ATC_DECLARATIVE_ACTION: 'bundles-ajax-add-to-cart',
        BUNDLE_NATC_ACCOUNT_LINKING_DECLARATIVE_ACTION: 'bundles-account-linking-checkbox',
        ACCOUNT_LINKING_INPUT_NAME_NATC:
          'items[0.base][additionalParameters][devicePreregistration][selected]',
        BUNDLE_NATC_INSTALLMENTS_DECLARATIVE_ACTION: 'bundles-installments-checkbox',
        INSTALLMENTS_INPUT_NAME_NATC:
          'items[0.base][additionalParameters][installments][programId]',
        ACCOUNT_LINKING_INPUT_ID_PREFIX: 'bundles-drawer-natc-accountLinking-',
        INSTALLMENTS_INPUT_ID_PREFIX: 'bundles-drawer-natc-installments-',
        ACCESSORY_ATC_DECLARATIVE_ACTION: 'bundles-ajax-accessory-atc',
        ITEM_COUNT_PLACEHOLDER: '{NUM_OF_ITEMS}',
      },
      n = {
        accessoryAtcButton: '.bundles-drawer-ajax-accessory-atc-button',
        accessoryAtcCard: '.bundles-drawer-accessory-atc-card',
        accessoryAtcErrorContent: '.bundles-drawer-accessory-atc-error-content',
        accessoryAtcSpinner: '.bundles-drawer-accessory-atc-spinner',
        accessoryAtcSuccessContainer: '.bundles-drawer-accessory-atc-success-container',
        accessoryAtcSuccessContent: '.bundles-drawer-accessory-atc-success-content',
        accessoryOfferListingId: '[name\x3d"accessory-offer-listing-id"]',
        upsellRecommendationSection: '#bundle-upsell-recommendations-',
        successCount: '.bundles-drawer-success-count',
        proceedToCheckoutText: '.bundles-drawer-proceed-to-checkout-text',
        addedItemImage: '.bundles-drawer-added-item-image',
        subTotalPrice: '.bundles-drawer-accessory-sub-total-price',
        subTotalContainer: '.bundles-drawer-accessory-sub-total-container',
      }
    b.on(e.BUNDLES_CARD_SECONDARY_VIEW_ATC_READY, function () {
      h.resetData()
      c.getCartData(a.aapiEndpoint, a.csrfToken, a.marketplaceId).done(function (a) {
        t(a.entity)
      })
      c.getFullCartCount(a.aapiEndpoint, a.csrfToken, a.marketplaceId).done(function (a) {
        a.entity && h.setCartTotalCount(a.entity.items)
      })
    })
    b.declarative(k.BUNDLE_AJAX_ATC_DECLARATIVE_ACTION, 'click', function (b) {
      b = b.data
      var c = b.asin,
        e = f(g.bundlesDrawerSideSheet),
        B = e.find(g.atcButton + c),
        w = e.find(g.reachCartLimitMessage + c),
        r = e.find(g.atcErrorBlock + c)
      h.cartContainsItem(c)
        ? (B.addClass(k.AUI_HIDDEN_CLASS), w.removeClass(k.AUI_HIDDEN_CLASS))
        : ((e = d.createRequest(b.csrfToken, b.marketplaceId, b.aapiEndpoint)),
          (b = { asin: c, offerId: b.offerListingId, quantity: 1 }),
          (b = y(b)),
          e.addSingleAsinData(b),
          e.setRefTag('bundles_dsk_sec_view_bundle_atc'),
          x.logCount('bundlesDrawerBundleCartApiSent', 1),
          e.sendRequest(
            function (b) {
              h.setCartItemQuantity(c, 1)
              var d = h.getCartTotalCount()
              z(b.entity.count.entity.items)
              a.isDevices &&
                x.logRefTag('amzdv_tplus_dp_dsk_atc_' + a.landingAsin + k.UNDERSCORE + c)
              l()
              u(h.getCartTotalCount())
              b = f(g.bundlesDrawerSideSheet)
                .find(g.bundleExpanders + c)
                .find(g.bundleImage)
                .attr('src')
              var e = 0
              f(g.installmentsCheckbox + c).length &&
                q(g.installmentsCheckbox + c).isChecked() &&
                (e = h.getCartTotalCount() - d)
              d = f(g.installmentsMessageText).text()
              0 < e
                ? (f(g.installmentsMessageText).text(d.replace(k.ITEM_COUNT_PLACEHOLDER, e)),
                  f(g.installmentsMessage).toggleClass(k.AUI_HIDDEN_CLASS, !1))
                : f(g.installmentsMessage).toggleClass(k.AUI_HIDDEN_CLASS, !0)
              f(n.addedItemImage).attr('src', b)
              f(g.bundlesDrawerSideSheet).scrollTop(0)
              f(g.bundleContent).toggleClass(k.AUI_HIDDEN_CLASS, !0)
              f(g.postAddToCartContent)
                .find(n.upsellRecommendationSection + c)
                .toggleClass(k.AUI_HIDDEN_CLASS)
              f(g.postAddToCartContent).toggleClass(k.AUI_HIDDEN_CLASS)
            },
            function () {
              x.logCount('bundlesDrawerBundleCartApiFailed', 1)
              m.log(
                'An error has occurred with Cart API addItems request when add ' +
                  c +
                  ' from Secondary View.',
                'WARN',
              )
              a.isDevices &&
                x.logRefTag('amzdv_tplus_dp_dsk_failed_atc_' + a.landingAsin + k.UNDERSCORE + c)
              B.addClass(k.AUI_HIDDEN_CLASS)
              r.removeClass(k.AUI_HIDDEN_CLASS)
            },
          ))
    })
    b.declarative(k.ACCESSORY_ATC_DECLARATIVE_ACTION, 'click', function (c) {
      var e = c.data
      x.logCount('bundlesDrawerSideSheetAccessoryAtcClicked', 1)
      var g = e.bundleAsin,
        f = e.asin,
        q = c.$target.closest(n.accessoryAtcButton)
      q.toggleClass(k.AUI_HIDDEN_CLASS, !0)
      var r = q.closest(n.accessoryAtcCard),
        t = r.find(n.accessoryAtcSpinner)
      t.toggleClass(k.AUI_HIDDEN_CLASS)
      var y = r.find(n.accessoryAtcSuccessContent).find(n.accessoryAtcButton),
        A = r.find(n.accessoryAtcErrorContent)
      c = r.find(n.accessoryOfferListingId).val()
      var C = r.find(n.accessoryAtcSuccessContainer),
        D = C.find(n.successCount),
        e = d.createRequest(e.csrfToken, e.marketplaceId, e.aapiEndpoint)
      e.addSingleAsinData({ asin: f, offerId: c, quantity: 1 })
      e.setRefTag('bundles_dsk_sec_view_acc_atc')
      e.sendRequest(
        function (c) {
          z(c.entity.count.entity.items)
          A.toggleClass(k.AUI_HIDDEN_CLASS, !0)
          h.cartContainsItem(f)
            ? h.setCartItemQuantity(f, h.getCartItemQuantity(f) + 1)
            : h.setCartItemQuantity(f, 1)
          !h.getItemQuantityLimit(f) || h.getCartItemQuantity(f) < h.getItemQuantityLimit(f)
            ? b.delay(function () {
                l()
                u(h.getCartTotalCount())
                w(t, D, h.getCartItemQuantity(f), C)
                q.toggleClass(k.AUI_HIDDEN_CLASS, !1)
                y.toggleClass(k.AUI_HIDDEN_CLASS, !1)
              }, 3e3)
            : (l(), u(h.getCartTotalCount()), w(t, D, h.getCartItemQuantity(f), C))
          a.isDevices &&
            x.logRefTag(
              'amzdv_tplus_dp_dsk_patc_' + a.landingAsin + k.UNDERSCORE + g + k.UNDERSCORE + f,
            )
        },
        function () {
          x.logCount('bundlesDrawerSideSheetAccessoryAtcFailed', 1)
          t.toggleClass(k.AUI_HIDDEN_CLASS, !0)
          q.toggleClass(k.AUI_HIDDEN_CLASS, !1)
          y.toggleClass(k.AUI_HIDDEN_CLASS, !0)
          A.toggleClass(k.AUI_HIDDEN_CLASS, !1)
          m.log(
            'An error has occurred with desktop post atc screen add to cart request handler for ' +
              f,
            'WARN',
          )
          a.isDevices &&
            x.logRefTag(
              'amzdv_tplus_dp_dsk_failed_patc_' +
                a.landingAsin +
                k.UNDERSCORE +
                g +
                k.UNDERSCORE +
                f,
            )
        },
      )
    })
    b.declarative(k.BUNDLE_NATC_ACCOUNT_LINKING_DECLARATIVE_ACTION, 'change', function (a) {
      var b = a.data.asin,
        c = q(g.accountLinkingCheckbox + b).isChecked()
      a = f(g.bundlesDrawerSideSheet).find(g.natcForm + b)
      var d = a.find(g.accountLinkingHiddenInput + b)
      d && d.length && d.remove()
      b = f('\x3cinput\x3e', {
        type: k.HIDDEN_TYPE,
        name: k.ACCOUNT_LINKING_INPUT_NAME_NATC,
        value: c,
        id: k.ACCOUNT_LINKING_INPUT_ID_PREFIX + b,
      })
      a.append(b)
    })
    b.declarative(k.BUNDLE_NATC_INSTALLMENTS_DECLARATIVE_ACTION, 'change', function (a) {
      a = a.data.asin
      var b = q(g.installmentsCheckbox + a),
        c = f(g.installmentsCheckbox + a).val(),
        d = b.isChecked(),
        b = f(g.bundlesDrawerSideSheet).find(g.natcForm + a),
        e = b.find(g.installmentsHiddenInput + a)
      e && e.length && e.remove()
      d &&
        ((a = f('\x3cinput\x3e', {
          type: k.HIDDEN_TYPE,
          name: k.INSTALLMENTS_INPUT_NAME_NATC,
          value: c,
          id: k.INSTALLMENTS_INPUT_ID_PREFIX + a,
        })),
        b.append(a))
    })
  })
  ;('use strict')
  m.when('A', 'bundles-focus-management', 'ready').register(
    'bundles-drawer-side-sheet',
    function (b, d) {
      function e(a, b) {
        t = document.activeElement
        if (a) c('#bundle-expander-header-' + a).focus()
        else {
          if (b && ((a = c(l.SIDE_SHEET_CONTAINER).find(l.RELATED_BUNDLES)), a.length))
            return a.find('[id^\x3d"bundle-expander-header-"]:first').focus(), y
          c(l.SIDE_SHEET_CONTAINER).find('[id^\x3d"bundle-expander-header-"]:first').focus()
        }
      }
      var c = b.$,
        a,
        h,
        m,
        q = !1,
        t,
        z,
        r,
        l = {
          SIDE_SHEET_MODAL_LAYER: '#bundles-desktop-side-sheet-modal-wrapper',
          SIDE_SHEET_CONTAINER: '#bundles-desktop-side-sheet',
          SIDE_SHEET_DARK_BACKGROUND: '#bundles-side-sheet-bg',
          PAGE_BODY: 'body',
          RELATED_BUNDLES: '.related-bundles',
        },
        y = {
          initialize: function (b) {
            m = b
            c(l.SIDE_SHEET_CONTAINER).html(m)
            a = this.close
          },
          onKeyDown: function (b) {
            27 === b.which && a()
          },
          close: function () {
            b.delay(function () {
              b.hide(l.SIDE_SHEET_DARK_BACKGROUND)
            }, 400)
            c(l.SIDE_SHEET_CONTAINER).animate(
              { right: h },
              {
                duration: 500,
                complete: function () {
                  c(l.SIDE_SHEET_CONTAINER).addClass('aok-hidden')
                  c(l.SIDE_SHEET_MODAL_LAYER).addClass('aok-hidden')
                  c(document).unbind('keydown', this.onKeyDown)
                  c(l.PAGE_BODY).removeClass('bundles-scroll-disabled')
                  q = !1
                  t.focus()
                },
              },
            )
          },
          show: function (a, d, f) {
            c(l.SIDE_SHEET_CONTAINER).html(m)
            c(l.SIDE_SHEET_CONTAINER).scrollTop(0)
            c(l.SIDE_SHEET_MODAL_LAYER).removeClass('aok-hidden')
            c(l.SIDE_SHEET_CONTAINER).removeClass('aok-hidden')
            c(l.SIDE_SHEET_CONTAINER).animate({ right: '0' }, 500, 'linear')
            b.delay(function () {
              b.show(l.SIDE_SHEET_DARK_BACKGROUND)
            }, 400)
            c(l.PAGE_BODY).addClass('bundles-scroll-disabled')
            c(document).unbind('keydown', this.onKeyDown)
            c(document).keydown(this.onKeyDown)
            a && 'function' === typeof a && a(f)
            h = c(l.SIDE_SHEET_CONTAINER).css('right')
            q = !0
            e(f, d)
          },
          reset: function () {
            m = null
            q = !1
            t = null
            z = !1
            r = null
          },
          isReadyToShow: function () {
            return null !== m
          },
          updateContent: function (a) {
            m = a
          },
        }
      document.addEventListener(
        'focus',
        function (a) {
          if (q && !z) {
            var b = c(l.SIDE_SHEET_MODAL_LAYER).get(0)
            b.contains(a.target)
              ? (r = a.target)
              : ((z = !0),
                d.focusDescendant(b, 'first'),
                r === document.activeElement && d.focusDescendant(b, 'last'),
                (z = !1),
                (r = document.activeElement))
          }
        },
        !0,
      )
      return y
    },
  )
  ;('use strict')
  m.register('bundles-side-sheet-cart-data', function () {
    var b = {},
      d = {},
      e
    return {
      resetData: function () {
        b = {}
        d = {}
      },
      setCartItemQuantity: function (c, a) {
        b[c] = a
      },
      getCartItemQuantity: function (c) {
        return b[c]
      },
      cartContainsItem: function (c) {
        return c in b
      },
      setCartTotalCount: function (b) {
        e = b
      },
      getCartTotalCount: function () {
        return e
      },
      getItemQuantityLimit: function (b) {
        return d[b]
      },
      setItemQuantityLimit: function (b, a) {
        d[b] = a
      },
    }
  })
  ;('use strict')
  m.when('A', 'bundles-drawer-side-sheet', 'bundles-card', 'bundle-logger').execute(
    'register-bundles-side-sheet-declarative-actions',
    function (b, d, e, c) {
      var a = b.$
      b.declarative('open-bundles-drawer-side-sheet', 'click', function (a) {
        d.isReadyToShow() &&
          (e.isDevices && c.logRefTag('amzdv_tplus_dp_dsk_shown_all_' + e.landingAsin), d.show())
      })
      b.declarative('close-bundles-side-sheet', 'click', function (a) {
        d.close()
      })
      b.on('a:expander:bundle-components-expander:toggle:expand', function (b) {
        a('#bundles-secondary-view .bundle-expander-header-highlighted')
          .removeClass('bundle-expander-header-highlighted')
          .addClass('bundle-expander-header')
        e.isDevices &&
          ((b = b.expander.$expander
            .closest('.secondary-bundle-container')
            .find("[name\x3d'bundle-asin']")
            .val()),
          c.logRefTag('amzdv_tplus_dp_dsk_witb_' + e.landingAsin + '_' + b))
      })
    },
  )
  ;('use strict')
  m.register('bundles-focus-management', function () {
    return {
      attemptFocus: function (b) {
        try {
          b.focus()
        } catch (d) {}
        return b === document.activeElement
      },
      focusDescendant: function (b, d) {
        if (b && b.children)
          for (var e = 0; e < b.children.length; e++) {
            var c = b.children.item('last' === d ? b.children.length - e - 1 : e)
            if (this.attemptFocus(c) || this.focusDescendant(c, d)) return !0
          }
        return !1
      },
    }
  })
})
/* ******** */
;(function (d) {
  var f = window.AmazonUIPageJS || window.P,
    h = f._namespace || f.attributeErrors,
    a = h ? h('FreshDetailPageDesktopAssets', '') : f
  a.guardFatal
    ? a.guardFatal(d)(a, window)
    : a.execute(function () {
        d(a, window)
      })
})(function (d, f, h) {
  d.when('A', 'afx-update-cart-count', 'fresh-dp-prevent-atc-default', 'ready').register(
    'fresh-dp-add-to-cart',
    function (a, c, b) {
      var e = !1
      return {
        init: function (a) {
          e ||
            (d.when('fresh-atc-handler').execute(function (a) {
              a.addToFreshCart({
                success: function (a) {},
                error: function (a, e, g, c) {
                  d.log('Error adding to Cart on Fresh Detail Page', 'Error')
                },
              })
            }),
            (e = !0))
          b.init()
        },
      }
    },
  )
  d.when('A', 'afx-utils', 'ready').register('fresh-show-atc-changeover', function (a, c) {
    var b = a.$,
      e = b('#afx-atc-changeover')
    return function (b) {
      if (b && 0 < e.length && c.isFunction(e.find)) {
        var g = a.state('fresh-atc-toast-text')
        g &&
          g.atcToastTextString &&
          ((b = g.atcToastTextString.replace('FreshATCToastQuantity', b)),
          (g = e.find('.a-changeover-inner')) &&
            c.isFunction(g.text) &&
            (g.text(b), c.isFunction(e.show) && e.show()))
      }
    }
  })
  d.when('A', 'afx-utils', 'ready').register('fresh-show-atl-changeover', function (a, c) {
    a = a.$
    var b = a('#afx-atl-changeover')
    return function () {
      0 < b.length && c.isFunction(b.show) && b.show()
    }
  })
  ;('use strict')
  d.when('jQuery', 'ready').register('fresh-featurebullets', function (a) {
    var c = (function () {
        var a = !1
        return {
          getIsExpanded: function () {
            return a
          },
          toggleExpanded: function (b) {
            a = !a
            b && b(a)
          },
        }
      })(),
      b = function (b) {
        var c = function () {
          var c = a('#fbSection')
          c.fadeTo(200, 0.75, null, function () {
            b.toggleExpanded(function (b) {
              if (b) {
                b = a('#fbSection')
                var d = a('#feature-bullets')
                d.find('.a-vertical').removeClass('collapsedFeatureBullets')
                b.addClass('expandedFeatureBullets')
                a('#fbExpandableSection').addClass('expanded')
                b.find('h1').addClass('expandedFBHeader')
                a('#featureBulletsPlaceholder').addClass('FBplaceholder')
                d.find('#fbExpanderMoreButtonSection').hide()
                a('#feature-bullets')[0].offsetHeight < a('#feature-bullets')[0].scrollHeight &&
                  (a('.fadeTextTopforFB').show(), a('.fadeTextBottomforFB').show())
                b.find('.closeFB').removeClass('aok-hidden')
              } else
                (b = a('#fbSection')),
                  (d = a('#feature-bullets')),
                  b.find('.closeFB').addClass('aok-hidden'),
                  a('#featureBulletsPlaceholder').removeClass('FBplaceholder'),
                  d.find('.a-vertical').addClass('collapsedFeatureBullets'),
                  a('#fbExpandableSection').removeClass('expanded'),
                  b.removeClass('expandedFeatureBullets'),
                  b.find('h1').removeClass('expandedFBHeader'),
                  a('.fadeTextTopforFB').hide(),
                  a('.fadeTextBottomforFB').hide(),
                  d.find('#fbExpanderMoreButtonSection').show()
              c.fadeTo(200, 1)
            })
          })
        }
        return {
          init: function () {
            a('.fadeTextTopforFB').hide()
            a('.fadeTextBottomforFB').hide()
            var d = a('#fbExpandableSection'),
              f = a('#fbExpandableSectionContent')
            f.height() > d.height() &&
              (f.addClass('expandableSection'),
              f.click(c),
              a('#fbExpanderMoreButtonSection').removeClass('aok-hidden'),
              a('#feature-bullets').find('.moreFB').click(c),
              (d = a('#fbSection')),
              d.find('.closeFB').click(c),
              d.hover(null, function () {
                b.getIsExpanded() && c()
              }))
          },
        }
      }
    return {
      init: function () {
        new b(c).init()
      },
    }
  })
  d.when('A', 'a-modal', 'ready').execute(function (a, c) {
    var b = a.$
    a = a.state('glowEligibilityState')
    a !== h &&
      a.glowModalDisplayEligible &&
      'desktop' === a.deviceType &&
      ((c = c.get(b('#dpGlowModal'))),
      c.attrs('ajaxHeaders', { 'anti-csrftoken-a2z': b('#glowValidationToken').val() || '' }),
      c.show())
  })
})
/* ******** */
;(function (f) {
  var d = window.AmazonUIPageJS || window.P,
    F = d._namespace || d.attributeErrors,
    a = F ? F('FreshDetailPageCommonAssets', '') : d
  a.guardFatal
    ? a.guardFatal(f)(a, window)
    : a.execute(function () {
        f(a, window)
      })
})(function (f, d, F) {
  f.when(
    'A',
    'jQuery',
    'a-modal',
    'afx-dp-uatc-proxy',
    'afx-update-cart-count',
    'a-dropdown',
    'fresh-dp-double-click',
    'afx-dp-csm-metrics-utils',
    'fresh-show-atc-changeover',
    'fresh-dp-quantity',
    'afx-utils',
    'ready',
  ).register('fresh-atc-handler', function (a, e, d, c, p, m, n, b, t, r, g) {
    var q
    f.when('EWC').execute(function (b) {
      q = b
    })
    f.when('nav.getFlyout').execute(function (b) {
      b('ewc')
    })
    var A = {
      'itemPrice:priceUnavailable:1': 'PRICE_UNAVAILABLE',
      'itemDeleted:itemCountOverflow:6': 'QUANTITY_OVERFLOW',
    }
    return {
      addToFreshCart: function (m) {
        function k(b, a, l, h) {
          w(b)
          m.error(b, a, l, h)
        }
        function w(h, c) {
          c = c || {}
          var g = h.data.sessionID
          c.title = D(h.data.title)
          c.asin = h.data.asin
          c.offerListingID = h.data.offerListingID
          c.sessionID = g
          switch (c.reasonCode ? c.reasonCode : F) {
            case y.itemNotAvailable:
              b.increment(l.freshUATCItemNotAvailableErrorCountMetric)
              break
            case y.itemPartiallyAvailable:
              b.increment(l.freshUATCItemPartiallyAvailableErrorCountMetric)
              break
            case y.itemPartiallyAvailableForReservation:
              b.increment(l.freshUATCItemPartiallyAvailableForReservationErrorCountMetric)
              break
            case y.itemNotAvailableForReservation:
              b.increment(l.freshUATCItemNotAvailableForReservationErrorCountMetric)
              break
            case y.itemPriceUnavailable:
              b.increment(l.freshUATCItemPriceUnavailableErrorCountMetric)
              break
            case y.itemCountOverflow:
              b.increment(l.freshUATCItemCountOverflowErrorCountMetric)
              break
            default:
              b.increment(l.freshUATCEmptyItemStatusCodeErrorCountMetric),
                f.log('fresh-atc-handler: No error status code.', 'ERROR')
          }
          c = e.param(c)
          d.create(h.$currentTarget, {
            name: 'fresh-add-to-cart-modal',
            sessionID: g,
            url: '/afx/cart/reservation_conflict?' + c,
          }).show()
          a.on('a:popover:afterHide:fresh-add-to-cart-modal', function (b) {
            u(g)
            d.remove(b.popover)
          })
        }
        function D(b) {
          var a = { '\x26amp;': '\x26' },
            h
          for (h in a) a.hasOwnProperty(h) && (b = b.replace(h, a[h]))
          return b
        }
        function B(b) {
          return b.filter(function (b) {
            return b.statusKey in A
          })
        }
        function h(b, a, h) {
          h += ' returned by UATC is not an array'
          f.log(h, 'Error', a)
          k(b, '', '', h)
        }
        function x(e, g, d) {
          d || (d = function () {})
          try {
            var m = e.data.asin
            if (m)
              if (e.data.title) {
                var z = e.data.offerListingID
                if (z) {
                  var t = e.data.sessionID
                  if (t) {
                    var n = r.val()
                    n ||
                      (f.log('fresh-atc-handler: "quantity" action parameter is missing.', 'ERROR'),
                      (n = 1))
                    b.setWidgetClickTimestamp(l.freshUATCTCallScope)
                    c({
                      asin: m,
                      offerListingID: z,
                      sessionID: t,
                      quantity: n,
                      reftag: 'afx-dp-addtocart',
                      success: function (c) {
                        try {
                          b.sendWidgetMetrics(l.freshUATCTCallScope)
                          var m
                          if (c && c.isOK) {
                            var z = c.extraErrorInfos
                            if (z && z.constructor === Array && 0 < z.length) m = !0
                            else {
                              var r = c.statusList,
                                C
                              if (r && r.constructor === Array && 0 < r.length) {
                                var y = B(r)
                                C = y && 0 < y.length
                              } else C = !1
                              m = C ? !0 : !1
                            }
                          } else m = !0
                          if (m)
                            if ((b.increment(l.freshUATCInvalidErrorResponseCountMetric), c))
                              if (c.isOK) {
                                var p = c.extraErrorInfos,
                                  u = c.statusList
                                if (p && p.constructor !== Array) h(e, p, 'extraErrorInfos')
                                else if (0 < p.length) {
                                  if (p && !(0 >= p.length)) {
                                    var x = p[0]
                                    'ADDRESS_NOT_SELECTED' === x.statusCode
                                      ? (b.increment(l.freshUATCAddressNotSelectedErrorCountMetric),
                                        f.log(
                                          'fresh-atc-handler: Address is not selected.',
                                          'INFO',
                                        ))
                                      : w(e, {
                                          reasonCode: x.itemStatusCode,
                                          quantityAdded: x.availableQuantity,
                                          quantityRequested: x.requestedQuantity,
                                        })
                                  }
                                } else if (u && u.constructor !== Array) h(e, u, 'statusList')
                                else if (0 < u.length && u && !(0 >= u.length)) {
                                  var q = B(u)
                                  q && 0 < q.length && w(e, { reasonCode: A[q[0].statusKey] })
                                }
                              } else
                                b.increment(l.freshUATCFailureCountMetric),
                                  k(e, '', '', 'isOK returned by UATC is false')
                            else
                              b.increment(l.freshUATCFailureCountMetric),
                                k(e, '', '', 'No response from UATC')
                          else b.increment(l.freshUATCSuccessCountMetric), g(c, t, n)
                        } catch (v) {
                          b.increment(l.freshAddToCartExceptionCountMetric),
                            f.log('fresh-atc-handler exception: ' + v, 'ERROR')
                        } finally {
                          a.delay(d, E.reEnableDelay)
                        }
                      },
                      error: function (h, c, g) {
                        try {
                          b.sendWidgetMetrics(l.freshUATCTCallScope),
                            b.increment(l.freshUATCFailureCountMetric),
                            k(e, h, c, g)
                        } catch (m) {
                          b.increment(l.freshAddToCartExceptionCountMetric),
                            f.log('fresh-atc-handler exception: ' + m, 'ERROR')
                        } finally {
                          a.delay(d, E.reEnableDelay)
                        }
                      },
                    })
                  } else
                    f.log(
                      'fresh-atc-handler: Required "sessionID" action parameter is missing.',
                      'ERROR',
                    ),
                      b.increment(l.freshAddToCartMissingParameterCountMetric),
                      k(e)
                } else
                  f.log(
                    'fresh-atc-handler: Required "offerListingID" action parameter is missing.',
                    'ERROR',
                  ),
                    b.increment(l.freshAddToCartMissingParameterCountMetric),
                    k(e)
              } else
                f.log('fresh-atc-handler: Required "title" action parameter is missing.', 'ERROR'),
                  b.increment(l.freshAddToCartMissingParameterCountMetric),
                  k(e)
            else
              f.log('fresh-atc-handler: Required "asin" action parameter is missing.', 'ERROR'),
                b.increment(l.freshAddToCartMissingParameterCountMetric),
                k(e)
          } catch (C) {
            b.increment(l.freshAddToCartExceptionCountMetric),
              f.log('fresh-atc-handler exception: ' + C, 'ERROR'),
              a.delay(d, E.reEnableDelay)
          }
        }
        function u(b) {
          q && 'function' === typeof q.refresh ? q.refresh() : p(b)
        }
        var E = { reEnableDelay: 1e3 },
          l = {
            freshAddToCartClickCountMetric: 'freshAddToCartClickCount',
            freshAddToCartMissingParameterCountMetric: 'freshAddToCartMissingParameterCount',
            freshAddToCartExceptionCountMetric: 'freshAddToCartExceptionCount',
            freshUATCTCallScope: 'freshUATCCall',
            freshUATCSuccessCountMetric: 'freshUATCSuccessCount',
            freshUATCFailureCountMetric: 'freshUATCFailureCount',
            freshUATCInvalidErrorResponseCountMetric: 'freshUATCInvalidErrorResponseCount',
            freshUATCAddressNotSelectedErrorCountMetric: 'freshUATCAddressNotSelectedErrorCount',
            freshUATCItemPartiallyAvailableErrorCountMetric:
              'freshUATCItemPartiallyAvailableErrorCount',
            freshUATCItemPartiallyAvailableForReservationErrorCountMetric:
              'freshUATCItemPartiallyAvailableForReservationErrorCount',
            freshUATCItemNotAvailableErrorCountMetric: 'freshUATCItemNotAvailableErrorCount',
            freshUATCItemNotAvailableForReservationErrorCountMetric:
              'freshUATCItemNotAvailableForReservationErrorCount',
            freshUATCEmptyItemStatusCodeErrorCountMetric: 'freshUATCEmptyItemStatusCodeErrorCount',
            freshUATCItemPriceUnavailableErrorCountMetric:
              'freshUATCItemPriceUnavailableErrorCount',
            freshUATCItemCountOverflowErrorCountMetric: 'freshUATCItemCountOverflowErrorCount',
          },
          y = {
            itemNotAvailable: 'ITEM_NOT_AVAILABLE',
            itemPartiallyAvailable: 'ITEM_PARTIALLY_AVAILABLE',
            itemPartiallyAvailableForReservation: 'ITEM_PARTIALLY_AVAILABLE_FOR_RESERVATION',
            itemNotAvailableForReservation: 'ITEM_NOT_AVAILABLE_FOR_RESERVATION',
            itemPriceUnavailable: 'PRICE_UNAVAILABLE',
            itemCountOverflow: 'QUANTITY_OVERFLOW',
          },
          C = function (b, h, a) {
            t(a)
            u(h)
            m.success(b)
          }
        a.declarative(
          'fresh-atc-handler',
          'click',
          n(function (h, a) {
            r.valid()
              ? (g.vibrate(), b.increment(l.freshAddToCartClickCountMetric), x(h, C, a))
              : a()
          }),
        )
      },
    }
  })
  ;('use strict')
  f.when('A', 'jQuery', 'a-button', 'fresh-show-atl-changeover', 'ready').register(
    'FreshAddToShoppingList',
    function (a, e, d, c) {
      function p(b) {
        e('#' + b.asin + '-afx-atl-dropdown').change(function (a) {
          b.$alreadyInMessage.addClass('aok-hidden')
          b.$errorMessage.addClass('aok-hidden')
        })
      }
      function m(b) {
        var e = (a.state('baseWidgetState') || {}).csrfToken
        a.post('/afx/lists/json/shoppinglists/additem', {
          cache: !1,
          timeout: 5e3,
          params: { asin: b.asin, listID: b.shoppingListID, token: e },
          success: function (a) {
            b.addButtonInstance.enable()
            a.successful
              ? (b.$modalParent.find('#' + b.cancelButtonID).click(), c())
              : 1 === a.errorCodes[0]
                ? b.$alreadyInMessage.removeClass('aok-hidden')
                : n(b)
          },
          error: function () {
            b.addButtonInstance.enable()
            n(b)
          },
        })
      }
      function n(b) {
        b.$errorMessage.removeClass('aok-hidden')
        f.log('Failed to add asin ' + b.asin + ' to shopping list ' + b.shoppingListID, 'ERROR')
      }
      a.declarative('add-to-list', 'click', function (b) {
        var a = b.$currentTarget.closest('.a-popover-wrapper')
        if (1 > a.length)
          f.log(
            'Could not find the element that parents this modal (it should contain class a-popover wrapper)',
            'FATAL',
          )
        else {
          var c = a.find('#' + b.data.addButtonID),
            e
          1 > c.length
            ? (f.log(
                'Could not find the button that will add the item. This is required for preventing double clicks',
                'ERROR',
              ),
              (e = !1))
            : b.data.asin
              ? (e = !0)
              : (f.log(
                  'ASIN was blank. Please supply the ASIN you wish to add to the list.',
                  'ERROR',
                ),
                (e = !1))
          e &&
            ((c = d(c)),
            c.isEnabled() &&
              (c.disable(),
              (b = {
                asin: b.data.asin,
                addButtonInstance: c,
                $modalParent: a,
                cancelButtonID: b.data.cancelButtonID,
                shoppingListID: a.find('#' + b.data.asin + '-afx-atl-dropdown').val(),
                $alreadyInMessage: a.find('#afx-atl-already-in'),
                $errorMessage: a.find('#afx-atl-service-error'),
              }),
              b.$alreadyInMessage.addClass('aok-hidden'),
              b.$errorMessage.addClass('aok-hidden'),
              p(b),
              m(b)))
        }
      })
    },
  )
  ;('use strict')
  f.when(
    'A',
    'jQuery',
    'fresh-add-to-cart',
    'fresh-dp-quantity',
    'fresh-show-atc-changeover',
  ).execute(function (a, e, d, c, p) {
    d.addToFreshCart({
      success: function (a, c) {
        p(a.data.renderableSellingQuantity ? a.data.renderableSellingQuantity : a.data.quantity)
        a = c.couponClipStatus
        if ('CLIP_SUCCESSFUL' === a || 'ALREADY_CLIPPED' === a)
          e('#unclippedCoupon').hide(), e('#clippedCoupon').show()
      },
      error: function (a, c, b, e) {},
    })
    c.init()
    a.on('a:pageUpdate', function () {
      c.init()
      d.updateQuantity('freshAddToCartButton', c.val())
    })
    d.updateQuantity('freshAddToCartButton', c.val())
    a.declarative('freshDetailPageQuantityUpdate', 'change', function (a) {
      d.updateQuantity('freshAddToCartButton', c.val())
    })
    f.when('fresh-atfc-hook').execute(function (a) {
      a.callback()
    })
  })
  f.when(
    'A',
    'jQuery',
    'a-dropdown',
    'fresh-dp-constants',
    'fresh-add-to-cart',
    'a-button',
  ).register('fresh-dp-quantity', function (a, e, d, c, f, m) {
    return (function () {
      var n,
        b,
        t,
        r,
        g,
        q,
        A,
        v,
        k,
        w,
        D,
        B,
        h,
        x = function () {
          if (!n) {
            b = e(c.addToCartButtonSelector)
            g = d.getSelect(c.dropdownID)
            if ((t = !!g)) {
              r = e(c.dropdownDivSelector)
              var a = g.getOptions().size()
              a && (A = a - 1)
            }
            v = e(c.freeTextDivSelector)
            if ((q = 0 !== v.length))
              (k = e(c.freeTextInputSelector)),
                (w = e(c.freeTextErrorDivsSelector)),
                (D = e(c.freeTextErrorMsgMin)),
                (B = e(c.freeTextErrorMsgMax))
          }
        },
        u = function () {
          a.on(c.dropdownSelectedID, function (a) {
            e(a.nativeItemNode).index() === A
              ? (k.attr('validValue', h),
                k.val(h),
                v.show(),
                w.hide(),
                r.hide(),
                k.focus().select(),
                g.val('1'))
              : (h = g.val())
          })
          var l = function () {
              var a = k.attr('validValue')
              a &&
                (g.val(a),
                g.val() === a
                  ? ((h = a), r.show(), v.hide())
                  : (f.updateQuantity('freshAddToCartButton', a), b.focus()))
            },
            d = function () {
              var a = E(k.val())
              k.attr('validValue', a ? a : '')
            }
          k.change(d)
          k.keyup(d)
          k.keypress(function (a) {
            if (
              0 === a.which ||
              8 === a.which ||
              a.ctrlKey ||
              a.altKey ||
              c.rxNumbersOnly.test(String.fromCharCode(a.which))
            )
              return !0
            13 === a.which && (l(), b.click())
            return !1
          })
          k.blur(l)
        },
        E = function () {
          var a
          a: {
            a = k.val()
            if (c.rxNumbersOnly.test(a) && ((a = parseInt(a, 10)), !isNaN(a))) break a
            a = !1
          }
          w.hide()
          var b = m(c.addToCartButtonSelector)
          if (!1 === a || 0 >= a) D.show(), b.isEnabled() && b.disable()
          else if (1e3 <= a) B.show()
          else return b.isEnabled() || b.enable(), String(a)
          return !1
        }
      return {
        init: function () {
          n = !1
          x()
          n = !0
          if (q) {
            v.hide().removeClass(c.auiHiddenClass)
            w.hide().removeClass(c.auiHiddenClass)
            var a = g.getOption(A),
              b = a.info()[0].text
            a.update({ value: '0', text: e.trim(b) + '+' })
            h = g.val()
            u()
          }
        },
        valid: function () {
          x()
          return q && v.is(':visible') ? !1 !== E() : !0
        },
        val: function () {
          x()
          return q && v.is(':visible') ? k.attr('validValue') : t ? g.val() : 1
        },
      }
    })()
  })
  f.register('fresh-dp-constants', function () {
    return {
      actionPanelStateData: 'apstate',
      actionPanelFreshState: 'fresh',
      mobileNavSearchFormSelector: '#nav-search-form, form[role\x3d"search"], #searchForm',
      rxNumbersOnly: /^\d+$/,
      auiHiddenClass: 'aok-hidden',
      addToCartButtonSelector: '#freshAddToCartButton',
      dropdownID: 'freshQuantity',
      dropdownSelectedID: 'a:dropdown:selected:freshQuantity',
      dropdownDivSelector: '#quantitySelect',
      freeTextDivSelector: '#quantityText',
      freeTextInputSelector: '#quantityTextInput',
      freeTextErrorDivsSelector: '#quantityTextErrors \x3e div',
      freeTextErrorMsgMin: '#quantityFreeTextErrorMsgMin',
      freeTextErrorMsgMax: '#quantityFreeTextErrorMsgMax',
    }
  })
  f.when('A', 'afx-dp-csm-metrics-utils', 'ready').execute(function (a, e) {
    a.on('a:expander:ingredients-expander:toggle:expand', function (a) {
      e.increment('almIngredientsExpand')
    })
    a.on('a:expander:ingredients-expander:toggle:collapse', function (a) {
      e.increment('almIngredientsCollapse')
    })
  })
  f.when('A', 'ready').register('fresh-dp-prevent-atc-default', function (a) {
    return {
      init: function () {
        a.$('#addToFreshCart').submit(function (a) {
          a.preventDefault()
        })
      },
    }
  })
  ;('use strict')
  f.when('A', 'jQuery', 'a-button', 'ready').register(
    'fresh-multiselleroffers-pagination-handler',
    function (a, e, d) {
      function c(a) {
        var c = parseInt(n.attr('data-currentPage'), 10),
          d = parseInt(n.attr('data-pageCount'), 10),
          c = 'next' === a ? c + 1 : c - 1
        n.attr('data-currentPage', c)
        0 === c ? b.disable() : b.enable()
        c === d - 1 ? t.disable() : t.enable()
        e('.freshMultiSellerOffer').addClass('hidden')
        e('.freshMultiSellerOffer[data-page\x3d"' + c + '"]').removeClass('hidden')
      }
      var f = e('#freshMultiSellerOffersPreviousPage'),
        m = e('#freshMultiSellerOffersNextPage'),
        n = e('#freshMultiSellerOffersPagination'),
        b = d(f),
        t = d(m)
      a.declarative.create(f, 'fresh-multiselleroffers-previous-page', {})
      a.declarative.create(m, 'fresh-multiselleroffers-next-page', {})
      a.declarative('fresh-multiselleroffers-previous-page', 'click', function (a) {
        b.isEnabled() && c('previous')
      })
      a.declarative('fresh-multiselleroffers-next-page', 'click', function (a) {
        t.isEnabled() && c('next')
      })
    },
  )
  ;('use strict')
  f.register('afx-dp-csm-metrics-utils', function () {
    return {
      setWidgetClickTimestamp: function (a) {
        d.ue && d.uet && a && d.uet('bb', a, { wb: 1 })
      },
      setWidgetTimestamp: function (a, e) {
        d.ue && d.uet && a && e && d.uet(a, e, { wb: 1 })
      },
      increment: function (a) {
        d.ue && d.ue.count && a && d.ue.count(a, (d.ue.count(a) || 0) + 1)
      },
      setCount: function (a, e) {
        d.ue && d.ue.count && a && e && d.ue.count(a, e)
      },
      sendWidgetMetrics: function (a) {
        d.ue && d.uex && a && d.uex('ld', a, { wb: 1 })
      },
    }
  })
  ;('use strict')
  f.when('A', 'jQuery', 'a-button', 'ready').register('fresh-dp-double-click', function (a, e, d) {
    return function (c) {
      var e = { disabled: 'true' },
        d = {}
      return function (f) {
        var b = a.state('fresh-atc-status')
        ;(b && b.disabled) ||
          (b && a.state('fresh-atc-status', e),
          c(f, function () {
            ;(b = a.state('fresh-atc-status')) && a.state.replace('fresh-atc-status', d)
          }))
      }
    }
  })
  ;('use strict')
  f.register('afx-utils', function () {
    return {
      isFunction: function (a) {
        return 'function' === typeof a
      },
      isDefined: function (a) {
        return 'undefined' !== typeof a
      },
      vibrate: function () {
        return (
          d.amazon &&
          d.amazon.cordova &&
          d.amazon.cordova.notification &&
          d.amazon.cordova.notification.vibrate &&
          d.amazon.cordova.notification.vibrate(50)
        )
      },
    }
  })
  ;('use strict')
  f.when('A', 'jQuery', 'fresh-show-atl-changeover', 'afx-dp-csm-metrics-utils', 'ready').register(
    'FreshAddToAlexaLists',
    function (a, e, z, c) {
      function p(a) {
        c.increment(g.countAddToAlexaList)
        a.data.isAlmInStoreMode && c.increment(g.countISMAddToAlexaList)
        c.setWidgetClickTimestamp(g.addToAlexaListCallTime)
        t(a)
        var b = Date.now(),
          k = n(a)
        e.ajax({
          url: a.data.url,
          type: 'POST',
          contentType: 'application/json',
          Accept: 'application/json',
          timeout: 5e3,
          dataType: 'json',
          data: JSON.stringify(a.data.alexaListV2Payload),
          headers: { 'x-amzn-as-metadata': JSON.stringify(k) },
          success: function (e) {
            c.sendWidgetMetrics(g.addToAlexaListCallTime)
            c.increment(g.addToAlexaListCallSuccess)
            if (a.data.isUnifiedMobileCx) {
              a.$currentTarget
                .find('.afx-dp-add-to-alexa-list-unified-mobile-text')
                .addClass('aok-hidden')
              a.$currentTarget
                .find('.afx-dp-added-to-alexa-list-unified-mobile-text')
                .removeClass('aok-hidden')
              var d = a.$currentTarget.find('button')
              d.prop('disabled', !0)
              a.data.isMobileWfm
                ? d.addClass('afx-dp-add-to-alexa-list-unified-mobile-wfm-success')
                : d.addClass('afx-dp-add-to-alexa-list-unified-mobile-success')
            } else z()
            m(b, Date.now(), a, e)
            r(a)
          },
          error: function (b, e, k) {
            c.sendWidgetMetrics(g.addToAlexaListCallTime)
            c.increment(g.addToAlexaListCallFail)
            f.log('Error response: ' + b.responseText, 'ERROR')
            b.status === B
              ? a && a.data && a.data.signInURL && (d.location = a.data.signInURL)
              : f.log(
                  'Failed to add item to shopping list ' + a.data.title + ', url : ' + a.data.url,
                  'ERROR',
                )
            r(a)
          },
        })
      }
      function m(a, c, d, g) {
        a =
          0 < g.itemInfoList.length
            ? b(a, c, d.data.underscoredBrandName, d.data.sessionId, g.itemInfoList[0])
            : {
                eventName: q + v,
                eventType: k,
                eventVersion: 1,
                pageName: k + w + d.data.underscoredBrandName,
                eventStartTime: a,
                delay: c - a,
                listType: 'SHOP',
                isDefaultList: !0,
                sessionId: d.data.sessionId,
              }
        d = n(d)
        e.ajax({
          url: D,
          type: 'POST',
          contentType: 'application/json',
          Accept: 'application/json',
          timeout: 5e3,
          dataType: 'json',
          data: JSON.stringify(a),
          headers: { 'x-amzn-as-metadata': JSON.stringify(d) },
          error: function (a, b, c) {
            f.log('Error response: ' + a.responseText, 'ERROR')
          },
        })
      }
      function n(a) {
        var b = a.data.alexaListV2Payload.items[0]
        return {
          requestType: a.data.requestType,
          applicationName: 'unknown',
          applicationVersion: 'unknown',
          ssnapVersion: 0,
          rnVersion: 'unknown',
          osName: 'unknown',
          osVersion: 'unknown',
          appId: 'unknown',
          bundleVersion: 'unknown',
          isBeta: !1,
          localeInfo: {
            marketplaceId: a.data.marketplaceCountryCode,
            localeId: b.locale,
            marketplaceObfuscatedId: b.marketplaceId,
          },
          deviceInfo: { model: 'unknown', manufacturer: 'unknown' },
          stage: 'Prod',
        }
      }
      function b(a, b, c, e, d) {
        return {
          eventName: q + A,
          eventType: k,
          eventVersion: 1,
          pageName: k + w + c,
          eventStartTime: a,
          delay: b - a,
          listId: d.listId,
          listType: 'SHOP',
          isDefaultList: !0,
          sessionId: e,
          item: {
            id: d.itemId,
            listId: d.listId,
            value: d.itemName,
            encryptedValue: d.encryptedItemName,
            updatedDateTime: d.updateAt,
            createdDateTime: d.createAt,
            customerId: d.customerId,
            version: 1,
            itemType: d.itemType,
          },
        }
      }
      function t(a) {
        a.data.isUnifiedMobileCx
          ? (a.$currentTarget.addClass('aok-hidden'),
            a.$currentTarget
              .siblings('.afx-dp-add-to-alexa-list-unified-mobile-spinner')
              .removeClass('aok-hidden'))
          : (a.$currentTarget.find('.afx-dp-add-to-alexa-list-link').addClass('aok-hidden'),
            a.$currentTarget
              .siblings('.afx-dp-add-to-alexa-list-spinner')
              .removeClass('aok-hidden'))
      }
      function r(a) {
        a.data.isUnifiedMobileCx
          ? (a.$currentTarget
              .siblings('.afx-dp-add-to-alexa-list-unified-mobile-spinner')
              .addClass('aok-hidden'),
            a.$currentTarget.removeClass('aok-hidden'))
          : (a.$currentTarget.siblings('.afx-dp-add-to-alexa-list-spinner').addClass('aok-hidden'),
            a.$currentTarget.find('.afx-dp-add-to-alexa-list-link').removeClass('aok-hidden'))
      }
      a.declarative('add-to-alexa-lists', 'click', function (a) {
        r(a)
        p(a)
      })
      var g = {
          countAddToAlexaList: 'countAddToAlexaList',
          addToAlexaListCallTime: 'addToAlexaListCallTime',
          addToAlexaListCallSuccess: 'addToAlexaListCallSuccess',
          addToAlexaListCallFail: 'addToAlexaListCallFail',
          countISMAddToAlexaList: 'countISMAddToAlexaList',
        },
        q = 'ADD_ITEM_',
        A = 'SUCCESS',
        v = 'FAILURE',
        k = 'F3_Detail_Page',
        w = '_',
        D = '/alexashoppinglists/api/logevents',
        B = 401
    },
  )
  f.when('A', 'afx-dp-csm-metrics-utils', 'ready').execute(function (a, d) {
    a.on('a:expander:alm-nutrition-information-expander:toggle:expand', function () {
      document.querySelectorAll('.js-hide-when-nutrition-info-expanded').forEach(function (a) {
        a.style.display = 'none'
      })
      d.increment('almNutritionalInformationExpand')
    })
    a.on('a:expander:alm-nutrition-information-expander:toggle:collapse', function () {
      document.querySelectorAll('.js-hide-when-nutrition-info-expanded').forEach(function (a) {
        a.style.display = ''
      })
      d.increment('almNutritionalInformationCollapse')
    })
  })
  f.when('A', 'afx-dp-csm-metrics-utils', 'ready').execute(function (a, d) {
    a.declarative('almCRIngress-click-metrics', 'click', { allowLinkDefault: !0 }, function (a) {
      d.increment('almCustomerReviewsATF')
    })
  })
  ;('use strict')
  f.when('A', 'afx-dp-csm-metrics-utils', 'dpContextualIngressPtTrigger', 'ready').execute(
    function (a, d, f) {
      a.declarative('alm-change-to-fulfillment-type-button', 'click', function (a) {
        if (a.data !== F) {
          var p = a.data
          d.increment('almChangeTo_' + p.fulfillmentType + '_' + p.almBrandId)
          f.showGlowModal(a)
        }
      })
    },
  )
})
/* ******** */
;(function (e) {
  var g = window.AmazonUIPageJS || window.P,
    l = g._namespace || g.attributeErrors,
    b = l ? l('DetailPageOffersDPv2Assets', '') : g
  b.guardFatal
    ? b.guardFatal(e)(b, window)
    : b.execute(function () {
        e(b, window)
      })
})(function (e, g, l) {
  e.when('A', 'jQuery', 'a-popover', 'cf').register(
    'actionpanel-modified-popover',
    function (b, d, c) {
      return function (f, e) {
        function l() {
          b.on.scroll(function () {
            var a = c.get(f)
            if (a && a.isActive()) {
              var b = a.$container.get(0).getBoundingClientRect()
              if (0 > b.bottom || 0 > b.right) a.attrs('originalFocus', null), a.hide()
            }
          })
        }
        function p() {
          var a = d(e)
          m.popoverHandle = c.create(a, {
            closeButton: !1,
            closeButtonLabel: a.attr('data-close-button-label') || 'close',
            position: 'triggerBottom',
            name: f,
            popoverLabel: a.attr('data-popover-label') || f,
            width: '400',
            activate: b.capabilities.touch ? 'onmouseover' : 'onclick',
          })
          b.capabilities.touch &&
            a.bind('touchend', function (b) {
              m.popoverHandle.isActive() || a.trigger('mouseenter')
            })
          b.on('a:popover:afterShow:' + f, q)
          b.on('a:popover:afterHide:' + f, r)
          b.on('a:popover:afterUpdatePosition:' + f, t)
        }
        function u() {
          k = d('#actionPanelOverlay')
          if (!k.length) {
            var a = document.createElement('div')
            h.length &&
              ((a.id = 'actionPanelOverlay'),
              (k = d(a)
                .addClass('action-panel-overlay')
                .css({ width: h.outerWidth(), top: h.position().top })
                .bind('touchend click', function (a) {
                  return !1
                })),
              h.append(a))
          }
        }
        function t(a) {
          var b,
            c = a.popover.$trigger.get(0).getBoundingClientRect()
          b = g.pageYOffset
            ? g.pageYOffset
            : 'CSS1Compat' === (document.compatMode || '')
              ? document.documentElement.scrollTop
              : document.body.scrollTop
          var d = h.get(0).getBoundingClientRect().left + 8
          a.popover.$container.css({ top: c.top + b + 'px', left: d + 'px' })
        }
        function n() {
          var a = h.get(0).getBoundingClientRect()
          k.css('height', a.bottom - a.top + 'px')
        }
        function q(a) {
          n()
          k.show()
          a.popover.$container.hasClass('burj-action-panel-modified-popover') ||
            a.popover.$container.addClass('burj-action-panel-modified-popover')
          a.popover.$trigger.trigger('ActionPanelModifiedPopover.showPopover', a)
        }
        function r(a) {
          k.hide()
          a.popover.$trigger.trigger('ActionPanelModifiedPopover.hidePopover', a)
        }
        var h = d('#actionPanel'),
          k,
          m = this
        h.length && (p(), u(), l(), d(g).resize(n))
      }
    },
  )
  e.when('jQuery').register('action-panel', function (b) {
    var d =
      'ap-onetime ap-sns ap-deal ap-pospromo ap-mom ap-fresh ap-oos ap-b2brd ap-used ap-sampling'.split(
        ' ',
      )
    return {
      setPanelState: function (c) {
        if (c.mode) {
          for (var f = b('#actionPanel'), e = 0; e < d.length; e++) f.removeClass(d[e])
          c = 'ap-' + c.mode
          0 <= b.inArray(c, d) && f.addClass(c)
        }
      },
    }
  })
  e.when('jQuery', 'action-panel').register('toggleBB', function (b, d) {
    return {
      init: function () {
        b('input[name\x3d"toggleBuyBox"]:radio').change(function () {
          var c = b(this).attr('value')
          d.setPanelState({ mode: c })
          'onetime' === c || 'used' === c
            ? b('#csffsFeaturecontainer').removeClass('a-hidden')
            : b('#csffsFeaturecontainer').addClass('a-hidden')
        })
      },
    }
  })
})
/* ******** */
;(function (e) {
  var h = window.AmazonUIPageJS || window.P,
    n = h._namespace || h.attributeErrors,
    a = n ? n('DetailPagePInfoDPv2Assets', '') : h
  a.guardFatal
    ? a.guardFatal(e)(a, window)
    : a.execute(function () {
        e(a, window)
      })
})(function (e, h, n) {
  e.when('jQuery', 'ready').register('burj-featurebullets', function (a) {
    var f = !1,
      b,
      c,
      d = function () {
        c.fadeTo(200, 0.75, null, function () {
          f
            ? (c.find('.closeFB').addClass('aok-hidden'),
              a('#featureBulletsPlaceholder').removeClass('FBplaceholder'),
              b.find('.a-vertical').addClass('collapsedFeatureBullets'),
              a('#fbExpandableSection').removeClass('expanded'),
              c.removeClass('expandedFeatureBullets'),
              c.find('h1').removeClass('expandedFBHeader'),
              a('.fadeTextTopforFB').hide(),
              a('.fadeTextBottomforFB').hide(),
              b.find('#fbExpanderMoreButtonSection').show(),
              (f = !1))
            : (b.find('.a-vertical').removeClass('collapsedFeatureBullets'),
              c.addClass('expandedFeatureBullets'),
              a('#fbExpandableSection').addClass('expanded'),
              c.find('h1').addClass('expandedFBHeader'),
              a('#featureBulletsPlaceholder').addClass('FBplaceholder'),
              b.find('#fbExpanderMoreButtonSection').hide(),
              a('#feature-bullets')[0].offsetHeight < a('#feature-bullets')[0].scrollHeight &&
                (a('.fadeTextTopforFB').show(), a('.fadeTextBottomforFB').show()),
              c.find('.closeFB').removeClass('aok-hidden'),
              (f = !0))
          c.fadeTo(200, 1)
        })
      }
    return {
      init: function () {
        b = a('#feature-bullets')
        c = a('#fbSection')
        a('.fadeTextTopforFB').hide()
        a('.fadeTextBottomforFB').hide()
        var k = a('#fbExpandableSection'),
          g = a('#fbExpandableSectionContent')
        g.height() > k.height() &&
          (g.addClass('expandableSection'),
          g.click(function () {
            d()
          }),
          a('#fbExpanderMoreButtonSection').removeClass('aok-hidden'),
          b.find('.moreFB').click(function () {
            d()
          }),
          c.find('.closeFB').click(function () {
            d()
          }),
          c.hover(null, function () {
            f && d()
          }))
      },
    }
  })
  e.when('jQuery', 'atf').register('title-burj', function (a) {
    var f,
      b,
      c,
      d,
      k,
      g,
      q,
      n,
      r,
      l,
      m,
      p,
      u,
      v = function () {
        k.text(g)
        if (m && f.height() < b.height()) {
          l.removeClass('aok-hidden')
          if (r) {
            n = g
            for (var a = 0, d = g.length - 1; a < d; ) {
              k.text(g)
              var e = g,
                h = a + Math.floor((d - a) / 2),
                p = e.indexOf(' ', h)
              e = e.substring(0, -1 !== p ? p : e.length - 1)
              k.text(e + '...')
              f.height() < b.height() ? (d = h - 1) : ((a = h + 1), (n = k.text()))
            }
            r = !1
          }
          k.text(n)
          c.addClass('showPointerOnHover')
          q = !0
        } else m && (l.addClass('aok-hidden'), c.removeClass('showPointerOnHover'), (q = !1))
      },
      t = function () {
        if (q) {
          var a = f.position().top
          b.fadeTo(200, 0.75, function () {
            m
              ? (u(),
                l.removeClass('expand').addClass('collapse titleToggleClickedState'),
                f.addClass('expandedTitle'),
                b.css('top', a),
                d.css('top', a - 8))
              : (p(),
                l.removeClass('collapse').addClass('expand titleToggleClickedState'),
                f.removeClass('expandedTitle'),
                b.css('top', ''),
                d.css('top', ''))
            m = !m
            v()
            d.height(b.height() + 16)
            b.fadeTo(200, 1, function () {
              l.removeClass('titleToggleClickedState')
            })
          })
        }
      },
      x = function () {
        m || t()
      },
      w = function () {
        r = !0
        v()
      }
    return {
      init: function () {
        f = a('#title_feature_div')
        b = a('#titleSection')
        c = a('#title')
        d = a('#titleOverlay')
        k = a('#productTitle')
        g = k.text()
        q = !1
        m = !0
        l = a('#expandTitleToggle')
        e.when('A', 'a-tooltip', 'atf').execute(function (a, b) {
          p = function () {
            b.create(l, {
              content: a.state('titleExpanderTooltipState').content,
              position: 'triggerTop',
            })
          }
          u = function () {
            b.remove(l)
          }
          m && p()
        })
        a('#socialFabric').append(a('\x3chr class\x3d"a-spacing-medium a-divider-normal"\x3e'))
        w()
        a(h).resize(w)
        c.click(t)
        l.click(t)
        b.hover(null, x)
      },
    }
  })
})
/* ******** */
;(function (g) {
  var e = window.AmazonUIPageJS || window.P,
    h = e._namespace || e.attributeErrors,
    d = h ? h('DetailPageFeaturesAssets', '') : e
  d.guardFatal
    ? d.guardFatal(g)(d, window)
    : d.execute(function () {
        g(d, window)
      })
})(function (g, e, h) {
  e.P &&
    (g.when('A', 'jQuery', 'atf').execute(function (d, b) {
      e.registeredDPApplicablePromotionListComponent ||
        g.register('DPApplicablePromotionListComponent', function () {
          return {
            recordImpressions: function () {},
            adjustPromotionMessageWidth: function () {
              var a = b('.apl_popover_hover').width() + b('.apl_label').width() + 10
              if (a) {
                var c = b('.apl_popover_hover').parent().parent().width()
                if (c && !(c <= a)) {
                  var d = b('.apl_popover_hover .apl_message').width()
                  d &&
                    ((a = c - a + d),
                    (c = parseInt(b('.apl_popover_hover .apl_message').css('max-width'), 10)),
                    !isNaN(c) &&
                      c !== a &&
                      60 <= a &&
                      b('.apl_popover_hover .apl_message').css('max-width', a + 'px'))
                }
              }
            },
          }
        })
      e.registeredDPApplicablePromotionListComponent = !0
    }),
    g.when('A', 'ready').execute(function (d) {
      var b = d.$('#applicable_promotion_list_sec'),
        a = d.$('#mediaTabsGroup #mediaAccordion')
      a &&
        a.length &&
        b &&
        b.length &&
        (((a = d.$('#mediaTabsGroup #newOfferAccordionRow')) && a.length) || b.addClass('a-hidden'),
        d.on('a:accordion:media-accordion:select', function (a) {
          'media-newOffer-accordion' === a.selectedRow.rowName
            ? b.removeClass('a-hidden')
            : b.addClass('a-hidden')
        }))
    }))
  ;('use strict')
  e.P &&
    g.when('A', 'ready').execute(function (d) {
      var b = d.$
      e.registeredDPApplicablePromotionListClaimCodeButtonComponent ||
        g.register('registeredDPApplicablePromotionListClaimCodeButtonComponent', function () {
          return {
            init: function () {
              e.registeredDPApplicablePromotionListClaimCodeButtonPageStates ||
                (d.state('aplDetailPageRedemption', { redeemedCoupons: [] }),
                d.state('aplDetailpageStateData', { visitedAsins: [] }),
                (e.registeredDPApplicablePromotionListClaimCodeButtonPageStates = !0))
            },
            isAplVisitedAsins: function (a) {
              var c = d.state('aplDetailpageStateData'),
                f = c ? c.visitedAsins : null
              if (f)
                if (-1 < b.inArray(a, f)) {
                  if ((a = (a = d.state('aplDetailPageRedemption')) ? a.redeemedCoupons : null))
                    for (c = 0; c < a.length; c++)
                      (f = a[c]),
                        b('#RedeemB_' + f).addClass('a-hidden'),
                        b('#RedeemM_' + f).removeClass('a-hidden'),
                        0 !== b('#hvaCoupon .apl_badgeHvaCoupon').length &&
                          b('#hvaCoupon .apl_badgeHvaCoupon').addClass(
                            'apl_badgeHvaCoupon_redeemed',
                          )
                } else f.push(a), (c.visitedAsins = f), d.state('aplDetailpageStateData', c)
            },
            bindClaimPromoEvent: function () {
              b('.apl_redeem').click(function () {
                var a = d.$(this).attr('id')
                b('#RedeemB_' + a).addClass('a-button-disabled')
                b.ajax({
                  url: '/gp/collect-coupon/handler/redeem-coupon-detailpage.html?ref_\x3dapl_redeem_coupon',
                  type: 'POST',
                  data: { encryptedPromotionId: a },
                  dataType: 'json',
                  success: function (c) {
                    if (1 == c.status) {
                      b('#RedeemB_' + a).addClass('a-hidden')
                      b('#RedeemM_' + a).removeClass('a-hidden')
                      g.when('PromotionUpellComponent').execute(function (b) {
                        b.showRedeemedNote(a)
                      })
                      var f = (c = d.state('aplDetailPageRedemption')) ? c.redeemedCoupons : null
                      if (f) {
                        for (var k = !1, l = f.length; l--; )
                          if (f[l] === a) {
                            k = !0
                            break
                          }
                        k ||
                          (f.push(a),
                          (c.redeemedCoupons = f),
                          d.state('aplDetailPageRedemption', c))
                      }
                    } else e.location.reload()
                  },
                  error: function () {
                    e.location.reload()
                  },
                })
              })
              b('.apl_login').click(function () {
                var a = b(this).attr('id'),
                  c = encodeURIComponent(e.location.pathname)
                e.location.href =
                  '/gp/collect-coupon/handler/redeem_coupon_after_login.html?path\x3d' +
                  c +
                  '\x26encryptedPromotionId\x3d' +
                  a
              })
            },
            showRedeemedNote: function (a) {
              if (b('#RedeemB_' + a).length) {
                b('#RedeemB_' + a).addClass('a-hidden')
                b('#RedeemM_' + a).removeClass('a-hidden')
                var c = d.state('aplDetailPageRedemption'),
                  f = c ? c.redeemedCoupons : null
                if (f) {
                  for (var e = !1, g = f.length; g--; )
                    if (f[g] === a) {
                      e = !0
                      break
                    }
                  e || (f.push(a), (c.redeemedCoupons = f), d.state('aplDetailPageRedemption', c))
                }
              }
            },
          }
        })
      e.registeredDPApplicablePromotionListClaimCodeButtonComponent = !0
    })
})
/* ******** */
;(function (a) {
  var c = window.AmazonUIPageJS || window.P,
    d = c._namespace || c.attributeErrors,
    b = d ? d('DetailPagePromotionalBundleAssets', '') : c
  b.guardFatal
    ? b.guardFatal(a)(b, window)
    : b.execute(function () {
        a(b, window)
      })
})(function (a, c, d) {
  a.when('A', 'ready').execute('kbpMobileExpander', function (b) {
    var a = b.$
    a('.pb-bundle-section-expander').click(function (b) {
      a('.pb-bundle-mobile-box').removeClass('aok-hidden')
      a('.pb-bundle-expander-box').addClass('aok-hidden')
    })
  })
})
/* ******** */
;(function (n) {
  var l = window.AmazonUIPageJS || window.P,
    t = l._namespace || l.attributeErrors,
    f = t ? t('DetailPageSnSAssets@dpxAssets', 'DetailPageSnSAssets') : l
  f.guardFatal
    ? f.guardFatal(n)(f, window)
    : f.execute(function () {
        n(f, window)
      })
})(function (n, l, t) {
  n.when('sns-join-prime-endpoint', 'sns-subscribe-constants').register(
    'sns-buybox-constants',
    function (f, b) {
      return {
        SNS_QUANTITY_FIELD: '#mobileQuantityDropDown, #tabletQuantityDropDown',
        SNS_FREQUENCY_NAME: 'rcxOrdFreq',
        SNS_OPT_IN_NAME: 'snsOptIn',
        QUANTITY_CONTAINER: '#selectQuantity, #mobileQuantitySelection, #sns',
        QUANTITY: '[name\x3dquantity]',
        SNS_QUANTITY: '[name\x3drcxsubsQuan]',
        SNS_SELECTED_FREQUENCY: '#rcxOrdFreqSns',
        ONML_SELECTED_FREQUENCY: '#rcxOrdFreqOnml',
        SNS_MOBILE_QUANTITY: ".snsQuantityRadio input[name\x3d'quantity']:checked",
        SNS_FREQUENCY_FORM_FIELD: '[name\x3drcxOrdFreq]',
        SNS_FREQUENCY_FORM_FIELD_MOBILE: '.rcxOrdFreq',
        SNS_ONMLV2_FREQUENCY_TRIGGER_DROPDOWN: 'a:dropdown:rcxOrdFreq:select',
        SNS_ONMLV2_FREQUENCY_TRIGGER_RADIO_BUTTON: '.snsOrdFreqRadio',
        SNS_ONMLV2_QUANTITY_TRIGGER_DROPDOWN: 'a:dropdown:rcxsubsQuan:select',
        SNS_ONMLV2_QUANTITY_TRIGGER_RADIO_BUTTON: '.snsQuantityRadio',
        SNS_ONMLV2_FREQUENCY_FORM_FIELD: "#onmlv2FormFields [name\x3d'rcxOrdFreq']",
        SNS_SUBSCRIBE_BUTTON_FREQUENCY_FORM_FIELD:
          "#subscribeButtonFormFields [name\x3d'rcxOrdFreq']",
        SNS_ONMLV2_QUANTITY_FORM_FIELD: "#onmlv2FormFields [name\x3d'quantity']",
        SNS_SUBSCRIBE_BUTTON_QUANTITY_FORM_FIELD: "#subscribeButtonFormFields [name\x3d'quantity']",
        SNS_ONMLV2_DELIVERY_OPTION_FORM_FIELD: '#onmlv2FormFields [name\x3d"snsDeliveryOption"]',
        SNS_SUBSCRIBE_BUTTON_DELIVERY_OPTION_FORM_FIELD:
          '#subscribeButtonFormFields [name\x3d"snsDeliveryOption"]',
        SNS_ONMLV2_QUANTITY_TRIGGER_DESKTOP: '#rcxsubsQuan',
        SNS_ONMLV2_QUANTITY_TRIGGER_MOBILE: '.snsQuantityRadio',
        SNS_DP_FREQUENCY_TRIGGER: '#sns-dp-frequency-trigger span',
        SNS_OPT_IN_CHECKBOX: '#snsOptInCheckbox',
        SNS_OFFER_LISTING_FIELD: '#snsOfferListingID',
        OFFER_LISTING_FIELD: '[name\x3dofferListingID]',
        SNS_FREQUENCY_SECTION: '#snsFrequencySection',
        SNS_SELECTED_FREQUENCY_LABEL: '#snsSelectedFrequencyLabel',
        SNS_FIRST_RECURRING_DELIVERY_DATE: '[id\x3dsnsFirstRecurringDeliveryDate]',
        SNS_BUY_USED_BUTTON: '#usedBuySection, #usedAccordionRow .a-accordion-row-a11y',
        ONE_CLICK_BUTTON: '.onml-one-click-button',
        ONE_CLICK_BUTTON_ICON: '.onml-one-click-button i',
        ONE_CLICK_BUTTON_TEXT: '.onml-one-click-button input+span',
        BUY_NOW_BUTTON: '.onml-buy-now-button',
        BUY_NOW_BUTTON_ICON: '.onml-buy-now-button i',
        BUY_NOW_BUTTON_TEXT: '.onml-buy-now-button input+span',
        ADD_TO_CART_BUTTON: '#add-to-cart-button',
        ADD_TO_CART_DIV: '#addToCart',
        DSK_BB: '#sns',
        DSK_BB_DPV1: '#snsBuyBox',
        MOBILE_ADD_TO_CART_DIV: '#sns',
        MOBILE_SNS_BUYBOX: '#snsBuyBox',
        TABLET_ADD_TO_CART_DIV: '#snsTablet',
        SNS_OPT_IN_FORM_FIELD: '[name\x3dsnsOptIn]',
        LEGACY_SPC_FORM_INPUT: "[name\x3d'submit.rcx-subscribe']",
        LEGACY_SPC_FORM_INPUT_X: "[name\x3d'submit.rcx-subscribe.x']",
        SNS_OFFER_FORM_FIELD: '.snsONMLOffer',
        SNS_DISCOUNT_PILL: '#snsDiscountPill',
        SNS_ONML_BUYBOX_UPSELL_MESSAGE_NON_TIERED: '#sns-onml-buybox-upsell-message-non-tiered',
        SNS_ONML_BUYBOX_UPSELL_MESSAGE_TIERED: '#sns-onml-buybox-upsell-message-tiered',
        SNS_ONML_FRDD: '.sns-onml-frdd',
        SNS_ONMLV2_FRDD: '.sns-onmlv2-frdd',
        SNS_FREQ_BOTTOMSHEET_SELECTOR: '[id\x3dsnsFrequencyBottomSheet]',
        SNS_OPT_IN_FEATURE_DIV: '#snsOptIn_div',
        SNS_OPT_IN_INPUT_ID: '[name\x3dsnsOptIn]',
        SNS_ONML_INIT_INPUT_ID: 'isOnmlInitialized',
        SNS_ONML_INIT_INPUT_SELECTOR: '#isOnmlInitialized',
        SNS_DATA_UPDATE_EVENT: 'sns-declarative-data-update',
        SNS_ONML_MERCHANT_INFO: '#snsOnmlMerchantInfo',
        SNS_DISCOUNT_PILL_POPOVER_TIERED: '.snsDiscountPillPopoverTiered',
        SNS_DISCOUNT_PILL_POPOVER_NON_TIERED: '.snsDiscountPillPopoverNonTiered',
        SNS_BUY_NEW_PRICE: '#onml_snsBuyNew',
        CBB_BUY_NEW_PRICE: '#buyNew_cbb',
        NON_CBB_BUY_NEW_PRICE: '#buyNew_noncbb',
        SNS_PRICE_IN_BUY_USED_SECTION: '#usedBuySection #onml_snsBuyNew',
        CBB_SNS_BUY_NEW_PRICE: '#onml_snsBuyNew_cbb',
        SNS_CBB_ACCORDION_ROW:
          '#snsAccordionRow, #snsAccordionRowMobile, #snsAccordionRowMobileApp, #snsAccordionRowMovedUp, #snsAccordionRowMobileMovedUp, #snsAccordionRowMobileAppMovedUp, #snsAccordionRowMiddle, #snsAccordionRowMobileMiddle, #snsAccordionRowMobileAppMiddle',
        SNS_ONMLV2_FORM_FIELDS: '#onmlv2FormFields',
        SUBSCRIBE_BUTTON_FORM_FIELDS: '#subscribeButtonFormFields',
        SNS_ACCORDION_HEADER_RADIO_BUTTON:
          '#snsAccordionRow [role\x3d"radio"], #snsAccordionRowMobile [role\x3d"radio"], #snsAccordionRowMobileApp [role\x3d"radio"], #snsAccordionRowMovedUp [role\x3d"radio"], #snsAccordionRowMobileMovedUp [role\x3d"radio"], #snsAccordionRowMobileAppMovedUp [role\x3d"radio"], #snsAccordionRowMiddle [role\x3d"radio"], #snsAccordionRowMobileMiddle [role\x3d"radio"], #snsAccordionRowMobileAppMiddle [role\x3d"radio"]',
        SNS_CBB_PRIME_SHIPPING: '#sns-cbb-prime-shipping-header, #sns-cbb-prime-shipping-row',
        DPV2_BUY_NEW_PRICE: '#buyNew_dpv2',
        SUBSCRIBE_ONLY_LINK: '#subscribe-only',
        SUBSCRIBE_ONLY_FORM: '#sns-onml-subscribe-only',
        JUST_SUBSCRIBE_DIV: '#just-subscribe-button-container',
        GOLDBOX_DISCOUNT_MESSAGE: '#onml-goldbox-discount-message',
        SUBSCRIBE_ONLY_FORM_ATTRIBUTES: {
          name: 'sns-onml-subscribe-only',
          id: 'sns-onml-subscribe-only',
          method: 'POST',
          action: '/gp/product/handle-buy-box/ref\x3donml_so_l',
        },
        SUBSCRIBE_ADD_TO_CART_FORM_ATTRIBUTES: b.SUBSCRIBE_FORM_ATTRIBUTES,
        JUST_SUBSCRIBE_FORM_ATTRIBUTES: {
          name: 'sns-onmlv2-just-subscribe',
          id: 'sns-onmlv2-just-subscribe',
          method: 'POST',
          action: '/gp/subscribe-and-save/pipeline/subscribe.html',
        },
        BUY_NOW_FORM_ATTRIBUTES: {
          name: 'sns-onmlv2-buy-now',
          id: 'sns-onmlv2-buy-now',
          method: 'POST',
          action: '',
        },
        SNS_LEGACY_SUBSCRIBE_FORM_ATTRIBUTES: {
          name: 'sns-legacy-subscribe',
          id: 'sns-legacy-subscribe',
          method: 'POST',
          action: '/gp/product/handle-buy-box',
        },
        SNS_JOIN_PRIME_FORM_ATTRIBUTES: {
          name: 'sns-join-prime',
          id: 'sns-join-prime',
          method: 'POST',
          action: '',
        },
        SNS_JOIN_PRIME_FORM_ATTRIBUTES_VMF: {
          name: 'sns-join-prime-vmf',
          id: 'sns-join-prime-vmf',
          method: 'POST',
          action: f.endpoint,
        },
        SUBSCRIBE_FORM_ATTRIBUTES: b.SUBSCRIBE_ADD_TO_CART_FORM_ATTRIBUTES,
        SNS_ATC_DECLARATIVE: '#addToCart_feature_div #atc-declarative',
        SNS_SUBMIT_SECTION_ID: '#snsSubmitSection',
        SNS_SWITCH_SUBMIT_SECTION_ID: '#snsSwitchSubmitSection',
        SNS_BUY_NOW_BUTTON: '#snsBuyNowSubmit',
        SNS_SUBSCRIBE_ONLY_BUTTON: '#snsSubscribeOnlySubmit',
        SNS_DECLARATIVE_ACTION: '#sns-submit-declarative',
        SNS_SUBSCRIBE_ONLY_ACTION: 'sns-subscribe-only',
        SNS_BUY_BOX_PARAMS: 'sns-buybox-message-params',
        SNS_BUY_BOX_PARAM_MAP: 'buyboxMessageParamsMap',
        SNS_SELECT_DELIVERY_URL:
          '/gp/subscribe-and-save/dp/delivery.html/ref\x3drcxsubs_sns_delivery_url?app-nav-type\x3dmodal',
        SNS_SELECT_DELIVERY_OPTION_ID: '#snsDeliveryOption',
        SNS_DELIVERY_OPTION_SNS: 'sns',
        SNS_DELIVERY_OPTION_ONML: 'onml',
        SNS_BASE_PRICE: '#sns-base-price',
        SNS_TIERED_PRICE: '#sns-tiered-price',
        SNS_DELIVERY_OPTION_DIV: '#snsDeliveryOpt',
        ONML_DELIVERY_OPTION_DIV: '#onmlDeliveryOpt',
        SNS_MOD_ACCORDION_HEADER_FEATURES:
          '#sns-cbb-prime-shipping-header-wrapper, #accordion-header-delivery-link',
        SNS_SUBSCRIPTION_PRICE: '#subscriptionPrice',
        SNS_DELIVERY_OPTION_SNS_LINK: '#sns-delivery-link',
        SNS_DELIVERY_OPTION_SNS_LINK_TEXT_IDENTIFIER: '#snsDeliveryChangeLinkText',
        ACCORDION_HEADER_DELIVERY_OPTION_SNS_LINK: '#accordion-header-sns-delivery-link',
        SNS_DELIVERY_OPTION_ONML_LINK: '#onml-delivery-link',
        SNS_DELIVERY_OPTION_ONML_LINK_TEXT_IDENTIFIER: '#onmlDeliveryChangeLinkText',
        ACCORDION_HEADER_DELIVERY_OPTION_ONML_LINK: '#accordion-header-onml-delivery-link',
        SNS_DELIVERY_BOTTOM_SHEET: '#snsDeliveryDateBottomSheet',
        SNS_DELIVERY_BOTTOM_SHEET_SPINNER: '#snsDeliveryDateBottomSheetSpinner',
        SNS_DELIVERY_BOTTOM_SHEET_CONTENT: '#snsDeliveryDateBottomSheetContent',
        SNS_SUBSCRIBE_SUBMIT_BUTTON: '#rcx-subscribe-submit-button',
        SNS_DELIVERY_UPSELL: '#sns-delivery-buybox-upsell-message',
        SNS_DELIVERY_NEW_OR_UNRECOGNIZED_UPSELL:
          '#sns-delivery-buybox-upsell-message-new-or-unrecognized',
        SNS_DELIVERY_NON_TIERED_UPSELL: '#sns-delivery-buybox-upsell-message-non-tiered',
        SNS_DELIVERY_TIERED_UPSELL: '#sns-delivery-buybox-upsell-message-tiered',
        ONML_DELIVERY_UPSELL: '#onml-delivery-buybox-upsell-message',
        ONML_DELIVERY_NEW_OR_UNRECOGNIZED_UPSELL:
          '#onml-delivery-buybox-upsell-message-new-or-unrecognized-sns-customer',
        ONML_DELIVERY_NON_TIERED_UPSELL: '#onml-delivery-buybox-upsell-message-non-tiered',
        ONML_DELIVERY_TIERED_UPSELL: '#onml-delivery-buybox-upsell-message-tiered',
        SNS_ADD_TO_CART_FORM: '#sns-onmlv2-add-to-cart',
        SNS_SUBSCRIBE_FORM: '#sns-onmlv2-subscribe',
        JUST_SUBSCRIBE_FORM: '#sns-onmlv2-just-subscribe',
        BUY_NOW_FORM: '#sns-onmlv2-buy-now',
        SNS_LEGACY_SUBSCRIBE_FORM: '#sns-legacy-subscribe',
        SNS_JOIN_PRIME_FORM: '#sns-join-prime',
        SNS_DELIVERY_PILL: '#sns-delivery-pill',
        SNS_DELIVERY_NEW_OR_UNRECOGNIZED_PILL:
          '#sns-delivery-new-or-unrecognized-sns-customer-pill',
        SNS_DELIVERY_NON_TIERED_PILL: '#sns-delivery-non-tiered-pill',
        SNS_DELIVERY_TIERED_PILL: '#sns-delivery-tiered-pill',
        ONML_DELIVERY_PILL: '#onml-delivery-pill',
        ONML_DELIVERY_NEW_OR_UNRECOGNIZED_PILL:
          '#onml-delivery-new-or-unrecognized-sns-customer-pill',
        ONML_DELIVERY_NON_TIERED_PILL: '#onml-delivery-non-tiered-pill',
        ONML_DELIVERY_TIERED_PILL: '#onml-delivery-tiered-pill',
        SNS_TOGGLE_BUY_BOX: '[name\x3dtoggleBuyBox]',
        SNS_ONMLV2_JOIN_PRIME_UPSELL: '#momAEmsg',
        SNS_ONMLV2_JOIN_PRIME_CHECKBOX: '#chkMom',
        SNS_ONMLV2_JOIN_PRIME_BUTTON: '#mom-join-button',
        SNS_DELIVERY_BOTTOMSHEET_IN_BUYBOX: '#snsDeliveryDateBottomSheet',
        SNS_SWITCH_WIDGET_ONML_URL: '/auto-deliveries/switchWidgetMobile?',
        SNS_SWITCH_WIDGET_LEGACY_URL: '/auto-deliveries/switchWidgetLegacy?',
        SNS_SWITCH_WIDGET_LEGACY_CONTINUE_URL: '/gp/subscribe-and-save/pipeline/subscribe.html?',
        SNS_SWITCH_WIDGET_ONML_DESKTOP_URL: '/auto-deliveries/ajax/switchWidgetAjax?',
        SNS_SWITCH_WIDGET_LEGACY_DESKTOP_URL: '/auto-deliveries/ajax/switchWidgetAjaxLegacy?',
        SNS_SWITCH_WIDGET_PARAMS: 'sns-switch-message-params',
        SNS_SWITCH_WIDGET_PARAM_MAP: 'switchMessageParamsMap',
        DISCOUNT_TYPE_ZERO_BASE: 'ZERO_BASE',
        DISCOUNT_TYPE_ZERO_STATIC: 'ZERO_STATIC',
        GET_MYD_RECOMMENDATIONS_URL: '/auto-deliveries/ajax/viewRecommendationsAjax',
        SOURCE_PAGE: 'dp',
        VIEW_CART_URL: '/gp/cart/view.html',
        GO_TO_CHECKOUT_URL: '/gp/cart/desktop/go-to-checkout.html?proceedToCheckout\x3d1',
        SNS_HUC_GET_TREATMENT_FORM_ID: 'sns-get-huc-treatment',
        SNS_ONML_MONTH: 'M|onml',
        SUBSCRIBE_FORM_FIELDS: b.FORM_FIELDS,
        SNS_ONML_SELECTED_FREQUENCY_TEXT: 'select[name\x3d"rcxOrdFreqOnml"] option:selected',
        SNS_ONML_NEXT_RECURRING_DELIVERY_DATE_TEXT: '.sns-onmlv2-frdd:first',
        SNS_BASE_DISCOUNT_MESSAGE: '.sns-base-discount-message',
        SNS_TIERED_DISCOUNT_MESSAGE: '.sns-tiered-discount-message',
        SNS_SUBSCRIBER_DISCOUNT_MESSAGE_STATE_ID: 'sns-subscriber-discount-message-data',
        SUBSCRIBER_DISCOUNT_MESSAGE_EXPERIMENT_ID:
          'CONSUMABLES_DP_SNS_APEX_SUBSCRIBER_DISCOUNT_MESSAGE_921625',
        REPLENISHMENT_SNS_FREQUENCY_POPOVER_ID: '#replenishment-sns-frequency-popover',
        REPLENISHMENT_ONML_FREQUENCY_POPOVER_ID: '#replenishment-onml-frequency-popover',
        REPLENISHMENT_ONML_FREQUENCY_INFO_POPOVER_ID: '#replenishment-onml-frequency-info-popover',
        REPLENISHMENT_SNS_FREQUENCY_INFO_POPOVER_ID: '#replenishment-sns-frequency-info-popover',
      }
    },
  )
  n.when(
    'A',
    'sns-utils',
    'sns-constants',
    'sns-buybox-constants',
    'sns-messaging-utils',
    'sns-atc-utils',
  ).register('sns-frequency-bottom-sheet', function (f, b, a, d, e, c) {
    return {
      init: function () {
        function g() {
          var a = k(d.SNS_FREQUENCY_FORM_FIELD).val()
          k(d.SNS_FREQ_BOTTOMSHEET_SELECTOR)
            .find('button[value\x3d' + a + ']')
            .click()
        }
        var k = f.$
        b.isMobileDevice() &&
          (b.registerCallbackForNameSpace(a.EVENT_NAMESPACE.FREQUENCY_HIDDEN_INPUT_CHANGE, g),
          b.registerCallbackForNameSpace(a.EVENT_NAMESPACE.PAGE_UPDATE, g),
          f.declarative('sns-frequency-selected', 'click', function (g) {
            var h = k(d.SNS_FREQUENCY_FORM_FIELD)
            g = g.$target
            var m = g.val(),
              p = {}
            p[d.SNS_FREQUENCY_NAME] = m
            c.setOnmlDeclaratives(p)
            h.val(m)
            l.setTimeout(function () {
              f.trigger(d.SNS_DATA_UPDATE_EVENT)
            }, 0)
            k(d.SNS_FIRST_RECURRING_DELIVERY_DATE).html(g.data('frdd-label'))
            k(d.SNS_SELECTED_FREQUENCY_LABEL).html(g.data('freq-button-label'))
            e.updateMessages(m)
            b.setOnmlUserPref(a.USER_PREFS_KEYS.SNS_FREQUENCY, m)
          }))
      },
    }
  })
  n.when(
    'A',
    'sns-constants',
    'sns-utils',
    'sns-buybox-constants',
    'sns-messaging-utils',
    'sns-atc-utils',
  ).register('sns-frequency-popover', function (f, b, a, d, e, c) {
    return {
      init: function () {
        function g() {
          var a = k(d.SNS_FREQUENCY_FORM_FIELD).val()
          k('[data-a-accordion-row-name\x3dfrequencyAccordionRow' + (a - 1) + '] a').click()
        }
        var k = f.$
        a.isMobileDevice() ||
          (a.registerCallbackForNameSpace(b.EVENT_NAMESPACE.FREQUENCY_HIDDEN_INPUT_CHANGE, g),
          f.on('a:accordion:sns-dp-frequency-accordion:select', function (g) {
            var h = k(d.SNS_FREQUENCY_FORM_FIELD),
              m = k(d.SNS_DP_FREQUENCY_TRIGGER),
              p = k(g.selectedRow.$row[0])
            g = p.data().frequencyLabel
            var p = p.data().frequencyValue,
              r = {}
            r[d.SNS_FREQUENCY_NAME] = p
            c.setOnmlDeclaratives(r)
            h.val(p)
            l.setTimeout(function () {
              f.trigger(d.SNS_DATA_UPDATE_EVENT)
            }, 0)
            m.text(g)
            e.updateMessages(p)
            a.setOnmlUserPref(b.USER_PREFS_KEYS.SNS_FREQUENCY, p)
          }))
      },
    }
  })
  n.when(
    'A',
    'sns-utils',
    'sns-constants',
    'sns-buybox-utils',
    'sns-buybox-constants',
    'sns-atc-utils',
  ).register('sns-opt-in-checkbox', function (f, b, a, d, e, c) {
    return {
      init: function () {
        function g(g) {
          var h = f.$(e.SNS_OPT_IN_CHECKBOX).is(':checked')
          g = f.$(e.SNS_OPT_IN_FORM_FIELD)
          h && (b.isMobileApp() || b.isTabletApp()) && c.getAddToCartStrings()
          var k = {}
          k[e.SNS_OPT_IN_NAME] = h
          c.setOnmlDeclaratives(k)
          g.val(h)
          l.setTimeout(function () {
            f.trigger(e.SNS_DATA_UPDATE_EVENT)
          }, 0)
          l.setTimeout(function () {
            d.updateAddToCartButtonLabel(h)
            d.updateOneClickButtonLabel(h)
            d.updateBuyNowButtonLabel(h)
          }, 0)
          d.showSnSMerchantInfoIfSnSOptInChecked(h)
          d.showGoldBoxDiscountMessageIfSnSOptInChecked(h)
          d.showSubscribeOnlyButtonIfSnSOptInChecked(h)
          b.setOnmlUserPref(a.USER_PREFS_KEYS.SNS_OPT_IN, h)
        }
        function k() {
          var a = (function () {
            var a = f.$('#buybox').find('.a-declarative').has('#add-to-cart-button')
            if (1 === a.length) return a
            a = f.$('#atc-declarative')
            return 1 === a.length ? a : null
          })()
          a &&
            a.click(function () {
              var g = c.getAddToCartData()
              if (g.inputs[e.SNS_OPT_IN_NAME] !== t) {
                var d = b.getAStateFromDom(
                    e.SNS_OPT_IN_FEATURE_DIV,
                    'sns-add-to-cart-params',
                    'addToCartParams',
                  ),
                  k = f.$(e.SNS_OPT_IN_CHECKBOX).is(':checked'),
                  r = {},
                  r = d || {}
                r[e.SNS_OPT_IN_NAME] = k
                var v = a.data('awMash')
                Object.keys(r).forEach(function (a) {
                  v.inputs[a] !== g.inputs[a] && (v.inputs[a] = g.inputs[a])
                })
              }
            })
        }
        b.isSnSEligible() && g({ snsOnLoad: !0 })
        f.declarative('sns-opt-in-checked', 'change', g)
        b.registerCallbackForNameSpace(a.EVENT_NAMESPACE.PAGE_UPDATE, g)
        b.registerCallbackForNameSpace(a.EVENT_NAMESPACE.PAGE_UPDATE, b.enableSnSOptIn)
        b.isMobileApp() && (b.registerCallbackForNameSpace(a.EVENT_NAMESPACE.PAGE_UPDATE, k), k())
        b.enableSnSOptIn()
      },
    }
  })
  n.when('A', 'sns-constants', 'sns-buybox-constants', 'sns-utils').register(
    'sns-messaging-utils',
    function (f, b, a, d) {
      var e = function (b, g) {
        var d = b.firstRecurringDeliveryDates[g - 1]
        f.$(a.SNS_ONML_FRDD).each(function () {
          f.$(this).html(d)
        })
      }
      return {
        updateMessages: function (c) {
          var g = d.getAStateFromDom(
            a.SNS_OPT_IN_FEATURE_DIV,
            'sns-buybox-message-params',
            'buyboxMessageParamsMap',
          )
          if (g) {
            var k = f.$(a.SNS_ONML_BUYBOX_UPSELL_MESSAGE_NON_TIERED),
              q = f.$(a.SNS_ONML_BUYBOX_UPSELL_MESSAGE_TIERED),
              h = f.$(a.SNS_DISCOUNT_PILL_POPOVER_TIERED),
              m = f.$(a.SNS_DISCOUNT_PILL_POPOVER_NON_TIERED)
            g.tieredStatusOnRecurringDeliveryDates[c - 1] === b.TIERED
              ? (k.addClass('aok-hidden'),
                q.removeClass('aok-hidden'),
                m.addClass('aok-hidden'),
                h.removeClass('aok-hidden'))
              : (k.removeClass('aok-hidden'),
                q.addClass('aok-hidden'),
                m.removeClass('aok-hidden'),
                h.addClass('aok-hidden'))
            k = g.discountType
            q = f.$(a.SNS_DISCOUNT_PILL)
            g.tieredStatusOnRecurringDeliveryDates[c - 1] === b.TIERED
              ? (q.attr('data-tiered-level', b.PREMIUM),
                k === b.ZERO_BASE && q.removeClass('aok-hidden'))
              : (q.attr('data-tiered-level', b.BASE), k === b.ZERO_BASE && q.addClass('aok-hidden'))
            e(g, c)
          }
        },
      }
    },
  )
  n.when('A', 'sns-buybox-constants', 'sns-onmlv2-utils', 'sns-moq-helper').register(
    'sns-buy-now',
    function (f, b, a, d) {
      var e = f.$
      f.declarative('sns-buy-now', 'click', function (c) {
        if (!d.isSnsLocked() && !d.isSnsLocked()) {
          c = e('\x3cform\x3e', {
            method: b.BUY_NOW_FORM_ATTRIBUTES.method,
            action: '/gp/subscribe-and-save/buynow/buy-now.html?ref\x3ddp_sns_bb_bn',
            id: b.BUY_NOW_FORM_ATTRIBUTES.id,
            name: b.BUY_NOW_FORM_ATTRIBUTES.name,
          })
          var g = ''
          if (a.isCbbTemplateEnabled())
            for (
              var k = [
                  { name: 'ASIN' },
                  { name: 'offerListingID', fieldName: 'snsOfferListingID' },
                  { name: 'snsAddressId' },
                  { name: 'snsOnmlOfferId' },
                  { name: 'snsMostCommonFrequency' },
                  { name: 'rcxOrdFreq' },
                  { name: 'quantity' },
                ],
                f = 0;
              f < k.length;
              f++
            )
              var h = k[f].name,
                m = k[f].fieldName ? k[f].fieldName : h,
                m = a.getOnmlv2FormValueByName(m),
                g = g + a.createHiddenInput(h, m)
          else {
            a.removeFormFieldsIntroducedByCbb()
            k = [
              { name: 'ASIN' },
              { name: 'offerListingID', fieldName: 'snsOfferListingID' },
              { name: 'rcxOrdFreq' },
              { name: 'snsOnmlOfferId' },
              { name: 'snsMostCommonFrequency' },
              { name: 'snsAddressId' },
            ]
            for (f = 0; f < k.length; f++)
              (h = k[f].name),
                (m = k[f].fieldName ? k[f].fieldName : h),
                (m = a.isMobileDevice()
                  ? e(b.MOBILE_ADD_TO_CART_DIV + ' [name\x3d' + m + ']').val()
                  : a.isWeb()
                    ? e(b.ADD_TO_CART_DIV + ' [name\x3d' + m + ']').val()
                    : e(b.TABLET_ADD_TO_CART_DIV + ' [name\x3d' + m + ']').val()),
                (g += a.createHiddenInput(h, m))
            k = a.isMobileDevice()
              ? e(b.SNS_MOBILE_QUANTITY)
              : e(b.QUANTITY_CONTAINER).find(b.SNS_QUANTITY)
            g += a.createHiddenInput('quantity', k.val())
          }
          g += a.createHiddenInput('submit.buy-now', '1')
          c.html(g)
          e('body').append(c)
          e(b.BUY_NOW_FORM).submit()
          e(b.BUY_NOW_FORM).remove()
        }
      })
    },
  )
  n.when('sns-join-prime-endpoint').register('sns-subscribe-constants', function (f) {
    return {
      SUBSCRIBE_ADD_TO_CART_FORM_ATTRIBUTES: {
        name: 'sns-onmlv2-add-to-cart',
        id: 'sns-onmlv2-add-to-cart',
        method: 'GET',
        action: '/auto-deliveries/checkout/subscribe',
      },
      SUBSCRIBE_FORM_ATTRIBUTES: {
        name: 'sns-onmlv2-subscribe',
        id: 'sns-onmlv2-subscribe',
        method: 'GET',
        action: '/auto-deliveries/checkout/subscribe',
      },
      FORM_FIELDS: [
        { name: 'snsAsin' },
        { name: 'rcxOrdFreqOnml' },
        { name: 'rcxOrdFreqSns' },
        { name: 'offerListingID', fieldName: 'snsOfferListingId' },
        { name: 'isTangoCheckoutEligible' },
      ],
    }
  })
  n.when('A', 'sns-buybox-constants', 'sns-onmlv2-utils', 'sns-moq-helper').register(
    'sns-subscribe-only',
    function (f, b, a, d) {
      var e = f.$
      f.declarative('sns-subscribe-only', 'click', function (c) {
        if (!d.isSnsLocked()) {
          c = e('\x3cform\x3e', {
            method: b.JUST_SUBSCRIBE_FORM_ATTRIBUTES.method,
            action: b.JUST_SUBSCRIBE_FORM_ATTRIBUTES.action,
            id: b.JUST_SUBSCRIBE_FORM_ATTRIBUTES.id,
            name: b.JUST_SUBSCRIBE_FORM_ATTRIBUTES.name,
          })
          var g = ''
          if (a.isCbbTemplateEnabled())
            for (
              var k = [
                  { name: 'ASIN' },
                  { name: 'snsMerchantID' },
                  { name: 'offerListingID', fieldName: 'snsOfferListingID' },
                  { name: 'longShipAddressId', fieldName: 'snsAddressId' },
                  { name: 'rcxOrdFreq' },
                  { name: 'quantity' },
                ],
                f = 0;
              f < k.length;
              f++
            )
              var h = k[f].name,
                m = k[f].fieldName ? k[f].fieldName : h,
                m = a.getOnmlv2FormValueByName(m),
                g = g + a.createHiddenInput(h, m)
          else {
            a.removeFormFieldsIntroducedByCbb()
            k = [
              { name: 'ASIN' },
              { name: 'offerListingID', fieldName: 'snsOfferListingID' },
              { name: 'rcxOrdFreq' },
              { name: 'snsMerchantID' },
              { name: 'longShipAddressId', fieldName: 'snsAddressId' },
            ]
            for (f = 0; f < k.length; f++)
              (h = k[f].name),
                (m = k[f].fieldName ? k[f].fieldName : h),
                (m = a.isMobileDevice()
                  ? e(b.MOBILE_ADD_TO_CART_DIV + ' [name\x3d' + m + ']').val()
                  : a.isWeb()
                    ? e(b.ADD_TO_CART_DIV + ' [name\x3d' + m + ']').val()
                    : e(b.TABLET_ADD_TO_CART_DIV + ' [name\x3d' + m + ']').val()),
                (g += a.createHiddenInput(h, m))
            k = a.isMobileDevice()
              ? e(b.SNS_MOBILE_QUANTITY)
              : e(b.QUANTITY_CONTAINER).find(b.SNS_QUANTITY)
            g += a.createHiddenInput('quantity', k.val())
          }
          g += a.createHiddenInput('ref', 'sns-subscribe-only')
          g += a.createHiddenInput('submit.subscribe-only', '1')
          c.html(g)
          e('body').append(c)
          e(b.JUST_SUBSCRIBE_FORM).submit()
          e(b.JUST_SUBSCRIBE_FORM).remove()
        }
      })
    },
  )
  n.when(
    'A',
    'a-dropdown',
    'a-modal',
    'sns-vmf-utils',
    'sns-onmlv2-utils',
    'sns-buybox-constants',
    'sns-constants',
  ).register('sns-select-delivery', function (f, b, a, d, e, c, g) {
    function k() {
      h('#sns-only-delivery-option-text').length &&
        (h('#sns-only-delivery-option-text').html(
          h('#sns-only-delivery-option-text')
            .html()
            .replace(/%_date_%/g, "\x3cspan class \x3d'sns-only-date'\x3e\x3c/span\x3e"),
        ),
        h('#sns-only-delivery-option-text').html(
          h('#sns-only-delivery-option-text')
            .html()
            .replace(/%_discount_%/g, "\x3cspan class \x3d'sns-only-discount'\x3e\x3c/span\x3e"),
        ),
        h('#onml-later-delivery-option-text').html(
          h('#onml-later-delivery-option-text')
            .html()
            .replace(/%_date-more-later_%/g, "\x3cspan class \x3d'sns-ml-date'\x3e\x3c/span\x3e"),
        ),
        h('#onml-later-delivery-option-text').html(
          h('#onml-later-delivery-option-text')
            .html()
            .replace(
              /%_discount-more-later_%/g,
              "\x3cspan class \x3d'sns-ml-discount'\x3e\x3c/span\x3e",
            ),
        ),
        h('#onml-now-delivery-option-text').html(
          h('#onml-now-delivery-option-text')
            .html()
            .replace(/%_date-one-now_%/g, "\x3cspan class \x3d'sns-one-now-date'\x3e\x3c/span\x3e"),
        ),
        h('#onml-now-delivery-option-text').html(
          h('#onml-now-delivery-option-text')
            .html()
            .replace(
              /%_discount-one-now_%/g,
              "\x3cspan class \x3d'sns-one-now-discount'\x3e\x3c/span\x3e",
            ),
        ))
      var a = e.getDeliveryInfoParam(),
        b = e.getDiscountOptionsParam(),
        k = e.getDiscountTypeParam(),
        f = e.getSnsFrequencyParam(),
        q = e.getOnmlFrequencyParam(),
        m = e.getOnmlDateParam(),
        r = d.getFrequencyIndex(g.DELIVERY_OPTION.SNS),
        p = d.getFrequencyIndex(g.DELIVERY_OPTION.ONML)
      if ('true' === h('#firstDeliveryOptionMessagesV2').val())
        h('#sns-only-delivery-option-text').html(f[r].firstDeliveryOptions[0].text),
          h('#onml-later-delivery-option-text').html(q[p].firstDeliveryOptions[0].text)
      else {
        var q = a.snsDates[r],
          a = a.onmlDates[p],
          r = f[r].highlightedDiscount,
          D = b[r],
          f = f[p].highlightedDiscount,
          p = b[f]
        k === c.DISCOUNT_TYPE_ZERO_BASE && 0 === f
          ? (h('.onmlNextDeliveryDate').addClass('aok-hidden'),
            h('.onmlNextDeliveryDateNoDiscount').removeClass('aok-hidden'))
          : k === c.DISCOUNT_TYPE_ZERO_STATIC
            ? (h('.onmlNextDeliveryDate').addClass('aok-hidden'),
              h('.onmlNextDeliveryDateNoDiscount').removeClass('aok-hidden'))
            : (h('.onmlNextDeliveryDate').removeClass('aok-hidden'),
              h('.onmlNextDeliveryDateNoDiscount').addClass('aok-hidden'))
        k === c.DISCOUNT_TYPE_ZERO_BASE && 0 === r
          ? (h('.snsDeliveryDate').addClass('aok-hidden'),
            h('.snsDeliveryDateNoDiscount').removeClass('aok-hidden'))
          : k === c.DISCOUNT_TYPE_ZERO_STATIC
            ? (h('.snsDeliveryDate').addClass('aok-hidden'),
              h('.snsDeliveryDateNoDiscount').removeClass('aok-hidden'))
            : (h('.snsDeliveryDate').removeClass('aok-hidden'),
              h('.snsDeliveryDateNoDiscount').addClass('aok-hidden'))
        h('.sns-only-date').html(q)
        h('.sns-only-discount').html(D)
        h('.sns-ml-date').html(a)
        h('.sns-ml-discount').html(p)
      }
      b = b[0]
      h('.sns-one-now-date').html(m)
      h('.sns-one-now-discount').html(b)
    }
    function q() {
      var a, b, k
      h(c.SNS_DELIVERY_OPTION_DIV).is(':checked')
        ? ((a = d.getFrequencyIndex(g.DELIVERY_OPTION.SNS)),
          (b = e.getSnsFrequencyParam()),
          h('#rcxOrdFreqSnsWrapper').removeClass('aok-hidden'),
          h('#rcxOrdFreqOnmlWrapper').addClass('aok-hidden'),
          h(c.REPLENISHMENT_SNS_FREQUENCY_POPOVER_ID).removeClass('aok-hidden'),
          h(c.REPLENISHMENT_ONML_FREQUENCY_POPOVER_ID).addClass('aok-hidden'),
          h(c.REPLENISHMENT_SNS_FREQUENCY_INFO_POPOVER_ID).removeClass('aok-hidden'),
          h(c.REPLENISHMENT_ONML_FREQUENCY_INFO_POPOVER_ID).addClass('aok-hidden'),
          (k = g.DELIVERY_OPTION.SNS))
        : ((a = d.getFrequencyIndex(g.DELIVERY_OPTION.ONML)),
          (b = e.getOnmlFrequencyParam()),
          h('#rcxOrdFreqOnmlWrapper').removeClass('aok-hidden'),
          h('#rcxOrdFreqSnsWrapper').addClass('aok-hidden'),
          h(c.REPLENISHMENT_ONML_FREQUENCY_POPOVER_ID).removeClass('aok-hidden'),
          h(c.REPLENISHMENT_SNS_FREQUENCY_POPOVER_ID).addClass('aok-hidden'),
          h(c.REPLENISHMENT_ONML_FREQUENCY_INFO_POPOVER_ID).removeClass('aok-hidden'),
          h(c.REPLENISHMENT_SNS_FREQUENCY_INFO_POPOVER_ID).addClass('aok-hidden'),
          (k = g.DELIVERY_OPTION.ONML))
      d.selectFrequency(b[a], k)
    }
    var h = f.$,
      m,
      p,
      r
    n.when('a-sheet').execute('sns-mobile-sheet', function (a) {
      p = a
    })
    f.declarative('sns-delivery-date-bottom-sheet', 'click', function (a) {
      h('#rcxOrdFreqOnmlWrapper').hasClass('aok-hidden')
        ? d.updateFrequencyIndex(h('[name\x3drcxOrdFreqSns]').prop('selectedIndex'))
        : d.updateFrequencyIndex(h('[name\x3drcxOrdFreqOnml]').prop('selectedIndex'))
      k()
      m ||
        ((a = {
          name: 'sns_delivery_bottom_sheet',
          preloadDomId: 'snsDeliveryDateBottomSheet',
          height: 270,
          closeType: 'message',
          closeMessage: h('#bottomSheetClose').val(),
          sheetType: 'web',
        }),
        (m = p.create(a)))
      p.showSheet(m)
    })
    f.declarative('sns-delivery-date', 'click', function (b) {
      h('#rcxOrdFreqOnmlWrapper').hasClass('aok-hidden')
        ? d.updateFrequencyIndex(h('[name\x3drcxOrdFreqSns]').prop('selectedIndex'))
        : d.updateFrequencyIndex(h('[name\x3drcxOrdFreqOnml]').prop('selectedIndex'))
      k()
      b = h(c.SNS_SUBMIT_SECTION_ID)
      var g = {
        dataStrategy: 'preload',
        header: h('#deliveryModalTitle').val(),
        name: 'sns-delivery-modal',
      }
      r || (r = a.create(b, g))
      r.show()
    })
    f.declarative('sns-delivery-cancel-btn', 'click', function (a) {
      r.hide()
    })
    f.declarative('sns-delivery-change-btn', 'click', function (a) {
      q()
      r.hide()
    })
    f.on('a:sheet:beforeHide:sns_delivery_bottom_sheet', function () {
      q()
    })
    f.on('a:sheet:beforeShow:sns_delivery_bottom_sheet', function () {
      var a = m.getContentContainer().find(c.SNS_DELIVERY_BOTTOM_SHEET),
        b = h('#a-popover-sns-delivery-modal').find(c.SNS_DELIVERY_BOTTOM_SHEET)
      b.html() !== t && null !== b.html() && a.replaceWith(b)
    })
  })
  n.when('A', 'sns-buybox-constants', 'sns-priceblock-constants').register(
    'sns-onmlv2-priceblock-utils',
    function (f, b, a) {
      var d = f.$
      return {
        updateDesktopPriceBlock: function (e) {
          if (e) {
            var c = e.zeroBaseDiscount,
              g = 0 < d(b.SNS_TOGGLE_BUY_BOX).length,
              k = 0 < d(a.DP_STRIKE_PRICE).length
            d(b.SNS_DELIVERY_OPTION_DIV).is(':checked')
              ? (d(a.ONE_NOW_SHIPPING_MESSAGE).addClass('aok-hidden'),
                e.justSubscribeTieredStatus
                  ? (d(a.SNS_TIERED_PRICE).removeClass('aok-hidden'),
                    d(a.SNS_BASED_PRICE).addClass('aok-hidden'),
                    d(a.SNS_TIERED_SAVINGS).removeClass('aok-hidden'),
                    d(a.SNS_BASED_SAVINGS).addClass('aok-hidden'),
                    d(a.SNS_SAVINGS_LABEL).removeClass('aok-hidden'),
                    d(a.SNS_SAVINGS_ROW).removeClass('aok-hidden'))
                  : c
                    ? (d(a.SNS_TIERED_PRICE).addClass('aok-hidden'),
                      d(a.SNS_BASED_PRICE).removeClass('aok-hidden'),
                      d(a.SNS_SAVINGS_ROW).addClass('aok-hidden'))
                    : (d(a.SNS_TIERED_PRICE).addClass('aok-hidden'),
                      d(a.SNS_BASED_PRICE).removeClass('aok-hidden'),
                      d(a.SNS_TIERED_SAVINGS).addClass('aok-hidden'),
                      d(a.SNS_BASED_SAVINGS).removeClass('aok-hidden'),
                      d(a.SNS_SAVINGS_LABEL).removeClass('aok-hidden'),
                      d(a.SNS_SAVINGS_ROW).removeClass('aok-hidden')))
              : d(b.ONML_DELIVERY_OPTION_DIV).is(':checked') &&
                (d(a.ONE_NOW_SHIPPING_MESSAGE).removeClass('aok-hidden'),
                c
                  ? (d(a.SNS_TIERED_PRICE).addClass('aok-hidden'),
                    d(a.SNS_BASED_PRICE).removeClass('aok-hidden'),
                    d(a.SNS_SAVINGS_ROW).addClass('aok-hidden'),
                    k &&
                      (d(b.SNS_TIERED_PRICE).hasClass('aok-hidden')
                        ? (d(a.SNS_SAVINGS_ROW).removeClass('aok-hidden'),
                          d(a.SNS_SAVINGS_LABEL).removeClass('aok-hidden'),
                          d(a.SNS_BASED_SAVINGS).removeClass('aok-hidden'),
                          d(a.SNS_TIERED_SAVINGS).addClass('aok-hidden'))
                        : d(b.SNS_BASE_PRICE).hasClass('aok-hidden') &&
                          (d(a.SNS_SAVINGS_ROW).removeClass('aok-hidden'),
                          d(a.SNS_SAVINGS_LABEL).removeClass('aok-hidden'),
                          d(a.SNS_TIERED_SAVINGS).removeClass('aok-hidden'),
                          d(a.SNS_BASED_SAVINGS).addClass('aok-hidden'))))
                  : (d(a.SNS_TIERED_PRICE).addClass('aok-hidden'),
                    d(a.SNS_BASED_PRICE).removeClass('aok-hidden'),
                    d(a.SNS_TIERED_SAVINGS).addClass('aok-hidden'),
                    d(a.SNS_BASED_SAVINGS).removeClass('aok-hidden'),
                    d(a.SNS_SAVINGS_LABEL).removeClass('aok-hidden'),
                    d(a.SNS_SAVINGS_ROW).removeClass('aok-hidden')))
            g && d(a.SNS_SAVINGS_ROW).addClass('aok-hidden')
          }
        },
        updateBuyboxPriceBlock: function (e) {
          e &&
            (d(b.SNS_DELIVERY_OPTION_DIV).is(':checked')
              ? (e.oneNowDiscountEligible || d(a.SNS_STRIKETHROUGH_PRICE).removeClass('aok-hidden'),
                e.justSubscribeTieredStatus
                  ? (d(b.SNS_BASE_PRICE).addClass('aok-hidden'),
                    d(b.SNS_TIERED_PRICE).removeClass('aok-hidden'))
                  : (d(b.SNS_BASE_PRICE).removeClass('aok-hidden'),
                    d(b.SNS_TIERED_PRICE).addClass('aok-hidden')))
              : d(b.ONML_DELIVERY_OPTION_DIV).is(':checked') &&
                (d(b.SNS_BASE_PRICE).removeClass('aok-hidden'),
                d(b.SNS_TIERED_PRICE).addClass('aok-hidden'),
                e.oneNowDiscountEligible ||
                  (d(a.SNS_STRIKETHROUGH_PRICE).addClass('aok-hidden'),
                  d(a.SNS_BASED_SAVINGS).addClass('aok-hidden'))))
        },
      }
    },
  )
  n.when('A', 'sns-buybox-constants', 'sns-constants', 'sns-onmlv2-utils').register(
    'sns-onmlv2-message-utils',
    function (f, b, a, d) {
      function e() {
        g('#sns-delivery-buybox-upsell-message')
          .find(
            [
              b.SNS_DELIVERY_NEW_OR_UNRECOGNIZED_UPSELL,
              b.SNS_DELIVERY_NON_TIERED_UPSELL,
              b.SNS_DELIVERY_TIERED_UPSELL,
            ].join(),
          )
          .addClass('aok-hidden')
        g('#onml-delivery-buybox-upsell-message')
          .find(
            [
              b.ONML_DELIVERY_NEW_OR_UNRECOGNIZED_UPSELL,
              b.ONML_DELIVERY_NON_TIERED_UPSELL,
              b.ONML_DELIVERY_TIERED_UPSELL,
            ].join(),
          )
          .addClass('aok-hidden')
      }
      function c() {
        g('#sns-delivery-pill')
          .find(
            [
              b.SNS_DELIVERY_NEW_OR_UNRECOGNIZED_PILL,
              b.SNS_DELIVERY_NON_TIERED_PILL,
              b.SNS_DELIVERY_TIERED_PILL,
            ].join(),
          )
          .addClass('aok-hidden')
        g('#onml-delivery-pill')
          .find(
            [
              b.ONML_DELIVERY_NEW_OR_UNRECOGNIZED_PILL,
              b.ONML_DELIVERY_NON_TIERED_PILL,
              b.ONML_DELIVERY_TIERED_PILL,
            ].join(),
          )
          .addClass('aok-hidden')
      }
      var g = f.$
      return {
        updateFirstRecurringDeliveryDate: function (a, c) {
          if (a && c) {
            var d = a.firstRecurringDeliveryDates[c - 1]
            g(b.SNS_ONMLV2_FRDD).each(function () {
              g(this).html(d)
            })
          }
        },
        updateUpsellMessages: function (c, d, h) {
          if (c && d && h) {
            var f = d.snsCustomer,
              p =
                null == d.snsJustSubscribeOptionEnabled
                  ? d.snsCustomer || !1
                  : d.snsJustSubscribeOptionEnabled || !1,
              r = g(b.SNS_DELIVERY_NEW_OR_UNRECOGNIZED_UPSELL).length ? !0 : !1,
              v = d.suppressSnSOneNowOption || !1,
              l = d.justSubscribeTieredStatus
            d = d.tieredStatusOnRecurringDeliveryDates[h - 1] === a.TIERED
            c === a.DELIVERY_OPTION.SNS
              ? (g(b.SNS_DELIVERY_UPSELL).removeClass('aok-hidden'),
                g(b.ONML_DELIVERY_UPSELL).addClass('aok-hidden'),
                p || v
                  ? r && !f
                    ? (e(), g(b.SNS_DELIVERY_NEW_OR_UNRECOGNIZED_UPSELL).removeClass('aok-hidden'))
                    : l
                      ? (e(), g(b.SNS_DELIVERY_TIERED_UPSELL).removeClass('aok-hidden'))
                      : (e(), g(b.SNS_DELIVERY_NON_TIERED_UPSELL).removeClass('aok-hidden'))
                  : e())
              : c === a.DELIVERY_OPTION.ONML
                ? (g(b.SNS_DELIVERY_UPSELL).addClass('aok-hidden'),
                  g(b.ONML_DELIVERY_UPSELL).removeClass('aok-hidden'),
                  p
                    ? r && !f
                      ? (e(),
                        g(b.ONML_DELIVERY_NEW_OR_UNRECOGNIZED_UPSELL).removeClass('aok-hidden'))
                      : d
                        ? (e(), g(b.ONML_DELIVERY_TIERED_UPSELL).removeClass('aok-hidden'))
                        : (e(), g(b.ONML_DELIVERY_NON_TIERED_UPSELL).removeClass('aok-hidden'))
                    : (e(),
                      g(b.ONML_DELIVERY_NEW_OR_UNRECOGNIZED_UPSELL).removeClass('aok-hidden')))
                : (g(b.SNS_DELIVERY_UPSELL).addClass('aok-hidden'),
                  g(b.ONML_DELIVERY_UPSELL).addClass('aok-hidden'),
                  e())
          }
        },
        updateDiscountPill: function (d, e, h) {
          if (d && e && h) {
            var f = e.snsCustomer,
              p =
                null == e.snsJustSubscribeOptionEnabled
                  ? e.snsCustomer || !1
                  : e.snsJustSubscribeOptionEnabled || !1,
              r = g(b.SNS_DELIVERY_NEW_OR_UNRECOGNIZED_PILL).length ? !0 : !1,
              l = e.suppressSnSOneNowOption || !1,
              z = e.justSubscribeTieredStatus
            h = e.tieredStatusOnRecurringDeliveryDates[h - 1] === a.TIERED
            e = e.zeroBaseDiscount
            d === a.DELIVERY_OPTION.SNS
              ? (g(b.SNS_DELIVERY_PILL).removeClass('aok-hidden'),
                g(b.ONML_DELIVERY_PILL).addClass('aok-hidden'),
                p || l
                  ? r && !f
                    ? (c(),
                      e || g(b.SNS_DELIVERY_NEW_OR_UNRECOGNIZED_PILL).removeClass('aok-hidden'))
                    : z
                      ? (c(), g(b.SNS_DELIVERY_TIERED_PILL).removeClass('aok-hidden'))
                      : (c(), e || g(b.SNS_DELIVERY_NON_TIERED_PILL).removeClass('aok-hidden'))
                  : c())
              : d === a.DELIVERY_OPTION.ONML
                ? (g(b.SNS_DELIVERY_PILL).addClass('aok-hidden'),
                  g(b.ONML_DELIVERY_PILL).removeClass('aok-hidden'),
                  p
                    ? r && !f
                      ? (c(),
                        e || g(b.ONML_DELIVERY_NEW_OR_UNRECOGNIZED_PILL).removeClass('aok-hidden'))
                      : h
                        ? (c(), g(b.ONML_DELIVERY_TIERED_PILL).removeClass('aok-hidden'))
                        : (c(), e || g(b.ONML_DELIVERY_NON_TIERED_PILL).removeClass('aok-hidden'))
                    : (c(),
                      e || g(b.ONML_DELIVERY_NEW_OR_UNRECOGNIZED_PILL).removeClass('aok-hidden')))
                : (c(),
                  g(b.SNS_DELIVERY_PILL).addClass('aok-hidden'),
                  g(b.ONML_DELIVERY_PILL).addClass('aok-hidden'))
          }
        },
        updateBuyboxDeliveryOption: function () {
          g(b.SNS_DELIVERY_OPTION_DIV).is(':checked')
            ? (f.declarative.remove(b.SNS_DECLARATIVE_ACTION),
              f.declarative.create(b.SNS_DECLARATIVE_ACTION, b.SNS_SUBSCRIBE_ONLY_ACTION),
              g(b.SNS_ONMLV2_DELIVERY_OPTION_FORM_FIELD).val(b.SNS_DELIVERY_OPTION_SNS),
              g(b.SNS_SUBSCRIBE_BUTTON_DELIVERY_OPTION_FORM_FIELD).val(b.SNS_DELIVERY_OPTION_SNS),
              g(b.SNS_DELIVERY_OPTION_ONML_LINK).addClass('aok-hidden'),
              g(b.SNS_DELIVERY_OPTION_SNS_LINK).removeClass('aok-hidden'),
              g(b.ACCORDION_HEADER_DELIVERY_OPTION_ONML_LINK).addClass('aok-hidden'),
              g(b.ACCORDION_HEADER_DELIVERY_OPTION_SNS_LINK).removeClass('aok-hidden'))
            : g(b.ONML_DELIVERY_OPTION_DIV).is(':checked') &&
              (f.declarative.remove(b.SNS_DECLARATIVE_ACTION),
              f.declarative.create(b.SNS_DECLARATIVE_ACTION, d.getOnmlDeclarativeAction()),
              g(b.SNS_ONMLV2_DELIVERY_OPTION_FORM_FIELD).val(b.SNS_DELIVERY_OPTION_ONML),
              g(b.SNS_SUBSCRIBE_BUTTON_DELIVERY_OPTION_FORM_FIELD).val(b.SNS_DELIVERY_OPTION_ONML),
              g(b.SNS_DELIVERY_OPTION_SNS_LINK).addClass('aok-hidden'),
              g(b.SNS_DELIVERY_OPTION_ONML_LINK).removeClass('aok-hidden'),
              g(b.ACCORDION_HEADER_DELIVERY_OPTION_SNS_LINK).addClass('aok-hidden'),
              g(b.ACCORDION_HEADER_DELIVERY_OPTION_ONML_LINK).removeClass('aok-hidden'))
        },
      }
    },
  )
  n.when(
    'A',
    'a-dropdown',
    'sns-vmf-utils',
    'sns-onmlv2-utils',
    'sns-metrics-constants',
    'sns-annual-savings',
    'sns-constants',
    'sns-buybox-constants',
    'a-popover',
    'ready',
  ).execute('sns-onmlv2-frequency-update', function (f, b, a, d, e, c, g, k, q) {
    function h(b, c) {
      var h = c + 'FrequencySelectedIndex',
        f = k.SNS_FREQUENCY_NAME + c + 'V2'
      if (
        b &&
        b.selectedRow &&
        b.selectedRow.$row &&
        b.selectedRow.$row.length &&
        b.selectedRow.$row[0] &&
        b.selectedRow.$row[0].dataset
      ) {
        var m = b.selectedRow.$row[0].dataset.frequencyValue,
          p = b.selectedRow.$row[0].dataset.selectedIndex
        b = b.selectedRow.$row[0].dataset.frequencyLabel
        m !== t && p !== t
          ? (r("input[name\x3d'" + f + "']").val(m),
            r("input[name\x3d'" + h + "']").val(p),
            r('#replenishment-' + c + '-frequency-trigger').text(b),
            c === g.DELIVERY_OPTION.ONML
              ? ((h = d.getOnmlFrequencyParam()),
                d.emitMetric(e.SNS_ONML_FREQUENCY_POPOVER_SELECTED + '-' + m))
              : ((h = d.getSnsFrequencyParam()),
                d.emitMetric(e.SNS_FREQUENCY_POPOVER_SELECTED + '-' + m)),
            a.selectFrequency(h[p], c))
          : d.emitMetric(e.SNS_INVALID_FREQUENCY_POPOVER_INPUTS)
      } else d.emitMetric(e.SNS_INVALID_FREQUENCY_POPOVER_DATA_STRUCTURE)
      c = q.get('replenishment' + c + 'FrequencyPopover')
      null !== c && c !== t && c.hide()
    }
    function m(b) {
      var c = a.getFrequencyIndex(b)
      b = f.$(
        "[data-a-accordion-name\x3d'" +
          ('replenishment-' + b + '-frequency-accordion') +
          "'] [data-a-accordion-row-name\x3d'" +
          (b + 'FrequencyAccordionRow-' + c) +
          "'] a",
      )
      b.length ? b.click() : d.emitMetric(e.SNS_INVALID_FREQUENCY_ACCORDION_ROW)
    }
    function p(a) {
      l.ue && l.ue.count(a, (ue.count(a) || 0) + 1)
    }
    var r = f.$
    f.on('a:dropdown:rcxOrdFreqSns:select', function (b) {
      b = a.getFrequencyIndex(g.DELIVERY_OPTION.SNS)
      a.updateFrequencyIndex(b)
      var h = d.getSnsFrequencyParam()
      a.selectFrequency(h[b], g.DELIVERY_OPTION.SNS)
      b = a.getFrequencyValue(g.DELIVERY_OPTION.SNS)
      h = a.getFrequencyValueExcludingDeliveryType(b)
      0 < b.search('W')
        ? p(e.SNS_LEGACY_WEEKLY_FREQUENCY_SELECT_METRICS)
        : p(e.SNS_LEGACY_MONTHLY_FREQUENCY_SELECT_METRICS)
      c.checkPreConditionsAndUpdateAnnualSavings(h)
    })
    f.on('a:dropdown:rcxOrdFreqOnml:select', function (b) {
      b = a.getFrequencyIndex(g.DELIVERY_OPTION.ONML)
      a.updateFrequencyIndex(b)
      var h = d.getOnmlFrequencyParam()
      a.selectFrequency(h[b], g.DELIVERY_OPTION.ONML)
      b = a.getFrequencyValue(g.DELIVERY_OPTION.ONML)
      h = a.getFrequencyValueExcludingDeliveryType(b)
      0 < b.search('W')
        ? p(e.SNS_ONML_WEEKLY_FREQUENCY_SELECT_METRICS)
        : p(e.SNS_ONML_MONTHLY_FREQUENCY_SELECT_METRICS)
      c.checkPreConditionsAndUpdateAnnualSavings(h)
    })
    f.on('a:accordion:replenishment-sns-frequency-accordion:select', function (a) {
      h(a, g.DELIVERY_OPTION.SNS)
      d.emitMetric(e.SNS_FREQUENCY_POPOVER_SELECTED)
    })
    f.on('a:accordion:replenishment-onml-frequency-accordion:select', function (a) {
      h(a, g.DELIVERY_OPTION.ONML)
      d.emitMetric(e.SNS_ONML_FREQUENCY_POPOVER_SELECTED)
    })
    f.on('a:popover:beforeShow:replenishmentsnsFrequencyPopover', function () {
      m(g.DELIVERY_OPTION.SNS)
    })
    f.on('a:popover:beforeShow:replenishmentonmlFrequencyPopover', function () {
      m(g.DELIVERY_OPTION.ONML)
    })
  })
  n.when('A', 'sns-buybox-constants').execute('sns-onmlv2-quantity-update', function (f, b) {
    var a = f.$
    f.on(b.SNS_ONMLV2_QUANTITY_TRIGGER_DROPDOWN, function (d) {
      d = d.value
      a(b.SNS_ONMLV2_QUANTITY_FORM_FIELD).val(d)
      a(b.SNS_SUBSCRIBE_BUTTON_QUANTITY_FORM_FIELD).val(d)
    })
    a(b.SNS_ONMLV2_QUANTITY_TRIGGER_RADIO_BUTTON).change(function (d) {
      d = d.target.value
      a(b.SNS_ONMLV2_QUANTITY_FORM_FIELD).val(d)
      a(b.SNS_SUBSCRIBE_BUTTON_QUANTITY_FORM_FIELD).val(d)
    })
  })
  n.when('A', 'sns-constants', 'sns-buybox-constants', 'sns-onmlv2-utils').execute(
    'sns-accordion-content-update',
    function (f, b, a, d) {
      var e = f.$,
        c = function () {
          e(a.SNS_DELIVERY_OPTION_DIV).is(':checked')
            ? e(a.SNS_CBB_PRIME_SHIPPING).addClass('aok-hidden')
            : e(a.ONML_DELIVERY_OPTION_DIV).is(':checked') &&
              e(a.SNS_CBB_PRIME_SHIPPING).removeClass('aok-hidden')
        }
      f.declarative('sns-delivery-change-btn', 'click', function (a) {
        c()
      })
      f.on('a:sheet:beforeHide:sns_delivery_bottom_sheet', function () {
        c()
      })
    },
  )
  ;('use strict')
  n.register('sns-join-prime-endpoint', function () {
    return { endpoint: '/amazonprime/' }
  })
  n.register('sns-priceblock-constants', function () {
    return {
      PRICEBLOCK_SNSPRICE_ROW: '#priceblock_snsprice_row',
      SNS_UPSELL: '#priceblock_snsupsell_row',
      SNS_SAVINGS: '#snsprice_savings',
      DP_OUR_PRICE: '#priceblock_ourprice',
      DP_OUR_PRICE_LABEL: '#priceblock_ourprice_lbl',
      DP_OUR_PRICE_SAVINGS: '#regularprice_savings',
      DP_OUR_PRICE_BADGING: '#ourprice_fbabadge',
      DP_OUR_PRICE_SHIPPING: '#ourprice_shippingmessage',
      DP_OUR_PRICE_PPU: '#priceblock_ourprice_row #priceblock_ourprice+.a-size-small',
      DP_STRIKE_PRICE: '#price .a-text-strike',
      DP_SALE_PRICE: '#priceblock_saleprice',
      DP_SALE_PRICE_LABEL: '#priceblock_saleprice_lbl',
      DP_SALE_PRICE_SHIPPING: '#saleprice_shippingmessage',
      DP_SALE_PRICE_PPU: '#priceblock_saleprice_row #priceblock_saleprice+.a-size-small',
      DP_DEAL_PRICE: '#priceblock_dealprice',
      DP_DEAL_PRICE_SAVINGS: '#dealprice_savings',
      DP_DEAL_PRICE_SHIPPING: '#dealprice_shippingmessage',
      DP_DEAL_PRICE_PPU: '#priceblock_dealprice_row #priceblock_dealprice+.a-size-small',
      SNS_PITCH_PRICE_UPSELL_TEXT: '#onmlPriceBlockUpsellText',
      SNS_ATF_REDESIGN_UPSELL_UNCHECKED: '#onml-atf-redesign-upsell-unchecked',
      SNS_ATF_REDESIGN_UPSELL_CHECKED: '#onml-atf-redesign-upsell-checked',
      ONML_ATF_REDESIGN_UPSELL: '#onml-atf-redesign-upsell',
      SNS_PITCH_PRICE_FEATURE: '#snsPitchPrice_feature_div',
      NEW_PITCH_PRICE_FEATURE: '#newPitchPriceWrapper_feature_div',
      MOBILE_OUR_PRICE_SHIPPING: '#ourPrice_availability',
      SHIPPING_DETAILS: '[data-a-sheet*\x3d"shippingDetailsDisplayContent"]',
      SNS_TIERED_PRICE:
        '#unifiedPrice_feature_div #priceblock_snsprice_Tiered, #snsPrice #priceblock_snsprice_Tiered',
      SNS_BASED_PRICE:
        '#unifiedPrice_feature_div #priceblock_snsprice_Based, #snsPrice #priceblock_snsprice_Based',
      SNS_TIERED_SAVINGS:
        '#unifiedPrice_feature_div #snsSavings_Tiered, #snsPrice #snsSavings_Tiered',
      SNS_BASED_SAVINGS:
        '#unifiedPrice_feature_div #snsSavings_NonTiered, #snsPrice #snsSavings_NonTiered',
      SNS_SAVINGS_LABEL: '#unifiedPrice_feature_div #snsSavings_lbl',
      SNS_SAVINGS_ROW:
        '#unifiedPrice_feature_div #priceblock_snsSavings_row, #snsPrice #priceblock_snsSavings_row',
      ONE_NOW_SHIPPING_MESSAGE:
        '#priceblock_oneNowShippingMessage, #priceblock_oneNowShippingMessage_dpv2',
      SNS_STRIKETHROUGH_PRICE: '#snsStrikeThroughPrice',
    }
  })
  n.when(
    'A',
    'sns-utils',
    'sns-constants',
    'sns-price-utils',
    'sns-buybox-constants',
    'sns-priceblock-constants',
  ).register('sns-price-refresh', function (f, b, a, d, e, c) {
    return {
      init: function () {
        f.declarative('sns-opt-in-checked', 'change', function () {
          d.showSnSPriceIfSnSOptInChecked()
        })
        b.registerCallbackForNameSpace(
          a.EVENT_NAMESPACE.PAGE_UPDATE,
          d.showSnSPriceIfSnSOptInChecked,
        )
        d.showSnSPriceIfSnSOptInChecked()
        f.$(e.SNS_BUY_USED_BUTTON).click(function () {
          var g = e.SNS_OPT_IN_CHECKBOX,
            d = b.getOnmlUserPref(a.USER_PREFS_KEYS.SNS_OPT_IN),
            q = c.SNS_UPSELL,
            h = c.SNS_PITCH_PRICE_UPSELL_TEXT,
            m = c.ONML_ATF_REDESIGN_UPSELL
          !0 === d && (f.$(g).click(), b.setOnmlUserPref(a.USER_PREFS_KEYS.SNS_OPT_IN, !0))
          f.$(m).addClass('aok-hidden')
          f.$(q).addClass('aok-hidden')
          f.$(h).addClass('aok-hidden')
        })
      },
    }
  })
  n.when('A', 'sns-utils', 'sns-priceblock-constants', 'sns-buybox-constants').register(
    'sns-price-utils',
    function (f, b, a, d) {
      var e = f.$,
        c = a.SNS_PITCH_PRICE_UPSELL_TEXT,
        g = a.SNS_PITCH_PRICE_FEATURE,
        k = a.NEW_PITCH_PRICE_FEATURE,
        q = a.PRICEBLOCK_SNSPRICE_ROW,
        h = d.SNS_OPT_IN_CHECKBOX,
        m = a.SNS_UPSELL,
        p = a.SNS_SAVINGS,
        r = a.DP_OUR_PRICE,
        l = a.DP_OUR_PRICE_LABEL,
        n = a.DP_OUR_PRICE_SAVINGS,
        t = a.DP_OUR_PRICE_BADGING,
        A = a.DP_OUR_PRICE_SHIPPING,
        B = a.DP_SALE_PRICE,
        C = a.DP_SALE_PRICE_LABEL,
        x = a.DP_SALE_PRICE_SHIPPING,
        w = a.DP_DEAL_PRICE,
        D = a.DP_DEAL_PRICE_SAVINGS,
        y = a.DP_DEAL_PRICE_SHIPPING,
        E = a.MOBILE_OUR_PRICE_SHIPPING,
        F = a.SHIPPING_DETAILS,
        G = d.SNS_BUY_NEW_PRICE,
        H = d.NON_CBB_BUY_NEW_PRICE,
        I = d.CBB_BUY_NEW_PRICE,
        J = d.SNS_PRICE_IN_BUY_USED_SECTION,
        K = d.CBB_SNS_BUY_NEW_PRICE,
        L = d.DPV2_BUY_NEW_PRICE,
        M = a.SNS_ATF_REDESIGN_UPSELL_CHECKED,
        N = a.SNS_ATF_REDESIGN_UPSELL_UNCHECKED
      return {
        showSnSPriceIfSnSOptInChecked: function () {
          b.isSnSEligible() &&
            (e(h).is(':checked')
              ? b.shouldShowPrice() &&
                (e(q).length
                  ? (e(q).removeClass('aok-hidden'),
                    e(p).removeClass('a-hidden'),
                    e(m).addClass('aok-hidden'),
                    e(n).addClass('a-hidden'),
                    e(t).addClass('a-hidden'),
                    e(A).addClass('a-hidden'),
                    e(E).addClass('a-hidden'),
                    e(r)
                      .addClass('a-text-strike a-size-base a-color-secondary onml-price-inactive')
                      .removeClass('a-size-medium a-color-price'),
                    e(l).addClass('onml-price-inactive'),
                    e(B)
                      .addClass('a-text-strike a-size-base a-color-secondary onml-price-inactive')
                      .removeClass('a-size-medium a-color-price '),
                    e(C).addClass('onml-price-inactive'),
                    e(x).addClass('a-hidden'),
                    e(w)
                      .addClass('a-text-strike a-size-base a-color-secondary onml-price-inactive')
                      .removeClass('a-size-medium a-color-price'),
                    e(D).addClass('a-hidden'),
                    e(y).addClass('a-hidden'),
                    e(q).css({ display: 'table-row', visibility: 'visible' }),
                    e(q).prev().has(F).addClass('aok-hidden'),
                    e(H).addClass('aok-hidden'),
                    e(G).removeClass('aok-hidden'),
                    e(I).addClass('aok-hidden'),
                    e(J).addClass('aok-hidden'),
                    e(K).removeClass('aok-hidden'),
                    e(L).addClass('aok-hidden'))
                  : (e(c).addClass('aok-hidden'),
                    e(k).addClass('aok-hidden'),
                    e(g).removeClass('aok-hidden'),
                    e(g).css({ display: 'block', visibility: 'visible' }),
                    e(M).removeClass('aok-hidden'),
                    e(N).addClass('aok-hidden')))
              : e(q).length
                ? (e(q).addClass('aok-hidden'),
                  e(p).addClass('a-hidden'),
                  e(m).removeClass('aok-hidden'),
                  e(n).removeClass('a-hidden'),
                  e(t).removeClass('a-hidden'),
                  e(A).removeClass('a-hidden'),
                  e(E).removeClass('a-hidden'),
                  e(r)
                    .addClass('a-size-medium a-color-price')
                    .removeClass('a-text-strike a-size-base a-color-secondary onml-price-inactive'),
                  e(l).removeClass('onml-price-inactive'),
                  e(B)
                    .addClass('a-size-medium a-color-price')
                    .removeClass('a-text-strike a-size-base a-color-secondary onml-price-inactive'),
                  e(C).removeClass('onml-price-inactive'),
                  e(x).removeClass('a-hidden'),
                  e(w)
                    .addClass('a-size-medium a-color-price')
                    .removeClass('a-text-strike a-size-base a-color-secondary onml-price-inactive'),
                  e(D).removeClass('a-hidden'),
                  e(y).removeClass('a-hidden'),
                  e(q).prev().has(F).removeClass('aok-hidden'),
                  e(H).removeClass('aok-hidden'),
                  e(G).addClass('aok-hidden'),
                  e(I).removeClass('aok-hidden'),
                  e(J).addClass('aok-hidden'),
                  e(K).addClass('aok-hidden'),
                  e(L).removeClass('aok-hidden'))
                : (e(c).removeClass('aok-hidden'),
                  e(k).removeClass('aok-hidden'),
                  e(g).addClass('aok-hidden'),
                  e(c).css({ display: 'block', visibility: 'visible' }),
                  e(N).removeClass('aok-hidden'),
                  e(M).addClass('aok-hidden')))
        },
      }
    },
  )
  n.when('A', 'sns-constants', 'sns-buybox-constants', 'sns-states-loaded-in-dom').register(
    'sns-utils',
    function (f, b, a) {
      var d = f.$,
        e = {},
        c = {},
        g = function (a, b, c) {
          var g,
            e = function (a) {
              if (!a || 'object' === typeof a) return a
              var c = d.parseJSON
              l.JSON && l.JSON.parse && (c = JSON.parse)
              try {
                return 'string' === typeof a ? c(a) : null
              } catch (g) {
                return (
                  l.ueLogError &&
                    l.ueLogError(g, {
                      logLevel: 'ERROR',
                      attribution: 'sns',
                      message:
                        'An error occurred when getting onml parameters from page-state. a-state: ' +
                        b,
                    }),
                  null
                )
              }
            }
          a = d(a || 'html')
          return 1 <= a.length &&
            (a = a.find("script[data-a-state*\x3d'" + b + "']")) &&
            1 <= a.length
            ? ((g = e(a.first().text())), e('object' === typeof g ? g[c] : null))
            : g
        },
        k = function (b) {
          var c = g(a.SNS_OPT_IN_FEATURE_DIV, 'sns-onml-params', 'onmlParams')
          return b ? c && c[b] : c
        },
        q = function () {
          var a = k('deviceType'),
            g = c[b.USER_PREFS_KEYS.ONML_PARAMS],
            g = g && g.deviceType
          return a || g
        }
      return {
        isSnSEligible: function () {
          return k('snsEligible')
        },
        getAStateFromDom: g,
        getOnmlParam: k,
        shouldShowPrice: function () {
          return k('showPrice')
        },
        getDeviceType: q,
        registerCallbackForNameSpace: function (a, b) {
          e[a] || (e[a] = [])
          ;-1 === e[a].indexOf(b) && e[a].push(b)
        },
        executeCallbacksForNameSpace: function (a) {
          if ((a = e[a]) && a.constructor === Array) for (var b = 0; b < a.length; b++) a[b]()
        },
        setOnmlUserPref: function (a, b) {
          c[a] = b
        },
        getOnmlUserPref: function (a) {
          return c[a]
        },
        deleteOnmlUserPref: function (a) {
          delete c[a]
        },
        isMobileDevice: function () {
          var a = q()
          return 'mobile' === a || 'mobileApp' === a
        },
        isMobileApp: function () {
          return 'mobileApp' === q()
        },
        isTabletApp: function () {
          var a = q()
          return 'iPad' === a || 'tabletApp' === a || 'tabletLargeApp' === a
        },
        isVerucaBuyNowEnabled: function () {
          return k('verucaBuyNowEnabled')
        },
        isVerucaOneClickEnabled: function () {
          return k('verucaOneClickEnabled')
        },
        enableSnSOptIn: function () {
          d(a.SNS_OPT_IN_CHECKBOX).removeAttr('disabled')
        },
        isSnsCustomer: function () {
          return k('snsCustomer')
        },
      }
    },
  )
  n.when('A', 'sns-buybox-constants', 'sns-constants').register(
    'sns-onmlv2-utils',
    function (f, b, a) {
      function d(a, b) {
        return ![0, 1, 3, 4, 5].includes(b)
      }
      var e = f.$,
        c,
        g = function (a, b, c) {
          var g,
            d = function (a) {
              if (!a || 'object' === typeof a) return a
              var c = e.parseJSON
              l.JSON && l.JSON.parse && (c = JSON.parse)
              try {
                return 'string' === typeof a ? c(a) : null
              } catch (g) {
                return (
                  x('snsGetAStateException', 'NotDefined'),
                  l.ueLogError &&
                    l.ueLogError(g, {
                      logLevel: 'ERROR',
                      attribution: 'sns',
                      message:
                        'An error occurred when getting onml parameters from page-state. a-state: ' +
                        b +
                        ' with string: ' +
                        a,
                    }),
                  null
                )
              }
            }
          a = e(a || 'html')
          return 1 <= a.length &&
            (a = a.find("script[data-a-state*\x3d'" + b + "']")) &&
            1 <= a.length
            ? ((g = d(a.first().text())), d('object' === typeof g ? g[c] : null))
            : g
        },
        k = function (a, b, c) {
          var g,
            d = function (a) {
              if (null === a || 'object' === typeof a || 'boolean' === typeof a) return a
              var c = e.parseJSON
              l.JSON && l.JSON.parse && (c = JSON.parse)
              try {
                return 'string' === typeof a ? c(a) : null
              } catch (g) {
                return (
                  x('b2bGetAStateException', 'NotDefined'),
                  l.ueLogError &&
                    l.ueLogError(g, {
                      logLevel: 'ERROR',
                      attribution: 'b2b',
                      message:
                        'An error occurred when getting onml parameters from page-state. a-state: ' +
                        b +
                        ' with string: ' +
                        a,
                    }),
                  null
                )
              }
            }
          a = e(a || 'html')
          return 1 <= a.length &&
            (a = a.find("script[data-a-state*\x3d'" + b + "']")) &&
            1 <= a.length
            ? ((g = d(a.first().text())), d('object' === typeof g ? g[c] : null))
            : g
        },
        q = function (a, b, c) {
          var g
          a = e(a || 'html')
          if (
            1 <= a.length &&
            (a = a.find("script[data-a-state*\x3d'" + b + "']")) &&
            1 <= a.length
          ) {
            if ((a = a.first().text()) && 'object' !== typeof a) {
              var d = e.parseJSON
              l.JSON && l.JSON.parse && (d = JSON.parse)
              try {
                g = 'string' === typeof a ? d(a) : null
              } catch (k) {
                x('snsGetAStateWithoutJsonException', 'NotDefined'),
                  l.ueLogError &&
                    l.ueLogError(k, {
                      logLevel: 'ERROR',
                      attribution: 'sns',
                      message:
                        'An error occurred when getting onml parameters from page-state. a-state: ' +
                        b +
                        ' with string: ' +
                        a,
                    }),
                  (g = null)
              }
            } else g = a
            return (c = 'object' === typeof g ? g[c] : null)
          }
          return g
        },
        h = function () {
          return g(t, b.SNS_BUY_BOX_PARAMS, b.SNS_BUY_BOX_PARAM_MAP)
        },
        m = function () {
          return g(t, 'sns-frequency-params', 'snsFrequencyParamsMap')
        },
        p = function () {
          return g(t, 'sns-frequency-params', 'onmlFrequencyParamsMap')
        },
        r = function () {
          var a = null,
            b = p()
          b &&
            Array.isArray(b) &&
            (a = b.find(function (a) {
              if (!0 === a.isDefault) return a
            }))
          return a ? !0 === a.isDefault : !1
        },
        n = function (a) {
          var b = h()
          return b ? b.deviceType === a : !1
        },
        z = function () {
          return n('mobile') || n('mobileApp')
        },
        u = function () {
          return n('web')
        },
        A = function () {
          return document.querySelector(b.SNS_ACCORDION_HEADER_RADIO_BUTTON)
        },
        B = function (b, c) {
          return b && c ? b.tieredStatusOnRecurringDeliveryDates[c - 1] === a.TIERED : !1
        },
        C = function (a, b) {
          return a && b ? a.firstRecurringDeliveryDates[b - 1] : ''
        },
        x = function (a, b) {
          l.ue && l.ue.count(a, (ue.count(a) || 0) + 1)
          l.uet && l.uet('cf', b, { wb: 1 })
        },
        w = function (a) {
          l.ue && l.ue.count(a, (ue.count(a) || 0) + 1)
        }
      return {
        getAStateFromDom: g,
        getAStateFromDomWithoutJson: q,
        getDeliveryOption: function () {
          return e(b.SNS_ONMLV2_DELIVERY_OPTION_FORM_FIELD).val()
        },
        getSwitchDeliveryOption: function () {
          if (!c) {
            var a = h()
            a && (c = a.deliveryOption)
          }
          return c
        },
        getBuyboxMessageParam: h,
        isMobileDevice: z,
        isMobileWeb: function () {
          return n('mobile')
        },
        isMobileApp: function () {
          return n('mobileApp')
        },
        isTabletApp: function () {
          return n('iPad') || n('tabletApp') || n('tabletLargeApp')
        },
        isWeb: u,
        getSnsFrequencyParam: m,
        getSnsFrequencyParamForB2B: function () {
          return k(t, 'sns-frequency-params', 'snsFrequencyParamsMap')
        },
        getOnmlFrequencyParam: p,
        getOnmlFrequencyParamForB2B: function () {
          return k(t, 'sns-frequency-params', 'onmlFrequencyParamsMap')
        },
        getIsCustomerPrimeMap: function () {
          return k(t, 'is-prime-customer', 'IsPrime')
        },
        getIsB2bDiscountWinningMap: function () {
          return k(t, 'is-b2b-discount-winning', 'isB2bDiscountWinning')
        },
        getIsRDProgramWinner: function () {
          return k(t, 'rd-program-params', 'isRDProgramWinner')
        },
        getDeliveryInfoParam: function () {
          var a
          a = e('#replenishment-onml-frequency-accordion')
          var b = e('#replenishment-sns-frequency-accordion')
          a =
            0 !== a.length || 0 !== b.length
              ? Math.max(a.children().length, b.children().length)
              : Math.max(
                  e('[name\x3drcxOrdFreqSns]').children('option').length,
                  e('[name\x3drcxOrdFreqOnml]').children('option').length,
                )
          b = g(t, 'sns-frequency-params', 'deliveryInfoParamsMap')
          6 === a &&
            b.snsDates &&
            6 < b.snsDates.length &&
            ((a = b),
            (a.snsDates = a.snsDates.filter(d)),
            (a.onmlDates = a.onmlDates.filter(d)),
            w('filteringWeeklyDeliveryInfoWhenGranularDisabled'),
            (b = a))
          return b
        },
        getDiscountOptionsParam: function () {
          return g(t, 'sns-frequency-params', 'discountOptionsParamsMap')
        },
        getDiscountTypeParam: function () {
          return q(t, 'sns-frequency-params', 'deliveryTypeParamsMap')
        },
        getOnmlDateParam: function () {
          return q(t, 'sns-frequency-params', 'onmlDateParamsMap')
        },
        createHiddenInput: function (a, b) {
          return '\x3cinput type\x3d"hidden" name\x3d"' + a + '" value\x3d"' + b + '"\x3e'
        },
        getBuyNowAction: function () {
          return z()
            ? e(b.MOBILE_ADD_TO_CART_DIV).attr('action')
            : u()
              ? e(b.ADD_TO_CART_DIV).attr('action')
              : e(b.TABLET_ADD_TO_CART_DIV).attr('action')
        },
        getOnmlv2FormValueByName: function (a) {
          return e(b.SNS_ONMLV2_FORM_FIELDS + " [name\x3d'" + a + "']").val()
        },
        getSubscribeButtonFormValueByName: function (a) {
          return e(b.SUBSCRIBE_BUTTON_FORM_FIELDS + " [name\x3d'" + a + "']").val()
        },
        isCbbTemplateEnabled: function () {
          return e(b.SNS_CBB_ACCORDION_ROW).length
        },
        removeFormFieldsIntroducedByCbb: function () {
          e(b.SNS_ONMLV2_FORM_FIELDS + ' #ASIN').remove()
          e(b.SNS_ONMLV2_FORM_FIELDS + ' #offerListingID').remove()
          e(b.SNS_ONMLV2_FORM_FIELDS + ' #snsOfferListingID').remove()
          e(b.SNS_ONMLV2_FORM_FIELDS + ' #snsMerchantID').remove()
          e(b.SNS_ONMLV2_FORM_FIELDS + ' #rcxOrdFreq').remove()
          e(b.SNS_ONMLV2_FORM_FIELDS + ' #quantity').remove()
        },
        getCbbSnsAccordionRowRadioButton: A,
        isCbbSnsAccordionRowExpanded: function () {
          return 'true' === A().getAttribute('aria-checked')
        },
        isTiered: B,
        getOnmlFirstRecurringDeliveryDate: C,
        getOnmlDeclarativeAction: function () {
          return e('#onmlDeclarativeAction').val()
        },
        generateUrlParams: function (a) {
          if (!a) {
            var c = b.SNS_SELECT_DELIVERY_URL
            return c
          }
          var g = (
              z() ? e(b.SNS_FREQUENCY_FORM_FIELD_MOBILE) : e(b.SNS_FREQUENCY_FORM_FIELD)
            ).val(),
            d = []
          d.subscribeOnlyDate = a.justSubscribeDeliveryDate
          d.subscribeOnlyDateShort = a.justSubscribeShortDeliveryDate
          d.subscribeOnlyDiscount = a.justSubscribeTieredStatus
            ? a.tieredDiscountPercent
            : a.baseDiscountPercent
          d.onmlDate = a.oneTimeDeliveryDate
          d.onmlDateShort = a.oneTimeShortDeliveryDate
          d.onmlDiscount = a.baseDiscountPercent
          d.onmlNextDate = C(a, g)
          d.onmlNextDiscount = B(a, g) ? a.tieredDiscountPercent : a.baseDiscountPercent
          d.snsDeliveryOption = e(b.SNS_SELECT_DELIVERY_OPTION_ID).val()
          d.isMobile = z()
          d.snscsrf = a.deliveryModalCSRFToken
          c = b.SNS_SELECT_DELIVERY_URL
          Object.keys(d).forEach(function (a) {
            c += '\x26' + a + '\x3d' + encodeURI(d[a])
          })
          return c
        },
        createUrlParameter: function (a, b) {
          b = encodeURIComponent(b)
          return a + '\x3d' + b + '\x26'
        },
        getDefaultDeliveryOption: function () {
          return r() ? b.SNS_DELIVERY_OPTION_ONML : b.SNS_DELIVERY_OPTION_SNS
        },
        isONMLDefault: r,
        getSelectedDeliveryOption: function () {
          return e(b.SNS_DELIVERY_OPTION_DIV).is(':checked')
            ? b.SNS_DELIVERY_OPTION_SNS
            : b.SNS_DELIVERY_OPTION_ONML
        },
        getDefaultFrequency: function (a) {
          var b = null
          ;(a = a ? m() : p()) &&
            Array.isArray(a) &&
            (b = a.find(function (a) {
              if (!0 === a.isDefault) return a
            }))
          return b ? b.value.split('|')[0] : null
        },
        getCurrencyCode: function () {
          return q(t, 'sns-huc-data', 'currencyCode')
        },
        emitSsbMetrics: x,
        emitInvalidFrequencyMetric: function (a, b) {
          var c = e('input[name\x3drcxOrdFreqOnml]').val(),
            g = e('input[name\x3drcxOrdFreqSns]').val(),
            d = /^[0-9][M|W]\|onml$/,
            k = /^[0-9][M|W]\|sns$/
          c === t || null === c || d.test(c) || w(a)
          g === t || null === g || k.test(g) || w(b)
        },
        emitMetric: w,
        getAnnualSavingsParamMap: function () {
          return g(t, 'sns-upsell-params', 'annualSavingsParamsMap')
        },
        getAnnualSavingsWeblabTreatment: function () {
          return q(t, 'sns-upsell-params', 'annualSavingsWeblabTreatment')
        },
        getDefaultSavingsValue: function () {
          return q(t, 'sns-upsell-params', 'defaultAnnualSavingsValue')
        },
        recordWeblabTriggers: function (a, b) {
          try {
            l.ue && 'function' === typeof l.ue.trigger && l.ue.trigger(a, b)
          } catch (c) {
            w('snsWeblabTriggeringException')
          }
        },
        logErrorWithAttribution: function (a, b) {
          l.ueLogError && l.ueLogError(b, { logLevel: 'ERROR', attribution: a })
        },
        getSubscriberDiscountMessageWeblabTreatment: function () {
          return q(
            t,
            b.SNS_SUBSCRIBER_DISCOUNT_MESSAGE_STATE_ID,
            'subscriberDiscountMessageTreatment',
          )
        },
        isSnSAccordionActive: function () {
          var b = f.$(a.ACTIVE_ACCORDION_SELECTOR).data(a.ACCORDION_ROW_NAME_SELECTOR)
          return (
            b === a.SNS_ACCORDION_ROW_NAME_DESKTOP ||
            b === a.SNS_ACCORDION_ROW_NAME_MOBILE ||
            b === a.SNS_ACCORDION_ROW_NAME_MOBILE_APP
          )
        },
        isSnSSelectedAccordion: function (b) {
          b = b.selectedRow.rowName
          return (
            b === a.SNS_ACCORDION_ROW_NAME_DESKTOP ||
            b === a.SNS_ACCORDION_ROW_NAME_MOBILE ||
            b === a.SNS_ACCORDION_ROW_NAME_MOBILE_APP
          )
        },
        isSnSAccordionActiveForDeviceType: function (b) {
          var c = f.$(a.ACTIVE_ACCORDION_SELECTOR).data(a.ACCORDION_ROW_NAME_SELECTOR)
          return b === a.DEVICE_TYPE.DESKTOP
            ? c === a.SNS_ACCORDION_ROW_NAME_DESKTOP
            : b === a.DEVICE_TYPE.MOBILE
              ? c === a.SNS_ACCORDION_ROW_NAME_MOBILE
              : b === a.DEVICE_TYPE.MOBILE_APP
                ? c === a.SNS_ACCORDION_ROW_NAME_MOBILE_APP
                : !1
        },
        isSnSSelectedAccordionForDeviceType: function (b, c) {
          b = b.selectedRow.rowName
          return c === a.DEVICE_TYPE.DESKTOP
            ? b === a.SNS_ACCORDION_ROW_NAME_DESKTOP
            : c === a.DEVICE_TYPE.MOBILE
              ? b === a.SNS_ACCORDION_ROW_NAME_MOBILE
              : c === a.DEVICE_TYPE.MOBILE_APP
                ? b === a.SNS_ACCORDION_ROW_NAME_MOBILE_APP
                : !1
        },
      }
    },
  )
  n.when('A', 'a-dropdown', 'sns-onmlv2-utils', 'sns-buybox-constants', 'sns-constants').register(
    'sns-vmf-utils',
    function (f, b, a, d, e) {
      var c = f.$,
        g = function (a) {
          var b = c("input[name\x3d'" + ('rcxOrdFreq' + a + 'V2') + "']")
          return b !== t && null !== b && 0 !== b.length
            ? b.val()
            : a === e.DELIVERY_OPTION.SNS
              ? c('[name\x3drcxOrdFreqSns]').val()
              : c('[name\x3drcxOrdFreqOnml]').val()
        }
      return {
        updateFrequencyIndex: function (a) {
          var g = c('[name\x3drcxOrdFreqSns]'),
            d = c('[name\x3drcxOrdFreqOnml]')
          0 !== g.length &&
            0 !== d.length &&
            ((g = g[0].options[a].value),
            (a = d[0].options[a].value),
            b.getSelect(c('[name\x3drcxOrdFreqSns]')).setValue(g),
            b.getSelect(c('[name\x3drcxOrdFreqOnml]')).setValue(a))
        },
        selectFrequency: function (b, g) {
          c('.sns-delivery-buybox-upsell-message').html(b.upsellInformation.message)
          c('.sns-delivery-buybox-upsell-additional-message-title').html(
            b.upsellInformation.additionalMessageTitle,
          )
          c('.sns-delivery-buybox-upsell-additional-message').html(
            b.upsellInformation.additionalMessage,
          )
          if ('sns' === g) {
            c('.onml-delivery-link').addClass('aok-hidden')
            if (-1 < b.value.indexOf('W|')) {
              c('.sns-delivery-link').addClass('aok-hidden')
              c('.sns-delivery-link-weekly').removeClass('aok-hidden')
              var e = c('.sns-delivery-link-weekly').html()
            } else
              c('.sns-delivery-link').removeClass('aok-hidden'),
                c('.sns-delivery-link-weekly').addClass('aok-hidden'),
                (e = c('.sns-delivery-link').html())
            c(d.ACCORDION_HEADER_DELIVERY_OPTION_SNS_LINK).html(e)
            c(d.ACCORDION_HEADER_DELIVERY_OPTION_ONML_LINK).addClass('aok-hidden')
            c(d.ACCORDION_HEADER_DELIVERY_OPTION_SNS_LINK).removeClass('aok-hidden')
            c(d.SNS_DELIVERY_OPTION_SNS_LINK_TEXT_IDENTIFIER).removeClass('aok-hidden')
            c(d.SNS_DELIVERY_OPTION_ONML_LINK_TEXT_IDENTIFIER).addClass('aok-hidden')
          } else
            c('.sns-delivery-link').addClass('aok-hidden'),
              c('.sns-delivery-link-weekly').addClass('aok-hidden'),
              c('.onml-delivery-link').removeClass('aok-hidden'),
              c(d.ACCORDION_HEADER_DELIVERY_OPTION_ONML_LINK).removeClass('aok-hidden'),
              c(d.ACCORDION_HEADER_DELIVERY_OPTION_SNS_LINK).addClass('aok-hidden'),
              c(d.SNS_DELIVERY_OPTION_SNS_LINK_TEXT_IDENTIFIER).addClass('aok-hidden'),
              c(d.SNS_DELIVERY_OPTION_ONML_LINK_TEXT_IDENTIFIER).removeClass('aok-hidden')
          b = b.highlightedDiscount
          var e = a.getDiscountTypeParam(),
            f = null != a.getIsB2bDiscountWinningMap() && !0 === a.getIsB2bDiscountWinningMap()[0],
            p = null != a.getIsB2bDiscountWinningMap() && !0 === a.getIsB2bDiscountWinningMap()[1]
          0 === b
            ? (c('#subscriptionPrice \x3e #sns-base-price').removeClass('aok-hidden'),
              c('#subscriptionPrice \x3e #sns-tiered-price').addClass('aok-hidden'),
              c('#snsDetailPagePrice \x3e #sns-base-price').removeClass('aok-hidden'),
              c('#snsDetailPagePrice \x3e #sns-tiered-price').addClass('aok-hidden'),
              c(d.SNS_BASE_DISCOUNT_MESSAGE).removeClass('aok-hidden'),
              c(d.SNS_TIERED_DISCOUNT_MESSAGE).addClass('aok-hidden'),
              c('.discountPillLeft').addClass('pillLightUp'),
              c('.discountPillRight').removeClass('pillLightUp'),
              e === d.DISCOUNT_TYPE_ZERO_BASE || f
                ? c('#snsDiscountPill').addClass('aok-hidden')
                : c('#snsDiscountPill').removeClass('aok-hidden'),
              f
                ? (c('.sns-ab-price-win-delivery-buybox-upsell-message').removeClass('aok-hidden'),
                  c('.sns-delivery-buybox-upsell-message').addClass('aok-hidden'),
                  c('.sns-delivery-buybox-upsell-additional-message-title').addClass('aok-hidden'),
                  c('.sns-delivery-buybox-upsell-additional-message').addClass('aok-hidden'))
                : (c('.sns-ab-price-win-delivery-buybox-upsell-message').addClass('aok-hidden'),
                  c('.sns-delivery-buybox-upsell-message').removeClass('aok-hidden'),
                  c('.sns-delivery-buybox-upsell-additional-message-title').removeClass(
                    'aok-hidden',
                  ),
                  c('.sns-delivery-buybox-upsell-additional-message').removeClass('aok-hidden')))
            : (c('#subscriptionPrice \x3e #sns-base-price').addClass('aok-hidden'),
              c('#subscriptionPrice \x3e #sns-tiered-price').removeClass('aok-hidden'),
              c('#snsDetailPagePrice \x3e #sns-base-price').addClass('aok-hidden'),
              c('#snsDetailPagePrice \x3e #sns-tiered-price').removeClass('aok-hidden'),
              c(d.SNS_BASE_DISCOUNT_MESSAGE).addClass('aok-hidden'),
              c(d.SNS_TIERED_DISCOUNT_MESSAGE).removeClass('aok-hidden'),
              c('.discountPillLeft').removeClass('pillLightUp'),
              c('.discountPillRight').addClass('pillLightUp'),
              (e === d.DISCOUNT_TYPE_ZERO_BASE && 'onml' === g) || p
                ? c('#snsDiscountPill').addClass('aok-hidden')
                : c('#snsDiscountPill').removeClass('aok-hidden'),
              p
                ? (c('.sns-ab-price-win-delivery-buybox-upsell-message').removeClass('aok-hidden'),
                  c('.sns-delivery-buybox-upsell-message').addClass('aok-hidden'),
                  c('.sns-delivery-buybox-upsell-additional-message-title').addClass('aok-hidden'),
                  c('.sns-delivery-buybox-upsell-additional-message').addClass('aok-hidden'))
                : (c('.sns-ab-price-win-delivery-buybox-upsell-message').addClass('aok-hidden'),
                  c('.sns-delivery-buybox-upsell-message').removeClass('aok-hidden'),
                  c('.sns-delivery-buybox-upsell-additional-message-title').removeClass(
                    'aok-hidden',
                  ),
                  c('.sns-delivery-buybox-upsell-additional-message').removeClass('aok-hidden')),
              e === d.DISCOUNT_TYPE_ZERO_BASE &&
                'sns' === g &&
                ((g = a.getSubscriberDiscountMessageWeblabTreatment()),
                'undefined' === typeof g || null === g
                  ? a.emitMetric('snsSdmExperimentTreatmentUndefined')
                  : (a.recordWeblabTriggers(d.SUBSCRIBER_DISCOUNT_MESSAGE_EXPERIMENT_ID, g),
                    a.emitMetric('snsSdmExperimentTriggeringSuccess'))))
        },
        getFrequencyValueExcludingDeliveryType: function (a) {
          if (null !== a && 'string' === typeof a) return a.replace(/\|(.*)/, '')
        },
        getQuantityIndex: function () {
          var a = f.$(d.SNS_QUANTITY)
          try {
            var b = a.prop('selectedIndex')
            if (0 === b) return b
            if (0 < b) return b - ('a-prompt' === a[0].options[0].className ? 1 : 0)
          } catch (c) {
            l.ue &&
              l.ue.count(
                'snsQuantityIndexException',
                (ue.count('snsQuantityIndexException') || 0) + 1,
              )
          }
        },
        getFrequencyIndex: function (a) {
          var b = c("input[name\x3d'" + (a + 'FrequencySelectedIndex') + "']")
          return b !== t && null !== b && 0 !== b.length
            ? b.val()
            : a === e.DELIVERY_OPTION.SNS
              ? c('[name\x3drcxOrdFreqSns]').prop('selectedIndex')
              : c('[name\x3drcxOrdFreqOnml]').prop('selectedIndex')
        },
        getFrequencyValue: g,
        isSelectedFreqSameAsDefaultFreq: function () {
          var b = a.getDefaultFrequency(!0),
            c = a.getDefaultFrequency(!1),
            b = null !== b ? b : c,
            c = (c =
              a.getSelectedDeliveryOption() === e.DELIVERY_OPTION.SNS
                ? g(e.DELIVERY_OPTION.SNS)
                : g(e.DELIVERY_OPTION.ONML))
              ? c.split('|')[0]
              : null
          return b === c
        },
      }
    },
  )
  n.when('ready').register('sns-stringify-util', function () {
    return JSON && 'function' === typeof JSON.stringify
      ? JSON.stringify
      : (function () {
          var f = {
              '"': '\\"',
              '\\': '\\\\',
              '\b': '\\b',
              '\f': '\\f',
              '\n': '\\n',
              '\r': '\\r',
              '\t': '\\t',
            },
            b = /[\\"\u0000-\u001F\u2028\u2029]/g,
            a = Object.prototype.toString,
            d =
              Array.isArray ||
              function (b) {
                return '[object Array]' === a.call(b)
              },
            e = function (a) {
              return f[a] || '\\u' + (a.charCodeAt(0) + 65536).toString(16).substr(1)
            }
          return function g(f) {
            if (null === f) return 'null'
            if ('number' === typeof f) return isFinite(f) ? f.toString() : 'null'
            if ('boolean' === typeof f) return f.toString()
            if ('object' === typeof f) {
              if ('function' === typeof f.toJSON) return g(f.toJSON())
              if (d(f)) {
                for (var q = '[', h = 0; h < f.length; h++) q += (h ? ', ' : '') + g(f[h])
                return q + ']'
              }
              if ('[object Object]' === a.call(f)) {
                q = []
                for (h in f) f.hasOwnProperty(h) && q.push(g(h) + ': ' + g(f[h]))
                return '{' + q.join(', ') + '}'
              }
            }
            return '"' + f.toString().replace(b, e) + '"'
          }
        })()
  })
  n.when('A', 'sns-stringify-util', 'ready').register('sns-declarative-util', function (f, b) {
    function a(a) {
      return a && ('object' === typeof a || 'object' === typeof a.prototype)
    }
    function d() {
      for (var a = 0; a < arguments.length; a++)
        if ('string' !== typeof arguments[a]) throw 'Function parameter must be of type string.'
    }
    function e() {
      for (
        var a = Object.prototype.toString,
          b =
            Array.isArray ||
            function (b) {
              return '[object Array]' === a.call(b)
            },
          c = 0;
        c < arguments.length;
        c++
      ) {
        var e = arguments[c]
        if (b(e) && 0 < e.length) for (var f = 0; f < e.length; f++) d(e[f])
        else throw 'Function parameter must be a non empty array.'
      }
    }
    function c(c) {
      var d = 'data-' + c.getAttribute('data-action'),
        e = function () {
          var a = c.getAttribute(d),
            e = a ? f.parseJSON(a) : {}
          e.save = function () {
            var a = e.save
            delete e.save
            var f = b(e)
            c.setAttribute(d, f)
            e.save = a
          }
          return e
        }
      return {
        hasExactKeyHeirarchy: function (b, c) {
          var g = e()
          b = b.split('.')
          for (var d = 0 < b.length, f = 0; f < b.length && d; f++)
            var k = b[f], d = a(g) && g.hasOwnProperty(k), g = g[k]
          d && c !== t && (d = g === c)
          return d
        },
        hasParsableJSON: function () {
          try {
            return e().save(), !0
          } catch (a) {
            return !1
          }
        },
        put: function (b) {
          var c = e()
          a(c.inputs) || (c.inputs = {})
          f.$.each(b, function (a, b) {
            c.inputs[a] = b
          })
          c.save()
        },
        getData: e,
      }
    }
    return {
      query: function (b) {
        e(b)
        var k = [],
          q = [],
          h = [],
          m,
          p,
          r = function () {
            return {
              numberOfMatchingActions: k.length,
              allMatchKeyValue: function (a, b) {
                d(a)
                for (
                  var c = 0 < this.numberOfMatchingActions, g = 0;
                  g < this.numberOfMatchingActions && c;
                  g++
                )
                  c = (c = k[g]) && c.hasExactKeyHeirarchy(a, b)
                return c
              },
              putAll: function (a) {
                for (var b = 0; b < this.numberOfMatchingActions; b++) k[b].put(a)
              },
              getStrings: function () {
                for (var a = 0; a < this.numberOfMatchingActions; a++) {
                  var b = k[a]
                  if (b.getData().strings) return b.getData().strings
                }
                return []
              },
              getData: function () {
                for (var a = 0; a < this.numberOfMatchingActions; a++) {
                  var b = k[a]
                  if (b.getData()) return b.getData()
                }
                return []
              },
            }
          },
          l = function () {
            for (
              var d = f.$('#buybox').find('.a-declarative').get(), e = 0 < q.length, m = 0;
              m < d.length;
              m++
            ) {
              var p = d[m],
                l
              a: {
                l = p
                for (var n = b, t = 0; t < n.length; t++) {
                  var v
                  var y = l
                  v = n[t]
                  a(y) && 'string' === typeof v
                    ? ((y = y.getAttribute('data-action') || ''), (v = 0 === v.localeCompare(y)))
                    : (v = !1)
                  if (v) {
                    l = !0
                    break a
                  }
                }
                l = !1
              }
              if (l && ((p = c(p)), p.hasParsableJSON()))
                if (e) {
                  l = !0
                  for (n = 0; n < q.length && l; n++) l = p.hasExactKeyHeirarchy(q[n], h[n])
                  l && k.push(p)
                } else k.push(p)
            }
            return r()
          }
        m = function (a) {
          d(a)
          q.push(a)
          return {
            equals: p,
            equalsAny: function () {
              return p(t)
            },
          }
        }
        p = function (a) {
          h.push(a)
          return { where: m, execute: l }
        }
        return { where: m, execute: l }
      },
    }
  })
  n.when('A', 'sns-utils', 'sns-buybox-constants', 'sns-declarative-util').register(
    'sns-atc-utils',
    function (f, b, a, d) {
      var e = f.$,
        c = ['aw-mash', 'add-to-cart', 'one-click', 'show-services-interstitial'],
        g = function (a) {
          d.query(c).where('buttonID').equals('add-to-cart').execute().putAll(a)
          d.query(c).where('buttonID').equals('buy-now').execute().putAll(a)
          d.query(c).where('buttonID').equals('buy-now-one-click').execute().putAll(a)
        }
      return {
        initializeOnmlDeclaratives: function () {
          if (b.isSnSEligible()) {
            var c = b.getAStateFromDom(
              a.SNS_OPT_IN_FEATURE_DIV,
              'sns-add-to-cart-params',
              'addToCartParams',
            )
            g(c || {})
            e('\x3cinput type\x3dhidden value\x3dtrue \x3e')
              .prop('id', a.SNS_ONML_INIT_INPUT_ID)
              .appendTo(a.SNS_OPT_IN_FEATURE_DIV)
          }
        },
        setOnmlDeclaratives: g,
        getAddToCartStrings: function () {
          return d.query(c).where('buttonID').equals('add-to-cart').execute().getStrings()
        },
        getAddToCartData: function () {
          return d.query(c).where('buttonID').equals('add-to-cart').execute().getData()
        },
      }
    },
  )
  n.when('A', 'sns-utils', 'sns-constants', 'sns-atc-utils').register(
    'sns-atc',
    function (f, b, a, d) {
      return {
        init: function () {
          b.registerCallbackForNameSpace(
            a.EVENT_NAMESPACE.PAGE_UPDATE,
            d.initializeOnmlDeclaratives,
          )
          d.initializeOnmlDeclaratives()
        },
      }
    },
  )
  n.when('A', 'sns-buybox-constants', 'sns-onmlv2-utils', 'sns-moq-helper').register(
    'sns-onmlv2-atc',
    function (f, b, a, d) {
      function e(g) {
        if (d.isSnsLocked()) a.emitMetric('sns-onmlv2-atc-sns-locked-moq')
        else {
          var e = c('\x3cform\x3e', {
              method: b.SUBSCRIBE_ADD_TO_CART_FORM_ATTRIBUTES.method,
              action: b.SUBSCRIBE_ADD_TO_CART_FORM_ATTRIBUTES.action,
              id: b.SUBSCRIBE_ADD_TO_CART_FORM_ATTRIBUTES.id,
              name: b.SUBSCRIBE_ADD_TO_CART_FORM_ATTRIBUTES.name,
            }),
            f = ''
          if (a.isCbbTemplateEnabled()) {
            a.emitMetric('sns-onmlv2-atc-cbb-template-enabled')
            for (
              var h = [
                  { name: 'ASIN' },
                  { name: 'offerListingID', fieldName: 'snsOfferListingID' },
                  { name: 'snsAddressId' },
                  { name: 'snsOnmlOfferId' },
                  { name: 'snsMostCommonFrequency' },
                  { name: 'rcxOrdFreq' },
                  { name: 'quantity' },
                ],
                m = 0;
              m < h.length;
              m++
            )
              var p = h[m].name,
                r = h[m].fieldName ? h[m].fieldName : p,
                r = a.getOnmlv2FormValueByName(r),
                f = f + a.createHiddenInput(p, r)
          } else {
            a.emitMetric('sns-onmlv2-atc-cbb-template-not-enabled')
            a.removeFormFieldsIntroducedByCbb()
            h = [
              { name: 'ASIN' },
              { name: 'offerListingID', fieldName: 'snsOfferListingID' },
              { name: 'rcxOrdFreq' },
              { name: 'snsOnmlOfferId' },
              { name: 'snsMostCommonFrequency' },
              { name: 'snsAddressId' },
            ]
            for (m = 0; m < h.length; m++)
              (p = h[m].name),
                (r = h[m].fieldName ? h[m].fieldName : p),
                (r = a.isMobileDevice()
                  ? c(b.MOBILE_ADD_TO_CART_DIV + ' [name\x3d' + r + ']').val()
                  : a.isWeb()
                    ? c(b.ADD_TO_CART_DIV + ' [name\x3d' + r + ']').val()
                    : c(b.TABLET_ADD_TO_CART_DIV + ' [name\x3d' + r + ']').val()),
                (f += a.createHiddenInput(p, r))
            h = a.isMobileDevice()
              ? c(b.SNS_MOBILE_QUANTITY)
              : c(b.QUANTITY_CONTAINER).find(b.SNS_QUANTITY)
            f += a.createHiddenInput('quantity', h.val())
          }
          f += a.createHiddenInput('ref', g)
          f += a.createHiddenInput('submit.add-to-cart', '1')
          e.html(f)
          c('body').append(e)
          c(b.SNS_ADD_TO_CART_FORM).submit()
          c(b.SNS_ADD_TO_CART_FORM).remove()
        }
      }
      var c = f.$
      f.declarative('sns-add-to-cart', 'click', function (b) {
        a.emitMetric('sns-onmlv2-atc-sns-add-to-cart')
        e('onmlv2_atc')
      })
      return { createAndSubmitAddToCartForm: e }
    },
  )
  n.when('A', 'sns-utils', 'sns-constants', 'sns-buybox-constants', 'sns-atc-utils').register(
    'sns-buybox-utils',
    function (f, b, a, d) {
      var e = function (a) {
          if (0 < a.length) return a.innerWidth() < a[0].scrollWidth
        },
        c = function (c, d, e) {
          d =
            c + '_' + (e ? 'checkedLabel' : 'uncheckedLabel') + '_' + ('oneClick' === c ? d : 'all')
          c = b.getOnmlParam(d)
          d = (e = b.getOnmlUserPref(a.USER_PREFS_KEYS.ONML_PARAMS)) && e[d]
          if ((c = c || d)) return f.$('\x3cp\x3e' + c + '\x3c/p\x3e').text()
        }
      return {
        updateOneClickButtonLabel: function (a) {
          if (b.isVerucaOneClickEnabled()) {
            a = 'boolean' === typeof a ? a : f.$(d.SNS_OPT_IN_CHECKBOX).is(':checked')
            var k = f.$(d.ONE_CLICK_BUTTON),
              q = f.$(d.ONE_CLICK_BUTTON_ICON),
              h = f.$(d.ONE_CLICK_BUTTON_TEXT),
              m = b.getDeviceType(),
              p = c('oneClick', m, !0),
              m = c('oneClick', m, !1)
            p &&
              m &&
              (a
                ? (h.text(p), e(h) && (q.addClass('aok-hidden'), k.removeClass('a-button-icon')))
                : (h.text(m),
                  q.length && (k.addClass('a-button-icon'), q.removeClass('aok-hidden'))))
          }
        },
        updateBuyNowButtonLabel: function (a) {
          if (b.isVerucaBuyNowEnabled()) {
            a = 'boolean' === typeof a ? a : f.$(d.SNS_OPT_IN_CHECKBOX).is(':checked')
            var k = f.$(d.BUY_NOW_BUTTON),
              q = f.$(d.BUY_NOW_BUTTON_ICON),
              h = f.$(d.BUY_NOW_BUTTON_TEXT),
              m = b.getDeviceType(),
              p = c('buyNow', m, !0),
              m = c('buyNow', m, !1)
            p &&
              m &&
              (a
                ? (h.text(p), e(h) && (q.addClass('aok-hidden'), k.removeClass('a-button-icon')))
                : (h.text(m),
                  q.length && (k.addClass('a-button-icon'), q.removeClass('aok-hidden'))))
          }
        },
        updateAddToCartButtonLabel: function (a) {
          a = 'boolean' === typeof a ? a : f.$(d.SNS_OPT_IN_CHECKBOX).is(':checked')
          var k = f.$(d.ADD_TO_CART_BUTTON).closest('.a-button'),
            q = k.find('.a-button-inner'),
            h = k.find('i.a-icon'),
            m = k.find('span.a-button-text'),
            p = b.getDeviceType(),
            r = c('addToCart', p, !0),
            p = c('addToCart', p, !1)
          r &&
            p &&
            (a
              ? (m.text(r),
                q.addClass('sns-onml-sky-button-inner'),
                m.addClass('sns-onml-sky-button-text'),
                e(m) && (h.addClass('aok-hidden'), k.removeClass('a-button-icon')))
              : (m.text(p),
                q.removeClass('sns-onml-sky-button-inner'),
                m.removeClass('sns-onml-sky-button-text'),
                h.length && (k.addClass('a-button-icon'), h.removeClass('aok-hidden'))))
        },
        showSnSMerchantInfoIfSnSOptInChecked: function (a) {
          var b = f.$(d.SNS_ONML_MERCHANT_INFO)
          a = 'boolean' === typeof a ? a : f.$(d.SNS_OPT_IN_CHECKBOX).is(':checked')
          b.toggleClass('aok-hidden', !a)
        },
        showGoldBoxDiscountMessageIfSnSOptInChecked: function (a) {
          var b = f.$(d.GOLDBOX_DISCOUNT_MESSAGE)
          a = 'boolean' === typeof a ? a : f.$(d.SNS_OPT_IN_CHECKBOX).is(':checked')
          b.toggleClass('aok-hidden', !a)
        },
        showSubscribeOnlyButtonIfSnSOptInChecked: function (a) {
          var b = f.$(d.JUST_SUBSCRIBE_DIV)
          a = 'boolean' === typeof a ? a : f.$(d.SNS_OPT_IN_CHECKBOX).is(':checked')
          b.toggleClass('aok-hidden', !a)
        },
        logError: function (a, b) {
          l.ueLogError && l.ueLogError(a, { logLevel: 'ERROR', attribution: b, message: a })
        },
      }
    },
  )
  n.when('A', 'sns-buybox-constants', 'sns-onmlv2-utils', 'ready').execute(
    'sns-onmlv2-join-prime',
    function (f, b, a) {
      var d = f.$,
        e = function () {
          d(b.SNS_ONMLV2_JOIN_PRIME_CHECKBOX).length &&
            (d(b.SNS_ONMLV2_JOIN_PRIME_UPSELL).removeClass('aok-hidden'),
            d(b.SNS_ONMLV2_JOIN_PRIME_CHECKBOX).is(':checked')
              ? (d(b.SNS_ONMLV2_JOIN_PRIME_BUTTON).removeClass('aok-hidden'),
                d(b.SNS_SUBSCRIBE_SUBMIT_BUTTON).addClass('aok-hidden'))
              : (d(b.SNS_ONMLV2_JOIN_PRIME_BUTTON).addClass('aok-hidden'),
                d(b.SNS_SUBSCRIBE_SUBMIT_BUTTON).removeClass('aok-hidden')))
        }
      e()
      d(document).delegate(b.SNS_ONMLV2_JOIN_PRIME_CHECKBOX, 'change', function (a) {
        e()
      })
      f.declarative('sns-join-prime', 'click', function (c) {
        c = f.state('momJoinPrimeEndpointState')
        c = d('\x3cform\x3e', {
          method: b.SNS_JOIN_PRIME_FORM_ATTRIBUTES.method,
          action: c && c.endpoint ? c.endpoint : '/gp/prime/pipeline/membersignup/',
          id: b.SNS_JOIN_PRIME_FORM_ATTRIBUTES.id,
          name: b.SNS_JOIN_PRIME_FORM_ATTRIBUTES.name,
        })
        for (
          var e = '', k = [{ name: 'session-id' }, { name: 'momAsin' }, { name: 'ref' }], q = 0;
          q < k.length;
          q++
        )
          var h = k[q].name,
            m = a.getSubscribeButtonFormValueByName(h),
            e = e + a.createHiddenInput(h, m)
        c.html(e)
        d('body').append(c)
        d(b.SNS_JOIN_PRIME_FORM).submit()
        d(b.SNS_JOIN_PRIME_FORM).remove()
      })
    },
  )
  n.when('A', 'ready').execute('sns-load-static-images', function (f) {
    var b = f.$
    b('#learnMoreBottomSheet .a-manually-loaded').each(function () {
      f.loadImageManually(b(this))
    })
  })
  n.when('A', 'sns-buybox-constants', 'sns-onmlv2-utils').execute(
    'sns-legacy-subscribe',
    function (f, b, a) {
      var d = f.$
      f.declarative('sns-legacy-subscribe', 'click', function (e) {
        e = d('\x3cform\x3e', {
          method: b.SNS_LEGACY_SUBSCRIBE_FORM_ATTRIBUTES.method,
          action: b.SNS_LEGACY_SUBSCRIBE_FORM_ATTRIBUTES.action,
          id: b.SNS_LEGACY_SUBSCRIBE_FORM_ATTRIBUTES.id,
          name: b.SNS_LEGACY_SUBSCRIBE_FORM_ATTRIBUTES.name,
        })
        for (
          var c = '',
            g = [
              { name: 'ASIN' },
              { name: 'offerListingID' },
              { name: 'merchantID' },
              { name: 'snsOfferListingID' },
              { name: 'snsMerchantID' },
              { name: 'rcxOrdFreq' },
              { name: 'quantity' },
            ],
            f = 0;
          f < g.length;
          f++
        )
          var q = g[f].name,
            h = a.getSubscribeButtonFormValueByName(q),
            c = c + a.createHiddenInput(q, h)
        c += a.createHiddenInput('ref', 'sns-legacy-subscribe')
        c += a.createHiddenInput('submit.rcx-subscribe', '1')
        e.html(c)
        d('body').append(e)
        d(b.SNS_LEGACY_SUBSCRIBE_FORM).submit()
        d(b.SNS_LEGACY_SUBSCRIBE_FORM).remove()
      })
    },
  )
  n.when(
    'A',
    'sns-subscribe-button-trigger-handler',
    'sns-subscribe-button-utils',
    'sns-constants',
  ).execute('sns-subscribe-button', function (f, b, a, d) {
    f.declarative('sns-submit-btn-declarative', 'click', function (e) {
      a.emitMetric('sns-subscribe-button-sns-submit-btn-declarative-called')
      b.triggerInterstitialWeblabIfEligible(d.WEBLAB_TREATMENT.C)
      a.createAndSubmitSubscribeNowForm('sns-subscribe-btn-dp-vmf-')
    })
    f.declarative('sns-subscribe-poi-declarative', 'click', function (b) {
      a.emitMetric('sns-subscribe-button-sns-subscribe-poi-declarative-called')
      a.createAndSubmitSubscribeNowForm(b.data.refTag)
    })
    f.declarative('sns-mom-submit-btn-declarative', 'click', function (b) {
      a.emitMetric('sns-subscribe-button-sns-mom-submit-btn-declarative-called')
      a.createAndSubmitSubscribeNowForm('sns-mom-btn-dp-vmf-')
    })
  })
  n.when('A', 'sns-onmlv2-utils', 'sns-metrics-constants', 'ready').register(
    'sns-subscribe-button-trigger-handler',
    function (f, b, a) {
      var d = !1
      return {
        triggerInterstitialWeblabIfEligible: function (e) {
          var c
          try {
            c = f.state('subscribe-now-interstitial-experience-enabled')
          } catch (g) {
            b.logErrorWithAttribution(
              'sns-subscribe-button-trigger-handler',
              'Exception ' +
                g +
                ' caught while getting subscribe-now-interstitial-experience-enabled page state',
            )
          }
          if (null == c)
            b.emitMetric(a.SNS_SUBSCRIBE_NOW_INTERSTITIAL_ELIGIBLE_STATE_EXCEPTION_METRICS)
          else if (!0 === c.value)
            return (
              d ||
                (b.recordWeblabTriggers('A2I_SNS_DP_SUBSCRIBE_NOW_INTERSTITIAL_830984', e),
                b.emitMetric(
                  'A2I_SNS_DP_SUBSCRIBE_NOW_INTERSTITIAL_830984' +
                    a.METRIC_DELIMITER +
                    e +
                    a.METRIC_DELIMITER +
                    'WeblabTriggered',
                ),
                (d = !0)),
              !0
            )
          return !1
        },
      }
    },
  )
  n.when(
    'A',
    'sns-buybox-constants',
    'sns-onmlv2-utils',
    'sns-moq-helper',
    'sns-metrics-constants',
    'sns-vmf-utils',
    'sns-constants',
  ).register('sns-subscribe-button-utils', function (f, b, a, d, e, c, g) {
    var k = f.$
    return {
      emitMetric: function (a) {
        l.ue && l.ue.count(a, (ue.count(a) || 0) + 1)
      },
      createAndSubmitSubscribeNowForm: function (q) {
        if (!d.isSnsLocked()) {
          var h, m
          k('#chkMom').length && k('#chkMom').is(':checked')
            ? ((h = k('\x3cform\x3e', {
                method: b.SNS_JOIN_PRIME_FORM_ATTRIBUTES_VMF.method,
                action: b.SNS_JOIN_PRIME_FORM_ATTRIBUTES_VMF.action,
                id: b.SNS_JOIN_PRIME_FORM_ATTRIBUTES_VMF.id,
                name: b.SNS_JOIN_PRIME_FORM_ATTRIBUTES_VMF.name,
              })),
              (m = b.SNS_JOIN_PRIME_FORM_ATTRIBUTES_VMF.id))
            : ((h = k('\x3cform\x3e', {
                method: b.SUBSCRIBE_FORM_ATTRIBUTES.method,
                action: b.SUBSCRIBE_FORM_ATTRIBUTES.action,
                id: b.SUBSCRIBE_FORM_ATTRIBUTES.id,
                name: b.SUBSCRIBE_FORM_ATTRIBUTES.name,
              })),
              (m = b.SUBSCRIBE_FORM_ATTRIBUTES.id))
          for (var p = '', r = b.SUBSCRIBE_FORM_FIELDS, l = 0; l < r.length; l++) {
            var n = r[l].name,
              u = r[l].fieldName ? r[l].fieldName : n
            'rcxOrdFreqSns' === u
              ? ((u = c.getFrequencyValue(g.DELIVERY_OPTION.SNS)),
                a.emitMetric(e.SNS_CREATE_SUBSCRIPTION_WITH_FREQUENCY + u))
              : 'rcxOrdFreqOnml' === u
                ? ((u = c.getFrequencyValue(g.DELIVERY_OPTION.ONML)),
                  a.emitMetric(e.SNS_CREATE_SUBSCRIPTION_WITH_FREQUENCY + u))
                : (u = k("[name\x3d'" + u + "']").val())
            p += a.createHiddenInput(n, u)
          }
          r = f.$(b.SNS_MOBILE_QUANTITY)
          if (r === t || r.val() === t)
            if (((r = k("[name\x3d'rcxsubsQuan']")), r === t || r.val() === t))
              r = k("[id\x3d'rcxsubsQuan']")
          l =
            0 !== k(b.REPLENISHMENT_ONML_FREQUENCY_POPOVER_ID).length
              ? !k(b.REPLENISHMENT_ONML_FREQUENCY_POPOVER_ID).hasClass('aok-hidden')
              : 0 !== k(b.REPLENISHMENT_ONML_FREQUENCY_INFO_POPOVER_ID).length
                ? !k(b.REPLENISHMENT_ONML_FREQUENCY_INFO_POPOVER_ID).hasClass('aok-hidden')
                : !k('#rcxOrdFreqOnmlWrapper').hasClass('aok-hidden')
          l ||
            ((n = a.getDeliveryInfoParam().snsDates[c.getFrequencyIndex(g.DELIVERY_OPTION.SNS)]),
            (p += a.createHiddenInput('snsDate', n)))
          p += a.createHiddenInput('onmlSelected', l)
          p += a.createHiddenInput('vmfEnabled', 'true')
          p += a.createHiddenInput('quantity', r.val())
          p += a.createHiddenInput('ref', q + (l ? 'onml' : 'sns'))
          p += a.createHiddenInput('submit.subscribe', '1')
          h.html(p)
          k('body').append(h)
          a.emitInvalidFrequencyMetric(
            e.SNS_ONML_INVALID_FREQUENCY_SELECT_METRICS,
            e.SNS_LEGACY_INVALID_FREQUENCY_SELECT_METRICS,
          )
          k('#' + m).submit()
          k('#' + m).remove()
        }
      },
    }
  })
  ;('use strict')
  n.when('A').register('sns-upsell-message-trigger-handler', function (f) {
    function b() {
      var a = f.$('.a-accordion-active').data('a-accordion-row-name')
      return (
        'snsAccordionRowMiddle' === a ||
        'snsAccordionRowMobileMiddle' === a ||
        'snsAccordionRowMobileAppMiddle' === a
      )
    }
    var a = !1,
      d = function (a, b) {
        l.ue && 'function' === typeof l.ue.trigger && l.ue.trigger(a, b)
      },
      e = function (a) {
        l.ue && l.ue.count(a, (ue.count(a) || 0) + 1)
      }
    return {
      handleAnnualSavingsExperimentTriggering: function (c, g) {
        try {
          a ||
            null === c ||
            0 === c.length ||
            (b()
              ? (d('CONSUMABLES_SNS_DP_ANNUAL_SAVINGS_EXPERIMENT_713035', g),
                (a = !0),
                e('snsAnnualSavingsWeblabTriggeringSuccess'))
              : e('snsAccordionNotActiveForAnnualSavingsExperiment'))
        } catch (k) {
          e('snsAnnualSavingsWeblabTriggeringFailure')
        }
        f.on('a:accordion:buybox-accordion:select', function (b) {
          try {
            if (!a && null !== c && 0 !== c.length) {
              var f = b.selectedRow.rowName
              'snsAccordionRowMiddle' === f ||
              'snsAccordionRowMobileMiddle' === f ||
              'snsAccordionRowMobileAppMiddle' === f
                ? (d('CONSUMABLES_SNS_DP_ANNUAL_SAVINGS_EXPERIMENT_713035', g),
                  (a = !0),
                  e('snsAnnualSavingsWeblabTriggeringSuccess'))
                : e('snsAccordionNotSelectedForAnnualSavingsExperiment')
            }
          } catch (h) {
            e('snsAnnualSavingsWeblabTriggeringFailure')
          }
        })
      },
    }
  })
  n.register('sns-constants', function () {
    return {
      TIERED: 'tiered',
      NON_TIERED: 'nonTiered',
      BASE: 'BASE',
      PREMIUM: 'PREMIUM',
      ZERO_BASE: 'ZERO_BASE',
      EVENT_NAMESPACE: {
        PAGE_UPDATE: 'pageUpdate',
        FREQUENCY_HIDDEN_INPUT_CHANGE: 'frequencyHiddenInputChange',
      },
      USER_PREFS_KEYS: {
        SNS_OPT_IN: 'snsOptIn',
        SNS_FREQUENCY: 'rcxOrdFreq',
        ONML_PARAMS: 'onmlParams',
      },
      DELIVERY_OPTION: { SNS: 'sns', ONML: 'onml' },
      WEBLAB_TREATMENT: { C: 'C', T1: 'T1', T2: 'T2' },
      DEVICE_TYPE: { DESKTOP: 'desktop', MOBILE: 'mobile', MOBILE_APP: 'mobile_app' },
      ACCORDION_ROW_NAME_SELECTOR: 'a-accordion-row-name',
      ACTIVE_ACCORDION_SELECTOR: '.a-accordion-active',
      SNS_ACCORDION_ROW_NAME_DESKTOP: 'snsAccordionRowMiddle',
      SNS_ACCORDION_ROW_NAME_MOBILE: 'snsAccordionRowMobileMiddle',
      SNS_ACCORDION_ROW_NAME_MOBILE_APP: 'snsAccordionRowMobileAppMiddle',
    }
  })
  n.when('A', 'sns-utils', 'sns-constants', 'sns-buybox-constants').register(
    'sns-event-handler',
    function (f, b, a, d) {
      return {
        init: function () {
          function e(a) {
            for (
              var b = f.$('\x3cform\x3e', {
                  method: d.SUBSCRIBE_ONLY_FORM_ATTRIBUTES.method,
                  action: d.SUBSCRIBE_ONLY_FORM_ATTRIBUTES.action,
                  id: d.SUBSCRIBE_ONLY_FORM_ATTRIBUTES.id,
                  name: d.SUBSCRIBE_ONLY_FORM_ATTRIBUTES.name,
                }),
                e = [
                  { name: 'ASIN' },
                  { name: 'offerListingID' },
                  { name: 'merchantID' },
                  { name: 'rcxOrdFreq' },
                  { name: 'snsOfferListingID' },
                  { name: 'snsMerchantID' },
                ],
                l = '',
                h = 0;
              h < e.length;
              h++
            )
              var m = e[h].name,
                p = f.$('[name\x3d' + m + ']').val(),
                l = l + ('\x3cinput type\x3d"hidden" name\x3d"' + m + '" value\x3d"' + p + '"\x3e')
            l =
              l +
              ('\x3cinput type\x3d"hidden" name\x3d"ref" value\x3d"' + a + '"\x3e') +
              '\x3cinput type\x3d"hidden" name\x3d"submit.rcx-subscribe" value\x3d"1"\x3e'
            a = f.$(d.QUANTITY_CONTAINER).find(d.QUANTITY)
            l += '\x3cinput type\x3d"hidden" name\x3d"quantity" value\x3d"' + a.val() + '"\x3e'
            b.html(l)
            f.$('body').append(b)
            f.$(d.SUBSCRIBE_ONLY_FORM).submit()
          }
          b.isSnSEligible() && b.setOnmlUserPref(a.USER_PREFS_KEYS.ONML_PARAMS, b.getOnmlParam())
          b.registerCallbackForNameSpace(a.EVENT_NAMESPACE.PAGE_UPDATE, function () {
            var c = b.getOnmlUserPref(a.USER_PREFS_KEYS.ONML_PARAMS) || {},
              e = c.asin,
              k = b.getOnmlParam('asin')
            c.asin = k
            b.setOnmlUserPref(a.USER_PREFS_KEYS.ONML_PARAMS, c)
            c = e !== k
            e = b.getOnmlUserPref(a.USER_PREFS_KEYS.SNS_OPT_IN)
            'undefined' !== typeof e &&
              f.$(d.SNS_OPT_IN_CHECKBOX).is(':checked') !== e &&
              (b.enableSnSOptIn(), f.$(d.SNS_OPT_IN_CHECKBOX).click())
            ;(e = b.getOnmlUserPref(a.USER_PREFS_KEYS.SNS_FREQUENCY)) && !c
              ? b.isMobileDevice()
                ? f
                    .$(d.SNS_FREQ_BOTTOMSHEET_SELECTOR)
                    .find('button[value\x3d' + e + ']')
                    .click()
                : f
                    .$('[data-a-accordion-row-name\x3dfrequencyAccordionRow' + (e - 1) + '] a')
                    .click()
              : b.deleteOnmlUserPref(a.USER_PREFS_KEYS.SNS_FREQUENCY)
          })
          f.$(d.SNS_FREQUENCY_FORM_FIELD).change(function () {
            b.executeCallbacksForNameSpace(a.EVENT_NAMESPACE.FREQUENCY_HIDDEN_INPUT_CHANGE)
          })
          f.on('a:pageUpdate', function () {
            b.executeCallbacksForNameSpace(a.EVENT_NAMESPACE.PAGE_UPDATE)
          })
          f.declarative('subscribe-only', 'click', function (a) {
            e('onml_so_l')
          })
          f.declarative('just-subscribe', 'click', function (a) {
            e('onml_justsub_l')
          })
        },
      }
    },
  )
  n.register('sns-metrics-constants', function () {
    return {
      METRIC_DELIMITER: '.',
      B2B_BUY_BOX_MESSAGE_UPDATE_SUCCESSFUL: 'b2bBuyBoxMessageUpdateSuccessful',
      B2B_BUY_BOX_MESSAGE_UPDATE_FAILED: 'b2bBuyBoxMessageUpdateFailed',
      SNS_ONML_EXISTING_SNS_CUSTOMER_CHECK_METRICS: 'snsOnmlExistingSnsCustomerCheck',
      SNS_ONML_NEW_SNS_CUSTOMER_CHECK_METRICS: 'snsOnmlNewSnsCustomerCheck',
      SNS_ONML_EXISTING_SNS_CUSTOMER_UNCHECK_METRICS: 'snsOnmlExistingSnsCustomerUncheck',
      SNS_ONML_NEW_SNS_CUSTOMER_UNCHECK_METRICS: 'snsOnmlNewSnsCustomerUncheck',
      SNS_SIGN_IN_IF_NOT_ALREADY_SIGNED_IN_METRICS: 'snsSignInIfNotAlreadySignedIn',
      SNS_ONML_FREQUENCY_LABEL_CLICK_METRICS: 'snsOnmlFrequencyLabelClick',
      SNS_ONML_FREQUENCY_CHANGE_METRICS: 'snsOnmlFrequencyChange',
      SNS_ONML_WEEKLY_FREQUENCY_SELECT_METRICS: 'snsOnmlWeeklyFrequencySelectMetrics',
      SNS_ONML_MONTHLY_FREQUENCY_SELECT_METRICS: 'snsOnmlMonthlyFrequencySelectMetrics',
      SNS_ONML_INVALID_FREQUENCY_SELECT_METRICS: 'snsOnmlInvalidFrequencySelectMetrics',
      B2B_ONML_WEEKLY_FREQUENCY_SELECT_METRICS: 'b2bOnmlWeeklyFrequencySelectMetrics',
      B2B_ONML_MONTHLY_FREQUENCY_SELECT_METRICS: 'b2bOnmlMonthlyFrequencySelectMetrics',
      SNS_LEGACY_WEEKLY_FREQUENCY_SELECT_METRICS: 'snsLegacyWeeklyFrequencySelectMetrics',
      SNS_LEGACY_MONTHLY_FREQUENCY_SELECT_METRICS: 'snsLegacyMonthlyFrequencySelectMetrics',
      SNS_LEGACY_INVALID_FREQUENCY_SELECT_METRICS: 'snsLegacyInvalidFrequencySelectMetrics',
      SNS_ONML_UPSELL_MESSAGE_METRICS: 'snsOnmlUpsellMessage',
      SNS_ONML_SUBSCRIBE_ONLY_METRICS: 'snsOnmlSubscribeOnly',
      SNS_CUSTOMER_RECOGNIZED_BUT_NOT_SIGNED_IN: 'snsOnmlCustomerRecognizedButNotSignedIn',
      SNS_REQUIRE_SIGN_IN_STATUS_FAILED: 'snsOnmlRequireSignInStatusFailed',
      SNS_ONMLV2_POPOVER_TRIGGERS:
        'justSubscribeLearnMorePopoverNonTiered justSubscribeLearnMorePopoverTiered onmlv2LearnMorePopoverNonTiered onmlv2LearnMorePopoverTiered onmlv2LearnMorePopoverNewOrUnrecognized justSubscribePillPopoverNonTiered justSubscribePillPopoverTiered onmlv2PillPopoverNonTiered onmlv2PillPopoverTiered onmlv2PillPopoverNewOrUnrecognized'.split(
          ' ',
        ),
      SNS_ONMLV2_BOTTOMSHEET_TRIGGERS:
        'justSubscribeLearnMoreBottomsheetNonTiered justSubscribeLearnMoreBottomsheetTiered onmlv2LearnMoreBottomsheetNonTiered onmlv2LearnMoreBottomsheetTiered onmlv2LearnMoreBottomsheetNewOrUnrecognized justSubscribePillBottomsheetNonTiered justSubscribePillBottomsheetTiered onmlv2PillBottomsheetNonTiered onmlv2PillBottomsheetTiered onmlv2PillBottomsheetNewOrUnrecognized'.split(
          ' ',
        ),
      SNS_ONMLV2_DESKTOP_POPOVER_SHOW_METRICS: 'snsOnmlv2DesktopPopoverShow',
      SNS_ONMLV2_MOBILE_BOTTOMSHEET_SHOW_METRICS: 'snsOnmlv2MobileBottomsheetShow',
      SNS_ONMLV2_DELIVERY_OPTION_CLICK_METRICS: 'snsOnmlv2DeliveryOptionClick',
      SNS_ONMLV2_DELIVERY_OPTION_CLICK_MOBILE_METRICS: 'snsOnmlv2DeliveryOptionClickMobile',
      SNS_ONMLV2_SWITCH_TO_SNS_METRICS: 'snsOnmlv2SwitchToSns',
      SNS_ONMLV2_SWITCH_TO_ONML_METRICS: 'snsOnmlv2SwitchToOnml',
      SNS_ONMLV2_SWITCH_TO_SNS_MOBILE_METRICS: 'snsOnmlv2SwitchToSnsMobile',
      SNS_ONMLV2_SWITCH_TO_ONML_MOBILE_METRICS: 'snsOnmlv2SwitchToOnmlMobile',
      SNS_ONMLV2_SUBSCRIBE_NOW_WITH_ONML_DELIVERY_METRICS: 'snsOnmlv2SubscribeNowWithOnmlDelivery',
      SNS_ONMLV2_SUBSCRIBE_NOW_WITH_SNS_DELIVERY_METRICS: 'snsOnmlv2SubscribeNowWithSnsDelivery',
      SNS_ONMLV2_SUBSCRIBE_NOW_WITH_ONML_DELIVERY_MOBILE_METRICS:
        'snsOnmlv2SubscribeNowWithOnmlDeliveryMobile',
      SNS_ONMLV2_SUBSCRIBE_NOW_WITH_SNS_DELIVERY_MOBILE_METRICS:
        'snsOnmlv2SubscribeNowWithSnsDeliveryMobile',
      SNS_QUANTITY_SELECT_DESKTOP: 'snsQuantitySelectDesktop',
      SNS_QUANTITY_SELECT_MOBILE: 'snsQuantitySelectMobile',
      SNS_SWITCH_WIDGET_SEE_PRODUCTS_ONMLV2_METRICS: 'snsSwitchWidgetSeeProductsOnmlv2',
      SNS_SWITCH_WIDGET_SEE_PRODUCTS_LEGACY_METRICS: 'snsSwitchWidgetSeeProductsLegacy',
      SNS_SWITCH_WIDGET_CONTINUE_LEGACY_METRICS: 'snsSwitchWidgetContinueLegacy',
      SNS_SWITCH_WIDGET_CONTINUE_WITH_ONE_NOW_METRICS: 'snsSwitchWidgetContinueWithOneNow',
      SNS_SWITCH_WIDGET_CONTINUE_WITH_SNS_METRICS: 'snsSwitchWidgetContinueWithSns',
      SNS_SWITCH_WIDGET_BOTTOMSHEET_TOTAL_COUNT_METRICS: 'snsSwitchWidgetBottomsheetTotalCount',
      SNS_SUBSCRIBE_NOW_INTERSTITIAL_BOTTOMSHEET_SWITCH_OFFER_METRICS:
        'snsSubscribeNowInterstitialBottomsheetSwitchOfferCount',
      SNS_SUBSCRIBE_NOW_INTERSTITIAL_BOTTOMSHEET_SHOW_METRICS:
        'snsSubscribeNowInterstitialBottomsheetShowCount',
      SNS_SUBSCRIBE_NOW_INTERSTITIAL_BOTTOMSHEET_SUBSCRIBE_BUTTON_CLICK_METRIC:
        'snsSubscribeNowInterstitialBottomsheetSubscribeButtonClick',
      SNS_SUBSCRIBE_NOW_INTERSTITIAL_BOTTOMSHEET_CLOSE_METRICS:
        'snsSubscribeNowInterstitialBottomsheetCloseCount',
      SNS_SUBSCRIBE_NOW_INTERSTITIAL_ELIGIBLE_STATE_EXCEPTION_METRICS:
        'snsSubscribeNowInterstitialEligibleStateExceptionCount',
      SNS_ONMLV2_SUBSCRIBE_NOW_WITH_SAME_FREQ_AS_DEFAULT_FREQ: 'snsOnmlv2SubscribeNowWithSameFreq',
      SNS_ONMLV2_SUBSCRIBE_NOW_WITH_DIFFERENT_FREQUENCY_OTHER_THAN_DEFAULT_FREQ:
        'snsOnmlv2SubscribeNowWithDifferentFreq',
      SNS_INVALID_FREQUENCY_ACCORDION_ROW: 'snsInvalidFrequencyAccordionRow',
      SNS_ONML_FREQUENCY_POPOVER_SELECTED: 'snsOnmlFrequencyPopoverSelected',
      SNS_FREQUENCY_POPOVER_SELECTED: 'snsFrequencyPopoverSelected',
      SNS_ONML_FREQUENCY_LABEL_INGRESS_CLICKED: 'snsOnmlFrequencyLabelIngressClicked',
      SNS_FREQUENCY_LABEL_INGRESS_CLICKED: 'snsFrequencyLabelIngressClicked',
      SNS_ONML_FREQUENCY_INFO_LABEL_INGRESS_CLICKED: 'snsOnmlFrequencyInfoLabelIngressClicked',
      SNS_FREQUENCY_INFO_LABEL_INGRESS_CLICKED: 'snsFrequencyInfoLabelIngressClicked',
      SNS_INVALID_FREQUENCY_POPOVER_INPUTS: 'snsInvalidFrequencyPopoverInputs',
      SNS_INVALID_FREQUENCY_POPOVER_DATA_STRUCTURE: 'snsInvalidFrequencyPopoverDataStructure',
      SNS_CREATE_SUBSCRIPTION_WITH_FREQUENCY: 'snsCreateSubscriptionWithFrequency-',
    }
  })
  n.when('A', 'sns-utils', 'sns-metrics-constants', 'sns-buybox-constants').register(
    'sns-metrics-helper',
    function (f, b, a, d) {
      return {
        init: function () {
          f.declarative('sns-opt-in-checked', 'change', function () {
            var e = f.$(d.SNS_OPT_IN_CHECKBOX).is(':checked')
            l.ue &&
              (e
                ? b.isSnsCustomer()
                  ? l.ue.count(
                      a.SNS_ONML_EXISTING_SNS_CUSTOMER_CHECK_METRICS,
                      (ue.count(a.SNS_ONML_EXISTING_SNS_CUSTOMER_CHECK_METRICS) || 0) + 1,
                    )
                  : l.ue.count(
                      a.SNS_ONML_NEW_SNS_CUSTOMER_CHECK_METRICS,
                      (ue.count(a.SNS_ONML_NEW_SNS_CUSTOMER_CHECK_METRICS) || 0) + 1,
                    )
                : b.isSnsCustomer()
                  ? l.ue.count(
                      a.SNS_ONML_EXISTING_SNS_CUSTOMER_UNCHECK_METRICS,
                      (ue.count(a.SNS_ONML_EXISTING_SNS_CUSTOMER_UNCHECK_METRICS) || 0) + 1,
                    )
                  : l.ue.count(
                      a.SNS_ONML_NEW_SNS_CUSTOMER_UNCHECK_METRICS,
                      (ue.count(a.SNS_ONML_NEW_SNS_CUSTOMER_UNCHECK_METRICS) || 0) + 1,
                    ))
          })
          f.$(document).delegate('.sns-buybox-upsell-trigger', 'click', function (b) {
            l.ue &&
              l.ue.count(
                a.SNS_ONML_UPSELL_MESSAGE_METRICS,
                (ue.count(a.SNS_ONML_UPSELL_MESSAGE_METRICS) || 0) + 1,
              )
          })
          f.$(document).delegate('#sns-dp-frequency-trigger', 'click', function (b) {
            l.ue &&
              l.ue.count(
                a.SNS_ONML_FREQUENCY_LABEL_CLICK_METRICS,
                (ue.count(a.SNS_ONML_FREQUENCY_LABEL_CLICK_METRICS) || 0) + 1,
              )
          })
          f.$(document).delegate('#snsSelectedFrequencyLabel', 'click', function (b) {
            l.ue &&
              l.ue.count(
                a.SNS_ONML_FREQUENCY_LABEL_CLICK_METRICS,
                (ue.count(a.SNS_ONML_FREQUENCY_LABEL_CLICK_METRICS) || 0) + 1,
              )
          })
          f.on('a:accordion:sns-dp-frequency-accordion:select', function () {
            l.ue &&
              l.ue.count(
                a.SNS_ONML_FREQUENCY_CHANGE_METRICS,
                (ue.count(a.SNS_ONML_FREQUENCY_CHANGE_METRICS) || 0) + 1,
              )
          })
          f.$(document).delegate('#snsFrequencyBottomSheet button', 'click', function (b) {
            l.ue &&
              l.ue.count(
                a.SNS_ONML_FREQUENCY_CHANGE_METRICS,
                (ue.count(a.SNS_ONML_FREQUENCY_CHANGE_METRICS) || 0) + 1,
              )
          })
          f.$(document).delegate('#subscribe-only', 'click', function (b) {
            l.ue &&
              l.ue.count(
                a.SNS_ONML_SUBSCRIBE_ONLY_METRICS,
                (ue.count(a.SNS_ONML_SUBSCRIBE_ONLY_METRICS) || 0) + 1,
              )
          })
          f.$(document).delegate('#replenishment-onml-frequency-popover', 'click', function (b) {
            l.ue &&
              l.ue.count(
                a.SNS_ONML_FREQUENCY_LABEL_INGRESS_CLICKED,
                (ue.count(a.SNS_ONML_FREQUENCY_LABEL_INGRESS_CLICKED) || 0) + 1,
              )
          })
          f.$(document).delegate('#replenishment-sns-frequency-popover', 'click', function (b) {
            l.ue &&
              l.ue.count(
                a.SNS_FREQUENCY_LABEL_INGRESS_CLICKED,
                (ue.count(a.SNS_FREQUENCY_LABEL_INGRESS_CLICKED) || 0) + 1,
              )
          })
          f.$(document).delegate(
            '#replenishment-onml-frequency-info-popover',
            'click',
            function (b) {
              l.ue &&
                l.ue.count(
                  a.SNS_ONML_FREQUENCY_INFO_LABEL_INGRESS_CLICKED,
                  (ue.count(a.SNS_ONML_FREQUENCY_INFO_LABEL_INGRESS_CLICKED) || 0) + 1,
                )
            },
          )
          f.$(document).delegate(
            '#replenishment-sns-frequency-info-popover',
            'click',
            function (b) {
              l.ue &&
                l.ue.count(
                  a.SNS_FREQUENCY_INFO_LABEL_INGRESS_CLICKED,
                  (ue.count(a.SNS_FREQUENCY_INFO_LABEL_INGRESS_CLICKED) || 0) + 1,
                )
            },
          )
        },
      }
    },
  )
  n.when(
    'A',
    'sns-onmlv2-utils',
    'sns-metrics-constants',
    'sns-buybox-constants',
    'sns-constants',
    'sns-onmlv2-cache',
    'sns-vmf-utils',
  ).register('sns-onmlv2-metrics-helper', function (f, b, a, d, e, c, g) {
    var k = f.$,
      q = '',
      h = ''
    a.SNS_ONMLV2_POPOVER_TRIGGERS.forEach(function (a) {
      q += ' a:popover:beforeShow:' + a
    })
    a.SNS_ONMLV2_BOTTOMSHEET_TRIGGERS.forEach(function (a) {
      h += ' a:sheet:beforeShow:' + a
    })
    f.declarative('sns-delivery-date', 'click', function (a) {
      c.incrementDeliveryOptionClickCounter()
    })
    f.declarative('sns-delivery-date-bottom-sheet', 'click', function (a) {
      c.incrementDeliveryOptionClickCounterMobile()
    })
    f.declarative('sns-delivery-change-btn', 'click', function (a) {
      k(d.SNS_DELIVERY_OPTION_DIV).is(':checked')
        ? c.incrementDeliveryOptionSwitchToSnsCounter()
        : k(d.ONML_DELIVERY_OPTION_DIV).is(':checked') &&
          c.incrementDeliveryOptionSwitchToOnmlCounter()
    })
    f.on('a:popover:beforeHide:sns-delivery-modal', function (b) {
      p(a.SNS_ONMLV2_DELIVERY_OPTION_CLICK_METRICS, c.getDeliveryOptionClickCounter())
      p(a.SNS_ONMLV2_SWITCH_TO_SNS_METRICS, c.getDeliveryOptionSwitchToSnsCounter())
      p(a.SNS_ONMLV2_SWITCH_TO_ONML_METRICS, c.getDeliveryOptionSwitchToOnmlCounter())
      p(a.SNS_QUANTITY_SELECT_DESKTOP, c.getQuantityClickCounterDesktop())
    })
    f.on('a:sheet:beforeHide:sns_delivery_bottom_sheet', function () {
      p(a.SNS_ONMLV2_DELIVERY_OPTION_CLICK_MOBILE_METRICS, c.getDeliveryOptionClickCounterMobile())
      k(d.SNS_DELIVERY_OPTION_DIV).is(':checked')
        ? c.incrementDeliveryOptionSwitchToSnsCounterMobile()
        : k(d.ONML_DELIVERY_OPTION_DIV).is(':checked') &&
          c.incrementDeliveryOptionSwitchToOnmlCounterMobile()
      p(a.SNS_ONMLV2_SWITCH_TO_SNS_MOBILE_METRICS, c.getDeliveryOptionSwitchToSnsCounterMobile())
      p(a.SNS_ONMLV2_SWITCH_TO_ONML_MOBILE_METRICS, c.getDeliveryOptionSwitchToOnmlCounterMobile())
      p(a.SNS_QUANTITY_SELECT_MOBILE, c.getQuantityClickCounterMobile())
    })
    f.on(q, function () {
      m(a.SNS_ONMLV2_DESKTOP_POPOVER_SHOW_METRICS)
    })
    f.on(h, function () {
      m(a.SNS_ONMLV2_MOBILE_BOTTOMSHEET_SHOW_METRICS)
    })
    f.$(document).delegate('#sns-submit-declarative', 'click', function (d) {
      d = c.getDeliveryOption()
      var f = b.isMobileDevice()
      d === e.DELIVERY_OPTION.SNS
        ? f
          ? m(a.SNS_ONMLV2_SUBSCRIBE_NOW_WITH_SNS_DELIVERY_MOBILE_METRICS)
          : m(a.SNS_ONMLV2_SUBSCRIBE_NOW_WITH_SNS_DELIVERY_METRICS)
        : d === e.DELIVERY_OPTION.ONML &&
          (f
            ? m(a.SNS_ONMLV2_SUBSCRIBE_NOW_WITH_ONML_DELIVERY_MOBILE_METRICS)
            : m(a.SNS_ONMLV2_SUBSCRIBE_NOW_WITH_ONML_DELIVERY_METRICS))
    })
    f.$(document).delegate('#sns-submit-btn-declarative', 'click', function (c) {
      c = b.getSelectedDeliveryOption()
      c =
        'defaultedWith' +
        a.METRIC_DELIMITER +
        b.getDefaultDeliveryOption() +
        a.METRIC_DELIMITER +
        'signUpWith' +
        a.METRIC_DELIMITER +
        c
      b.emitMetric(c)
      g.isSelectedFreqSameAsDefaultFreq()
        ? b.emitMetric(a.SNS_ONMLV2_SUBSCRIBE_NOW_WITH_SAME_FREQ_AS_DEFAULT_FREQ)
        : b.emitMetric(a.SNS_ONMLV2_SUBSCRIBE_NOW_WITH_DIFFERENT_FREQUENCY_OTHER_THAN_DEFAULT_FREQ)
    })
    f.$(document).delegate(d.SNS_ONMLV2_QUANTITY_TRIGGER_DESKTOP, 'change', function (b) {
      c.incrementQuantityClickCounterDesktop()
      p(a.SNS_QUANTITY_SELECT_DESKTOP, c.getQuantityClickCounterDesktop())
    })
    f.$(document).delegate(d.SNS_ONMLV2_QUANTITY_TRIGGER_MOBILE, 'change', function (b) {
      c.incrementQuantityClickCounterMobile()
      p(a.SNS_QUANTITY_SELECT_MOBILE, c.getQuantityClickCounterMobile())
    })
    var m = function (a) {
        l.ue && l.ue.count(a, (ue.count(a) || 0) + 1)
      },
      p = function (a, b) {
        l.ue && l.ue.count(a, b)
      }
  })
  n.when('A', 'sns-onmlv2-utils', 'sns-buybox-constants').register(
    'sns-onmlv2-cache',
    function (f, b, a) {
      var d = f.$,
        e = 0,
        c = 0,
        g = 0,
        k = 0,
        l = 0,
        h = 0,
        m = 0,
        p = 0
      return {
        getDeliveryOptionClickCounter: function () {
          return e
        },
        incrementDeliveryOptionClickCounter: function () {
          e++
        },
        getDeliveryOptionClickCounterMobile: function () {
          return c
        },
        incrementDeliveryOptionClickCounterMobile: function () {
          c++
        },
        getDeliveryOptionSwitchToSnsCounter: function () {
          return g
        },
        incrementDeliveryOptionSwitchToSnsCounter: function () {
          g++
        },
        getDeliveryOptionSwitchToSnsCounterMobile: function () {
          return k
        },
        incrementDeliveryOptionSwitchToSnsCounterMobile: function () {
          k++
        },
        getDeliveryOptionSwitchToOnmlCounterMobile: function () {
          return h
        },
        incrementDeliveryOptionSwitchToOnmlCounterMobile: function () {
          h++
        },
        getDeliveryOptionSwitchToOnmlCounter: function () {
          return l
        },
        incrementDeliveryOptionSwitchToOnmlCounter: function () {
          l++
        },
        getDeliveryOption: function () {
          return d(a.SNS_ONMLV2_DELIVERY_OPTION_FORM_FIELD).val()
        },
        getQuantityClickCounterDesktop: function () {
          return m
        },
        incrementQuantityClickCounterDesktop: function (a) {
          m++
        },
        getQuantityClickCounterMobile: function () {
          return p
        },
        incrementQuantityClickCounterMobile: function (a) {
          p++
        },
      }
    },
  )
  n.when('A', 'ready').execute('sns-detail-page-impressions', function (f) {
    function b(a) {
      l.ue && l.ue.count(a, (ue.count(a) || 0) + 1)
    }
    var a = f.$
    f.on.load(function () {
      if (a('#snsAccordionRowMiddle').length)
        try {
          b('snsBuyBoxVisibleOnDetailPage'),
            a('#sns-pill').length &&
              a('#sns-pill').text().trim() &&
              b('snsBuyBoxPillVisibleOnDetailPage'),
            a('#snsAccordionRowMiddle #a-popover-learnMorePopover').length &&
              a('#snsAccordionRowMiddle #a-popover-learnMorePopover').text().trim() &&
              b('snsBuyBoxLearnMoreVisibleOnDetailPage'),
            a('#sns-base-price').length &&
              a('#sns-base-price').text().trim() &&
              b('snsBuyBoxPriceVisibleOnDetailPage'),
            a('#sns-delivery-buybox-upsell').length &&
              a('#sns-delivery-buybox-upsell').text().trim() &&
              b('snsBuyBoxDeliveryUpsellVisibleOnDetailPage'),
            a('#sns-delivery-buybox-upsell').length &&
            a('#sns-delivery-buybox-upsell').text().trim().includes('1 more')
              ? b('snsBuyBoxDeliveryUpsell_2_MoreSubsToGo')
              : a('#sns-delivery-buybox-upsell').length &&
                  a('#sns-delivery-buybox-upsell').text().trim().includes('2 more')
                ? b('snsBuyBoxDeliveryUpsell_3_MoreSubsToGo')
                : a('#sns-delivery-buybox-upsell').length &&
                    a('#sns-delivery-buybox-upsell').text().trim().includes('3 more')
                  ? b('snsBuyBoxDeliveryUpsell_4_MoreSubsToGo')
                  : a('#sns-delivery-buybox-upsell').length &&
                      a('#sns-delivery-buybox-upsell')
                        .text()
                        .trim()
                        .includes('Unlock extra savings')
                    ? b('snsBuyBoxDeliveryUpsellAlmostTieredCustomer')
                    : a('#sns-delivery-buybox-upsell').length &&
                        a('#sns-delivery-buybox-upsell')
                          .text()
                          .trim()
                          .includes("You've unlocked extra savings")
                      ? b('snsBuyBoxDeliveryUpsellTieredCustomer')
                      : a('#sns-delivery-buybox-upsell').length &&
                        (a('#sns-delivery-buybox-upsell').text().trim().includes('No fees') ||
                          a('#sns-delivery-buybox-upsell')
                            .text()
                            .trim()
                            .includes('Cancel anytime')) &&
                        b('snsBuyBoxDeliveryUpsellNewOrUnrecognizedCustomer'),
            a('.sns-delivery-link').length &&
              a('.sns-delivery-link').text().trim() &&
              b('snsBuyBoxFRDDVisibleOnDetailPage'),
            a('#snsAccordionRowMiddle #availability').length &&
              a('#snsAccordionRowMiddle #availability').text().trim() &&
              a('#snsAccordionRowMiddle #availability').text().trim().includes('In Stock') &&
              b('snsBuyBoxAvailabilityInStockVisibleOnDetailPage'),
            ((a('#rcxOrdFreqSnsWrapper').length && a('#rcxOrdFreqSnsWrapper').text().trim()) ||
              a('#replenishment-sns-frequency-accordion').length) &&
              b('snsBuyBoxFrequencySelectorVisibleOnDetailPage'),
            a('#rcx-subscribe-submit-button').length &&
            a('#rcx-subscribe-submit-button').text().trim()
              ? b('snsBuyBoxSubscribeNowButtonVisibleOnDetailPage')
              : b('snsBuyBoxSubscribeNowButtonNotVisibleOnDetailPage')
        } catch (d) {
          b('snsBuyBoxImpressionMetricException')
        }
      else if (a('#snsAccordionRowMobileMiddle').length)
        try {
          b('snsBuyBoxVisibleOnDetailPageMobile'),
            a('#sns-pill').length &&
              a('#sns-pill').text().trim() &&
              b('snsBuyBoxPillVisibleOnDetailPageMobile'),
            a('#snsAccordionRowMobileMiddle #a-popover-learnMorePopover').length &&
              a('#snsAccordionRowMobileMiddle #a-popover-learnMorePopover').text().trim() &&
              b('snsBuyBoxLearnMoreVisibleOnDetailPageMobile'),
            a('#sns-base-price').length &&
              a('#sns-base-price').text().trim() &&
              b('snsBuyBoxPriceVisibleOnDetailPageMobile'),
            a('#sns-delivery-buybox-upsell').length &&
              a('#sns-delivery-buybox-upsell').text().trim() &&
              b('snsBuyBoxDeliveryUpsellVisibleOnDetailPageMobile'),
            a('#sns-delivery-buybox-upsell').length &&
            a('#sns-delivery-buybox-upsell').text().trim().includes('1 more')
              ? b('snsBuyBoxDeliveryUpsell_2_MoreSubsToGoMobile')
              : a('#sns-delivery-buybox-upsell').length &&
                  a('#sns-delivery-buybox-upsell').text().trim().includes('2 more')
                ? b('snsBuyBoxDeliveryUpsell_3_MoreSubsToGoMobile')
                : a('#sns-delivery-buybox-upsell').length &&
                    a('#sns-delivery-buybox-upsell').text().trim().includes('3 more')
                  ? b('snsBuyBoxDeliveryUpsell_4_MoreSubsToGoMobile')
                  : a('#sns-delivery-buybox-upsell').length &&
                      a('#sns-delivery-buybox-upsell')
                        .text()
                        .trim()
                        .includes('Unlock extra savings')
                    ? b('snsBuyBoxDeliveryUpsellAlmostTieredCustomerMobile')
                    : a('#sns-delivery-buybox-upsell').length &&
                        a('#sns-delivery-buybox-upsell')
                          .text()
                          .trim()
                          .includes("You've unlocked extra savings")
                      ? b('snsBuyBoxDeliveryUpsellTieredCustomerMobile')
                      : a('#sns-delivery-buybox-upsell').length &&
                        (a('#sns-delivery-buybox-upsell').text().trim().includes('No fees') ||
                          a('#sns-delivery-buybox-upsell')
                            .text()
                            .trim()
                            .includes('Cancel anytime')) &&
                        b('snsBuyBoxDeliveryUpsellNewOrUnrecognizedCustomerMobile'),
            a('.sns-delivery-link').length &&
              a('.sns-delivery-link').text().trim() &&
              b('snsBuyBoxFRDDVisibleOnDetailPageMobile'),
            a('#snsAccordionRowMobileMiddle #availability').length &&
              a('#snsAccordionRowMobileMiddle #availability').text().trim() &&
              a('#snsAccordionRowMobileMiddle #availability').text().trim().includes('In Stock') &&
              b('snsBuyBoxAvailabilityInStockVisibleOnDetailPageMobile'),
            ((a('#rcxOrdFreqSnsWrapper').length && a('#rcxOrdFreqSnsWrapper').text().trim()) ||
              a('#replenishment-sns-frequency-accordion').length) &&
              b('snsBuyBoxFrequencySelectorVisibleOnDetailPageMobile'),
            a('#rcx-subscribe-submit-button').length &&
            a('#rcx-subscribe-submit-button').text().trim()
              ? b('snsBuyBoxSubscribeNowButtonVisibleOnDetailPageMobile')
              : b('snsBuyBoxSubscribeNowButtonNotVisibleOnDetailPageMobile')
        } catch (d) {
          b('snsBuyBoxImpressionMetricExceptionMobile')
        }
      else b('snsBuyBoxNotVisibleOnDetailPage')
    })
  })
  n.when(
    'sns-atc',
    'sns-frequency-bottom-sheet',
    'sns-frequency-popover',
    'sns-opt-in-checkbox',
    'sns-event-handler',
    'sns-metrics-helper',
    'sns-price-refresh',
  ).execute('sns-execute', function (f, b, a, d, e, c, g) {
    f.init()
    b.init()
    a.init()
    d.init()
    e.init()
    c.init()
    g.init()
  })
  n.when('moq-core').register('sns-moq-helper', function (f) {
    return { isSnsLocked: f.isSnsLocked }
  })
  n.when(
    'A',
    'sns-buybox-constants',
    'sns-onmlv2-utils',
    'sns-vmf-utils',
    'sns-constants',
  ).register('sns-dp-widget-utils', function (f, b, a, d, e) {
    function c(a) {
      for (var b = []; b.length < a; ) {
        var c = Math.floor(Math.random() * a)
        ;-1 === b.indexOf(c) && b.push(c)
      }
      return b
    }
    var g = f.$,
      k = !1,
      l
    return {
      getSnSRecommendations: function () {
        var d = a.getCurrencyCode()
        g.ajax({
          url: b.GET_MYD_RECOMMENDATIONS_URL,
          type: 'GET',
          data: { currencyCode: d, shipId: 'undef', sourcePage: b.SOURCE_PAGE },
          dataType: 'json',
          success: function (a) {
            l = c(20)
            g('#snsHighUpsellCartRecs').replaceWith(a.recommendationsDiv)
            for (a = 0; 3 > a; a++) g('#recItem' + l[a]).removeClass('aok-hidden')
          },
          error: function (b) {
            a.emitSsbMetrics('ssb-get-recs-ajax-error', 'snsHighUpsellCartRecs')
            g('#snsHighUpsellCartRecs').remove()
          },
        })
      },
      createImage: function (a) {
        return (
          '\x3cimg id\x3d"hucATCProductImage" src\x3d"' +
          a +
          '" class\x3d"' +
          (f.capabilities.mobile ? 'huc-confirmation-image-mobile' : 'huc-confirmation-image') +
          '"/\x3e'
        )
      },
      isSSBDataPresent: function () {
        return null != a.getAStateFromDomWithoutJson(t, 'sns-huc-data', 'currencyCode')
      },
      updateDeliveryOptionWidget: function () {
        k ||
          ((k = !0),
          g('#sns-only-delivery-option-text').html(
            g('#sns-only-delivery-option-text')
              .html()
              .replace(/%_month_%/g, "\x3cspan class \x3d'sns-only-month'\x3e\x3c/span\x3e"),
          ),
          g('#sns-only-delivery-option-text').html(
            g('#sns-only-delivery-option-text')
              .html()
              .replace(/%_day_%/g, "\x3cspan class \x3d'sns-only-day'\x3e\x3c/span\x3e"),
          ),
          g('#sns-only-delivery-option-text').html(
            g('#sns-only-delivery-option-text')
              .html()
              .replace(
                /%_upsell_information_%/g,
                "\x3cspan class \x3d'sns-upsell-message'\x3e\x3c/span\x3e",
              ),
          ),
          g('#onml-later-delivery-option-text').html(
            g('#onml-later-delivery-option-text')
              .html()
              .replace(/%_frequency_%/g, "\x3cspan class \x3d'sns-frequency'\x3e\x3c/span\x3e"),
          ),
          g('#onml-later-delivery-option-text').html(
            g('#onml-later-delivery-option-text')
              .html()
              .replace(/%_date-more-later_%/g, "\x3cspan class \x3d'sns-ml-date'\x3e\x3c/span\x3e"),
          ))
        var b = a.getDeliveryInfoParam(),
          c = a.getSnsFrequencyParam(),
          f = a.getOnmlFrequencyParam(),
          l = d.getFrequencyIndex(e.DELIVERY_OPTION.SNS),
          q = d.getFrequencyIndex(e.DELIVERY_OPTION.ONML),
          n = b.snsDates[l].split(' '),
          t = n[0],
          n = n[1],
          c = c[l].upsellInformation.message,
          b = b.onmlDates[q],
          f = f[l].label.split(' '),
          f = f[0] + ' ' + f[1]
        g('.sns-ml-date').html(b)
        g('.sns-frequency').html(f)
        g('.sns-only-month').html(t)
        g('.sns-only-day').html(n)
        g('.sns-upsell-message').html(c)
      },
      isDeliveryOptionEnabled: function () {
        return !1
      },
      getRandomizeRecList: function () {
        return 0 !== l.length ? l : c(20)
      },
      disableButton: function (a) {
        n.when('a-button').execute(function (b) {
          b('#' + a).disable()
        })
      },
      enableButton: function (a) {
        n.when('a-button').execute(function (b) {
          b('#' + a).enable()
        })
      },
      SUBSCRIBE_ADD_TO_CART_FORM_ATTRIBUTES: {
        name: 'sns-onmlv2-add-to-cart',
        id: 'sns-onmlv2-add-to-cart',
        method: 'POST',
        action: '/gp/subscribe-and-save/atc/sns-atc.html',
      },
      SUBSCRIBE_FORM_ATTRIBUTES: {
        name: 'sns-onmlv2-subscribe',
        id: 'sns-onmlv2-subscribe',
        method: 'POST',
        action: '/gp/subscribe-and-save/atc/sns-atc.html',
      },
    }
  })
  n.when('A', 'sns-buybox-constants', 'sns-onmlv2-utils', 'sns-dp-widget-utils').register(
    'sns-high-upsell-cart-widget',
    function (f, b, a, d) {
      function e(e) {
        var f, l
        f = c('\x3cform\x3e', {
          method: d.SUBSCRIBE_FORM_ATTRIBUTES.method,
          action: d.SUBSCRIBE_FORM_ATTRIBUTES.action,
          id: d.SUBSCRIBE_FORM_ATTRIBUTES.id,
          name: d.SUBSCRIBE_FORM_ATTRIBUTES.name,
        })
        l = d.SUBSCRIBE_FORM_ATTRIBUTES.id
        var n = ''
        e = '#hucRecFields' + e
        var t = c(e + " [name\x3d'snsRecsMcf']").val() + b.SNS_ONML_MONTH,
          n = n + a.createHiddenInput('snsAsin', c(e + " [name\x3d'snsRecsAsin']").val()),
          n = n + a.createHiddenInput('rcxOrdFreqOnml', t),
          n = n + a.createHiddenInput('onmlSelected', 'true'),
          n = n + a.createHiddenInput('vmfEnabled', 'true'),
          n = n + a.createHiddenInput('quantity', '1'),
          n = n + a.createHiddenInput('ref', 'sns-subscribe-btn-dp-vmf-onml'),
          n = n + a.createHiddenInput('submit.subscribe', '1'),
          n = n + a.createHiddenInput('merchantId', c(e + " [name\x3d'snsRecsMerchantID']").val()),
          n =
            n +
            a.createHiddenInput(
              'offerListingID',
              c(e + " [name\x3d'snsRecsOfferListingID']").val(),
            ),
          n = n + a.createHiddenInput('hucWidgetEnabled', '1')
        f.html(n)
        c('body').append(f)
        f = c('#' + l).serialize()
        c.ajax({
          url: d.SUBSCRIBE_FORM_ATTRIBUTES.action,
          type: d.SUBSCRIBE_FORM_ATTRIBUTES.method,
          data: f,
          success: function (a) {
            a = d.getRandomizeRecList()
            c('#hucATCProductImage').replaceWith(d.createImage(q))
            c('#' + k).addClass('aok-hidden')
            c('#recItem' + a[g]).insertAfter('#' + k)
            c('#recItem' + a[g]).removeClass('aok-hidden')
            g++
          },
          error: function () {
            a.emitSsbMetrics('ssb-rec-atc-ajax-error', 'sns-huc-add-to-cart')
          },
        })
        c('#' + l).remove()
      }
      var c = f.$,
        g = 3,
        k,
        q
      f.declarative('sns-huc-add-to-cart', 'click', function (b) {
        a.emitSsbMetrics(
          f.capabilities.mobile ? 'ssb_recs_atc_mobile' : 'ssb_recs_atc_desktop',
          'sns-huc-add-to-cart',
        )
        k = b.data.recId
        var c = b.data.recIndex
        q = b.data.productImageURL
        d.disableButton((f.capabilities.mobile ? 'recs-atc-mobile' : 'recs-atc-desktop') + c)
        e(c)
      })
      f.declarative('sns-huc-go-to-cart', 'click', function (c) {
        a.emitSsbMetrics(
          f.capabilities.mobile ? 'ssb_go_to_cart_mobile' : 'ssb_go_to_cart_desktop',
          'sns-huc-go-to-cart',
        )
        l.location.href = b.VIEW_CART_URL
      })
      f.declarative('sns-huc-go-to-checkout', 'click', function (c) {
        a.emitSsbMetrics(
          f.capabilities.mobile ? 'ssb_go_to_checkout_mobile' : 'ssb_go_to_checkout_desktop',
          'sns-huc-go-to-checkout',
        )
        l.location.href = b.GO_TO_CHECKOUT_URL
      })
    },
  )
  n.when(
    'A',
    'a-dropdown',
    'sns-vmf-utils',
    'sns-onmlv2-utils',
    'sns-metrics-constants',
    'ready',
  ).execute('b2b-onmlv2-frequency-update', function (f, b, a, d, e) {
    function c(a) {
      l.ue && l.ue.count(a, (ue.count(a) || 0) + 1)
    }
    var g = f.$
    g('#rcxOrdFreq')
      .change(function () {
        if (
          g('#b2brd').length &&
          !0 === d.getIsRDProgramWinner() &&
          ('rcxOrdFreqOnml' === g('#rcxOrdFreq').attr('name')) !== !1
        ) {
          var a
          a =
            !0 === d.getIsCustomerPrimeMap()
              ? d.getOnmlFrequencyParamForB2B()
              : d.getSnsFrequencyParamForB2B()
          var b = g('[name\x3drcxOrdFreqOnml]').prop('selectedIndex'),
            f = g('[name\x3drcxOrdFreqOnml]')[0].options[b].value
          g('[name\x3d"rcxOrdFreqOnml"]').val(f)
          a = a[b]
          g('.b2brd-delivery-buybox-upsell-message').html(a.upsellInformation.message)
          g('.b2brd-delivery-buybox-upsell-additional-message-title').html(
            a.upsellInformation.additionalMessageTitle,
          )
          g('.b2brd-delivery-buybox-upsell-additional-message').html(
            a.upsellInformation.additionalMessage,
          )
          0 === a.highlightedDiscount
            ? (g('#rd-base-price').removeClass('aok-hidden'),
              g('#rd-tiered-price').addClass('aok-hidden'))
            : (g('#rd-base-price').addClass('aok-hidden'),
              g('#rd-tiered-price').removeClass('aok-hidden'))
          a = g('[name\x3drcxOrdFreqOnml]').val()
          c(e.B2B_BUY_BOX_MESSAGE_UPDATE_SUCCESSFUL)
          0 < a.search('W')
            ? c(e.B2B_ONML_WEEKLY_FREQUENCY_SELECT_METRICS)
            : c(e.B2B_ONML_MONTHLY_FREQUENCY_SELECT_METRICS)
        }
      })
      .error(function () {
        c(e.B2B_BUY_BOX_MESSAGE_UPDATE_FAILED)
      })
  })
  n.when('A', 'sns-onmlv2-utils', 'sns-vmf-utils', 'sns-upsell-message-trigger-handler').register(
    'sns-annual-savings',
    function (f, b, a, d) {
      function e(a) {
        l.ue && l.ue.count(a, (ue.count(a) || 0) + 1)
      }
      return {
        checkPreConditionsAndUpdateAnnualSavings: function (c) {
          var g = f.$('#sns-annual-savings')
          if ('undefined' === typeof c || null === c)
            e('snsFrequencyValueAbsent'), g.addClass('aok-hidden')
          else {
            var k = b.getAnnualSavingsParamMap(),
              l = b.getAnnualSavingsWeblabTreatment(),
              h = a.getQuantityIndex()
            if ('undefined' === typeof k || 0 === Object.keys(k).length)
              e('snsAnnualSavingsMapIsNotPresent'), g.addClass('aok-hidden')
            else if ('undefined' === typeof h || null === h)
              e('snsQuantityIndexAbsent'), g.addClass('aok-hidden')
            else if ('undefined' === typeof l)
              e('snsAnnualSavingsWeblabTreatmentAbsent'), g.addClass('aok-hidden')
            else {
              var m
              k.hasOwnProperty(c) && k[c][h] !== t && (m = k[c][h])
              c = m
              g = f.$('#sns-annual-savings')
              'undefined' !== typeof c
                ? (d.handleAnnualSavingsExperimentTriggering(c, l),
                  'T1' === l &&
                    ((l = null !== c && 0 !== c.length),
                    f.$('#sns-annual-savings-value').text(c),
                    g.toggleClass('aok-hidden', !l),
                    l && e('snsAnnualSavingsShown')))
                : (e('snsAnnualSavingsValueAbsent'), g.addClass('aok-hidden'))
            }
          }
        },
      }
    },
  )
  n.when(
    'A',
    'a-dropdown',
    'sns-vmf-utils',
    'sns-annual-savings',
    'sns-constants',
    'sns-buybox-constants',
    'ready',
  ).execute('sns-quantity-update', function (f, b, a, d, e, c) {
    var g = f.$
    f.on('a:dropdown:rcxsubsQuan:select', function (b) {
      b =
        g('#rcxOrdFreqOnmlWrapper').hasClass('aok-hidden') ||
        g(c.REPLENISHMENT_ONML_FREQUENCY_POPOVER_ID).hasClass('aok-hidden') ||
        g(c.REPLENISHMENT_ONML_FREQUENCY_INFO_POPOVER_ID).hasClass('aok-hidden')
          ? a.getFrequencyValue(e.DELIVERY_OPTION.SNS)
          : a.getFrequencyValue(e.DELIVERY_OPTION.ONML)
      b = a.getFrequencyValueExcludingDeliveryType(b)
      d.checkPreConditionsAndUpdateAnnualSavings(b)
    })
  })
  n.when('A', 'sns-onmlv2-utils', 'sns-upsell-message-trigger-handler', 'ready').execute(
    'sns-annual-savings-trigger',
    function (f, b, a) {
      f = b.getDefaultSavingsValue()
      b = b.getAnnualSavingsWeblabTreatment()
      a.handleAnnualSavingsExperimentTriggering(f, b)
    },
  )
  n.when('A', 'sns-onmlv2-utils', 'ready').execute(
    'sns-udm-delivery-block-styling',
    function (f, b) {
      function a() {
        try {
          var a = d("div[id^\x3d'snsAccordionRow'] div#mir-layout-DELIVERY_BLOCK")
          a &&
            a.each(function () {
              var a = d(this).find('div:last')
              a &&
                a
                  .removeClass(function (a, b) {
                    return (b.match(/(^|\s)a-spacing-\S+/g) || []).join(' ')
                  })
                  .addClass('a-spacing-none')
            })
        } catch (c) {
          b.emitMetric('snsUdmDeliveryBlockSpacingAdjustmentFailed'),
            b.logErrorWithAttribution(
              'sns-delivery-block-apply-styling',
              'Error occurred while applying delivery block styling ' + c,
            )
        }
      }
      var d = f.$
      a()
      f.on('a:pageUpdate', function (b) {
        a()
      })
    },
  )
  ;('use strict')
  n.when('A', 'sns-onmlv2-utils', 'sns-constants').register(
    'sns-improved-dropdown-trigger-handler',
    function (f, b, a) {
      function d(a) {
        var d = e('#snsQuantity_feature_div #selectQuantity'),
          f = e('#rcxOrdFreqSnsWrapper'),
          l = e('#rcxOrdFreqOnmlWrapper')
        'C' !== a || d || f || l
          ? 'T1' !== a || !d || f || l
            ? 'T2' === a && d && f && l
              ? b.emitMetric('improvedDropdownExperiment.successfulTreatmentTwoAllocationMetric')
              : b.emitMetric('improvedDropdownExperiment.weblabAllocationError')
            : b.emitMetric('improvedDropdownExperiment.successfulTreatmentOneAllocationMetric')
          : b.emitMetric('improvedDropdownExperiment.successfulControlAllocationMetric')
      }
      function e(a) {
        a = f.$(a)
        if (a !== t && null !== a) {
          if (1 === a.length) return a[0].classList.contains('improvedSnSOfferDisplayDropdown')
          b.emitMetric('improvedDropdownExperiment.snsMultipleDropdownComponents')
          return !1
        }
        b.emitMetric('improvedDropdownExperiment.snsMissingDropdownComponents')
        return !1
      }
      return {
        handleImprovedDropdownExperimentTriggering: function (c) {
          var e = !1
          try {
            !e && b.isSnSAccordionActiveForDeviceType(a.DEVICE_TYPE.DESKTOP)
              ? (b.recordWeblabTriggers(
                  'CONSUMABLES_DP_SNS_IMPROVED_QTY_AND_FREQ_DROPDOWN_1013907',
                  c,
                ),
                (e = !0),
                b.emitMetric('improvedDropdownExperiment.weblabTriggeringSuccess'),
                d(c))
              : e
                ? b.emitMetric('improvedDropdownExperiment.weblabAlreadyTriggeredOnce')
                : b.emitMetric('improvedDropdownExperiment.snsDesktopAccordionNotActive')
          } catch (k) {
            b.emitMetric('improvedDropdownExperiment.weblabTriggeringFailure')
          }
          f.on('a:accordion:buybox-accordion:select', function (f) {
            try {
              !e && b.isSnSSelectedAccordionForDeviceType(f, a.DEVICE_TYPE.DESKTOP)
                ? (b.recordWeblabTriggers(
                    'CONSUMABLES_DP_SNS_IMPROVED_QTY_AND_FREQ_DROPDOWN_1013907',
                    c,
                  ),
                  (e = !0),
                  b.emitMetric('improvedDropdownExperiment.weblabTriggeringSuccess'),
                  d(c))
                : e
                  ? b.emitMetric('improvedDropdownExperiment.weblabAlreadyTriggeredOnce')
                  : b.emitMetric('improvedDropdownExperiment.snsDesktopAccordionNotSelected')
            } catch (l) {
              b.emitMetric('improvedDropdownExperiment.weblabTriggeringFailure')
            }
          })
        },
      }
    },
  )
  ;('use strict')
  n.when('A', 'sns-improved-dropdown-trigger-handler', 'sns-constants', 'ready').execute(
    'sns-dropdown',
    function (f, b, a) {
      b.handleImprovedDropdownExperimentTriggering(a.WEBLAB_TREATMENT.T2)
    },
  )
})
/* ******** */
;(function (b) {
  var c = window.AmazonUIPageJS || window.P,
    d = c._namespace || c.attributeErrors,
    a = d ? d('AmazonsChoiceAssets', '') : c
  a.guardFatal
    ? a.guardFatal(b)(a, window)
    : a.execute(function () {
        b(a, window)
      })
})(function (b, c, d) {
  b.when('A', 'a-popover', 'ready').execute(function (a, b) {
    var g = a.$
    g(document).delegate('#why-we-love-this-product-link', 'click mouseenter', function (a) {
      b.get(g('#ac-badge-popover-declarative')).show()
      a.preventDefault()
    })
  })
  ;('use strict')
  b.when('A', 'atf', 'dp-refresh-handler', 'twisterModule', 'ac-state-utils').execute(
    function (a, b, g, c, d) {
      d.addACStateParamsToPageRefreshAjaxUrl()
    },
  )
  ;('use strict')
  b.when('A', 'atf', 'dp-refresh-handler', 'ready').register('ac-state-utils', function (a, b, c) {
    return {
      addACStateParamsToPageRefreshAjaxUrl: function () {
        var b = { featureName: 'acBadge' },
          d = a.$,
          e = a.state('acState')
        if (e) {
          var f = {}
          e.acAsin && (f.acAsin = e.acAsin)
          e.modalityMetadata && (f.ac_md = e.modalityMetadata)
          d.isEmptyObject(f) || new c(b).addParams(f)
        }
      },
    }
  })
})
/* ******** */
;(function (a) {
  var b = window.AmazonUIPageJS || window.P,
    c = b._namespace || b.attributeErrors,
    d = c ? c('USMediaBooksDetailPageAsset', '') : b
  d.guardFatal
    ? d.guardFatal(a)(d, window)
    : d.execute(function () {
        a(d, window)
      })
})(function (a, b, c) {
  a.when('jQuery', 'ready').register('booksPromotionalBundle', function (d) {
    function a(a) {
      var b = a.find('tr:eq(0) td:eq(1)').html(),
        c = a.find('tr:eq(1) td:eq(1) span').html()
      b = d.trim(b)
      c = d.trim(c)
      b === c
        ? a.find('tr td:eq(1)').addClass('a-color-price')
        : a.find('tr:eq(1)').addClass('displayOffer')
    }
    var b = d('#mediaTabsGroup .promotionalBundle .pb-price-block'),
      c = d('.book #promotionalBundle_feature_div .pb-price-block')
    b.length ? a(b) : c.length && a(c)
  })
})
/* ******** */
;(function (b) {
  var c = window.AmazonUIPageJS || window.P,
    d = c._namespace || c.attributeErrors,
    a = d ? d('PrimeOneClickAssets', '') : c
  a.guardFatal
    ? a.guardFatal(b)(a, window)
    : a.execute(function () {
        b(a, window)
      })
})(function (b, c, d) {
  b.register('PrimeOneClickCountdown', function () {
    function a(e, a, b, c, d) {
      if (!(1 > e)) {
        var f = this
        this.endTime = this.getCurrentTime() + e
        this.expirationCallback = a
        this.displayElement = b
        this.displayEnabled = !!d
        this.formatFunction = c
        this.update()
        this.currentTimer = setInterval(function () {
          f.update()
        }, 6e4)
      }
    }
    a.prototype.update = function () {
      var a = this.endTime - this.getCurrentTime()
      0 > a && (a = 0)
      this.updateDisplay(a)
      0 === a &&
        ('function' === typeof this.expirationCallback && this.expirationCallback(), this.destroy())
    }
    a.prototype.updateDisplay = function (a) {
      this.displayElement &&
        this.displayEnabled &&
        (this.displayElement.innerHTML = this.getCountdownDisplay(
          Math.floor(a / 3600),
          Math.floor((a % 3600) / 60),
          a % 60,
        ))
    }
    a.prototype.getCountdownDisplay = function (a, b, c) {
      return 'function' === typeof this.formatFunction
        ? this.formatFunction(a, b, c)
        : a + 'h ' + b + 'm ' + c + 's'
    }
    a.prototype.enableDisplay = function () {
      this.displayEnabled = !0
      this.update()
    }
    a.prototype.disableDisplay = function (a) {
      this.displayEnabled = !1
      a && this.displayElement && (this.displayElement.innerHTML = '')
    }
    a.prototype.getCurrentTime = function () {
      return Math.floor(+new Date() / 1e3)
    }
    a.prototype.destroy = function () {
      clearTimeout(this.currentTimer)
    }
    return { Countdown: a }
  })
})
/* ******** */
;(function (p) {
  var f = window.AmazonUIPageJS || window.P,
    r = f._namespace || f.attributeErrors,
    d = r ? r('ABPricingFreeFormQuantityPickerAssets', '') : f
  d.guardFatal
    ? d.guardFatal(p)(d, window)
    : d.execute(function () {
        p(d, window)
      })
})(function (p, f, r) {
  p.when(
    'jQuery',
    'A',
    'abPricingFfqp_constants',
    'abPricingFfqp_metrics',
    'abPricingFfqp_amazonAPIPriceFormatter',
  ).register('abPricingFfqp_amazonAPIClient', function (d, f, g, a, c) {
    return f.createClass({
      inclusions: function () {
        return {
          priceV1: 'buyingOptions[].price(product.price/v1)',
          quantityPricingTableV1:
            'buyingOptions[].quantityPricingTable(product.quantity-pricing-table/v1)',
          availabilityV2: 'buyingOptions[].availability(product.availability/v2)',
        }
      },
      init: function (a) {
        this._baseEndpoint = 'https://' + a.endpoint
        this._baseUrl = this._baseEndpoint + '/api/marketplaces/' + a.marketplaceId + '/'
        this._defaultHeaders = {
          'Accept-Language': a.language,
          'x-api-csrf-token': a.csrfToken,
          'x-cc-currency-of-preference': a.currencyOfPreference,
          'x-amzn-encrypted-slate-token': this._getSlateToken(),
        }
        'object' === typeof a.priceFormatConfig &&
          (this._aapiPriceFormatter = new c(a.priceFormatConfig))
        a = this._getValidatedClientId(a.clientId)
        this._metricScopeName = g.METRIC_SCOPE_NAME.AAPI_CLIENT.replace(
          g.AAPI_CLIENT_ID_PLACEHOLDER,
          a,
        )
        this._statusMetricNameTpl = g.COUNTER_METRIC.AAPI_REQUEST_STATUS.replace(
          g.AAPI_CLIENT_ID_PLACEHOLDER,
          a,
        )
      },
      _constructHeader: function (a, c) {
        return (
          'application/vnd.com.amazon.api+json; ' +
          ('' === a ? '' : 'type\x3d"' + a + '"; ') +
          ('' === c ? '' : 'expand\x3d"' + c + '"; ') +
          'experiments\x3d"enableQuantityPricingTablePaginationField_dn2f4w34"'
        )
      },
      productV2: function (a) {
        var c = ['products', a.asin],
          g = { Accept: this._constructHeader('product/v2', a.subresources.join(',')) },
          c = this._constructUrl(c, a.parameters)
        this._get(a.success, a.error, c, g)
      },
      productQPT: function (a) {
        var c = { Accept: this._constructHeader('product.quantity-pricing-table/v1', '') }
        this._get(a.success, a.error, this._baseEndpoint + a.url, c)
      },
      _getValidatedClientId: function (a) {
        return 'string' === typeof a && 0 < a.length ? a : g.UNSPECIFIED_CLIENT_ID
      },
      _get: function (c, l, f, m) {
        var h = this
        a.registerWidgetBodyBegin(this._metricScopeName)
        m = d.extend(this._defaultHeaders, m)
        d.ajax({
          url: f,
          type: 'GET',
          headers: m,
          xhrFields: { withCredentials: !0 },
          timeout: g.AAPI_CLIENT_TIMEOUT,
        })
          .done(function (b, e) {
            h._handleAjaxSuccess(b, e, c)
          })
          .fail(function (b, e, a) {
            h._handleAjaxError(e, a, l, b.status)
          })
          .always(function (b, e) {
            h._handleAjaxComplete(e)
          })
      },
      _constructUrl: function (a, c) {
        c = c || {}
        c = d
          .map(c, function (a, c) {
            return c.toString() + '\x3d' + a.toString()
          })
          .join('\x26')
        return this._baseUrl + a.join('/') + (0 < c.length ? '?' + c : '')
      },
      _getSlateToken: function () {
        var a = document.querySelector('meta[name\x3d"encrypted-slate-token"]')
        if (a) return a.content
      },
      _handleAjaxSuccess: function (c, g, d) {
        this._aapiPriceFormatter && this._aapiPriceFormatter.formatPrices(c)
        a.registerWidgetCriticalFeature(this._metricScopeName)
        a.registerWidgetLoaded(this._metricScopeName)
        d && d(c, g)
      },
      _handleAjaxError: function (c, g, d, f) {
        a.registerWidgetLoaded(this._metricScopeName)
        d && d(c, g, f)
      },
      _handleAjaxComplete: function (c) {
        'string' !== typeof c && (c = g.UNSPECIFIED_REQUEST_STATUS)
        c = this._statusMetricNameTpl.replace(g.AAPI_REQUEST_STATUS_PLACEHOLDER, c)
        a.registerCounter(c)
      },
    })
  })
  ;('use strict')
  p.when(
    'A',
    'abPricingFfqp_constants',
    'abPricingFfqp_metrics',
    'abPricingFfqp_priceFormatter',
  ).register('abPricingFfqp_amazonAPIPriceFormatter', function (d, f, g, a) {
    return d.createClass({
      init: function (c) {
        this._priceFormatter = new a(c)
      },
      formatPrices: function (a) {
        g.registerWidgetBodyBegin(f.METRIC_SCOPE_NAME.AAPI_PRICE_FORMATTER)
        try {
          this._formatPricesRec(a),
            g.registerWidgetCriticalFeature(f.METRIC_SCOPE_NAME.AAPI_PRICE_FORMATTER)
        } catch (d) {
          throw d
        } finally {
          g.registerWidgetLoaded(f.METRIC_SCOPE_NAME.AAPI_PRICE_FORMATTER)
        }
      },
      _formatPricesRec: function (a) {
        if (this._isPriceObject(a))
          a.displayString = this._formatPrice(a.amount, a.currencyCode, a.displayString)
        else if ('object' === typeof a)
          for (var g in a) a.hasOwnProperty(g) && this._formatPricesRec(a[g])
      },
      _isPriceObject: function (a) {
        return 'object' === typeof a && this._priceFormatter.isValidPrice(a.amount, a.currencyCode)
      },
      _formatPrice: function (a, g, d) {
        return 'string' === typeof d && 0 < d.length ? d : this._priceFormatter.format(a, g)
      },
    })
  })
  ;('use strict')
  p.when('A', 'abPricingFfqp_constants', 'abPricingFfqp_metrics').register(
    'abPricingFfqp_priceFormatter',
    function (d, f, g) {
      return d.createClass({
        init: function (a) {
          a = a || {}
          this._priceFormat = a.priceFormat
          this._decimalSeparator = a.decimalSeparator
          this._fractionDigits = parseInt(a.fractionDigits)
          this._groupingSeparator = a.groupingSeparator
          this._groupingDigits = parseInt(a.groupingDigits)
          this._secondaryGroupingDigits = parseInt(a.secondaryGroupingDigits)
          this._minGroupingDigits = parseInt(a.minGroupingDigits)
          this._currencyCode = a.currencyOfPreference
          this._validateInput()
          0 === this._secondaryGroupingDigits &&
            (this._secondaryGroupingDigits = this._groupingDigits)
        },
        format: function (a, c) {
          a = parseFloat(a)
          isNaN(a) && this._throwValidationError('amount')
          if (0 > a) return '-' + this.format(-a, c)
          a = this._formatAmount(a)
          return this._currencyFormat(c).replace('{}', a)
        },
        isValidPrice: function (a, c) {
          a = parseFloat(a)
          return !isNaN(a) && 0 <= a && this._isValidCurrencyCode(c)
        },
        _validateInput: function () {
          this._validatePriceFormat()
          this._validateSeparator('decimalSeparator', this._decimalSeparator)
          this._validateSeparator('groupingSeparator', this._groupingSeparator)
          this._validateDigitsCount('fractionDigits', this._fractionDigits, 0)
          this._validateDigitsCount('groupingDigits', this._groupingDigits, 0)
          this._validateDigitsCount('secondaryGroupingDigits', this._secondaryGroupingDigits, 0)
          this._validateDigitsCount('minGroupingDigits', this._minGroupingDigits, 1)
          this._validateCurrencyCode()
        },
        _validatePriceFormat: function () {
          ;('string' === typeof this._priceFormat && -1 !== this._priceFormat.indexOf('{}')) ||
            this._throwValidationError('priceFormat')
        },
        _validateSeparator: function (a, c) {
          ;('string' === typeof c && 0 !== c.length) || this._throwValidationError(a)
        },
        _validateDigitsCount: function (a, c, g) {
          ;('number' !== typeof c || isNaN(c) || c < g) && this._throwValidationError(a)
        },
        _validateCurrencyCode: function () {
          this._isValidCurrencyCode(this._currencyCode) ||
            this._throwValidationError('currencyOfPreference')
        },
        _isValidCurrencyCode: function (a) {
          return 'string' === typeof a && /^[A-Z]{3}$/.test(a)
        },
        _throwValidationError: function (a) {
          throw Error('[abPricingFfqp_priceFormatter] Invalid value for ' + a)
        },
        _formatAmount: function (a) {
          var c = this._halfEvenRound(a, this._fractionDigits).toString().split('.')
          a = this._formatIntegerPart(c[0])
          if (0 === this._fractionDigits) return a
          c = this._formatDecimalPart(2 === c.length ? c[1] : '')
          return [a, c].join(this._decimalSeparator)
        },
        _halfEvenRound: function (a, c) {
          a *= Math.pow(10, c)
          var g = a % 1
          a =
            0.500001 <= g || (1e-6 > Math.abs(g - 0.5) && 1 === Math.floor(a) % 2)
              ? Math.ceil(a)
              : Math.floor(a)
          return a / Math.pow(10, c)
        },
        _formatIntegerPart: function (a) {
          if (
            0 === this._groupingDigits ||
            a.length < this._groupingDigits + this._minGroupingDigits
          )
            return a
          for (var c = a.length, g = !0, d = []; 0 < c; ) {
            var f = this._secondaryGroupingDigits
            g && ((g = !1), (f = this._groupingDigits))
            c < f ? d.push(a.substr(0, c)) : d.push(a.substr(c - f, f))
            c -= f
          }
          return d.reverse().join(this._groupingSeparator)
        },
        _formatDecimalPart: function (a) {
          for (; a.length < this._fractionDigits; ) a += '0'
          return a.substr(0, this._fractionDigits)
        },
        _currencyFormat: function (a) {
          if (a === this._currencyCode) return this._priceFormat
          this._isValidCurrencyCode(a) || this._throwValidationError('currencyCode')
          g.registerCounter(f.COUNTER_METRIC.FALLBACK_PRICE_FORMAT_USED)
          return a + ' {}'
        },
      })
    },
  )
  ;('use strict')
  p.register('abPricingFfqp_constants', function () {
    return {
      METRIC_SCOPE_NAME: {
        AAPI_PRICE_FORMATTER: 'b2b-ffqp-aapi-price-formatter',
        AAPI_CLIENT: 'b2b-ffqp-aapi-client-{clientId}',
        AAPI_QPT: 'b2b-ffqp-aapi-qpt',
        AAPI_PACK_ASIN: 'b2b-ffqp-aapi-pack-asin',
        AAPI_SINGLE_QUANTITY: 'b2b-ffqp-aapi-single-quantity',
        AUI_STATE_PARSING: 'b2b-ffqp-aui-state-parsing',
        GET_QPT_REQUEST: 'b2b-ffqp-get-qpt-request',
      },
      COUNTER_METRIC: {
        FALLBACK_PRICE_FORMAT_USED: 'ABPricingFreeFormQuantityPicker.FallbackPriceFormatUsed',
        AAPI_REQUEST_STATUS:
          'ABPricingFreeFormQuantityPicker.AAPIClient.{clientId}.status.{status}',
        AAPI_SINGLE_QUANTITY_BO_NOT_FOUND:
          'ABPricingFreeFormQuantityPicker.AAPISingleQuantityBONotFound',
        AAPI_SINGLE_QUANTITY_EXTRACTION_FAILED:
          'ABPricingFreeFormQuantityPicker.AAPISingleQuantityBONotFoundExtractionFailed',
        AAPI_PACK_ASIN_EXTRACTION_FAILED:
          'ABPricingFreeFormQuantityPicker.AAPIPackAsinExtractionFailed',
        AAPI_PACK_ASIN_BO_NOT_FOUND: 'ABPricingFreeFormQuantityPicker.AAPIPackAsinBONotFound',
        AAPI_PACK_ASIN_MISSING: 'ABPricingFreeFormQuantityPicker.AAPIPackAsinMissing',
        AAPI_PACK_ASIN_MISSING_BO: 'ABPricingFreeFormQuantityPicker.AAPIPackAsinMissing.{bo}',
        AAPI_PACK_ASIN_ERROR: 'ABPricingFreeFormQuantityPicker.AAPIPackAsinError',
        AAPI_PACK_ASIN_ERROR_CODE: 'ABPricingFreeFormQuantityPicker.AAPIPackAsinError.{code}',
        AAPI_PACK_ASIN_PRESENT: 'ABPricingFreeFormQuantityPicker.AAPIPackAsinPresent',
        AAPI_QPT_BO_NOT_FOUND: 'ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTableBONotFound',
        AAPI_QPT_MISSING: 'ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTableMissing',
        AAPI_QPT_MISSING_BO: 'ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTableMissing.{bo}',
        AAPI_QPT_ERROR: 'ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTableError',
        AAPI_QPT_ERROR_CODE: 'ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTableError.{code}',
        AAPI_QPT_PRESENT: 'ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTablePresent',
        AAPI_QPT_PAGINATES: 'ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTablePaginates',
        AAPI_QPT_FETCH_PAGE: 'ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTableFetchPage',
        AAPI_QPT_PAGE_FETCHED:
          'ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTablePageFetched',
        AAPI_QPT_PAGINATION_COMPLETE:
          'ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTablePaginationComplete',
        AAPI_QPT_NEXT_PAGE_ONLY:
          'ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTableNextPageOnly',
        AAPI_QPT_PAGE_MISSING:
          'ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTablePaginationPageMissing',
        AAPI_QPT_EXTRACTION_FAILED:
          'ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTableExtractionFailed',
        AAPI_QPT_CONVERSION_ERROR:
          'ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTableConversionFailed',
        AAPI_QPT_PAGINATION_PAGE_ERROR:
          'ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTablePaginationPageError',
        AAPI_QPT_PAGINATION_ERROR:
          'ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTablePaginationError',
        AAPI_QPT_PAGINATION_404_ERROR:
          'ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTablePagination404Error',
        AAPI_QPT_PAGINATION_404_EXCEPTION:
          'ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTablePagination404Exception',
        AAPI_QPT_MAX_PAGINATION_DEPTH_REACHED:
          'ABPricingFreeFormQuantityPicker.AAPIQuantityPricingTablePaginationDepthReached',
        AAPI_QPT_WEBLABS_TRIGGERING_EXCEPTION:
          'ABPricingFreeFormQuantityPicker.WeblabTriggeringException',
        AAPI_SUBRESOURCE_WEBLABS_TRIGGERING_EXCEPTION:
          'ABPricingFreeFormQuantityPicker.SubresourceWeblabTriggeringException',
        AAPI_DATA_MGR_INIT_FAILED:
          'ABPricingFreeFormQuantityPicker.AAPIDataManagerInitializationFailed',
        PACK_ASIN_RECOMMENDATION_ERROR:
          'ABPricingFreeFormQuantityPicker.PackAsinRecommendationError',
        QUANTITY_REFRESH_CHECK_ERROR: 'ABPricingFreeFormQuantityPicker.QuantityRefreshCheckError',
        PAGE_WILL_REFRESH: 'ABPricingFreeFormQuantityPicker.PageWillRefresh',
        NO_PAGE_REFRESH_QTY_AVAILABLE: 'ABPricingFreeFormQuantityPicker.NoPageRefreshQtyAvailable',
        NO_PAGE_REFRESH_QTY_NOT_AVAILABLE:
          'ABPricingFreeFormQuantityPicker.NoPageRefreshQtyNotAvailable',
        AVAILABILITY_CHECK_QTY_AVAILABLE_SHOULD_REFRESH:
          'ABPricingFreeFormQuantityPicker.AvailabilityCheckQtyAvailableShouldRefresh',
        AVAILABILITY_CHECK_PAGE_WILL_REFRESH:
          'ABPricingFreeFormQuantityPicker.AvailabilityCheckPageWillRefresh',
        AVAILABILITY_CHECK_QTY_AVAILABLE_NO_REFRESH:
          'ABPricingFreeFormQuantityPicker.AvailabilityCheckQtyAvailableNoRefresh',
        AVAILABILITY_CHECK_QTY_AVAILABLE:
          'ABPricingFreeFormQuantityPicker.AvailabilityCheckQtyAvailable',
        OPTIMIZER_POPOVER_DISPLAYED: 'ABPricingFreeFormQuantityPicker.OptimizerPopoverDisplayed',
        OPTIMIZER_BOTTOM_SHEET_DISPLAYED:
          'ABPricingFreeFormQuantityPicker.OptimizerBottomSheetDisplayed',
        AVAILABILITY_CHECK_QTY_NOT_AVAILABLE:
          'ABPricingFreeFormQuantityPicker.AvailabilityCheckQtyNotAvailable',
        AVAILABILITY_CHECK_ERROR: 'ABPricingFreeFormQuantityPicker.AvailabilityCheckError',
        MISSING_AJAX_PARAMS: 'ABPricingFreeFormQuantityPicker.MissingAjaxParams',
        SPLIT_OFFER_LINK_DISPLAYED: 'SplitOfferLinkDisplayed',
      },
      ERROR: {
        AAPI_DATA_MGR_INIT_FAILED: 'AAPIDataManager initialization failed',
        MISSING_AJAX_PARAMS: 'AAPIDataManager could not find the AJAX parameters',
      },
      AAPI_CLIENT_ID_PLACEHOLDER: '{clientId}',
      AAPI_METADATA_EXPERIMENTS: 'x-api-exp-data',
      AAPI_REQUEST_STATUS_PLACEHOLDER: '{status}',
      AAPI_ERROR_CODE_PLACEHOLDER: '{code}',
      AAPI_BO_PLACEHOLDER: '{bo}',
      UNSPECIFIED_CLIENT_ID: 'unspecified',
      UNSPECIFIED_REQUEST_STATUS: 'unspecified',
      AAPI_CLIENT_TIMEOUT: 6e3,
      AJAX_PARAMS_STATE_KEY: 'quantityPickerAjaxParams',
      MAX_SUPPORTED_QTY: 999,
      MAX_PAGINATION_DEPTH: 10,
      ADD_TO_CART_QUANTITY_CHANGE_EVENT: 'addToCartQuantityChange',
      URL_PARAM_ID__BUYING_IN_BULK_QUANTITY: 'quantity',
      URL_PARAM_ID__BUYING_IN_BULK_REFTAG: 'ref_',
      URL_PARAM_ID__BUYING_IN_BULK_ASIN: 'asin',
      URL_PARAM_VALUE__LIMITED_AVAILABILITY_REFTAG: 'bbt_limit_order',
      WEBLAB_AUTOTRIGGER_ALLOWLIST: [
        'AB_SAVINGS_STANDARDIZATION_EXPERIMENT_868536',
        'B2BHAWKS_QPT_PAGE_LIMIT_DATAPATH_1033347',
        'AB_DPX_OPTIMIZER_EXPERIMENT_1056062',
      ],
    }
  })
  ;('use strict')
  p.when('jQuery', 'abPricingFfqp_constants', 'ready').register(
    'abPricingFfqp_metrics',
    function (d, m) {
      function g(a) {
        c.isEnabled && f.ue && f.ue.count && f.ue.count(a, (f.ue.count(a) || 0) + 1)
      }
      function a(a, c) {
        f.ue && f.ue.trigger && f.ue.trigger(a, c)
      }
      var c = { isEnabled: !0 }
      return {
        logError: function (a, c, g) {
          f.ueLogError &&
            f.ueLogError(g, {
              logLevel: a,
              attribution: 'ABPricingFreeFormQuantityPicker',
              message: c,
            })
        },
        updateCounterTriggering: function (a) {
          c.isEnabled = a
        },
        register: function (a) {
          a.counter && g(a.counter)
        },
        registerCounter: g,
        registerWidgetBodyBegin: function (a) {
          c.isEnabled && f.uet && f.uet('bb', a, { wb: 1 })
        },
        registerWidgetCriticalFeature: function (a) {
          c.isEnabled && f.uet && f.uet('cf', a, { wb: 1 })
        },
        registerWidgetLoaded: function (a) {
          c.isEnabled && f.uex && f.uex('ld', a, { wb: 1 })
        },
        triggerWeblab: a,
        triggerWeblabIfAllowlisted: function (c, g) {
          m.WEBLAB_AUTOTRIGGER_ALLOWLIST.includes(c) && a(c, g)
        },
      }
    },
  )
  ;('use strict')
  p.when(
    'jQuery',
    'A',
    'abPricingFfqp_utils',
    'abPricingFfqp_constants',
    'abPricingFfqp_metrics',
    'abPricingFfqp_quantityPickerDataManager',
  ).register('abPricingFfqp_quantityManager', function (d, m, g, a, c, k) {
    function l(e, a) {
      return (e = new RegExp('(?:^|\\?|\x26)' + a + '\x3d(?:([^\x26#]*)|\x26|#|$)').exec(e))
        ? e[1]
          ? decodeURIComponent(e[1].replace(/\+/g, ' '))
          : ''
        : r
    }
    function n(e, a, b) {
      var h = e.split('#')
      e = h[0]
      e = '?' === e[0] ? e.substr(1) : e
      h = h[1]
      'undefined' !== typeof b && null !== b
        ? ((b = a + '\x3d' + b),
          (a = new RegExp('(^|\x26)(' + a + '\x3d[^\x26]*)')),
          (e = a.test(e) ? e.replace(a, '$1' + b) : e + ((0 !== e.length ? '\x26' : '') + b)))
        : ((a = new RegExp('(^|\x26)(' + a + '\x3d[^\x26]*)')),
          a.test(e) && ((e = e.replace(a, '')), '\x26' === e[0] && (e = e.substr(1))))
      return '?' + e + ('undefined' !== typeof h ? '#' + h : '')
    }
    function q(e, a) {
      for (var b in a)
        a.hasOwnProperty(b) && (e = n(e, encodeURIComponent(b), encodeURIComponent(a[b])))
      return e
    }
    function h(e) {
      return (
        f.location.protocol + '//' + f.location.host + f.location.pathname + q(f.location.search, e)
      )
    }
    function b() {
      var e
      e = parseInt(l(f.location.search, 'qty'))
      e = isNaN(e) || 1 > e || e > a.MAX_SUPPORTED_QTY ? 1 : e
      this._initialQuantity = this.currentQuantity = e
      this.wireUpSelectorBasedEvents()
    }
    m.on('ready', function () {
      f.location.search.includes('\x26bmsmSlotRedirect\x3d1') &&
        document.getElementById('qtyUpdatedTooltip').click()
    })
    b.prototype.getCurrentQuantity = function () {
      return this.currentQuantity
    }
    b.prototype.wireUpSelectorBasedEvents = function () {
      var e = this
      p.when('A', 'jQuery', 'quanityChangePriceUpdate').execute(function (a, b, h) {
        e.quantityChangePriceUpdater = h
        a.on('a:pageUpdate', function () {
          e.handleTwisterPageRefresh()
        })
      })
    }
    b.prototype.update3PPriceBlock = function () {
      if (!(this.leastMinimumOrderQuantity === r || 1 >= this.leastMinimumOrderQuantity)) {
        var e = d('.price3P')
        e.hasClass('updatedPrice3P') ||
          (e.addClass('updatedPrice3P'),
          this.quantityChangePriceUpdater.ajaxCall({
            qt: this.leastMinimumOrderQuantity,
            quantityPriceField: 'quantity_price',
          }))
      }
    }
    b.prototype.handleTwisterPageRefresh = function () {
      this.update3PPriceBlock()
    }
    b.prototype.reloadPageForQuantity = function (e, a) {
      var b = {},
        c = ''
      b.qty = e
      b.psc = 1
      e = ''
      'undefined' !== typeof a &&
        ('undefined' !== typeof a.refTag && (b.ref_ = a.refTag),
        'string' === typeof a.selectedBuyingOption &&
          0 < a.selectedBuyingOption.length &&
          (b.sbo = a.selectedBuyingOption),
        'undefined' !== typeof a.merchantId && (b.smid = a.merchantId),
        'undefined' !== typeof a.anchorToDiv && (e = a.anchorToDiv),
        'undefined' !== typeof a.asinDetailPageUrl &&
          (c =
            f.location.protocol +
            '//' +
            f.location.host +
            a.asinDetailPageUrl +
            q('', b) +
            '\x26bmsmSlotRedirect\x3d1' +
            e))
      0 === c.length && (c = h(b) + e)
      f.location.href = c
    }
    b.prototype.notifyQuantityTyped = function (e, b) {
      this.quantityRefreshCheck({
        newQuantity: e,
        currentBuyBoxId: b.currentBuyBoxId,
        qdsForLockedMerchantEnabled: b.qdsForLockedMerchantEnabled,
        success: function (e, h) {
          c.registerCounter(
            e
              ? a.COUNTER_METRIC.AVAILABILITY_CHECK_QTY_AVAILABLE
              : a.COUNTER_METRIC.AVAILABILITY_CHECK_QTY_NOT_AVAILABLE,
          )
          b.callback({ hasAvailability: e })
        },
        error: function () {
          c.registerCounter(a.COUNTER_METRIC.AVAILABILITY_CHECK_ERROR)
          b.callback({ hasAvailability: !0 })
        },
      })
    }
    b.prototype.buyboxRefreshCheck = function (e) {
      var b = this
      this.quantityRefreshCheck({
        newQuantity: e.newQuantity,
        currentBuyBoxId: e.currentBuyBoxId,
        qdsForLockedMerchantEnabled: e.qdsForLockedMerchantEnabled,
        startEvent: 'quantityRefreshCheckStarted',
        success: function (h, g) {
          e.newQuantity === b.currentQuantity &&
            (h && g
              ? (c.registerCounter(a.COUNTER_METRIC.PAGE_WILL_REFRESH),
                b.reloadPageForQuantity(e.newQuantity, {
                  activeBuyBoxId: e.activeBuyBoxId,
                  selectedBuyingOption: e.selectedBuyingOption,
                }))
              : (c.registerCounter(
                  h
                    ? a.COUNTER_METRIC.NO_PAGE_REFRESH_QTY_AVAILABLE
                    : a.COUNTER_METRIC.NO_PAGE_REFRESH_QTY_NOT_AVAILABLE,
                ),
                e.callback({ hasAvailability: h })),
            m.trigger('quantityRefreshCheckFinished'))
        },
        error: function () {
          c.registerCounter(a.COUNTER_METRIC.QUANTITY_REFRESH_CHECK_ERROR)
          e.newQuantity === b.currentQuantity &&
            b.reloadPageForQuantity(e.newQuantity, {
              activeBuyBoxId: e.activeBuyBoxId,
              selectedBuyingOption: e.selectedBuyingOption,
            })
        },
      })
    }
    b.prototype.notifyQuantityChanged = function (e, a) {
      e = parseInt(e)
      if (this.currentQuantity !== e) {
        this.currentQuantity = e
        if (f.history !== r && f.history.pushState !== r) {
          var b = {}
          b.qty = e
          f.history.pushState({}, '', h(b))
        }
        m.trigger('buyBoxQuantityChanged', a.senderId, e, {
          newQuantity: e,
          activeBuyBoxId: a.activeBuyBoxId,
          selectedBuyingOption: a.selectedBuyingOption,
        })
        m.trigger('notifyBuyingInBulkOptionClicked', e)
      }
    }
    b.prototype.quantityRefreshCheck = function (e) {
      if (!0 !== e.preventRefreshCheck) {
        var a = {
          asin: g.getPageState().asin,
          initialQuantity: this._initialQuantity,
          quantity: e.newQuantity,
          currentBuyBoxId: e.currentBuyBoxId,
          success: e.success,
          error: e.error,
        }
        if (e.qdsForLockedMerchantEnabled) {
          var b = l(f.location.search, 'smid')
          'undefined' !== typeof b && (a.merchantId = b)
        }
        'string' === typeof e.startEvent && m.trigger(e.startEvent)
        k.getInstance().refreshCheck(a)
      }
    }
    b.prototype.fetchAllTiersForQuantityDiscountTable = function (e) {
      var a = this.isQPTBuyBoxAwareEnabled(e),
        b = { asin: g.getPageState().asin, enableQPTPagination: 'true' }
      a && (b.currentBuyBoxId = e.activeBuyBoxId)
      if (e.qdsForLockedMerchantEnabled) {
        var h = l(f.location.search, 'smid')
        'undefined' !== typeof h && (b.merchantId = h)
      }
      h = e.enableQuantityPricingTablePagination
      'undefined' !== h && (b.enableQPTPagination = !1 === h ? 'false' : 'true')
      var c = this
      this.triggerBuyBoxAwareEvent('fetchQuantityDiscountTableStarted', e)
      b.success = function (b) {
        a
          ? m.trigger('fetchQuantityDiscountTableCompleted', b, e.senderId)
          : m.trigger('fetchQuantityDiscountTableCompleted', b)
      }
      b.error = function () {
        c.triggerBuyBoxAwareEvent('fetchQuantityDiscountTableError', e)
      }
      k.getInstance().getQuantityPricingTable(b)
    }
    b.prototype.isQPTBuyBoxAwareEnabled = function (e) {
      return e && e.senderId && e.activeBuyBoxId
    }
    b.prototype.triggerBuyBoxAwareEvent = function (e, a) {
      this.isQPTBuyBoxAwareEnabled(a) ? m.trigger(e, a.senderId) : m.trigger(e)
    }
    b.prototype.notifyBuyingInBulkOptionClicked = function (e) {
      m.trigger('notifyBuyingInBulkOptionClicked', e)
    }
    b.prototype.getLimitedAvailabilityUrl = function (e) {
      var b = {}
      b[a.URL_PARAM_ID__BUYING_IN_BULK_QUANTITY] = e
      b[a.URL_PARAM_ID__BUYING_IN_BULK_ASIN] = g.getPageState().asin
      b[a.URL_PARAM_ID__BUYING_IN_BULK_REFTAG] = a.URL_PARAM_VALUE__LIMITED_AVAILABILITY_REFTAG
      return '/ab/bulk-order/bebx/api/v2/fastForwardBasket' + q('?', b)
    }
    b.prototype.notifyQuantityUnavailableOptionClicked = function (e) {
      e = f.location.protocol + '//' + f.location.host + this.getLimitedAvailabilityUrl(e)
      f.location.href = e
    }
    return {
      EVENT__BUY_BOX_QUANTITY_CHANGED: 'buyBoxQuantityChanged',
      EVENT__QUANTITY_REFRESH_CHECK_STARTED: 'quantityRefreshCheckStarted',
      EVENT__QUANTITY_REFRESH_CHECK_FINISHED: 'quantityRefreshCheckFinished',
      EVENT__FETCH_QUANTITY_DISCOUNT_TABLE_STARTED: 'fetchQuantityDiscountTableStarted',
      EVENT__FETCH_QUANTITY_DISCOUNT_TABLE_COMPLETED: 'fetchQuantityDiscountTableCompleted',
      EVENT__FETCH_QUANTITY_DISCOUNT_TABLE_ERROR: 'fetchQuantityDiscountTableError',
      EVENT__NOTIFY_BUYING_IN_BULK_OPTION_CLICKED: 'notifyBuyingInBulkOptionClicked',
      getUrlParameter: l,
      replaceUrlParameter: n,
      replaceUrlQueryParameters: function (e, a) {
        var b = '?'
        e = e.split(b)
        2 === e.length && (b += e[1])
        a = q(b, a)
        '?' !== a && (e[0] += a)
        return e[0]
      },
      singleton: new b(),
    }
  })
  ;('use strict')
  p.when(
    'A',
    'jQuery',
    'abPricingFfqp_constants',
    'abPricingFfqp_metrics',
    'abPricingFfqp_amazonAPIClient',
    'abPricingFfqp_helpers',
    'ready',
  ).register('abPricingFfqp_quantityPickerDataManager', function (d, f, g, a, c, k) {
    var l = d.createClass({
        _buyboxIdToBOTypes: {
          customOffer: ['CUSTOM_OFFER'],
          b2bRd: ['B2B_RD'],
          default: ['NEW', 'B2B_NEW'],
        },
        _buyboxIdToFallbackBOTypes: { customOffer: ['NEW', 'B2B_NEW'] },
        init: function (a) {
          this._aapiClient = new c(a)
          this._qptCache = this._getQPTCacheInstance()
          this._quantityDataCache = this._getQuantityDataCacheInstance()
        },
        getQuantityPricingTable: function (h) {
          a.registerWidgetBodyBegin(g.METRIC_SCOPE_NAME.GET_QPT_REQUEST)
          var b = this
          this._qptCache.get(
            h,
            function (e) {
              try {
                var c,
                  d = b._extractQPT(e, h),
                  f = b._extractPricingTiers(d)
                if (b._hasNextPage(d)) {
                  a.registerCounter(g.COUNTER_METRIC.AAPI_QPT_PAGINATES)
                  a.registerCounter(g.COUNTER_METRIC.AAPI_QPT_FETCH_PAGE)
                  var k = b._extractNextPage(d)
                  b._aapiQPTRequest({
                    asin: h.asin,
                    nextPageUrl: k,
                    pricingTiersPages: [f],
                    onSuccess: h.success,
                    onError: h.error,
                  })
                } else (c = b._convertToLegacyFormat(f)), h.success(c)
              } catch (m) {
                a.registerCounter(g.COUNTER_METRIC.AAPI_QPT_EXTRACTION_FAILED), h.error(m)
              }
            },
            h.error,
          )
        },
        refreshCheck: function (a) {
          function b(e) {
            g || ((g = !0), a.error(e))
          }
          var e = this,
            c = {},
            g = !1
          f.each([a.quantity, a.initialQuantity], function (g, d) {
            e._getSingleQuantityData({
              asin: a.asin,
              merchantId: a.merchantId,
              quantity: d,
              currentBuyBoxId: a.currentBuyBoxId,
              success: function (e) {
                c[d] = e
                if (c[a.initialQuantity] && c[a.quantity]) {
                  e = c[a.initialQuantity]
                  var b = c[a.quantity]
                  a.success(
                    b.isAvailable,
                    e.price !== b.price || e.buyingOptionId !== b.buyingOptionId,
                  )
                }
              },
              error: b,
            })
          })
        },
        _aapiRequest: function (h) {
          a.registerWidgetBodyBegin(h.metricScopeName)
          this._aapiClient.productV2({
            asin: h.asin,
            subresources: h.subresources,
            parameters: h.parameters,
            success: function (b) {
              a.registerWidgetCriticalFeature(h.metricScopeName)
              a.registerWidgetLoaded(h.metricScopeName)
              h.onSuccess(b)
            },
            error: function (b, e) {
              a.registerWidgetLoaded(h.metricScopeName)
              h.onError(b, e)
            },
          })
        },
        _triggerQPTWeblabsIfAllowlisted: function (h) {
          if (h.metadata && h.metadata[g.AAPI_METADATA_EXPERIMENTS])
            try {
              h.metadata[g.AAPI_METADATA_EXPERIMENTS].split(',').forEach(function (b) {
                b = b.split(':', 2)
                a.triggerWeblabIfAllowlisted(b[0], b[1])
              })
            } catch (b) {
              a.logError('ERROR', 'Could not trigger weblabs', b),
                a.registerCounter(g.COUNTER_METRIC.AAPI_QPT_WEBLABS_TRIGGERING_EXCEPTION)
            }
        },
        _aapiQPTRequest: function (h) {
          var b = this
          this._aapiClient.productQPT({
            asin: h.asin,
            url: h.nextPageUrl,
            success: function (e) {
              try {
                var c = b._processQPTPage(e)
                h.pricingTiersPages.push(b._extractPricingTiers(c))
                a.registerCounter(g.COUNTER_METRIC.AAPI_QPT_PAGE_FETCHED)
                b._maxPaginationDepthGuardrail(h.pricingTiersPages.length)
                if (b._hasNextPage(c)) {
                  a.registerCounter(g.COUNTER_METRIC.AAPI_QPT_FETCH_PAGE)
                  var d = b._extractNextPage(c)
                  b._aapiQPTRequest({
                    asin: h.asin,
                    nextPageUrl: d,
                    pricingTiersPages: h.pricingTiersPages,
                    onSuccess: h.onSuccess,
                    onError: h.onError,
                  })
                } else {
                  var f = b._constructTiers(h.pricingTiersPages),
                    k = b._convertToLegacyFormat(f)
                  a.registerWidgetCriticalFeature(g.METRIC_SCOPE_NAME.GET_QPT_REQUEST)
                  a.registerWidgetLoaded(g.METRIC_SCOPE_NAME.GET_QPT_REQUEST)
                  a.registerCounter(g.COUNTER_METRIC.AAPI_QPT_PAGINATION_COMPLETE)
                  h.onSuccess(k)
                }
              } catch (m) {
                a.registerCounter(g.COUNTER_METRIC.AAPI_QPT_PAGINATION_PAGE_ERROR),
                  a.logError('ERROR', 'Exception when processing next page', m),
                  h.onError(m)
              }
            },
            error: function (e, c, d) {
              if (404 === d) {
                a.registerCounter(g.COUNTER_METRIC.AAPI_QPT_PAGINATION_404_ERROR)
                try {
                  var f = b._constructTiers(h.pricingTiersPages),
                    k = b._convertToLegacyFormat(f)
                  a.registerWidgetCriticalFeature(g.METRIC_SCOPE_NAME.GET_QPT_REQUEST)
                  a.registerWidgetLoaded(g.METRIC_SCOPE_NAME.GET_QPT_REQUEST)
                  h.onSuccess(k)
                } catch (m) {
                  a.registerWidgetLoaded(g.METRIC_SCOPE_NAME.GET_QPT_REQUEST),
                    a.registerCounter(g.COUNTER_METRIC.AAPI_QPT_PAGINATION_404_EXCEPTION),
                    a.logError('ERROR', 'Exception when processing empty page', m),
                    h.onError(m)
                }
              } else a.registerCounter(g.COUNTER_METRIC.AAPI_QPT_PAGINATION_ERROR), h.onError(e, c)
            },
          })
        },
        _maxPaginationDepthGuardrail: function (c) {
          if (c >= this.getMaxPaginationDepth())
            throw (
              (a.registerCounter(g.COUNTER_METRIC.AAPI_QPT_MAX_PAGINATION_DEPTH_REACHED),
              Error('Max pagination depth reached'))
            )
        },
        getMaxPaginationDepth: function () {
          return g.MAX_PAGINATION_DEPTH
        },
        _getQPTCacheInstance: function () {
          var a = this,
            b = [a._aapiClient.inclusions().quantityPricingTableV1]
          return new k.AsyncCache({
            loader: function (e, c, d) {
              var f = {}
              'string' === typeof e.merchantId && (f.merchantId = e.merchantId)
              f.enableQuantityPricingTablePagination = e.enableQPTPagination
              a._aapiRequest({
                asin: e.asin,
                subresources: b,
                parameters: f,
                onSuccess: c,
                onError: d,
                metricScopeName: g.METRIC_SCOPE_NAME.AAPI_QPT,
              })
            },
            keyGenerator: function (a) {
              var b = a.asin
              'string' === typeof a.merchantId && (b += a.merchantId)
              return b
            },
          })
        },
        _getQuantityDataCacheInstance: function () {
          var a = this,
            b = [a._aapiClient.inclusions().priceV1, a._aapiClient.inclusions().availabilityV2]
          return new k.AsyncCache({
            loader: function (e, c, d) {
              var f = { itemQuantity: e.quantity }
              'string' === typeof e.merchantId && (f.merchantId = e.merchantId)
              a._aapiRequest({
                asin: e.asin,
                subresources: b,
                parameters: f,
                onSuccess: c,
                onError: d,
                metricScopeName: g.METRIC_SCOPE_NAME.AAPI_SINGLE_QUANTITY,
              })
            },
            keyGenerator: function (a) {
              var b = a.asin + a.quantity.toString()
              'string' === typeof a.merchantId && (b += a.merchantId)
              return b
            },
          })
        },
        _firstBuyingOption: function (a) {
          return a.entity.buyingOptions[0]
        },
        _firstBuyingOptionByType: function (a, b) {
          a = a.entity.buyingOptions
          for (var e = 0; e < a.length; e++) {
            var c = a[e]
            if (-1 !== b.indexOf(c.type)) return c
          }
        },
        _firstBuyingOptionByBuyboxId: function (a, b) {
          a = this._firstBuyingOptionByType(
            a,
            this._buyboxIdToBOTypes[b] || this._buyboxIdToBOTypes.default,
          )
          if ('undefined' === typeof a) throw Error('Could not find an eligible buying option')
          return a
        },
        _firstBuyingOptionByBuyboxIdWithFallback: function (a, b) {
          var e = this._buyboxIdToFallbackBOTypes[b]
          b = this._firstBuyingOptionByType(
            a,
            this._buyboxIdToBOTypes[b] || this._buyboxIdToBOTypes.default,
          )
          'undefined' === typeof b &&
            'undefined' !== typeof e &&
            (b = this._firstBuyingOptionByType(a, e))
          if ('undefined' === typeof b)
            throw Error('Could not find an eligible or fallback buying option')
          return b
        },
        _extractQPT: function (c, b) {
          var e
          try {
            e = this._firstBuyingOptionByBuyboxId(c, b.currentBuyBoxId)
          } catch (d) {
            a.registerCounter(g.COUNTER_METRIC.AAPI_QPT_BO_NOT_FOUND)
            a.logError('ERROR', 'Exception when getting first BO', d)
            return
          }
          c = e.quantityPricingTable
          if ('undefined' === typeof c || 'undefined' === typeof c.entity)
            a.registerCounter(g.COUNTER_METRIC.AAPI_QPT_MISSING),
              'string' === typeof e.type &&
                a.registerCounter(
                  g.COUNTER_METRIC.AAPI_QPT_MISSING_BO.replace(g.AAPI_BO_PLACEHOLDER, e.type),
                )
          else return this._triggerQPTWeblabsIfAllowlisted(c), c
        },
        _processQPTPage: function (c) {
          if ('undefined' === c.entity) a.registerCounter(g.COUNTER_METRIC.AAPI_QPT_PAGE_MISSING)
          else return c
        },
        _extractPricingTiers: function (c) {
          if ('undefined' === typeof c) return []
          var b = c.entity.pricingTiers
          if ('undefined' === typeof b && this._hasNextPage(c))
            return a.registerCounter(g.COUNTER_METRIC.AAPI_QPT_NEXT_PAGE_ONLY), []
          if ('undefined' === typeof b)
            throw (
              (a.registerCounter(g.COUNTER_METRIC.AAPI_QPT_ERROR),
              (c = c.entity.code),
              'string' === typeof c &&
                a.registerCounter(
                  g.COUNTER_METRIC.AAPI_QPT_ERROR_CODE.replace(g.AAPI_ERROR_CODE_PLACEHOLDER, c),
                ),
              Error('Error in the QPT sub-resource'))
            )
          a.registerCounter(g.COUNTER_METRIC.AAPI_QPT_PRESENT)
          return b
        },
        _hasNextPage: function (a) {
          return 'undefined' !== typeof a && 'undefined' !== typeof a.entity.nextPage
        },
        _extractNextPage: function (a) {
          return a.entity.nextPage.resource.url
        },
        _constructTiers: function (a) {
          for (var b = 0, e = [], c = 0; c < a.length; c++)
            for (var g = 0; g < a[c].length; g++) {
              var d = a[c][g],
                f = d.minimumQuantity
              f !== b && ((b = f), e.push(d))
            }
          return e
        },
        _convertToLegacyFormat: function (c) {
          var b = []
          try {
            for (var e = 0; e < c.length; e++) {
              var d = c[e],
                f = {
                  quantity: d.minimumQuantity,
                  quantityPickerPriceText: k.richContentHelper.toText(d.priceMessage),
                  isUncompetitive: d.hidden,
                  isLowestAvailablePrice: d.lowestAvailablePrice,
                }
              d.savingsMessage && (f.savingsMessage = k.richContentHelper.toText(d.savingsMessage))
              d.availabilityMessage &&
                (f.availabilityMessage = k.richContentHelper.toText(d.availabilityMessage))
              d.program && (f.program = d.program)
              d.buyingInBulk &&
                'undefined' !== typeof d.buyingInBulk.fragments &&
                1 <= d.buyingInBulk.fragments.length &&
                ((f.buyingInBulkLink = k.richContentHelper.toText(d.buyingInBulk.fragments[0])),
                (f.buyingInBulkMessage = k.richContentHelper.toText({
                  fragments: d.buyingInBulk.fragments.slice(1),
                })))
              b.push(f)
            }
          } catch (m) {
            throw (a.registerCounter(g.COUNTER_METRIC.AAPI_QPT_CONVERSION_ERROR), m)
          }
          return b
        },
        _extractSingleQuantityData: function (c, b) {
          var e = { isAvailable: !1, buyingOptionId: '', price: '' },
            d
          try {
            d = this._firstBuyingOptionByBuyboxIdWithFallback(c, b)
          } catch (f) {
            return a.registerCounter(g.COUNTER_METRIC.AAPI_SINGLE_QUANTITY_BO_NOT_FOUND), e
          }
          try {
            return {
              isAvailable: 'OUT_OF_STOCK' !== d.availability.entity.type,
              buyingOptionId: d.availability.resource.url,
              price: d.price.entity.priceToPay.moneyValueOrRange.value.displayString,
            }
          } catch (f) {
            return a.registerCounter(g.COUNTER_METRIC.AAPI_SINGLE_QUANTITY_EXTRACTION_FAILED), e
          }
        },
        _getSingleQuantityData: function (a) {
          var b = this
          b._quantityDataCache.get(
            { asin: a.asin, merchantId: a.merchantId, quantity: a.quantity },
            function (e) {
              a.success(b._extractSingleQuantityData(e, a.currentBuyBoxId))
            },
            a.error,
          )
        },
      }),
      n = d.createClass({
        init: function (a) {
          this._errorMessage = a
        },
        getQuantityPricingTable: function (a) {
          a.error && a.error(this._errorMessage)
        },
        refreshCheck: function (a) {
          a.error && a.error(this._errorMessage)
        },
      }),
      q
    return {
      getInstance: function () {
        if ('undefined' !== typeof q) return q
        var c = d.state(g.AJAX_PARAMS_STATE_KEY)
        'undefined' === typeof c &&
          (a.registerWidgetBodyBegin(g.METRIC_SCOPE_NAME.AUI_STATE_PARSING),
          d.state.parse(),
          a.registerWidgetLoaded(g.METRIC_SCOPE_NAME.AUI_STATE_PARSING),
          (c = d.state(g.AJAX_PARAMS_STATE_KEY)))
        if ('undefined' !== typeof c) {
          c.priceFormatConfig = c
          c.clientId = 'dpx'
          try {
            q = new l(c)
          } catch (b) {
            a.registerCounter(g.COUNTER_METRIC.AAPI_DATA_MGR_INIT_FAILED),
              (q = new n(g.ERROR.AAPI_DATA_MGR_INIT_FAILED))
          }
        } else
          return (
            a.registerCounter(g.COUNTER_METRIC.MISSING_AJAX_PARAMS),
            new n(g.ERROR.MISSING_AJAX_PARAMS)
          )
        return q
      },
    }
  })
  ;('use strict')
  p.when('A').register('abPricingFfqp_helpers', function (d) {
    var f = d.createClass({
      _listeners: {},
      addListeners: function (d, a, c) {
        this._listeners.hasOwnProperty(d) || (this._listeners[d] = [])
        this._listeners[d].push({ success: a, error: c })
      },
      triggerSuccess: function (d, a) {
        this._triggerListeners(d, 'success', a)
      },
      triggerError: function (d, a) {
        this._triggerListeners(d, 'error', a)
      },
      _triggerListeners: function (d, a, c) {
        if (this._listeners.hasOwnProperty(d))
          for (d = this._listeners[d]; 0 < d.length; ) {
            var f = d.pop()
            if (f[a]) f[a](c)
          }
      },
    })
    return {
      AsyncCache: d.createClass({
        _requestStatus: { IN_PROGRESS: 1, READY: 2, ERROR: 3 },
        _status: {},
        _cache: {},
        init: function (d) {
          this._eventHandler = new f()
          this._loader = d.loader
          this._keyGenerator = d.keyGenerator
        },
        _getKey: function (d) {
          return this._keyGenerator ? this._keyGenerator(d) : d
        },
        get: function (d, a, c) {
          var f = this._getKey(d)
          this._status[f] === this._requestStatus.READY
            ? a(this._cache[f])
            : (this._eventHandler.addListeners(f, a, c), this._load(d, f))
        },
        _load: function (d, a) {
          var c = this
          c._status[a] !== c._requestStatus.IN_PROGRESS &&
            ((c._status[a] = c._requestStatus.IN_PROGRESS),
            c._loader(
              d,
              function (d) {
                c._cache[a] = d
                c._status[a] = c._requestStatus.READY
                c._eventHandler.triggerSuccess(a, d)
              },
              function (d) {
                c._status[a] = c._requestStatus.ERROR
                c._eventHandler.triggerError(a, d)
              },
            ))
        },
      }),
      richContentHelper: {
        toText: function a(c) {
          if (c.money) return c.money.displayString
          if (c.text) return c.text
          if (c.link) return a(c.link.content)
          if (c.fragments) {
            for (var d = [], f = 0; f < c.fragments.length; f++) d.push(a(c.fragments[f]))
            return d.join('')
          }
          return c.semanticContent ? a(c.semanticContent.content) : ''
        },
      },
    }
  })
  ;('use strict')
  p.when(
    'jQuery',
    'A',
    'a-dropdown',
    'a-button',
    'abPricingFfqp_utils',
    'abPricingFfqp_quantityManager',
    'abPricingFfqp_metrics',
    'abPricingFfqp_constants',
  ).register('abPricingFfqp_quantityPickerLogic', function (d, f, g, a, c, k, l, n) {
    function q(a) {
      return a.prop('selectedIndex') + 1 === a.prop('length')
    }
    function h(a, b) {
      if (!c.dropdownContainsQuantity(a, b)) {
        var d = document.createElement('option')
        d.value = b
        d.text = b.toString()
        a.append(d)
      }
    }
    function b(a) {
      this.id = a.id
      this.buyBoxId = a.buyBoxId
      this.buyingOptionStereotype = a.buyingOptionStereotype ? a.buyingOptionStereotype : ''
      this.quantityHiddenFieldSelector = a.quantityHiddenFieldSelector
      this.leastMinimumOrderQuantity = a.leastMinimumOrderQuantity
      this.predefinedQuantitiesDropdownSelector = a.predefinedQuantitiesDropdownSelector
      this.predefinedQuantitiesDropdownContainerSelector =
        a.predefinedQuantitiesDropdownContainerSelector
      this.freeQuantityTextInputSelector = a.freeQuantityTextInputSelector
      this.freeQuantityTextInputOuterSelector = a.freeQuantityTextInputOuterSelector
      this.updateButtonSelector = a.updateButtonSelector
      this.addToCartButtonSelector = a.addToCartButtonSelector
      this.buyingOptionPosition = a.buyingOptionPosition
      this.limitedAvailabilityMessageSelector = a.limitedAvailabilityMessageSelector
      this.splitOfferLinkSelector = a.splitOfferLinkSelector
      this.splitOfferSectionSelector = a.splitOfferSectionSelector
      this.amazonDevicesLinkEnabled = a.amazonDevicesLinkEnabled
      this.buyingInBulkBaseUrl = a.buyingInBulkBaseUrl
      this.initializeQuantityHiddenField()
      this.wireUpSelectorBasedEvents()
    }
    b.prototype.wireUpSelectorBasedEvents = function () {
      var a = this,
        b = d(this.predefinedQuantitiesDropdownSelector)
      f.on('a:dropdown:' + b[0].id + ':select', function (b) {
        a.handleDropdownOptionClicked(b.value)
      })
      f.on(k.EVENT__BUY_BOX_QUANTITY_CHANGED, function (b, c, d) {
        a.handleQuantityChangedOnOtherBuyBox(b, c, d)
      })
      f.on(k.EVENT__QUANTITY_REFRESH_CHECK_STARTED, function () {
        a.handleQuantityRefreshCheckStarted()
      })
      f.on(k.EVENT__QUANTITY_REFRESH_CHECK_FINISHED, function () {
        a.handleQuantityRefreshCheckFinished()
      })
    }
    b.prototype.wireUpReferenceBasedEvents = function () {
      var a = this,
        b = d(this.freeQuantityTextInputSelector),
        c = d(this.updateButtonSelector)
      b.keydown(function (b) {
        a.handleTextInputKeyDown(b)
      })
      b.keyup(function (b) {
        a.handleTextInputKeyUp(b)
      })
      b.focus(function () {
        a.handleTextInputFocused()
      })
      c.click(function () {
        a.handleButtonClick()
      })
    }
    b.prototype.attachToDOM = function () {
      this.wireUpReferenceBasedEvents()
      q(d(this.predefinedQuantitiesDropdownSelector))
        ? this.switchToFreeQuantityUI()
        : this.switchToPredefinedQuantitiesUI()
      this.enableUI()
      this.lastSelectedQuantity = this.getCurrentQuantity()
      k.singleton.leastMinimumOrderQuantity = this.leastMinimumOrderQuantity
    }
    b.prototype.getCurrentQuantity = function () {
      if (this.isTextInputVisible()) {
        var a = d(this.freeQuantityTextInputSelector)
        return parseInt(a.val())
      }
      return this.isDropdownVisible()
        ? ((a = d(this.predefinedQuantitiesDropdownSelector)), parseInt(a.find(':selected').val()))
        : r
    }
    b.prototype.handleQuantityRefreshCheckStarted = function () {
      this.doesDOMExist() && this.disableUI()
    }
    b.prototype.handleQuantityRefreshCheckFinished = function () {
      this.doesDOMExist() && this.enableUI()
    }
    b.prototype.handleDropdownOptionClicked = function (a) {
      var b = d(this.predefinedQuantitiesDropdownSelector)
      q(b)
        ? ((a = d(this.freeQuantityTextInputSelector)),
          a.val(this.lastSelectedQuantity.toString()),
          this.switchToFreeQuantityUI(),
          a.focus(),
          c.incrementMetricByOne('freeFormQtyPickerMaxQtySelected'))
        : ((this.lastSelectedQuantity = a = parseInt(a)),
          this.updateQuantityHiddenField(a),
          k.singleton.notifyQuantityChanged(a, {
            senderId: this.id,
            activeBuyBoxId: this.buyBoxId,
            selectedBuyingOption: this.buyingOptionStereotype,
          }))
    }
    b.prototype.handleTextInputFocused = function () {
      d(this.freeQuantityTextInputSelector).select()
    }
    b.prototype.handleTextInputKeyUp = function (b) {
      13 !== b.keyCode && a(this.updateButtonSelector).show()
    }
    b.prototype.handleTextInputKeyDown = function (a) {
      13 === a.keyCode &&
        (a.preventDefault(),
        d(this.updateButtonSelector).click(),
        this._findWithinPickerAccordionRow(this.addToCartButtonSelector).focus())
    }
    b.prototype.clampQuantity = function (a) {
      999 < a && (a = 999)
      this.leastMinimumOrderQuantity !== r &&
        a < this.leastMinimumOrderQuantity &&
        (a = this.leastMinimumOrderQuantity)
      return a
    }
    b.prototype.handleButtonClick = function () {
      var b = d(this.predefinedQuantitiesDropdownSelector),
        f = g.getSelect(b[0]),
        h = d(this.freeQuantityTextInputSelector),
        m = h.val(),
        l = parseInt,
        n = m.match(/[1-9][0-9]*/),
        l = l(null === n ? '1' : n[0]),
        l = this.clampQuantity(l)
      c.dropdownContainsQuantity(b, l)
        ? (this.switchToPredefinedQuantitiesUI(),
          f.setValue(l.toString()),
          this.handleDropdownOptionClicked(l))
        : ((b = l.toString()),
          b !== m && h.val(b),
          a(this.updateButtonSelector).hide(),
          this.updateQuantityHiddenField(l),
          k.singleton.notifyQuantityChanged(l, {
            senderId: this.id,
            activeBuyBoxId: this.buyBoxId,
            selectedBuyingOption: this.buyingOptionStereotype,
          }))
    }
    b.prototype.doesDOMExist = function () {
      return (
        0 < d(this.predefinedQuantitiesDropdownSelector).length &&
        0 < d(this.freeQuantityTextInputSelector).length &&
        0 < d(this.updateButtonSelector).length
      )
    }
    b.prototype.handleQuantityChangedOnOtherBuyBox = function (a, b, c) {
      if (this.doesDOMExist()) {
        a !== this.id && this.getCurrentQuantity() !== b && this._updateSelectedQuantity(b)
        var d = this
        k.singleton.buyboxRefreshCheck({
          newQuantity: b,
          activeBuyBoxId: c.activeBuyBoxId,
          selectedBuyingOption: c.selectedBuyingOption,
          currentBuyBoxId: this.buyBoxId,
          callback: function (a) {
            d.updateLimitedAvailabilityMessageVisibility(a.hasAvailability)
          },
        })
      }
    }
    b.prototype._updateSelectedQuantity = function (a) {
      var b = d(this.predefinedQuantitiesDropdownSelector),
        f = g.getSelect(b[0])
      c.dropdownContainsQuantity(b, a)
        ? (f.setValue(a.toString()),
          (this.lastSelectedQuantity = a),
          this.switchToPredefinedQuantitiesUI())
        : (d(this.freeQuantityTextInputSelector).val(a.toString()), this.switchToFreeQuantityUI())
      this.updateQuantityHiddenField(a)
    }
    b.prototype.showDropdown = function () {
      d(this.predefinedQuantitiesDropdownContainerSelector).removeClass('aok-hidden')
    }
    b.prototype.hideDropdown = function () {
      d(this.predefinedQuantitiesDropdownContainerSelector).addClass('aok-hidden')
    }
    b.prototype.isDropdownVisible = function () {
      return !d(this.predefinedQuantitiesDropdownContainerSelector).hasClass('aok-hidden')
    }
    b.prototype.showTextInput = function () {
      'mobile' === c.getPageState().platform
        ? d(this.freeQuantityTextInputOuterSelector).removeClass('aok-hidden')
        : d(this.freeQuantityTextInputSelector).removeClass('aok-hidden')
    }
    b.prototype.hideTextInput = function () {
      'mobile' === c.getPageState().platform
        ? d(this.freeQuantityTextInputOuterSelector).addClass('aok-hidden')
        : d(this.freeQuantityTextInputSelector).addClass('aok-hidden')
    }
    b.prototype.isTextInputVisible = function () {
      return 'mobile' === c.getPageState().platform
        ? !d(this.freeQuantityTextInputOuterSelector).hasClass('aok-hidden')
        : !d(this.freeQuantityTextInputSelector).hasClass('aok-hidden')
    }
    b.prototype.disableTextInput = function () {
      if ('mobile' === c.getPageState().platform) {
        var a = d(this.freeQuantityTextInputSelector),
          b = d(this.freeQuantityTextInputOuterSelector)
        a.prop('disabled', 'disabled')
        b.addClass('a-form-disabled')
      } else
        (a = d(this.freeQuantityTextInputSelector)),
          a.prop('disabled', 'disabled'),
          a.addClass('a-form-disabled')
    }
    b.prototype.enableTextInput = function () {
      if ('mobile' === c.getPageState().platform) {
        var a = d(this.freeQuantityTextInputSelector),
          b = d(this.freeQuantityTextInputOuterSelector)
        a.removeProp('disabled')
        b.removeClass('a-form-disabled')
      } else
        (a = d(this.freeQuantityTextInputSelector)),
          a.removeProp('disabled'),
          a.removeClass('a-form-disabled')
    }
    b.prototype.switchToFreeQuantityUI = function () {
      this.hideDropdown()
      this.showTextInput()
      a(this.updateButtonSelector).hide()
    }
    b.prototype.switchToPredefinedQuantitiesUI = function () {
      this.showDropdown()
      this.hideTextInput()
      a(this.updateButtonSelector).hide()
    }
    b.prototype.disableUI = function () {
      var b = g.getSelect(this.predefinedQuantitiesDropdownSelector),
        c = a(this.updateButtonSelector)
      b.update({ status: 'disabled' })
      this.disableTextInput()
      c.disable()
    }
    b.prototype.enableUI = function () {
      var b = g.getSelect(this.predefinedQuantitiesDropdownSelector),
        c = a(this.updateButtonSelector)
      b.update({ status: 'normal' })
      this.enableTextInput()
      c.enable()
    }
    b.prototype._isMobileQuantityHiddenFieldSelector = function () {
      return (
        'string' === typeof this.quantityHiddenFieldSelector &&
        -1 < this.quantityHiddenFieldSelector.indexOf('select#mobileQuantityDropDown')
      )
    }
    b.prototype._mobileQuantityHiddenFieldSelector = function () {
      return this.quantityHiddenFieldSelector.replace(
        'input#quantity',
        'select#mobileQuantityDropDown',
      )
    }
    b.prototype.updateQuantityHiddenField = function (a) {
      var b = this._findWithinPickerAccordionRow(this.quantityHiddenFieldSelector).first()
      b.is('select') ? (h(b, a), g.getSelect(b).val(a)) : b.val(a.toString())
      f.trigger(n.ADD_TO_CART_QUANTITY_CHANGE_EVENT, { nativeItemNode: b[0], value: a.toString() })
      'mobile' !== c.getPageState().platform ||
        this._isMobileQuantityHiddenFieldSelector() ||
        ((b = this._findWithinPickerAccordionRow(this._mobileQuantityHiddenFieldSelector())) &&
          b.is('select') &&
          (h(b, a), g.getSelect(b).val(a), b.val(a.toString())))
    }
    b.prototype.updateLimitedAvailabilityMessageVisibility = function (b) {
      var c = this._findWithinPickerAccordionRow(this.addToCartButtonSelector).closest('.a-button'),
        f = a(c),
        c = this._findWithinPickerAccordionRow(this.splitOfferSectionSelector)
      b
        ? (d(this.limitedAvailabilityMessageSelector).addClass('aok-hidden'),
          f.enable(),
          c.addClass('aok-hidden'))
        : (d(this.limitedAvailabilityMessageSelector).removeClass('aok-hidden'),
          f.disable(),
          (b = this.getCurrentQuantity()),
          (f = this.amazonDevicesLinkEnabled
            ? this.buyingInBulkBaseUrl
            : k.singleton.getLimitedAvailabilityUrl(b)),
          this._findWithinPickerAccordionRow(this.splitOfferLinkSelector).attr('href', f),
          1 < b
            ? (l.registerCounter(n.COUNTER_METRIC.SPLIT_OFFER_LINK_DISPLAYED),
              c.removeClass('aok-hidden'))
            : c.addClass('aok-hidden'))
    }
    b.prototype._findWithinPickerAccordionRow = function (a) {
      return c.findWithinPickerAccordionRow(this.id, a)
    }
    b.prototype.initializeQuantityHiddenField = function () {
      var a = k.singleton.currentQuantity,
        b = parseInt(this.leastMinimumOrderQuantity)
      b && b > a && (a = b)
      this.updateQuantityHiddenField(a)
    }
    return { QuantityPickerLogic: b }
  })
  ;('use strict')
  p.when(
    'jQuery',
    'A',
    'a-dropdown',
    'a-modal',
    'a-button',
    'abPricingFfqp_utils',
    'abPricingFfqp_quantityManager',
    'abPricingFfqp_metrics',
    'abPricingFfqp_constants',
  ).register('abPricingFfqpV2_quantityPickerLogic', function (d, m, g, a, c, k, l, n, q) {
    function h(a, b) {
      if (!k.dropdownContainsQuantity(a, b)) {
        var c = document.createElement('option')
        c.value = b
        c.text = b.toString()
        a.append(c)
      }
    }
    function b(a) {
      this.id = a.id
      this.buyBoxId = a.buyBoxId
      this.buyingOptionStereotype = a.buyingOptionStereotype ? a.buyingOptionStereotype : ''
      this.quantityHiddenFieldSelector = a.quantityHiddenFieldSelector
      this.leastMinimumOrderQuantity = a.leastMinimumOrderQuantity
      this.quantityPickerSelector = a.quantityPickerSelector
      this.quantityDiscountTableSelector = this.quantityPickerSelector + ' .quantity-discount-table'
      this.quantityTextInputLabelSelector =
        this.quantityPickerSelector + ' .quantity-text-input-label'
      this.buyboxAccordionContainerSelector = a.buyboxAccordionContainerSelector
      this.loadMoreMessage = a.loadMoreMessage
      this.fetchTheBestPricesMessage = a.fetchTheBestPricesMessage
      this.qdtErrorMessage = a.qdtErrorMessage
      this.includeRfqdLinkInNewPicker = a.includeRfqdLinkInNewPicker
      this.requestForQuantityDiscountModalSelector = a.requestForQuantityDiscountModalSelector
      this.requestForQuantityDiscountMessage = a.requestForQuantityDiscountMessage
      this.requestForQuoteLinkEnabled = a.requestForQuoteLinkEnabled
      this.bbtLinkSelector = a.bbtLinkSelector
      this.addToCartButtonSelector = a.addToCartButtonSelector
      this.limitedAvailabilityMessageSelector = a.limitedAvailabilityMessageSelector
      this.fetchQuantityDiscountTableCompleted =
        this.fetchQuantityDiscountTableStarted =
        this.isLoadMoreButtonClicked =
          !1
      this.quantityTextInputSelector = this.quantityPickerSelector
      this.quantityTextInputSelector += ' .quantity-text-input-with-label'
      this.loadMoreButtonForUncompetitiveTiersPresence = this.hasError = !1
      this.quantityPricingTableSummaryEnabled = a.quantityPricingTableSummaryEnabled
      this.qdsForLockedMerchantEnabled = a.qdsForLockedMerchantEnabled
      this.isAODLinkEnabled = !0 === a.isAODLinkEnabled
      this.quantityPickerUnavailabilityMessage = a.quantityPickerUnavailabilityMessage
      this.quantityPickerUnavailabilityLink = a.quantityPickerUnavailabilityLink
      this.splitOfferLinkSelector = a.splitOfferLinkSelector
      this.splitOfferSectionSelector = a.splitOfferSectionSelector
      this.amazonDevicesLinkEnabled = a.amazonDevicesLinkEnabled
      this.buyingInBulkBaseUrl = a.buyingInBulkBaseUrl
      this.initializeQuantityAvailabilityVariables()
      this.wireUpSelectorBasedEvents()
      this.initializeQuantityHiddenField()
    }
    var e = k.PACKAGE_PREFIX + '.PriceTableLoadError',
      p = k.PACKAGE_PREFIX + '.QuantityPriceTableRender',
      t = k.PACKAGE_PREFIX + '.QuantityPriceTableView',
      u = k.PACKAGE_PREFIX + '.QuantityPriceTableRenderWithLockedMerchant',
      v = k.PACKAGE_PREFIX + '.QuantityPriceTableViewWithLockedMerchant',
      w = k.PACKAGE_PREFIX + '.QuantityPriceTableRenderWithUncompetitiveTiers',
      x = k.PACKAGE_PREFIX + '.QuantityPriceTableViewWithUncompetitiveTiers',
      y = k.PACKAGE_PREFIX + '.QuantityPriceTableLoadMoreButtonClicked',
      z = k.PACKAGE_PREFIX + '.QuantityPriceTableLoadMoreButtonClickedWithUncompetitiveTiers',
      A = k.PACKAGE_PREFIX + '.QuantityPriceTableBBTLinkRender',
      B = k.PACKAGE_PREFIX + '.QuantityPriceTableBBTLinkClick',
      C = k.PACKAGE_PREFIX + '.QuantityPriceTableQuantityUnavailableLinkRender',
      D = k.PACKAGE_PREFIX + '.QuantityPriceTableQuantityUnavailableLinkClick',
      E = k.PACKAGE_PREFIX + '.QuantityPriceTableRFQDBBTLinkClick',
      F = k.PACKAGE_PREFIX + '.QuantityPriceTableAvailabilityMessageRender',
      G = k.PACKAGE_PREFIX + '.QuantityPriceTableAvailabilityMessageView',
      H = k.PACKAGE_PREFIX + '.QuantityPriceTablePerceivedError'
    b.prototype.initializeQuantityAvailabilityVariables = function () {
      this.hasAvailability = !0
    }
    b.prototype.wireUpSelectorBasedEvents = function () {
      var a = this
      m.on(l.EVENT__FETCH_QUANTITY_DISCOUNT_TABLE_STARTED, function (b) {
        ;(b && b !== a.id) || a.handleFetchQuantityDiscountTableStarted()
      })
      m.on(l.EVENT__FETCH_QUANTITY_DISCOUNT_TABLE_COMPLETED, function (b, c) {
        ;(c && c !== a.id) || a.handleFetchQuantityDiscountTableCompleted(b)
      })
      m.on(l.EVENT__FETCH_QUANTITY_DISCOUNT_TABLE_ERROR, function (b) {
        ;(b && b !== a.id) || a.handleFetchQuantityDiscountTableError()
      })
      m.on(l.EVENT__BUY_BOX_QUANTITY_CHANGED, function (b, c, d) {
        a.handleQuantityChangedOnOtherBuyBox(b, c, d)
      })
      m.on(l.EVENT__QUANTITY_REFRESH_CHECK_STARTED, function () {
        a.handleQuantityRefreshCheckStarted()
      })
      m.on(l.EVENT__QUANTITY_REFRESH_CHECK_FINISHED, function () {
        a.handleQuantityRefreshCheckFinished()
      })
    }
    b.prototype.initializeQuantityHiddenField = function () {
      var a = l.singleton.currentQuantity,
        b = parseInt(this.leastMinimumOrderQuantity)
      b && b > a && (a = b)
      this.updateQuantityHiddenField(a)
    }
    b.prototype.handleFetchQuantityDiscountTableCompleted = function (a) {
      this.wireUpQuantityDiscountTableData(a)
      this.generateQuantityDiscountTable()
      this.fetchQuantityDiscountTableCompleted = !0
    }
    b.prototype.handleFetchQuantityDiscountTableStarted = function () {
      this.fetchQuantityDiscountTableStarted = !0
    }
    b.prototype.wireUpQuantityDiscountTableData = function (a) {
      this.priceTiers = a
      this.buildQptRenderMetrics()
      this.buildQptForLockedMerchantMetrics(u)
      this.buildQptUncompetitiveTiersMetrics(w)
      this.buildAvailabilityMessageMetrics(F)
    }
    b.prototype.handleFetchQuantityDiscountTableError = function () {
      k.incrementMetricByOne(e)
      this.fetchQuantityDiscountTableStarted = !1
      this.hasError = !0
      this.generateQuantityDiscountTable()
    }
    b.prototype.wireUpReferenceBasedEvents = function () {
      var a = this,
        b = d(this.quantityTextInputSelector),
        c = d(this.quantityTextInputLabelSelector)
      c.click(function () {
        b.focus()
        b.click()
      })
      b.focus(function () {
        c.hide()
        '1' === this.value && (this.value = '')
        a.showQuantityDiscountTable()
      })
      b.blur(function () {
        '' === this.value && (this.value = l.singleton.currentQuantity)
        a.updateQuantityAndHideQuantityDiscountTable()
        c.show()
      })
      b.live('keypress input', function (b) {
        a.isValidQuantityTextInputKeyCode(b)
        this.value = this.value.replace(/[^0-9]/g, '')
      })
      b.live(
        'input',
        m.throttle(function (b) {
          a.quantityAvailabilityCheckStart()
        }, 500),
      )
      b.live('keydown', function (b) {
        a.isValidQuantityTextPressKeyCode(b)
      })
      b.live('click change paste keyup', function () {
        a.clampQuantity(b.val())
        a.generateQuantityDiscountTable()
      })
    }
    b.prototype.quantityAvailabilityCheckStart = function () {
      this.initializeQuantityAvailabilityVariables()
      var a = this.getCurrentQuantity(),
        b = this
      l.singleton.notifyQuantityTyped(a, {
        currentBuyBoxId: this.buyBoxId,
        activeBuyBoxId: this.buyBoxId,
        selectedBuyingOption: this.buyingOptionStereotype,
        qdsForLockedMerchantEnabled: this.qdsForLockedMerchantEnabled,
        callback: function (c) {
          a === b.getCurrentQuantity() &&
            b.updateLimitedAvailabilityMessageVisibility(c.hasAvailability)
        },
      })
    }
    b.prototype.attachToDOM = function () {
      this.wireUpReferenceBasedEvents()
      this.enableUI()
      l.singleton.leastMinimumOrderQuantity = this.leastMinimumOrderQuantity
    }
    b.prototype.isValidQuantityTextPressKeyCode = function (a) {
      var b = { left: 37, up: 38, right: 39, down: 40 },
        c = f.event ? a.keyCode : a.which,
        d
      for (d in b) b[d] === c && a.preventDefault()
    }
    b.prototype.isValidQuantityTextInputKeyCode = function (a) {
      var b = f.event ? a.keyCode : a.which
      8 !== b &&
        46 !== b &&
        (13 === b
          ? (this.updateQuantityAndHideQuantityDiscountTable(), a.preventDefault())
          : ((b = String.fromCharCode(b)), /\d/.test(b) || a.preventDefault()))
    }
    b.prototype.getCurrentQuantity = function () {
      var a = d(this.quantityTextInputSelector)
      return this.clampQuantity(a.val())
    }
    b.prototype.handleQuantityRefreshCheckStarted = function () {
      this.doesDOMExist() && this.disableUI()
    }
    b.prototype.handleQuantityRefreshCheckFinished = function () {
      this.doesDOMExist() && this.enableUI()
    }
    b.prototype.clampQuantity = function (a) {
      var b = a
      999 < a && (b = 999)
      this.leastMinimumOrderQuantity !== r &&
        a < this.leastMinimumOrderQuantity &&
        (b = this.leastMinimumOrderQuantity)
      return b
    }
    b.prototype.doesDOMExist = function () {
      return 0 < d(this.quantityTextInputSelector).length
    }
    b.prototype.handleQuantityChangedOnOtherBuyBox = function (a, b, c) {
      if (this.doesDOMExist()) {
        a !== this.id &&
          parseInt(this.getCurrentQuantity()) !== b &&
          (d(this.quantityTextInputSelector).val(b), this.updateQuantityHiddenField(b))
        var e = this
        l.singleton.buyboxRefreshCheck({
          newQuantity: b,
          activeBuyBoxId: c.activeBuyBoxId,
          selectedBuyingOption: c.selectedBuyingOption,
          currentBuyBoxId: this.buyBoxId,
          qdsForLockedMerchantEnabled: this.qdsForLockedMerchantEnabled,
          callback: function (a) {
            e.updateLimitedAvailabilityMessageVisibility(a.hasAvailability)
          },
        })
      }
    }
    b.prototype.showQuantityDiscountTable = function () {
      this.buildQptViewMetrics()
      this.hasError && n.registerCounter(H)
      this.fetchQuantityDiscountTableCompleted &&
        (this.buildQptForLockedMerchantMetrics(v),
        this.buildQptUncompetitiveTiersMetrics(
          x,
          this.getStartIndexOfQuantityDiscountTierTable(),
          3,
        ),
        this.buildAvailabilityMessageMetrics(G))
      var a = k.findAccordionRow(this.id)
      0 < a.length &&
        (a.get(0).setAttribute('style', 'overflow:visible'),
        (a = a.find('.a-accordion-inner.accordion-row-content')),
        0 < a.length && a.get(0).setAttribute('style', 'overflow:visible'))
      a = d(this.buyboxAccordionContainerSelector)
      0 < a.length &&
        (a.get(0).setAttribute('style', 'overflow:visible'),
        (a = a.find('.a-accordion-inner')),
        0 < a.length && a.get(0).setAttribute('style', 'overflow:visible'))
      d(this.quantityPickerSelector).addClass('open')
    }
    b.prototype.hideQuantityDiscountTable = function () {
      d(this.quantityPickerSelector).removeClass('open')
    }
    b.prototype.updateQuantityAndHideQuantityDiscountTable = function () {
      var a = d(this.quantityDiscountTableSelector),
        b = d(this.quantityTextInputSelector),
        c = this.clampQuantity(b.val())
      b.val(c)
      this.updateQuantityHiddenField(c)
      l.singleton.notifyQuantityChanged(c, {
        senderId: this.id,
        activeBuyBoxId: this.buyBoxId,
        selectedBuyingOption: this.buyingOptionStereotype,
        qdsForLockedMerchantEnabled: this.qdsForLockedMerchantEnabled,
      })
      this.isLoadMoreButtonClicked = !1
      this.hideQuantityDiscountTable()
      a.empty()
    }
    b.prototype.disableUI = function () {
      var a = d(this.quantityTextInputSelector),
        b = d(this.quantityDiscountTableSelector)
      a.attr('disabled', !0)
      a.addClass('quantity-text-input-disabled')
      b.attr('disabled', !0)
    }
    b.prototype.enableUI = function () {
      var a = d(this.quantityTextInputSelector),
        b = d(this.quantityDiscountTableSelector)
      a.attr('disabled', !1)
      a.removeClass('quantity-text-input-disabled')
      b.attr('disabled', !1)
      this.hideQuantityDiscountTable()
    }
    b.prototype._isMobileQuantityHiddenFieldSelector = function () {
      return (
        'string' === typeof this.quantityHiddenFieldSelector &&
        -1 < this.quantityHiddenFieldSelector.indexOf('select#mobileQuantityDropDown')
      )
    }
    b.prototype._mobileQuantityHiddenFieldSelector = function () {
      return this.quantityHiddenFieldSelector.replace(
        'input#quantity',
        'select#mobileQuantityDropDown',
      )
    }
    b.prototype.updateQuantityHiddenField = function (a) {
      var b = this._findWithinPickerAccordionRow(this.quantityHiddenFieldSelector).first()
      b.is('select') && (h(b, a), g.getSelect(b).val(a))
      b.val(a.toString())
      m.trigger(q.ADD_TO_CART_QUANTITY_CHANGE_EVENT, { nativeItemNode: b[0], value: a.toString() })
      'mobile' !== k.getPageState().platform ||
        this._isMobileQuantityHiddenFieldSelector() ||
        ((b = this._findWithinPickerAccordionRow(this._mobileQuantityHiddenFieldSelector())) &&
          b.is('select') &&
          (h(b, a), g.getSelect(b).val(a), b.val(a.toString())))
    }
    b.prototype.generateVisibleTiersList = function (a, b) {
      for (
        var c = [], d = 0, e = !1;
        b < this.priceTiers.length && (this.isLoadMoreButtonClicked || 3 > d);

      ) {
        var f = this.priceTiers[b],
          g = !this.shouldHideFirstTier() && 0 === d,
          h = f.isLowestAvailablePrice || e || 2 !== d
        if (this.isLoadMoreButtonClicked || g || (!f.isUncompetitive && h))
          c.push({
            quantity: Math.max(a, f.quantity),
            savingsMessage: f.savingsMessage,
            availabilityMessage: f.availabilityMessage,
            quantityPickerPriceText: f.quantityPickerPriceText,
            isDiscountUnlocked:
              0 === d ? 0 === b && 'BUSINESS_VOLUME_AWARE_PRICING' === f.program : !1,
            isFirstTier: g,
          }),
            (e = e || f.isLowestAvailablePrice),
            d++
        b++
      }
      return c
    }
    b.prototype.findStartIndexOfQuantityDiscountTierTable = function (a) {
      for (var b = 0, c = this.priceTiers.length - 1; b <= c; ) {
        var d = parseInt((b + c) / 2),
          e
        e = this.priceTiers[d].quantity
        e = 0 === e.length ? 0 : parseInt(e)
        if (e === a) return d
        e > a ? (c = d - 1) : (b = d + 1)
      }
      return Math.max(0, c)
    }
    b.prototype.getStartIndexOfQuantityDiscountTierTable = function () {
      var a = this.getCurrentQuantity(),
        a = this.findStartIndexOfQuantityDiscountTierTable(a)
      return this.shouldHideFirstTier() && 1 < this.priceTiers.length ? a + 1 : a
    }
    b.prototype.shouldHideFirstTier = function () {
      var a = l.singleton.currentQuantity,
        b = d(this.quantityTextInputSelector)
      return !this.isAvailabilityMessagePresent() && 1 === a && '' === b.val()
    }
    b.prototype.generateQuantityDiscountTable = function () {
      this.cleanOutQuantityDiscountTable()
      var a = d(this.quantityDiscountTableSelector)
      this.hasError
        ? a.append(
            this.generateSingleTierDiscountTableUnorderedList(this.generateQdtErrorMessage()),
          )
        : this.hasAvailability
          ? this.priceTiers === r
            ? a.append(this.generateFetchInProcessTableUnorderedList())
            : 0 === this.priceTiers.length
              ? a.append(this.generateSingleTierDiscountTableUnorderedList())
              : a.append(this.generateQuantityDiscountTableUnorderedList())
          : a.append(this.generateQuantityUnavailableTableUnorderedList())
    }
    b.prototype.cleanOutQuantityDiscountTable = function () {
      d(this.quantityDiscountTableSelector).empty()
    }
    b.prototype.areUncompetitiveTiersPresent = function (a, b) {
      var c = !1
      if ('undefined' !== typeof this.priceTiers)
        for (
          'undefined' === typeof a && (a = 0),
            b =
              'undefined' === typeof b
                ? this.priceTiers.length
                : Math.min(a + b, this.priceTiers.length),
            a += 1;
          a < b;
          a++
        )
          if (this.priceTiers[a].isUncompetitive) {
            c = !0
            break
          }
      return c
    }
    b.prototype.isAvailabilityMessagePresent = function () {
      return (
        'undefined' !== typeof this.priceTiers &&
        0 < this.priceTiers.length &&
        'undefined' !== typeof this.priceTiers[0].availabilityMessage
      )
    }
    b.prototype.showLoadMoreButton = function (a) {
      this.loadMoreButtonForUncompetitiveTiersPresence = this.areUncompetitiveTiersPresent(a)
      return (
        !this.isLoadMoreButtonClicked &&
        (3 < this.priceTiers.length - a || this.loadMoreButtonForUncompetitiveTiersPresence)
      )
    }
    b.prototype.showBuyingInBulkLink = function (a) {
      return 'undefined' !== typeof this.priceTiers[a].buyingInBulkLink
    }
    b.prototype.generateQuantityDiscountTableUnorderedList = function () {
      var a = this.getCurrentQuantity(),
        b = this.getStartIndexOfQuantityDiscountTierTable(),
        a = this.generateVisibleTiersList(a, b),
        c = document.createElement('ul')
      c.setAttribute('class', 'qdt-ul')
      for (var e = d(c), f = 0; f < a.length; f++)
        e.append(this.generateQuantityDiscountTierOption(a[f]))
      this.showLoadMoreButton(b)
        ? e.append(this.generateLoadMoreOption())
        : !this.showBuyingInBulkLink(b) ||
            (!0 !== this.includeRfqdLinkInNewPicker && 'true' !== this.includeRfqdLinkInNewPicker)
          ? (!0 !== this.includeRfqdLinkInNewPicker &&
              'true' !== this.includeRfqdLinkInNewPicker) ||
            e.append(this.generateRequestForQuantityDiscountOption())
          : e.append(this.generateBuyingInBulkOption(b))
      return c
    }
    b.prototype.generateSingleTierDiscountTableUnorderedList = function (a) {
      var b = this.getCurrentQuantity(),
        b = this.generateSingleTierQuantityList(b),
        c = document.createElement('ul')
      c.setAttribute('class', 'qdt-ul')
      for (var e = d(c), f = 0; f < b.length; f++)
        e.append(this.generateQuantityDiscountTierOption(b[f]))
      a && e.append(a)
      return c
    }
    b.prototype.generateQuantityUnavailableTableUnorderedList = function () {
      var a = document.createElement('ul')
      a.setAttribute('class', 'qdt-ul')
      d(a).append(this.generateQuantityUnavailableOption())
      return a
    }
    b.prototype.generateSingleTierQuantityList = function (a) {
      var b = []
      b.push({
        quantity: Math.max(a, 1),
        savingsMessage: null,
        availabilityMessage: null,
        quantityPickerPriceText: '',
        isDiscountUnlocked: !1,
        isFirstTier: !0,
      })
      return b
    }
    b.prototype.generateFetchInProcessTableUnorderedList = function () {
      var a = document.createElement('ul')
      a.setAttribute('class', 'qdt-ul')
      d(a).append(this.generateFetchInProcessOption())
      return a
    }
    b.prototype._removeINRSymbol = function (a) {
      a = a.split('\x3e')
      return a[a.length - 1]
    }
    b.prototype._populateOptionPriceContent = function (a, b) {
      if (
        'string' === typeof a.quantityPickerPriceText &&
        -1 !== a.quantityPickerPriceText.search('currencyINR')
      ) {
        var c = document.createElement('span')
        c.setAttribute('class', 'currencyINR')
        c.textContent = '  '
        b.appendChild(c)
        a = this._removeINRSymbol(a.quantityPickerPriceText)
        b.appendChild(document.createTextNode(a))
      } else b.textContent = a.quantityPickerPriceText
    }
    b.prototype.generateQuantityDiscountTierOption = function (a) {
      var b = this,
        c = document.createElement('li'),
        d = document.createElement('div'),
        e = document.createElement('div'),
        f = document.createElement('div')
      a.isFirstTier
        ? ((e.textContent = a.quantity), c.setAttribute('class', 'qdt-dropdown-item qdt-active'))
        : ((e.textContent = a.quantity + '+'), c.setAttribute('class', 'qdt-dropdown-item'))
      b._populateOptionPriceContent(a, f)
      e.setAttribute('class', 'option-tier')
      f.setAttribute('class', 'option-price')
      a.availabilityMessage !== r
        ? this.generateTierWithAvailabilityMessageContent(d, e, f, a.availabilityMessage)
        : a.savingsMessage !== r
          ? this.generateTierWithSavingsMessageContent(d, e, f, a)
          : (d.setAttribute('class', 'qdt-dropdown-option-no-saving-message'),
            d.appendChild(e),
            d.appendChild(f))
      c.appendChild(d)
      c.addEventListener('mousedown', function () {
        b.handleQuantityDiscountTableOptionClicked(a.quantity)
      })
      return c
    }
    b.prototype.generateTierWithAvailabilityMessageContent = function (a, b, c, d) {
      var e = document.createElement('div')
      e.textContent = d
      e.setAttribute('class', 'option-availability-message')
      this.generateTierWithMessageContent(a, b, c, e)
    }
    b.prototype.generateTierWithSavingsMessageContent = function (a, b, c, e) {
      var f = document.createElement('div')
      f.textContent = e.savingsMessage
      e.isDiscountUnlocked
        ? ((e = document.createElement('div')),
          e.setAttribute('class', 'option-unlocked-saving-message-icon'),
          d(f).prepend(e),
          f.setAttribute('class', 'option-unlocked-saving-message'))
        : f.setAttribute('class', 'a-color-tertiary option-saving-message')
      this.generateTierWithMessageContent(a, b, c, f)
    }
    b.prototype.generateTierWithMessageContent = function (a, b, c, e) {
      var d = document.createElement('div')
      a.setAttribute('class', 'qdt-dropdown-option-regular')
      d.setAttribute('class', 'option-price-and-message')
      d.appendChild(c)
      d.appendChild(e)
      a.appendChild(b)
      a.appendChild(d)
    }
    b.prototype.generateLoadMoreOption = function () {
      var a = this,
        b = document.createElement('li'),
        c = document.createElement('div')
      c.textContent = this.loadMoreMessage
      b.setAttribute('class', 'qdt-dropdown-item')
      c.setAttribute('class', 'qdt-dropdown-option-load-more')
      b.setAttribute('id', 'qdt-dropdown-load-more')
      b.appendChild(c)
      b.addEventListener('mousedown', function (b) {
        a.handleLoadMoreOptionClicked(b)
      })
      return b
    }
    b.prototype.generateRequestForQuantityDiscountOption = function () {
      var a = this,
        b = document.createElement('a')
      b.textContent = this.requestForQuantityDiscountMessage
      b.setAttribute('class', 'a-link-normal qdt-dropdown-request-for-quantity-discount')
      b.addEventListener('mousedown', function (b) {
        a.handleRequestForQuantityDiscountOptionClicked(b)
      })
      return this.generateLinkOption(b)
    }
    b.prototype.generateBuyingInBulkOption = function (a) {
      var b = this
      a = {
        container: { element: document.createElement('div'), class: 'qdt-dropdown-buying-in-bulk' },
        link: {
          element: document.createElement('a'),
          class: 'a-link-normal qdt-dropdown-buying-in-bulk-link',
          text: b.priceTiers[a].buyingInBulkLink,
        },
        message: {
          element: document.createElement('div'),
          class: 'qdt-dropdown-buying-in-bulk-message',
          text: b.priceTiers[a].buyingInBulkMessage,
        },
      }
      for (var c in a)
        a.hasOwnProperty(c) &&
          (a[c].element.setAttribute('class', a[c].class),
          'undefined' !== typeof a[c].text && (a[c].element.textContent = a[c].text))
      a.container.element.appendChild(a.link.element)
      a.container.element.appendChild(a.message.element)
      a.link.element.addEventListener('mousedown', function (a) {
        b.handleBuyingInBulkOptionClicked(b.bbtLinkSelector, B, a)
      })
      n.registerCounter(A)
      return this.generateLinkOption(a.container.element)
    }
    b.prototype.generateQuantityUnavailableOption = function () {
      var a = this,
        b = document.createElement('div'),
        c = document.createElement('div')
      c.innerHTML = this.quantityPickerUnavailabilityMessage
      b.setAttribute('class', 'a-link-normal qdt-dropdown-quantity-unavailable')
      c.setAttribute('class', 'qdt-dropdown-quantity-unavailable-message')
      b.appendChild(c)
      0 < this._findWithinPickerAccordionRow(this.splitOfferSectionSelector).length &&
        ((c = document.createElement('a')),
        (c.textContent = this.quantityPickerUnavailabilityLink),
        c.setAttribute('class', 'a-link-normal qdt-dropdown-quantity-unavailable-link'),
        b.appendChild(c),
        c.addEventListener('mousedown', function (b) {
          a.handleQuantityUnavailableOptionClicked(b)
        }))
      n.registerCounter(C)
      return this.generateLinkOption(b)
    }
    b.prototype.generateLinkOption = function (a) {
      var b = document.createElement('li'),
        c = document.createElement('div')
      b.setAttribute('class', 'qdt-dropdown-item qdt-inactive')
      c.setAttribute('class', 'qdt-dropdown-option-link')
      c.appendChild(a)
      b.appendChild(c)
      return b
    }
    b.prototype.generateFetchInProcessOption = function () {
      var a = document.createElement('li'),
        b = document.createElement('div'),
        c = document.createElement('div'),
        e = document.createElement('div'),
        d = document.createElement('img')
      d.src = 'https://m.media-amazon.com/images/G/01/AmazonBusiness/vapLoading3._CB1556651073_.gif'
      c.textContent = this.fetchTheBestPricesMessage
      d.setAttribute('class', 'fetching-in-progress-img')
      a.setAttribute('class', 'qdt-dropdown-item qdt-inactive')
      b.setAttribute('class', 'qdt-dropdown-option-fetch-in-progress')
      e.appendChild(d)
      b.appendChild(e)
      b.appendChild(c)
      a.setAttribute('id', 'qdt-dropdown-fetch-in-progress')
      a.appendChild(b)
      return a
    }
    b.prototype.generateQdtErrorMessage = function () {
      var a = document.createElement('li'),
        b = document.createElement('div')
      if (this.isAODLinkEnabled) {
        var c = document.createElement('span')
        c.setAttribute('class', 'a-declarative')
        c.setAttribute('data-action', 'show-all-offers-display')
        c.setAttribute('data-show-all-offers-display', '{}')
        c.innerHTML = this.qdtErrorMessage
        b.appendChild(c)
      } else b.innerHTML = this.qdtErrorMessage
      a.setAttribute('class', 'qdt-dropdown-item qdt-inactive')
      b.setAttribute('class', 'qdt-dropdown-option-request-for-olp')
      a.setAttribute('id', 'qdt-dropdown-error-message')
      a.appendChild(b)
      var e = b.getElementsByTagName('a')[0]
      e.addEventListener('mousedown', function (a) {
        e.click()
      })
      return a
    }
    b.prototype.handleLoadMoreOptionClicked = function (a) {
      this.isLoadMoreButtonClicked = !0
      this.buildLoadMoreButtonMetrics()
      this.generateQuantityDiscountTable()
      a.preventDefault()
    }
    b.prototype.handleQuantityDiscountTableOptionClicked = function (a) {
      d(this.quantityTextInputSelector).val(a)
      this.updateQuantityAndHideQuantityDiscountTable()
      d(this.quantityTextInputLabelSelector).show()
    }
    b.prototype.handleRequestForQuantityDiscountOptionClicked = function (b) {
      var c = d(this.requestForQuantityDiscountModalSelector).find('.a-declarative')
      ;(c = a.get(c)) && c.show()
      this.handleBuyingInBulkOptionClicked(this.requestForQuantityDiscountModalSelector, E, b)
    }
    b.prototype.handleBuyingInBulkOptionClicked = function (a, b, c) {
      var e = this.getCurrentQuantity()
      if (this.amazonDevicesLinkEnabled && !this.requestForQuoteLinkEnabled)
        n.registerCounter(b),
          l.singleton.notifyBuyingInBulkOptionClicked(e),
          (f.location.href = this.buyingInBulkBaseUrl)
      else if ((a = document.querySelector(a + ' .a-link-normal')))
        n.registerCounter(b), l.singleton.notifyBuyingInBulkOptionClicked(e), a.click()
      c.preventDefault()
    }
    b.prototype.handleQuantityUnavailableOptionClicked = function (a) {
      n.registerCounter(D)
      var b = this.getCurrentQuantity()
      this.quantityUnavailableOptionClicked(b)
      a.preventDefault()
    }
    b.prototype.quantityUnavailableOptionClicked = function (a) {
      a = this.amazonDevicesLinkEnabled
        ? this.buyingInBulkBaseUrl
        : f.location.protocol + '//' + f.location.host + l.singleton.getLimitedAvailabilityUrl(a)
      f.location.href = a
    }
    b.prototype.updateLimitedAvailabilityMessageVisibility = function (a) {
      this.hasAvailability = a
      this.generateQuantityDiscountTable()
      this.updateBuyboxLimitedAvailabilityMessageVisibility()
    }
    b.prototype.updateBuyboxLimitedAvailabilityMessageVisibility = function () {
      var a = this._findWithinPickerAccordionRow(this.addToCartButtonSelector).closest('.a-button'),
        b = c(a),
        a = this._findWithinPickerAccordionRow(this.splitOfferSectionSelector)
      if (this.hasAvailability)
        d(this.limitedAvailabilityMessageSelector).addClass('aok-hidden'),
          b.enable(),
          a.addClass('aok-hidden')
      else {
        d(this.limitedAvailabilityMessageSelector).removeClass('aok-hidden')
        b.disable()
        var b = this.getCurrentQuantity(),
          e
        e = this.amazonDevicesLinkEnabled
          ? this.buyingInBulkBaseUrl
          : l.singleton.getLimitedAvailabilityUrl(b)
        this._findWithinPickerAccordionRow(this.splitOfferLinkSelector).attr('href', e)
        1 < b
          ? (n.registerCounter(q.COUNTER_METRIC.SPLIT_OFFER_LINK_DISPLAYED),
            a.removeClass('aok-hidden'))
          : a.addClass('aok-hidden')
      }
    }
    b.prototype.buildQptRenderMetrics = function () {
      var a = {}
      a.counter = p + (this.quantityPricingTableSummaryEnabled ? '.QPTS' : '')
      n.register(a)
    }
    b.prototype.buildQptViewMetrics = function () {
      var a = {}
      a.counter = t + (this.quantityPricingTableSummaryEnabled ? '.QPTS' : '')
      n.register(a)
    }
    b.prototype.buildQptForLockedMerchantMetrics = function (a) {
      this.qdsForLockedMerchantEnabled && n.registerCounter(a)
    }
    b.prototype.buildQptUncompetitiveTiersMetrics = function (a, b, c) {
      this.areUncompetitiveTiersPresent(b, c) && n.registerCounter(a)
    }
    b.prototype.buildLoadMoreButtonMetrics = function () {
      this.loadMoreButtonForUncompetitiveTiersPresence ? n.registerCounter(z) : n.registerCounter(y)
    }
    b.prototype.buildAvailabilityMessageMetrics = function (a) {
      this.isAvailabilityMessagePresent() && n.registerCounter(a)
    }
    b.prototype._findWithinPickerAccordionRow = function (a) {
      return k.findWithinPickerAccordionRow(this.id, a)
    }
    return { QuantityPickerLogicV2: b }
  })
  ;('use strict')
  p.when('jQuery', 'A', 'ready').execute(function (d, m) {
    function g(a) {
      f.ue !== r && f.ue.count !== r && f.ue.count(a, (f.ue.count(a) || 0) + 1)
    }
    function a(a, c, d) {
      null === d && (d = '')
      var f = new RegExp('\\b(' + c + '\x3d).*?(\x26|#|$)')
      if (0 <= a.search(f)) return a.replace(f, '$1' + d + '$2')
      a = a.replace(/[?#]$/, '')
      return a + (0 < a.indexOf('?') ? '\x26' : '?') + c + '\x3d' + d
    }
    function c() {
      return m.state('ABPricingFreeFormQuantityPicker')
    }
    function k(a, c) {
      return 0 !== a.find('option[value\x3d"' + c.toString() + '"]').length
    }
    function l(a) {
      return d('[id^\x3d' + a + ']').closest('[data-a-accordion-row-name]')
    }
    function n(a, c) {
      a = l(a)
      return 0 < a.length ? a.find(c) : d(c)
    }
    function q() {
      h ||
        c() === r ||
        ((h = !0),
        p.register('abPricingFfqp_utils', function () {
          return {
            PACKAGE_PREFIX: 'ABPricingFreeFormQuantityPicker',
            getPageState: c,
            incrementMetricByOne: g,
            replaceUrlParam: a,
            dropdownContainsQuantity: k,
            findAccordionRow: l,
            findWithinPickerAccordionRow: n,
          }
        }))
    }
    var h = !1
    q()
    p.register('abPricingFfqp_lazyInitializer', function () {
      return { tryInitialize: q }
    })
  })
})
/* ******** */
;(function (c) {
  var d = window.AmazonUIPageJS || window.P,
    f = d._namespace || d.attributeErrors,
    a = f ? f('ABPricingQuantityPricingTableSummaryAssets', '') : d
  a.guardFatal
    ? a.guardFatal(c)(a, window)
    : a.execute(function () {
        c(a, window)
      })
})(function (c, d, f) {
  c.when(
    'A',
    'jQuery',
    'abPricingFfqp_utils',
    'abPricingFfqp_quantityManager',
    'abPricingFfqp_metrics',
  ).execute(function (a, c, d, f, g) {
    a.declarative('b2bhawks-quantity-pricing-table-summary-click', 'click', function (b) {
      var a = b.data.selectedQuantity,
        e = '',
        c = b.data.deviceType,
        d = b.data.bestTier,
        k = b.data.recommendedTier,
        h = b.data.asinDetailPageUrl
      if (!b.data.tierSelected) {
        d && k
          ? g.registerCounter('AB_QR_QPTS_RECOMMENDED_AND_BEST_TIER')
          : k
            ? g.registerCounter('AB_QR_QPTS_RECOMMENDED_TIER')
            : d
              ? g.registerCounter('AB_QR_QPTS_BEST_TIER')
              : g.registerCounter('AB_QR_QPTS_DEFAULT_TIER')
        if ('mobile' === c || 'mobileApp' === c) e += '#b2bhawks-quantity-pricing-table-summary'
        e = { anchorToDiv: e }
        e.selectedBuyingOption =
          'undefined' !== typeof b.data.selectedBuyingOption &&
          0 < b.data.selectedBuyingOption.length
            ? b.data.selectedBuyingOption
            : 'RZvfv//HxDF+O5021pAnSA\x3d\x3d'
        h && 0 != h.length && ((e.asinDetailPageUrl = h), (e.refTag = 'bmsm_slot_redirect'))
        f.singleton.reloadPageForQuantity(a, e)
      }
    })
  })
})
/* ******** */
;(function (g) {
  var h = window.AmazonUIPageJS || window.P,
    l = h._namespace || h.attributeErrors,
    b = l ? l('DetailPageFluxComponents', '') : h
  b.guardFatal
    ? b.guardFatal(g)(b, window)
    : b.execute(function () {
        g(b, window)
      })
})(function (g, h, l) {
  g.when('dp-flux-utils').register('dp-flux-action', function (b) {
    function e(d, a, c) {
      if (b.isNonEmptyString(d) && b.isNonEmptyString(a))
        (this._name = d), (this._source = a), (this._metadata = c)
      else throw Error('Action(...): Action must be created with valid name and source')
    }
    e.prototype = {
      getName: function () {
        return this._name
      },
      getSource: function () {
        return this._source
      },
      getMetaData: function () {
        return this._metadata
      },
    }
    return (e.prototype.constructor = e)
  })
  g.when('dp-flux-utils').register('dp-flux-attribution', function (b) {
    function e(d, a, c, f) {
      if (
        b.isNonEmptyString(d) &&
        b.isNonEmptyString(a) &&
        b.isNonEmptyString(c) &&
        b.isNonEmptyString(f)
      )
        (this._name = d), (this._category = a), (this._type = c), (this._item = f)
      else throw Error('All parameters (name, categoty, type, item) must be a non-empty string')
    }
    e.prototype = {
      getName: function () {
        return this._name
      },
      getAttribution: function () {
        return (
          'name: ' +
          this._name +
          '; CTI\x3d ' +
          this._category +
          '/' +
          this._type +
          '/' +
          this._item
        )
      },
    }
    return (e.prototype.constructor = e)
  })
  g.when('A', 'dp-flux-action', 'dp-flux-attribution').register(
    'dp-flux-dispatcher',
    function (b, e, d) {
      function a() {
        this._callbacks = {}
        this._isDispatching = !1
        this._pendingAction = null
        this._lastID = 1
      }
      var c = b.$
      a.prototype = {
        register: function (a, b) {
          if (!(a instanceof d))
            throw Error('Dispatch.register(...): attribution must be instance of Attribution')
          if (!c.isFunction(b)) throw Error('Dispatch.register(...): callback must be a function')
          var f = 'ID_' + this._lastID++
          this._callbacks[f] = {
            attribution: a,
            callback: b,
            _isCallbackExecutionStarted: !1,
            _isCallbackExecutionCompleted: !1,
          }
          return f
        },
        unregister: function (a) {
          if (this._callbacks[a]) delete this._callbacks[a]
          else
            throw Error(
              'Dispatcher.unregister(...): ' + a + ' does not map to a registered callback',
            )
        },
        dispatch: function (a) {
          if (this._isDispatching)
            throw Error('Dispatch.dispatch(...): Cannot dispatch in the middle of a dispatch')
          if (!(a instanceof e))
            throw Error('Dispatch.dispatch(...): action param must be of type Action')
          this._startDispatching(a)
          for (var c in this._callbacks)
            this._callbacks[c]._isCallbackExecutionStarted || this._invokeCallback(c)
          this._stopDispatching()
        },
        waitFor: function (a) {
          if (!this._isDispatching)
            throw Error('Dispatcher.waitFor(...): Must be invoked while dispatching')
          if (!c.isArray(a))
            throw Error('Dispatcher.waitFor(...): dispatchTokenList must be an array')
          for (var b = 0; b < a.length; b++) {
            var f = a[b]
            if (!this._callbacks[f])
              throw Error(
                'Dispatcher.waitFor(...): ' + f + ' does not map to a registered callback. ',
              )
            if (this._callbacks[f]._isCallbackExecutionStarted)
              if (this._callbacks[f]._isCallbackExecutionCompleted) continue
              else
                throw Error(
                  'Dispatcher.waitFor(...): Circular dependency detected while waiting for ' + f,
                )
            this._invokeCallback(f)
          }
        },
        _invokeCallback: function (a) {
          this._callbacks[a]._isCallbackExecutionStarted = !0
          try {
            this._callbacks[a].callback(this._pendingAction)
          } catch (k) {
            g.log(
              'Dispatcher._invokeCallback(...): Error while calling dispatcher callback: error message \x3d ' +
                k.message,
              'FATAL',
              this._callbacks[a].attribution.getAttribution(),
            )
          }
          this._callbacks[a]._isCallbackExecutionCompleted = !0
        },
        _startDispatching: function (a) {
          for (var c in this._callbacks)
            (this._callbacks[c]._isCallbackExecutionStarted = !1),
              (this._callbacks[c]._isCallbackExecutionCompleted = !1)
          this._pendingAction = a
          this._isDispatching = !0
        },
        _stopDispatching: function () {
          this._pendingAction = null
          this._isDispatching = !1
        },
      }
      return (a.prototype.constructor = a)
    },
  )
  g.when('A', 'dp-flux-utils').register('dp-flux-emitter', function (b, e) {
    function d() {
      this._subscriptions = {}
    }
    var a = b.$
    d.prototype = {
      emit: function (a) {
        if (e.isNonEmptyString(a))
          b.each(this._subscriptions[a] || [], function (a) {
            a()
          })
        else throw Error('Emitter.emit()...: eventType must be a non empty string')
      },
      addListener: function (c, b) {
        if (e.isNonEmptyString(c) && a.isFunction(b))
          (this._subscriptions[c] = this._subscriptions[c] || []), this._subscriptions[c].push(b)
        else
          throw Error(
            'Emitter.addListener()...: Invalid arguments - eventType must be a non empty string \x26 callback must be a function ',
          )
      },
      removeListener: function (b, d) {
        if (e.isNonEmptyString(b) && a.isFunction(d)) {
          if ((b = this._subscriptions[b])) (d = a.inArray(d, b)), -1 !== d && b.splice(d, 1)
        } else
          throw Error(
            'Emitter.removeListener()...: Invalid arguments - eventType must be a non empty string \x26 callback must be a function',
          )
      },
    }
    return d
  })
  g.when(
    'A',
    'dp-flux-emitter',
    'dp-flux-attribution',
    'dp-flux-dispatcher',
    'dp-flux-utils',
  ).register('dp-flux-store', function (b, e, d, a, c) {
    function f(b, f, k, h) {
      if (!(b instanceof d)) throw Error('storeAttribution should be instance of Attribution')
      if (!(k instanceof a)) throw Error('dispatcher must be an instance of Dispatcher')
      if (!g.isFunction(f)) throw Error('Store must provide a reduce callback method')
      this.reduce = f
      this.dispatcher = k
      this._storeAttribution = b
      this._state = h || {}
      c.deepFreeze(this._state)
      this._dispatchToken = this.dispatcher.register(
        this._storeAttribution,
        this._invokeOnDispatch.bind(this),
      )
      this._changed = !1
      this._changeEvent = this._storeAttribution.getName() + ':change'
      this._emitter = new e()
    }
    var g = b.$
    f.prototype = {
      addListener: function (a) {
        return this._emitter.addListener(this._changeEvent, a)
      },
      removeListener: function (a) {
        this._emitter.removeListener(this._changeEvent, a)
      },
      getDispatcher: function () {
        return this.dispatcher
      },
      getDispatchToken: function () {
        return this._dispatchToken
      },
      getState: function () {
        return this._state
      },
      getStoreAttribution: function () {
        return this._storeAttribution
      },
      _invokeOnDispatch: function (a) {
        this._changed = !1
        var b = this._state
        ;(a = this.reduce(this._state, a) || b) &&
          a !== b &&
          ((this._state = a),
          c.deepFreeze(this._state),
          (this._changed = !0),
          this._emitter.emit(this._changeEvent))
      },
    }
    return (f.prototype.constructor = f)
  })
  g.when('A', 'dp-flux-attribution').register('dp-flux-store-group', function (b) {
    function e(b, a, c) {
      this._stores = a
      this._callBack = c
      this._attribution = b
      this._registerStoreGroup()
    }
    e.prototype = {
      _registerStoreGroup: function () {
        var b = this._getUniformDispatcher()
        this._dispatchToken = b.register(
          this._attribution,
          function () {
            b.waitFor(this._getStoreTokens())
            this._callBack()
          }.bind(this),
        )
      },
      unregisterStoreGroup: function () {
        this._getUniformDispatcher().unregister(this._dispatchToken)
      },
      _getUniformDispatcher: function () {
        var d = this._stores[0].getDispatcher()
        b.each(this._stores, function (a) {
          if (d !== a.getDispatcher()) throw Error('All stores must have common dispatcher')
        })
        return d
      },
      _getStoreTokens: function () {
        return b.map(this._stores, function (b) {
          return b.getDispatchToken()
        })
      },
    }
    return (e.prototype.constructor = e)
  })
  g.when('A', 'dp-flux-store-group').register('dp-flux-store-subscription', function (b, e) {
    function d(a, b, d) {
      this._stores = b
      this._changed = !1
      this._updatedStores = []
      this._viewUpdateCallBack = d
      this._viewAttribution = a
      this._allListeners = []
      this._addListenerToAllStores()
      this._storeGroup = new e(a, b, this._viewCallBack.bind(this))
    }
    d.prototype = {
      _storeListener: function (a) {
        this._changed = !0
        this._updatedStores.push(a)
      },
      _addListenerToAllStores: function () {
        var a
        b.each(
          this._stores,
          function (b) {
            a = this._storeListener.bind(this, b)
            this._allListeners.push({ listener: a, store: b })
            b.addListener(a)
          },
          this,
        )
      },
      _removeListenerFromAllStores: function () {
        b.each(this._allListeners, function (a) {
          a.store.removeListener(a.listener)
        })
      },
      _viewCallBack: function () {
        if (this._changed) {
          try {
            this._viewUpdateCallBack(this._updatedStores)
          } catch (a) {
            g.log(
              'StoreSubscription._viewCallBack(...): view callback failed ' + a,
              'WARN',
              this._viewAttribution.getAttribution(),
            )
          }
          this._changed = !1
          this._updatedStores = []
        }
      },
      reset: function () {
        this._removeListenerFromAllStores()
        this._storeGroup.unregisterStoreGroup()
      },
    }
    return (d.prototype.constructor = d)
  })
  g.when('A').register('dp-flux-utils', function (b) {
    function e(a) {
      return 'string' === typeof a || '[object String]' === Object.prototype.toString.call(a)
    }
    function d(a) {
      if (!Object.isFrozen(a)) {
        var c = Object.getOwnPropertyNames(a)
        b.each(c, function (b) {
          var c = a[b]
          a[b] = c && 'object' === typeof c ? d(c) : c
        })
        Object.freeze(a)
      }
      return a
    }
    return {
      isString: e,
      isNonEmptyString: function (a) {
        return !(!e(a) || !b.trim(a).length)
      },
      deepFreeze: function (a) {
        return Object.freeze && Object.getOwnPropertyNames && Object.isFrozen ? (d(a), !0) : !1
      },
    }
  })
  g.when('A', 'dp-flux-attribution', 'dp-flux-store', 'dp-flux-store-subscription').register(
    'dp-flux-view',
    function (b, e, d, a) {
      function c(c, g, h) {
        if (!(c instanceof e))
          throw Error('View(...): viewAttribution should be an instance of Attribution')
        if (f.isArray(g) && 1 <= g.length)
          b.each(g, function (a) {
            if (!(a instanceof d))
              throw Error('View(...): storeList contains an object which is not of type Store')
          })
        else throw Error('View(...): View must listen on at least one store')
        if (!f.isFunction(h)) throw Error('View(...): View must provide update callback method')
        this._viewAttribution = c
        this._storeSubscription = new a(c, g, h)
      }
      var f = b.$
      c.prototype.getViewAttribution = function () {
        return this._viewAttribution
      }
      c.prototype.unregisterStores = function () {
        this._storeSubscription.reset()
      }
      return c
    },
  )
})
/* ******** */
;(function (k) {
  var g = window.AmazonUIPageJS || window.P,
    m = g._namespace || g.attributeErrors,
    a = m ? m('DetailPageMobileAppAssets', '') : g
  a.guardFatal
    ? a.guardFatal(k)(a, window)
    : a.execute(function () {
        k(a, window)
      })
})(function (k, g, m) {
  k.when('jQuery', 'aw-mash-handler', 'dp-instant-map', 'dp-client-counter').execute(
    'dp-instant-atc-handler',
    function (a, e, c, f) {
      Object.keys(c).forEach(function (d) {
        var e = c[d].instant,
          k = c[d].triggerButton,
          g = e.getShouldTrigger()
        e.disable()
        g && (f.inc('dp-instant-' + d + '-clicked'), a(k).trigger('click'))
      })
    },
  )
  ;('use strict')
  k.register('dp-mash-pre-registry-handler')
  k.when(
    'A',
    'aw-mash',
    'dp-util-cookie',
    'mobile-app-atc-action',
    'mobile-app-gift',
    'mobile-app-device-prereg',
    'natc-check',
    'atc-metrics',
    'update-atc-data',
    'atc-data-validation',
    'aw-mbb-checkbox-helper',
    'offersx-csrf-utils',
    'patc-csm-init',
    'atc-eligibility',
    'sns-buybox-validation-on-patc',
    'atc-constants',
    'dp-csm-metrics',
  ).register('aw-mash-handler', function (a, e, c, f, d, h, v, B, p, q, w, E, C, x, r, y, z) {
    function R(b) {
      b.preventDefault()
      b.stopPropagation()
    }
    function S() {
      u('#atc-toast-overlay').css('display', '')
      F.addClass('udp-stop-scrolling')
      F.bind('touchmove touchstart touchend touchcancel', R)
    }
    function T() {
      F.removeClass('udp-stop-scrolling')
      F.unbind('touchmove touchstart touchend touchcancel', R)
      u('#atc-toast-overlay').css('display', 'none')
    }
    function n(b) {
      b = '.' + b
      var a = u(b)
      0 < u('#buybox .a-accordion-active').length && (a = u('#buybox .a-accordion-active ' + b))
      return a
    }
    function ba() {
      S()
      var b = n('atc-button'),
        a = n('atc-button-text'),
        c = n('inst-button-space'),
        d = n('inst-indicator')
      b.addClass('inst-btn-opacity')
      a.hide()
      c.removeClass('aok-hidden')
      d.removeClass('aok-hidden')
    }
    function O(b) {
      var a = n('atc-toast'),
        c = n('atc-success'),
        d = n('atc-failed'),
        f = n('atc-failed-deals'),
        e = n('inst-indicator'),
        h = n('inst-button-space'),
        q = n('atc-button-text'),
        E = n('atc-button')
      g.requestAnimationFrame(function () {
        E.removeClass('inst-btn-opacity')
        e.addClass('aok-hidden')
        h.addClass('aok-hidden')
        q.show()
        a.css('display', '')
        0 === b
          ? (c.css('display', ''), a.addClass('atc-toast-success-styles'))
          : -1 === b
            ? (d.css('display', ''), a.addClass('atc-toast-failure-styles'))
            : -2 === b && (f.css('display', ''), a.addClass('atc-toast-failure-styles'))
      })
    }
    function D(b) {
      var a = n('atc-toast'),
        c = n('atc-success'),
        d = n('atc-failed'),
        f = n('atc-failed-deals'),
        e = n('inst-indicator'),
        h = n('inst-button-space'),
        q = n('atc-button-text'),
        E = n('atc-button')
      g.requestAnimationFrame(function () {
        E.removeClass('inst-btn-opacity')
        e.addClass('aok-hidden')
        h.addClass('aok-hidden')
        q.show()
        a.removeClass('atc-toast-failure-styles')
        a.removeClass('atc-toast-success-styles')
        d.css('display', 'none')
        f.css('display', 'none')
        c.css('display', 'none')
        a.css('display', 'none')
        setTimeout(function () {
          T()
        }, b)
      })
    }
    function U(b, a, c) {
      D(1e3)
      e.showAlert({
        title: a,
        message: b,
        buttonTitles: [c],
        successCallback: function (b) {},
        failCallback: function (b) {
          console.log(b)
        },
      })
    }
    function I(b) {
      b = parseInt(b, 10)
      e.cart.didUpdate({ newCartQuantity: b })
      amazon.cordova.notification.vibrate(50)
    }
    function J(b, c, d) {
      function f(b) {
        var a = []
        b.usGlExclusionPatcExperimental && a.push(b.usGlExclusionPatcExperimental)
        return JSON.stringify(a)
      }
      function h() {
        var e = v.getAtcEndpoint(b),
          h =
            v.getShouldUseNatc() && b.queryString !== m && '' !== b.queryString
              ? '?' + b.queryString
              : ''
        q.validateData(b)
        var l = w()
        b.inputs.experimentalIDs = f(b)
        l && V
          ? ((b.queryParameters = {
              customizers: 'BOTTOM_SHEET',
              isUssEligible: N() && p() && x() && r(),
              isSSD: !!b.shouldShowSsdBottomSheetAddToCartExperience,
              hasSubSameDayOffer: !!b.hasSubSameDayOffer,
            }),
            k.when('action-executor').execute(function (a) {
              a.executeAddToCart(b, T, S)
            }))
          : ((l = E.setCSRFHeaderFromId('mobile-app-atc-anti-csrf-token')),
            V && C.initialize(),
            B.recordAtcAjaxCall(),
            a.ajax(e + '/ref\x3d' + b.reftag + h, {
              method: 'post',
              params: b.inputs,
              headers: l,
              timeout: b.timeout,
              success: function (a, d, f) {
                B.recordAtcAjaxSuccess()
                v.getShouldUseNatc()
                  ? (a && a.successful
                      ? Z(a)
                      : (a && a.count && I(a.count),
                        z.updateCount(y.NATC_AJAX_RESPONSE_FAILURE),
                        A(
                          '[Detail Page Mobile App Add to Cart failed due to failure message from NeoAddToCart]',
                        ),
                        M()),
                    C.recordAXControlMetric(f))
                  : a && a.ok
                    ? Z(a)
                    : a && a.isDeal
                      ? ca(a)
                      : a && 'perOfferingRestrictionViolated' === a.error
                        ? (z.updateCount(y.ATC_AJAX_RESPONSE_OFFERING_RESTRICTION_VIOLATED),
                          A('[Detail Page Mobile App Add to Cart Offer Restriction Failure]'),
                          c(b, a))
                        : a && a.isCartServiceFailed
                          ? (z.updateCount(y.ATC_AJAX_RESPONSE_CART_SERVICE_FAILURE),
                            A(
                              '[Detail Page Mobile App Add to Cart failed due to Cart Service Failure]',
                              a,
                            ))
                          : W(a)
              },
              error: function (a, c, f) {
                B.recordAtcAjaxFailure()
                v.getShouldUseNatc()
                  ? (A(
                      '[Detail Page Mobile App Add to Cart failed due to AJAX Error when calling NeoAddToCart]',
                    ),
                    M())
                  : ((a = '[Detail Page Mobile App Add to Cart Error Status: ' + c + ']'),
                    b.inputs.isUSSAjax
                      ? t.aa_mash_add_to_cart_lost_connection_message &&
                        t.aa_mash_add_to_cart_lost_connection_title
                        ? A(a)
                        : (d(), K())
                      : t.aa_mash_add_to_cart_lost_connection_message &&
                          t.aa_mash_add_to_cart_lost_connection_title
                        ? (U(
                            t.aa_mash_add_to_cart_lost_connection_message,
                            t.aa_mash_add_to_cart_lost_connection_title,
                            t.aa_mash_ok,
                          ),
                          A(a))
                        : K())
              },
            }))
      }
      function w() {
        b.ssdBottomSheetAddToCartExperienceEligible &&
          b.ssdBottomSheetAddToCartExperienceEligible &&
          !G('scheduledDelivery') &&
          !G('partialStateBuyBox') &&
          !G('snsInterstitialWidget') &&
          H() &&
          !Y() &&
          J(da)
        var a = !!b.shouldShowSsdBottomSheetAddToCartExperience
        a || (N() && p() && x() && r() && J(ea))
        return (
          v.getShouldUseNatc() &&
          !P &&
          ((!N() && b.showBottomSheetDefaultAddToCartExperience) ||
            (N() &&
              p() &&
              x() &&
              r() &&
              ('T1' === b.ussConvergenceExperimentTreatment ||
                'T2' === b.ussConvergenceExperimentTreatment)) ||
            a)
        )
      }
      function N() {
        return (
          'true' === a.$('#uss-mobileApp').val() &&
          a.$('#ussEligible').length &&
          '1' === a.$('#ussEligible').val()
        )
      }
      function r() {
        return fa.test(a.$('#uss-weblabTreatment').val())
      }
      function p() {
        return 'true' === a.$('#uss-serverPreconditionsPassed').val()
      }
      function x() {
        var b
        if ((b = a.capabilities.transform && a.capabilities.transition))
          (b = a.$('\x3cdiv\x3e\x3c/div\x3e')[0]),
            (b =
              '' === b.style.flex ||
              '' === b.style.webkitFlex ||
              '' === b.style.msFlex ||
              '' === b.style.MozBoxFlex ||
              '' === b.style.webkitBoxFlex
                ? !0
                : !1)
        return (
          b &&
          !G('scheduledDelivery') &&
          !G('partialStateBuyBox') &&
          !G('snsInterstitialWidget') &&
          H() &&
          !Y()
        )
      }
      function Y() {
        return (
          a.$('#attach-accessory-card-deck').length &&
          ('true' === a.$('#uss-mobileApp').val() || a.$('#attach-accessory-mobile-web-mbs').length)
        )
      }
      function H() {
        var b = a.$('#add-to-cart-button')
        return b.length && 'submit' == b.prop('type')
      }
      function G(b) {
        b = a.$('#' + b + '_feature_div').html()
        null !== b && (b = b.trim())
        return null !== b && 0 < b.length
      }
      function J(b) {
        if (b) {
          var d = ''
          g.ue && (d = g.ue.id)
          d = ha + 'weblabValue\x3d' + b + '\x26requestId\x3d' + d
          navigator && navigator.sendBeacon
            ? (b = navigator.sendBeacon(d)) || a.$.ajax({ url: d })
            : a.$.ajax({ url: d })
        }
      }
      function M() {
        d && b.inputs.isUSSAjax
          ? d()
          : (O(-1),
            setTimeout(function () {
              D(0)
            }, 2e3))
      }
      function Q() {
        var d = u('#cps-atc-changeover')
        if (0 < d.length) {
          var c = a.state('cps-atc-toast-text')
          if (c && c.atcToastTextString) {
            c = c.atcToastTextString.replace('FreshATCToastQuantity', b.inputs.quantity)
            var f = d.find('.a-changeover-inner')
            f && (f.text(c), d.show())
          }
        }
      }
      function X() {
        F.addClass('udp-stop-scrolling')
        F.bind('touchmove touchstart touchend touchcancel', R)
        var b = n('atc-button'),
          a = n('atc-button-text'),
          d = n('inst-button-space'),
          c = n('inst-indicator')
        b.addClass('inst-btn-opacity')
        a.hide()
        d.removeClass('aok-hidden')
        c.removeClass('aok-hidden')
      }
      function W(c) {
        a.trigger('dpx:add-to-cart:error')
        z.updateCount(y.ATC_AJAX_RESPONSE_FAILURE)
        b.inputs.isUSSAjax
          ? t.aa_mash_failed_add_to_cart && t.aa_mash_encounter_problem && t.aa_mash_ok
            ? A('[Detail Page Mobile App Add to Cart Mash Failure]', c)
            : (d(c), K())
          : t.aa_mash_failed_add_to_cart && t.aa_mash_encounter_problem && t.aa_mash_ok
            ? (U(t.aa_mash_failed_add_to_cart, t.aa_mash_encounter_problem, t.aa_mash_ok),
              A('[Detail Page Mobile App Add to Cart Mash Failure]'))
            : (O(-1),
              setTimeout(function () {
                D(0)
              }, 2e3),
              K())
      }
      function A(c, f) {
        a.trigger('dpLogFatalsEvent', c, 'ERROR', 'mobileApp_addtocart_fatal')
        b.inputs.isUSSAjax && d(f)
      }
      function K() {
        a.trigger(
          'dpLogFatalsEvent',
          '[Detail Page Mobile App Add to cart String error]',
          'ERROR',
          'mobileApp_addtocart_string_error',
        )
      }
      function ca(a) {
        z.updateCount(y.ATC_AJAX_RESPONSE_DEAL_NOT_AVAILABLE)
        A('[Detail Page Mobile App Add to Cart Unavailable Deal Failure]')
        b.inputs.isUSSAjax
          ? d(a)
          : t.aa_mash_deal_not_available
            ? (D(1e3),
              e.showAlert({
                title: t.aa_mash_deal_not_available,
                message: '',
                successCallback: function (b) {},
                buttonTitles: [t.aa_mash_ok],
                failCallback: function (b) {
                  console.log(b)
                },
              }))
            : K()
      }
      function Z(c) {
        a.trigger('dpx:add-to-cart:success', c)
        P ||
          (aa ? Q() : O(0),
          setTimeout(function () {
            D(0)
          }, 2e3))
        v.getShouldUseNatc()
          ? (z.updateCount(y.NATC_AJAX_RESPONSE_SUCCESS), c && c.count && I(c.count))
          : (z.updateCount(y.ATC_AJAX_RESPONSE_SUCCESS), I(c.numActiveItemsInCart))
        d && (b.inputs.isUSSAjax ? d(c) : d())
      }
      var L = u('#add-to-cart-button')
      if (!L.length || 'submit' === L.prop('type')) {
        var aa = 0 < u('#cps-atc-changeover').length,
          t = b.strings,
          P = d !== m
        l &&
          l.count &&
          (l.count('dp-mobile-app-doatc', (l.count('dp-mobile-app-doatc') || 0) + 1),
          P &&
            l.count(
              'dp-mobile-app-doatc-skiptoast',
              (l.count('dp-mobile-app-doatc-skiptoast') || 0) + 1,
            ))
        L = u('#subscribeToApubPrimeFirstEmailList')
        ;('use strict')
        var V = (function () {
          var b = !1
          k.now('action-executor').execute(function (a) {
            a !== m
              ? (b = !0)
              : l &&
                l.count &&
                l.count(
                  'ax_bottom_sheet_not_ready',
                  (l.count('ax_bottom_sheet_not_ready') || 0) + 1,
                )
          })
          return b
        })()
        ;('use strict')
        ;('use strict')
        ;('use strict')
        var da = 'DEX_SSD_DP_POST_ATC_SSD_BOTTOM_SHEET_960271'
        ;('use strict')
        var ha = '/ussx/weblab-trigger?',
          ea = 'CONSUMABLES_CSE_USS_SW_CONVERGENCE_692339',
          fa = /^T[0-9]+$/
        ;('use strict')
        P || (w() && V) || (aa ? X() : ba())
        L.length
          ? (L.is(':checked') && (b.inputs.subscribeToApubPrimeFirstEmailList = 1),
            b.requiresSignIn && !g.apubPrimeFirstSignInSuccessful
              ? ((g.apubPrimeFirstSignInSuccessful = 1),
                e.showLoginDialog({
                  successCallback: function () {
                    h(b)
                  },
                  failCallback: function (b) {
                    g.apubPrimeFirstSignInSuccessful = 0
                    'CANCELED' !== b && W(b)
                  },
                }))
              : h(b))
          : b.requiresSignIn
            ? e.showLoginDialog({
                successCallback: function () {
                  h()
                },
                failCallback: function (b) {
                  'CANCELED' !== b && W(b)
                },
              })
            : h()
      }
    }
    function X(b) {
      J(b, function (b, a) {
        D(1e3)
        I(a.numActiveItemsInCart)
        e.showAlert({
          message: b.strings.aa_mash_some_out_of_stock,
          buttonTitles: [
            b.strings.multi_aa_mash_go_to_cart,
            b.strings.multi_aa_mash_continue_shopping,
          ],
          successCallback: function (b) {
            0 === b && (g.location = '/gp/cart/view.html')
          },
          failCallback: function (b) {
            console.log(b)
          },
        })
      })
    }
    function H(b, a) {
      b = JSON.parse(JSON.stringify(b))
      if ('undefined' === typeof b.inputs.isSecondaryAtc || 1 !== b.inputs.isSecondaryAtc)
        'true' !== u('#twister-plus-mbb-selected').val() && (b = p.updateQuantity(b)),
          'undefined' === typeof b.inputs.isUsedBuyBox || '1' !== b.inputs.isUsedBuyBox
            ? ('reftag' in b ||
                (b.reftag =
                  'undefined' !== typeof b.isMobbSecondNew && b.isMobbSecondNew
                    ? 'dp_atc_ma_secondnew'
                    : 'mw_pa_dp_buy_crt'),
              '000-0000000-8675309' === b.inputs.verificationSessionID &&
                (b.inputs.verificationSessionID = c('session-id')),
              w.mbbCheckboxIsChecked() && !v.getShouldUseNatc() && w.updateData(b))
            : 'reftag' in b || (b.reftag = 'dp_uatc_ma')
      b = d.updateData(b)
      b = h.updateData(b)
      b = x.updateEligibilityData(b)
      r !== m && (b = r.updateSnSBuyingOptionData(b))
      J(
        b,
        function (b, c) {
          b.inputs.isUSSAjax
            ? a(c)
            : U(
                b.strings.aa_mash_add_to_cart_failed_quantity_message,
                b.strings.aa_mash_add_to_cart_failed_quantity_title,
                b.strings.aa_mash_ok,
              )
          I(c.numActiveItemsInCart)
        },
        a,
      )
    }
    function M(b) {
      return {
        asin: b.a,
        offerId: b.oid,
        listId: b.colid,
        listItemId: b.coliid,
        dealId: b.di,
        clickStream: '',
      }
    }
    var u = a.$
    a.state('a-page-options')
    var F = u('body')
    ;('use strict')
    var l = g.ue
    ;('use strict')
    var Q = {
      'add-to-cart': function (b) {
        l &&
          l.count &&
          l.count('mobileAppAddToCartMash', (l.count('mobileAppAddToCartMash') || 0) + 1)
        f.atcAction(b, H)
      },
      'add-multiple-to-cart': function (b) {
        l &&
          l.count &&
          l.count(
            'mobileAppAddMultipleToCartMash',
            (l.count('mobileAppAddMultipleToCartMash') || 0) + 1,
          )
        X(b)
      },
      'add-to-wish-list': function (b) {
        l &&
          l.count &&
          l.count('mobileAppAddToWishListMash', (l.count('mobileAppAddToWishListMash') || 0) + 1)
        S()
        e.addToWishList({ asin: b.inputs.a })
        T()
      },
      'buy-now': function (b) {
        l && l.count && l.count('mobileAppBuyNowMash', (l.count('mobileAppBuyNowMash') || 0) + 1)
        var a = document.getElementById('same-day-swatches-shipping-speed')
        b = M(b.inputs)
        b.shippingSpeed = (a && a.value) || 'default'
        e.buyNow(b)
      },
      'buy-now-one-click': function (b) {
        l &&
          l.count &&
          l.count('mobileAppBuyNowOneClickMash', (l.count('mobileAppBuyNowOneClickMash') || 0) + 1)
        var a = document.getElementById('prime-toggle-main')
        b = M(b.inputs)
        b.oneClickShippingSpeed = (a && a.name) || 'default'
        e.buyNowWithOneClick(b)
      },
    }
    u.isFunction(g.markFeatureInteractive) &&
      g.markFeatureInteractive('atc', {
        hasComponents: !0,
        components: [{ name: 'aw-mash', alwaysInteractive: !0 }],
      })
    a.declarative('aw-mash', ['click'], function (b) {
      var a = g.ue
      b && b.data && v.setShouldUseNatc(b.data)
      a &&
        a.count &&
        b &&
        b.data &&
        'add-to-cart' === b.data.buttonID &&
        a.count(
          'DetailPage_MobileApp_AddToCart',
          (a.count('DetailPage_MobileApp_AddToCart') || 0) + 1,
        )
      'undefined' !== typeof b.$target.context.id &&
        'mobb.addToCart' === b.$target.context.id &&
        (b.data.isMobbSecondNew = !0)
      b = p.setNatcQuantityFromDom(b)
      'object' === typeof b &&
        'object' === typeof b.data &&
        'string' === typeof b.data.buttonID &&
        'function' === typeof Q[b.data.buttonID] &&
        Q[b.data.buttonID](b.data)
    })
    a.declarative('aw-mash', ['touchstart'], function (b) {
      var a = b.$event.originalEvent,
        c = g.ue
      a.acknowledge &&
        (a.acknowledge(0 < b.$currentTarget.length ? b.$currentTarget[0] : m),
        c && c.count && c.count('tnr-post-ack-atc', (c.count('tnr-post-ack-atc') || 0) + 1))
    })
    a.on('js-trigger-aw-mash', function (b, a) {
      v.setShouldUseNatc(b)
      H(b, a)
    })
    return { addToCart: H, hideAtcToast: D, updateAtcToast: O }
  })
  ;('use strict')
  k.when('A', 'aw-mash').register('aw-mash-open-external-url', function (a, e) {
    a.declarative('aw-mash-open-external-url', ['click'], function (a) {
      e.openInExternalBrowser({ url: a.data.url })
      return !1
    })
  })
  ;('use strict')
  k.when('A').register('mobileiv-images', function () {
    return { imageArray: [] }
  })
  k.when('A', 'jQuery', 'a-carousel-framework', 'atf', 'mobileiv-images').execute(
    function (a, e, c, f, d) {
      function h(a, c, d) {
        amazon.mash.showImageGallery({ title: a, startIndex: c, imageUrls: d })
        k.when('mobileIBmetricCollectionWeblab').execute(function (a) {
          if (a.isMobileIBmetricCollectionEnabled)
            if (a.onPrimaryImg)
              if (a.IVReqCount > a.IVSuccessCount) {
                a.logCountAndTime('dpmob_primaryImageImmersiveViewRequestServed')
                a.IVSuccessCount++
                var c = a.IVCountsDiff
                a.IVCountsDiff = a.IVReqCount - a.IVSuccessCount
                a.IVCountsDiff > c &&
                  (a.logSpecificCount('dpmob_primaryImageImmersiveViewRequestFailed', 1),
                  a.logSpecificCount('dpmob_primaryImageInteractionFailed', 1))
              } else a.logCountAndTime('dpmob_primaryImageImmersiveViewRequestServedWithoutPlaced')
            else a.logCountAndTime('dpmob_altImagesImmersiveViewRequestServed')
        })
      }
      function v(a) {
        var d = c.getCarouselByName(a)
        if ('undefined' === typeof d)
          for (var f = c.getAllCarousels(), e = 0; e < f.length; e++) {
            var h = f[e]
            if (h.getAttr('name') === a) {
              d = h
              break
            }
          }
        return d
      }
      function B(a) {
        var c = 1
        if ('undefined' !== typeof a.dom && 'undefined' !== typeof a.dom.$carousel)
          a = a.dom.$carousel
        else if (!(0 < a.length)) {
          a = e
          return
        }
        a.children('li').each(function (a, d) {
          ;(a = e(d).find('.a-declarative')) &&
          a.length &&
          'undefined' !== typeof a.data &&
          a.data('a-secondary-view-native') !== m &&
          'immersive-view-app' == a.data('a-secondary-view-native').name &&
          !a.find('.ar-ib-ingress-overlay').length
            ? (p.push(c), c++)
            : p.push(null)
        })
      }
      var p = [null]
      g.ue &&
        g.ue.count &&
        g.performance &&
        g.performance.now &&
        ue.count('immersive_view_mobile_app_time', performance.now())
      a.on('image-block-refresh', function () {
        p = [null]
      })
      a.declarative('a-secondary-view-native', ['click'], function (c) {
        var f = c.data && c.data.titleText ? c.data.titleText : 'Product Image Gallery',
          q =
            0 < e('.lookbook \x3e .lookbook-container .a-carousel').length
              ? !1
              : 0 < e('.lookbook \x3e .lookbook-container').length,
          C = q ? e('.lookbook \x3e .lookbook-container') : v('image-block-carousel'),
          x = 0,
          r = 0
        'undefined' !== typeof C &&
          (1 >= p.length && B(C),
          (q = q ? C.parent().find('progress').prop('value') : C.getAttr('pageNumber')),
          (r = a.state('sneakPeekStateData')) &&
            r.sneakPeekEnabled &&
            r.lastPageClicked !== m &&
            (q = r.lastPageClicked),
          (r = a.state('putbPageState')) &&
            r.putbEnabled &&
            r.lastPageClicked !== m &&
            (q = r.lastPageClicked),
          'number' === typeof q &&
            ((x = p[q]), (r = d.imageArray ? d.imageArray.length : 0), x > r && (x = q)))
        if (0 < e('#swf-share-icon.android').length && c.data.shareParams) {
          r = c.data.shareParams
          var y = { apply: function (a, c) {} },
            z = {
              title: f,
              startIndex: x,
              imageUrls: d.imageArray,
              messagePlain: r.messagePlain,
              subject: r.subject,
              imageUrl: r.imageURL,
              url: r.url,
            }
          k.when('immersiveViewWithShare').execute(function (a) {
            ;(g.cordova && g.cordova.require('cordova/exec'))(
              y,
              y,
              'ShowImageGallerySocial',
              'ShowImageGalleryWithShare',
              z,
            )
          })
        } else h(f, x - 1 || 0, d.imageArray)
        c.$event.preventDefault()
      })
    },
  )
  ;('use strict')
  k.when('A', 'aw-mash').execute(function (a, e) {
    var c = {
      offers: function (a) {
        var c = a.asin || a.inputs.asin
        '1' === a.nativePage
          ? e.showOfferListingPage({ asin: c })
          : (g.location.href = '/gp/aw/ol/' + c)
      },
    }
    a.declarative('aw-mash', ['click'], function (a) {
      'object' === typeof a &&
        'object' === typeof a.data &&
        'string' === typeof a.data.buttonID &&
        'function' === typeof c[a.data.buttonID] &&
        c[a.data.buttonID](a.data)
    })
  })
  ;('use strict')
  k.when('A', 'a-checkbox').register('aw-mbb-checkbox-helper', function (a, e) {
    var c = a.$
    return {
      updateData: function (a) {
        var d = 0 < c('.a-accordion-active ').length ? '.a-accordion-active ' : ''
        a.inputs.a += '|' + c(d + '#mbb-checkbox-input').val()
        a.inputs.oid += '|' + c(d + '#mbb-offering-id').val()
        a.inputs.quantity += '|' + c(d + '#mbb-quantity').val()
        return a
      },
      mbbCheckboxIsChecked: function () {
        var a = e('.mbb-checkbox')
        return 0 < a.size() && a.isChecked()
      },
    }
  })
  ;('use strict')
  k.when(
    'a-checkbox',
    'add-to-cart-parameter-name',
    'add-to-cart-constants',
    'natc-check',
  ).register('mobile-app-gift', function (a, e, c, f) {
    return {
      updateData: function (d) {
        var h = a('#gift-wrap')
        0 < h.size() &&
          h.isChecked() &&
          (f.getShouldUseNatc()
            ? ((h = e.constructParameterName(c.ITEM_TYPES.BASE, 0, c.PARAMETER_PATHS.GIFTOPTIONS)),
              (d.inputs[h] = 'true'))
            : (d.inputs.isToBeGiftWrapped = !0))
        return d
      },
    }
  })
  ;('use strict')
  k.when('A').register('mobile-app-atc-action', function (a) {
    return {
      atcAction: function (e, c) {
        var f = a.state('program-winner')
        null != f && 'undefined' !== typeof f && 'Pantry' === f.Type
          ? k.when('pantry-mobile-app-atc-setup').execute(function (a) {
              a.addToCart(e)
            })
          : c(e)
      },
    }
  })
  ;('use strict')
  k.when('A').register('natc-check', function (a) {
    var e = !1
    return {
      setShouldUseNatc: function (a) {
        e = !0
      },
      getShouldUseNatc: function () {
        return e
      },
      getAtcEndpoint: function (a) {
        e = !0
        return a.addToCartUrl
      },
    }
  })
  ;('use strict')
  k.when('natc-check', 'dp-csm-metrics', 'atc-constants').register(
    'atc-metrics',
    function (a, e, c) {
      function f(a, c) {
        e.updateCount(c)
        e.recordLatencyTime(a)
      }
      return {
        recordAtcAjaxCall: function () {
          if (a.getShouldUseNatc()) {
            var d = c.NATC_AJAX_LATENCY
            e.updateCount(c.NATC_AJAX_COUNT)
            e.startLatencyTime(d)
          } else (d = c.ATC_AJAX_LATENCY), e.updateCount(c.ATC_AJAX_COUNT), e.startLatencyTime(d)
        },
        recordAtcAjaxSuccess: function () {
          a.getShouldUseNatc()
            ? f(c.NATC_AJAX_LATENCY, c.NATC_AJAX_SUCCESS_COUNT)
            : f(c.ATC_AJAX_LATENCY, c.ATC_AJAX_SUCCESS_COUNT)
        },
        recordAtcAjaxFailure: function () {
          a.getShouldUseNatc()
            ? f(c.NATC_AJAX_LATENCY, c.NATC_AJAX_FAILURE_COUNT)
            : f(c.ATC_AJAX_LATENCY, c.ATC_AJAX_FAILURE_COUNT)
        },
      }
    },
  )
  ;('use strict')
  k.register('atc-constants', function () {
    return {
      ATC_AJAX_COUNT: 'mobileApp:atc:ajax',
      ATC_AJAX_SUCCESS_COUNT: 'mobileApp:atc:ajax:success',
      ATC_AJAX_FAILURE_COUNT: 'mobileApp:atc:ajax:failure',
      ATC_AJAX_LATENCY: 'mobileapp:atc:ajax',
      ATC_AJAX_RESPONSE_SUCCESS: 'mobileApp:atc:ajax:response:success',
      ATC_AJAX_RESPONSE_DEAL_NOT_AVAILABLE: 'mobileApp:atc:ajax:response:dealNotAvailable',
      ATC_AJAX_RESPONSE_OFFERING_RESTRICTION_VIOLATED:
        'mobileApp:atc:ajax:response:perOfferingRestrictionViolated',
      ATC_AJAX_RESPONSE_CART_SERVICE_FAILURE: 'mobileApp:atc:ajax:response:cartServiceFailure',
      ATC_AJAX_RESPONSE_FAILURE: 'mobileApp:atc:ajax:response:failure',
      NATC_AJAX_COUNT: 'mobileApp:atc:ajax:natc',
      NATC_AJAX_SUCCESS_COUNT: 'mobileApp:atc:ajax:success:natc',
      NATC_AJAX_FAILURE_COUNT: 'mobileApp:atc:ajax:failure:natc',
      NATC_AJAX_LATENCY: 'mobileapp:atc:ajax:natc',
      NATC_AJAX_RESPONSE_SUCCESS: 'mobileApp:atc:ajax:response:success:natc',
      NATC_AJAX_RESPONSE_FAILURE: 'mobileApp:atc:ajax:response:failure:natc',
      ADD_TO_CART_INPUT_VALIDATION_SUCCESS: 'mobileApp:addToCart:inputValidation:success',
      ADD_TO_CART_INPUT_VALIDATION_FAILURE: 'mobileApp:addToCart:inputValidation:failure',
    }
  })
  ;('use strict')
  k.when('A', 'add-to-cart-parameter-name', 'add-to-cart-constants').register(
    'update-atc-data',
    function (a, e, c) {
      var f = a.$
      return {
        updateQuantity: function (a) {
          var d = e.constructParameterName(c.ITEM_TYPES.BASE, 0, c.PARAMETER_PATHS.QUANTITY)
          a.inputs[d]
            ? (a.inputs.quantity = a.inputs[d])
            : f('#mobileQuantityDropDown').length &&
              (f('.a-accordion-active select.mobileQuantityDropDown').length
                ? (a.inputs[d] = f('.a-accordion-active select.mobileQuantityDropDown').val())
                : (a.inputs[d] = f('#mobileQuantityDropDown').val()),
              (a.inputs.quantity = a.inputs[d]))
          return a
        },
        setNatcQuantityFromDom: function (a) {
          var d = JSON.parse(a.$currentTarget.attr('data-aw-mash')).inputs.quantity,
            f = e.constructParameterName(c.ITEM_TYPES.BASE, 0, c.PARAMETER_PATHS.QUANTITY)
          d && (a.data.inputs[f] = d)
          return a
        },
      }
    },
  )
  ;('use strict')
  k.when(
    'A',
    'atc-constants',
    'add-to-cart-constants',
    'add-to-cart-parameter-name',
    'dp-csm-metrics',
  ).register('atc-data-validation', function (a, e, c, f, d) {
    var h = a.$
    return {
      validateData: function (k) {
        var g = m
        0 < h('#buybox .a-accordion-active #atc-declarative').length
          ? (g = h('#buybox .a-accordion-active #atc-declarative')[0])
          : 0 < h('#buybox #atc-declarative').length && (g = h('#buybox #atc-declarative')[0])
        var p = m
        if (g !== m && g.dataset != m)
          for (q in g.dataset)
            try {
              p = JSON.parse(String(g.dataset[q]))
              break
            } catch (E) {}
        var q = p
        if (q !== m) {
          if (
            ((g = [
              c.CSRF_TOKEN,
              c.CLIENT_NAME,
              f.constructParameterName(c.ITEM_TYPES.BASE, 0, c.PARAMETER_PATHS.ASIN),
              f.constructParameterName(c.ITEM_TYPES.BASE, 0, c.PARAMETER_PATHS.OFFER_LISTING_ID),
            ]),
            q !== m && q.inputs !== m && k !== m && k.inputs !== m && Array.isArray(g))
          )
            for (p = 0; p < g.length; p++) {
              var w = g[p]
              q.inputs[w] !== k.inputs[w]
                ? (d.updateCount(e.ADD_TO_CART_INPUT_VALIDATION_FAILURE),
                  a.trigger(
                    'dpLogFatalsEvent',
                    'ERROR: Add To Cart Input Validation Failed for "' +
                      w +
                      '". Expected "' +
                      q.inputs[w] +
                      '", but received "' +
                      k.inputs[w] +
                      '".',
                    'ERROR',
                    'mobileApp_addtocart_fatal',
                  ))
                : d.updateCount(e.ADD_TO_CART_INPUT_VALIDATION_SUCCESS)
            }
        } else
          a.trigger(
            'dpLogFatalsEvent',
            'WARNING: Could not validate add to cart parameters. Could not fetch expected data',
            'WARN',
            'mobileApp_addtocart_fatal',
          )
      },
    }
  })
  ;('use strict')
  k.when(
    'a-checkbox',
    'add-to-cart-parameter-name',
    'add-to-cart-constants',
    'natc-check',
  ).register('mobile-app-device-prereg', function (a, e, c, f) {
    return {
      updateData: function (d) {
        var h = a('#account-linking')
        if (f.getShouldUseNatc() && 0 < h.size()) {
          var g = e.constructParameterName(
            c.ITEM_TYPES.BASE,
            0,
            c.PARAMETER_PATHS.DEVICEPREREGISTRATION,
          )
          d.inputs[g] = h.isChecked() ? 'true' : 'false'
        }
        return d
      },
    }
  })
  ;('use strict')
  k.when('add-to-cart-parameter-name', 'add-to-cart-constants').register(
    'atc-eligibility',
    function (a, e) {
      var c = {}
      return {
        updateEligibilityData: function (f) {
          var d = a.constructParameterName(e.ITEM_TYPES.BASE, 0, e.PARAMETER_PATHS.ASIN),
            h = a.constructParameterName(e.ITEM_TYPES.BASE, 0, e.PARAMETER_PATHS.OFFER_LISTING_ID)
          f.inputs.programEligibility = JSON.stringify({
            primaryAsinData: { asin: f.inputs[d], offerListingId: f.inputs[h] },
            eligibility: c,
          })
          return f
        },
        registerProgramEligibility: function (a, d) {
          a && (c[a] = d)
        },
      }
    },
  )
  ;('use strict')
  k.when('A', 'aw-mash').register('patc-csm-init', function (a, e) {
    function c() {
      return (
        'true' === a.$('#uss-mobileApp').val() &&
        a.$('#ussEligible').length &&
        '1' === a.$('#ussEligible').val()
      )
    }
    var f
    ;('use strict')
    return {
      initialize: function () {
        c() ||
          k.when('ax:csm-metrics', 'ax:constants').execute(function (a, c) {
            a.initLatencyTime(c.CSM_PREFIX)
            f = a
          })
      },
      recordAXControlMetric: function (a) {
        !c() &&
          f &&
          ((a = a.http.getResponseHeader('x-amz-rid'))
            ? f.mapRequestToLatencyMetrics(a)
            : f.updateCount('no-rid'),
          f.recordLatencyTime('ld'))
      },
    }
  })
  ;('use strict')
  k.when('A', 'mash').register('aw-mash', function (a, e) {
    return e
  })
  ;('use strict')
  k.when('A').execute('tnr-hack-acknowledgement', function (a) {
    function e() {}
    function c(c, d) {
      a.trigger('dp:click-to-buyable', { featureName: d })
      c.addEventListener('touchstart', function (a) {
        var c = 'tnr-post-ack-' + d
        a.ack && (a.ack(), h(c, h(c) || 1))
      })
    }
    function f(a, c, d) {
      m('tnr-' + a + '-marked')
      m('tnr-' + a + '-' + c + '-seen')
      h('tnr-features-tracked', h('tnr-features-tracked') || 1)
      d ? h('tnr-' + a + '-element-exist', 1) : h('tnr-' + a + '-element-does-not-exist', 1)
    }
    var d = g.ue,
      h = (d && d.count) || e,
      m = (d && d.tag) || e,
      B = {
        imageBlock: 'tnr-imageblock',
        mobile_buybox: 'tnr-mobile_buybox',
        buybox: 'tnr-buybox',
        buyBoxAccordion: 'tnr-buyboxaccordion',
        buyBoxAccordionApp: 'tnr-buyboxaccordionapp',
        mobileapp_buybox: 'tnr-mobileapp_buybox',
        pantryBuyBox: 'tnr-pantrybuybox',
        agsTips: 'tnr-agstips',
      }
    a.each(
      {
        imageBlock: ['imageBlock'],
        buybox:
          'mobile_buybox buybox buyBoxAccordion buyBoxAccordionApp mobileapp_buybox pantryBuyBox agsTips'.split(
            ' ',
          ),
      },
      function (d, e) {
        a.each(d, function (a) {
          var d = a + '_feature_div',
            g = document.getElementById(d)
          g
            ? (c(g, e), f(e, a, !0))
            : B[a] &&
              k.when(B[a]).execute(function () {
                var g = document.getElementById(d)
                g ? (c(g, e), f(e, a, !1)) : h('tnr-' + e + '-element-not-available', 1)
              })
        })
      },
    )
    var p = a.$
    a.each(
      ['#atc-declarative', '#atc-twister-declarative', '#prohibitedBuyBox-popover'],
      function (c) {
        p(c).each(function () {
          var d = p(this).attr('id') || 'unknown-id',
            e = p(this).data('action') || 'unknown-action'
          m('tnr-atc-marked')
          '#atc-twister-declarative' === c &&
            a.trigger('dp:click-to-buyable', { featureName: 'atc' })
          m('tnr-atc-' + d + '-' + e + '-seen')
          h('tnr-features-tracked', h('tnr-features-tracked') || 1)
        })
      },
    )
    ;(d = document.getElementById('#prohibited-buybox-addToCart')) &&
      d.addEventListener('touchstart', function (a) {
        a.ack && (a.ack(), h('tnr-post-ack-atc', h('tnr-post-ack-atc') || 1))
      })
  })
  ;('use strict')
  ;('use strict')
  ;('use strict')
  ;('use strict')
  k.when('A').register('sns-buybox-validation-on-patc', function (a) {
    function e(a) {
      g.ue && g.ue.count(a, (ue.count(a) || 0) + 1)
    }
    return {
      updateSnSBuyingOptionData: function (c) {
        try {
          var f = a.state('sns-integartion-in-patc-weblab-treatment')
          if (f !== m && 'T1' === f.value) {
            if (0 < a.$('#snsAccordionRowMobileAppMiddle').length) {
              e('snsBuyBoxPresentInDetailPageMobileApp')
              var d = !0
            } else e('snsBuyBoxAbsentInDetailPageMobileApp'), (d = !1)
            c.inputs.isSnSBuyingOptionPresent = d
          }
          return c
        } catch (h) {
          return e('updatingSnSBuyBoxDataExceptionMetric'), c
        }
      },
    }
  })
})
/* ******** */
;(function (q) {
  var w = window.AmazonUIPageJS || window.P,
    F = w._namespace || w.attributeErrors,
    A = F ? F('QuantitySelectorAssets', '') : w
  A.guardFatal
    ? A.guardFatal(q)(A, window)
    : A.execute(function () {
        q(A, window)
      })
})(function (q, w, F) {
  function A(n) {
    var f = !1
    q.now(n).execute('qsAssetDuplicationGuard', function (a) {
      f = !!a
    })
    return f
  }
  function L(n, f) {
    if (!A(n))
      try {
        q.register(n, f)
      } catch (a) {
        if (!a.message.includes('reregistered by QuantitySelectorAssets')) throw a
      }
  }
  function Da() {
    var n = arguments
    return {
      register: function (f, a) {
        if (!A(f))
          try {
            q.when.apply(q, n).register(f, a)
          } catch (c) {
            if (!c.message.includes('reregistered by QuantitySelectorAssets')) throw c
          }
      },
      execute: function (f, a) {
        q.when.apply(q, n).execute(f, a)
      },
    }
  }
  L('QSAssetDuplicationGuard', function () {
    return { register: L, when: Da }
  })
  ;('use strict')
  q.when('QSAssetDuplicationGuard').execute('qsAUIDeps-main-duplication-guard', function (n) {
    n.when('A', 'QuantitySelectorConstants', 'a-util').execute(
      'qsAUIDeps-main',
      function (f, a, c) {
        function h() {
          v && v.enableCheckoutCompatibility && g()
        }
        function g() {
          f.$(
            'span[id^\x3d"' + a.getQsWidgetSummaryPriceId('') + '"][data-a-color\x3d"price"]',
          ).each(function () {
            f.$(this)[0].style.color = '#B12704'
          })
          f.$('span[id^\x3d"' + a.getQsWidgetButtonId('') + '"]').each(function () {
            var a = f.$(this)
            a.hasClass('a-button-dropdown') &&
              a.hasClass('a-button-small') &&
              ((a = a.attr('id')),
              f.$('button[id^\x3d"' + a + '-announce"]').each(function () {
                f.$(this)[0].style.paddingRight = '17px'
              }))
          })
        }
        function k(a) {
          function d(a) {
            return f.$(a + '-announce')
          }
          return function (a) {
            return new d(a)
          }
        }
        function G(c) {
          var d = function (a, d) {
            var e = a + '-extradata',
              k = c.state(e)
            if (null == d) return (e = c.state(a)), (d = f.$.extend({}, e, k))
            k = f.$.extend({}, k, d)
            c.state(e, k)
          }
          d.parse = function () {
            for (
              var d = f.$(a.getQsWidgetGenericStateSelectorQuery()),
                k = a.getQsWidgetConfigurationId(''),
                e = 0;
              e < d.length;
              e++
            )
              try {
                var l = d[e].getAttribute('data-a-state'),
                  r = JSON.parse(l).key
                if (r && r.substring(0, k.length) == k) {
                  var u = c.state(r)
                  if (!u || !u.id) {
                    var g = JSON.parse(d[e].innerHTML)
                    c.state(r, g)
                  }
                }
              } catch (N) {
                var v = a.getQsWidgetConfigurationJsonString(),
                  G = a.getQsWidgetStateAttributeJsonString()
                if (l.includes(G) || d[e].innerHTML.includes(v)) throw N
              }
          }
          d.replace = function (a, d) {
            a += '-extradata'
            'function' === typeof c.state.replace ? c.state.replace(a, d) : c.state(a, d)
          }
          return { state: d }
        }
        var v
        q.when('QuantitySelectorAUIDeps_AState', 'QuantitySelectorAUIDeps_AButton').execute(
          'qsAUIDeps-register',
          function (a, d) {
            n.register('QuantitySelectorAUIDeps', function () {
              return { aUtil: c, aState: a.object, aButton: d.object, initialize: h }
            })
          },
        )
        ;(function () {
          for (
            var c = f.$(a.getQsWidgetGenericStateSelectorQuery()),
              d = a.getQsWidgetGlobalConfigurationId(),
              k = 0;
            k < c.length;
            k++
          )
            try {
              var g = c[k].getAttribute('data-a-state'),
                e = JSON.parse(g).key
              if (e && e.substring(0, d.length) == d) {
                v = JSON.parse(c[k].innerHTML)
                break
              }
            } catch (u) {
              var l = a.getQsWidgetConfigurationJsonString(),
                r = a.getQsWidgetStateAttributeJsonString()
              if (g.includes(r) || c[k].innerHTML.includes(l)) throw u
            }
        })()
        ;(function () {
          v && v.enableCheckoutCompatibility
            ? (q
                .when('a-state')
                .execute('qsAUIDeps-checkout-compat-a-state-register', function (a) {
                  n.register('QuantitySelectorAUIDeps_AState', function () {
                    return { object: G(a) }
                  })
                }),
              q
                .when('a-buttons')
                .execute('qsAUIDeps-checkout-compat-a-button-register', function (a) {
                  n.register('QuantitySelectorAUIDeps_AButton', function () {
                    return { object: k(a) }
                  })
                }),
              f.on('checkout:afterReload', function () {
                f.trigger(a.getQsWidgetEventInitialize(), !1)
              }))
            : (q.when('a-state').execute('qsAUIDeps-a-state-register', function (a) {
                n.register('QuantitySelectorAUIDeps_AState', function () {
                  return { object: a }
                })
              }),
              q.when('a-button').execute('qsAUIDeps-a-button-register', function (a) {
                n.register('QuantitySelectorAUIDeps_AButton', function () {
                  return { object: a }
                })
              }))
          f.on('a:pageUpdate ready', function () {
            f.trigger(a.getQsWidgetEventInitialize(), !1)
          })
        })()
        h()
      },
    )
  })
  ;('use strict')
  q.when('QSAssetDuplicationGuard').execute('qsConstants-duplication-guard', function (n) {
    n.when('A').register('QuantitySelectorConstants', function (f) {
      function a(a) {
        return 'qs-widget-configuration-' + a
      }
      var c = {
          height: 358,
          heightWithAtc: 410,
          disclaimerTextAdjustment: 41,
          disclaimerTextAdjustmentWithAtc: 40,
        },
        h = {
          height: 303,
          heightWithAtc: 355,
          disclaimerTextAdjustment: 41,
          disclaimerTextAdjustmentWithAtc: 40,
        },
        g = { scrollEventStop: 200, constant: 19, increment: 45, adjustment: 20 }
      return {
        getQsWidgetEventInitialize: function () {
          return 'quantity-selector-widget:initialize'
        },
        getQsWidgetEventLoadStatesAndInitialize: function () {
          return 'quantity-selector-widget:loadStatesAndInitialize'
        },
        getQsWidgetEventTriggerAction: function () {
          return 'quantity-selector-widget:triggerAction'
        },
        getQsWidgetVariationEventTriggerAction: function () {
          return 'quantity-selector-widget-variation-selector:triggerAction'
        },
        getQsWidgetEventConfigureList: function () {
          return 'quantity-selector-widget:configure:list'
        },
        getQsWidgetEventConfigureEnable: function () {
          return 'quantity-selector-widget:configure:enable'
        },
        getQsWidgetEventConfigureDisable: function () {
          return 'quantity-selector-widget:configure:disable'
        },
        getQsWidgetEventConfigureReset: function () {
          return 'quantity-selector-widget:configure:reset'
        },
        getQsWidgetEventConfigureGet: function () {
          return 'quantity-selector-widget:configure:get'
        },
        getQsWidgetEventConfigureSet: function () {
          return 'quantity-selector-widget:configure:set'
        },
        getQsWidgetEventSelectId: function () {
          return 'quantity-selector-widget:selectId'
        },
        getQsWidgetVariationEventSelectId: function () {
          return 'quantity-selector-widget-variation-selector:selectId'
        },
        getQsWidgetEventSelectQuantity: function () {
          return 'quantity-selector-widget:selectQuantity'
        },
        getQsWidgetEventSelectQuantityClientUpdate: function () {
          return 'quantity-selector-widget:selectQuantity:clientUpdate'
        },
        getQsWidgetEventHideDropdown: function () {
          return 'quantity-selector-widget:hideDropdown'
        },
        getQsWidgetEventSyncStepperQuantity: function () {
          return 'quantity-selector-widget:sync-stepper-quantity'
        },
        getQsWidgetEventSyncStepperQuantityFromIcdpToHostPage: function () {
          return 'quantity-selector-widget:sync-stepper-quantity:icdp-to-host'
        },
        getQsWidgetEventInitialized: function () {
          return 'quantity-selector-widget:initialized'
        },
        getQsWidgetEventAction: function (a) {
          return 'quantity-selector-widget:action:' + a
        },
        getQsWidgetAuiInputTextWrapperClass: function () {
          return 'a-input-text-wrapper'
        },
        getQsWidgetActivateDebounce: function () {
          return 100
        },
        getQsWidgetInitialViewDropdown: function () {
          return 'dropdown'
        },
        getQsWidgetInitialViewTextLink: function () {
          return 'text_link'
        },
        getQsWidgetInitialViewChooseQuantity: function () {
          return 'choose_quantity'
        },
        getQsWidgetActionTriggerOnConfirmation: function () {
          return 'on_confirmation'
        },
        getQsWidgetActionTriggerOnSelect: function () {
          return 'on_select'
        },
        getQsWidgetGlobalConfigurationId: function () {
          return 'qs-widget-global-configuration'
        },
        getQsWidgetConfigurationId: a,
        getQsWidgetStateScriptSelectorQuery: function (c) {
          return (
            "script[data-a-state*\x3d'" + a(c) + "'], " + ("div[data-a-state*\x3d'" + a(c) + "']")
          )
        },
        getQsWidgetGenericStateSelectorQuery: function () {
          return "script[type\x3d'a-state'], div[data-a-state]"
        },
        getQsWidgetStateAttributeJsonString: function () {
          return 'qs-widget-'
        },
        getQsWidgetConfigurationJsonString: function () {
          return 'qsItems'
        },
        getQsWidgetContainerId: function (a) {
          return 'qs-widget-container-' + a
        },
        getQsWidgetDivSelectorQueryForWidgetContainers: function () {
          return 'div[id^\x3dqs-widget-container-]'
        },
        getQsWidgetSpinnerId: function (a) {
          return 'qs-widget-spinner-' + a
        },
        getQsWidgetDivSelectorQueryForSpinners: function () {
          return 'div[id^\x3dqs-widget-spinner-]'
        },
        getQsWidgetCheckboxId: function (a) {
          return 'qs-widget-checkbox-' + a
        },
        getQsWidgetInputSelectorQueryForCheckboxes: function () {
          return 'input[id^\x3dqs-widget-checkbox-]'
        },
        getQsWidgetButtonContainerId: function (a) {
          return 'qs-widget-button-container-' + a
        },
        getQsWidgetButtonId: function (a) {
          return 'qs-widget-button-' + a
        },
        getQsWidgetStepperId: function (a) {
          return 'qs-widget-stepper-' + a
        },
        getQsWidgetAtcButtonId: function (a) {
          return 'qs-widget-atc-button-' + a
        },
        getQsWidgetPlusButtonId: function (a) {
          return 'qs-widget-plus-button-' + a
        },
        getQsWidgetMinusButtonId: function (a) {
          return 'qs-widget-minus-button-' + a
        },
        getQsWidgetDropdownContainerGenericId: function () {
          return 'qs-widget-dropdown-container-'
        },
        getQsWidgetDropdownContainerId: function (a) {
          return 'qs-widget-dropdown-container-' + a
        },
        getQsWidgetDropdownId: function (a) {
          return 'qs-widget-dropdown-' + a
        },
        getQsWidgetDropdownViewId: function (a) {
          return 'qs-widget-dropdown-view-' + a
        },
        getQsWidgetVariationDropdownViewId: function (a) {
          return 'qs-widget-dropdown-view-variation-' + a
        },
        getQsWidgetDropdownItemId: function (a, c) {
          return 'qs-widget-dropdown-item-' + c + '-' + a
        },
        getQsWidgetDropdownItemAriaId: function (a, c) {
          return 'qs-widget-dropdown-item-aria-' + c + '-' + a
        },
        getQsWidgetDropdownItemQuantitySuffixId: function (a, c) {
          return 'qs-widget-dropdown-item-quantitySuffix-' + c + '-' + a
        },
        getQsWidgetDropdownUnorderedListId: function (a) {
          return 'qs-widget-dropdown-unorderedlist-' + a
        },
        getQsWidgetDropdownVariationUnorderedListId: function (a) {
          return 'qs-widget-dropdown-variation-unorderedlist-' + a
        },
        getQsWidgetTextInputId: function (a) {
          return 'qs-widget-text-input-' + a
        },
        getQsWidgetTextInputContainerId: function (a) {
          return 'qs-widget-text-input-container-' + a
        },
        getQsWidgetTextInputUpdateButtonId: function (a) {
          return 'qs-widget-text-input-updatelink-' + a
        },
        getQsWidgetTextInputUpdateButtonContainerId: function (a) {
          return 'qs-widget-text-input-updatelink-container-' + a
        },
        getQsWidgetTextInputUpdateButtonDecl: function () {
          return 'qs-widget-text-input-updatelink-decl'
        },
        getQsWidgetTextInputDecl: function () {
          return 'qs-widget-text-input-decl'
        },
        getQsWidgetQuantityContainerId: function (a) {
          return 'qs-widget-quantity-container-' + a
        },
        getQsWidgetQuantityId: function (a) {
          return 'qs-widget-quantity-' + a
        },
        getQsWidgetQuantitySuffixId: function (a) {
          return 'qs-widget-quantity-suffix-' + a
        },
        getQsWidgetInitialViewSuffixId: function (a) {
          return 'qs-widget-initialView-suffix-' + a
        },
        getQsWidgetSummaryPriceId: function (a) {
          return 'qs-widget-summary-price-' + a
        },
        getQsWidgetSummaryPriceSymbolId: function (a) {
          return 'qs-widget-summary-price-symbol-' + a
        },
        getQsWidgetSummaryPriceWholeId: function (a) {
          return 'qs-widget-summary-price-whole-' + a
        },
        getQsWidgetSummaryPriceFractionId: function (a) {
          return 'qs-widget-summary-price-fraction-' + a
        },
        getQsWidgetSummaryPriceDecimalId: function (a) {
          return 'qs-widget-summary-price-decimal-' + a
        },
        getQsWidgetSummaryAtcId: function (a) {
          return 'qs-widget-summary-atc-' + a
        },
        getQsWidgetFooterPriceContainerId: function (a) {
          return 'qs-widget-footer-price-container-' + a
        },
        getQsWidgetFooterPriceSymbolId: function (a) {
          return 'qs-widget-footer-price-symbol-' + a
        },
        getQsWidgetFooterPriceWholeId: function (a) {
          return 'qs-widget-footer-price-whole-' + a
        },
        getQsWidgetFooterPriceFractionId: function (a) {
          return 'qs-widget-footer-price-fraction-' + a
        },
        getQsWidgetFooterPriceDecimalId: function (a) {
          return 'qs-widget-footer-price-decimal-' + a
        },
        getQsWidgetFooterQuantitySuffixContainerId: function (a) {
          return 'qs-widget-footer-quantitySuffix-container-' + a
        },
        getQsWidgetFooterQuantitySuffixId: function (a) {
          return 'qs-widget-footer-quantitySuffix-' + a
        },
        getQsWidgetButtonDecl: function () {
          return 'qs-widget-button-decl'
        },
        getQsWidgetSummaryAtcDecl: function () {
          return 'qs-widget-summary-atc-decl'
        },
        getQsWidgetQuantityChangelinkId: function (a) {
          return 'qs-widget-quantity-changelink-' + a
        },
        getQsWidgetQuantityChangelinkDecl: function () {
          return 'qs-widget-quantity-changelink-decl'
        },
        getQsWidgetDropdownItemDecl: function () {
          return 'qs-widget-dropdown-item-decl'
        },
        getQsWidgetVariationDropdownItemDecl: function () {
          return 'qs-widget-dropdown-variation-item-decl'
        },
        getQsWidgetDropdownDecl: function () {
          return 'qs-widget-dropdown-decl'
        },
        getQsWidgetDropdownScrollMetricThreshold: function () {
          return 20
        },
        getQsWidgetBottomSheetId: function (a) {
          return 'qs-widget-bottom-sheet-' + a
        },
        getQsWidgetBottomSheetPriceTextId: function (a) {
          return 'qs-widget-bottom-sheet-price-text-' + a
        },
        getQsWidgetBottomSheetContainerId: function (a) {
          return 'qs-widget-bottom-sheet-container-' + a
        },
        getQsWidgetBottomSheetQuantitySuffixId: function (a) {
          return 'qs-widget-bottom-sheet-quantitySuffix-' + a
        },
        getQsWidgetBottomSheetBackButtonId: function (a) {
          return 'qs-widget-bottom-sheet-back-button-' + a
        },
        getQsWidgetBottomSheetBackButtonDecl: function () {
          return 'qs-widget-bottom-sheet-back-button-decl'
        },
        getQsWidgetSummaryDisclaimerId: function (a) {
          return 'qs-widget-summary-disclaimer-' + a
        },
        getQsWidgetSummaryDisclaimerContainerId: function (a) {
          return 'qs-widget-summary-disclaimer-container-' + a
        },
        getQsWidgetBottomSheetTemplateId: function () {
          return 'qs-widget-bottom-sheet-container-qsUID'
        },
        getQsWidgetBottomSheetSelectQuantityTextId: function (a) {
          return 'qs-widget-bottom-sheet-select-quantity-text-' + a
        },
        getQsWidgetBottomSheetImageId: function (a) {
          return 'qs-widget-bottom-sheet-image-' + a
        },
        getQsWidgetBottomSheetUnitTextId: function (a) {
          return 'qs-widget-bottom-sheet-unit-text-' + a
        },
        getQsWidgetBottomSheetTableId: function (a) {
          return 'qs-widget-bottom-sheet-table-' + a
        },
        getQsWidgetBottomSheetPpuTextId: function (a) {
          return 'qs-widget-bottom-sheet-ppu-text-' + a
        },
        getQsWidgetInitialViewTextLinkId: function (a) {
          return 'qs-widget-link-' + a
        },
        getQsWidgetBottomSheetHeightConfig: function (a) {
          return a ? c : h
        },
        getQsWidgetBottomSheetDropDownScrollFactor: function () {
          return g
        },
        getQsWidget1DBottomSheetSelectorCssClass: function () {
          return 'qs-widget-new-1d-dropdown-li'
        },
        getQsWidget2DBottomSheetQuantitySelectorCssClass: function () {
          return 'qs-widget-new-2d-dropdown-qs-li'
        },
        getQsWidget2DBottomSheetVariationSelectorCssClass: function () {
          return 'qs-widget-new-2d-dropdown-vs-li'
        },
        getQsWidgetVariationSelectorListMapKey: function () {
          return 'variationSelectorListsMap'
        },
        getQsWidgetVariationSelectorSelectedIdKey: function () {
          return 'selectedId'
        },
        getQsWidgetVariationSelectorDisplayTextKey: function () {
          return 'displayText'
        },
        getQsWidgetVariationSelectorDisplayTextWithQuantityKey: function () {
          return 'displayTextWithQuantity'
        },
        getQsWidgetStepperIncrementDecl: function () {
          return 'qs-widget-increment-decl'
        },
        getQsWidgetStepperDecrementDecl: function () {
          return 'qs-widget-decrement-decl'
        },
        getQsWidgetStepperDecrementMinusIconId: function (a) {
          return 'qs-widget-decrement-minus-icon-' + a
        },
        getQsWidgetStepperDecrementTrashIconId: function (a) {
          return 'qs-widget-decrement-trash-icon-' + a
        },
        getQsWidgetStepperAddToCartReftag: function () {
          return '_qs_atc'
        },
        getQsWidgetStepperDecrementReftag: function () {
          return '_qs_rm'
        },
        getQsWidgetStepperIncrementReftag: function () {
          return '_qs_add'
        },
        getQsWidgetBottomSheetReftag: function () {
          return '_qs_udt'
        },
        getQsWidgetStepperShapeType: function () {
          return 'QUANTITY_STEPPER'
        },
        getQsWidgetSimplifiedStepperShapeType: function () {
          return 'SIMPLIFIED_QUANTITY_STEPPER'
        },
      }
    })
  })
  ;('use strict')
  q.when('QSAssetDuplicationGuard').execute('qsMetadata-duplication-guard', function (n) {
    n.when('A', 'QuantitySelectorState', 'QuantitySelectorAUIDeps').register(
      'QuantitySelectorMetadata',
      function (f, a, c) {
        function h(c) {
          return (c = a.getQsWidgetConfiguration(c).metadata) ? JSON.parse(c) : null
        }
        return {
          isWeblabEnabled: function (a, c, f) {
            a: {
              if ((a = h(a)) && a.weblabs)
                for (var g = 0; g < a.weblabs.length; g++) {
                  var k = a.weblabs[g]
                  if (k.weblabName == c) {
                    c = k.treatment
                    break a
                  }
                }
              c = null
            }
            return null == c ? f : 'T1' == c ? !0 : !1
          },
          getMetaConfiguration: function (a, c) {
            return (a = h(a)) ? a[c] : null
          },
        }
      },
    )
  })
  ;('use strict')
  q.when('A', 'QSAssetDuplicationGuard').execute('qsMetrics-duplication-guard', function (n, f) {
    f.when('A', 'QuantitySelectorAUIDeps', 'QuantitySelectorConstants').register(
      'QuantitySelectorMetrics',
      function (a, c, f) {
        function g(a) {
          w.ue && w.ue.count && a && ue.count(a, (ue.count(a) || 0) + 1)
        }
        q.when('ready').execute(function () {
          a.now()
        })
        return {
          incrementInitializeCount: function (a, c) {
            var f = 'QuantitySelector-Initialize'
            f = a ? f + '-Success-Count' : f + '-Failed-Count'
            g(c ? f + ':mobile' : f + ':desktop')
          },
          incrementInvalidIdCount: function () {
            g('QuantitySelector-InvalidID')
          },
          incrementTriggerActionCount: function (a, c, f) {
            a = 'QuantitySelector-TriggerAction-' + a
            a = c ? a + '-Success-Count' : a + '-Failed-Count'
            g(f ? a + ':mobile' : a + ':desktop')
          },
          incrementChangeLinkCount: function () {
            g('QuantitySelector-ChangeLink-Count')
          },
          incrementShowPopup: function (a) {
            var c = 'QuantitySelector-ShowPopup-Count'
            g(a ? c + ':mobile' : c + ':desktop')
          },
          incrementQsItemNotFound: function (a, c) {
            var f = 'QuantitySelector-QsItemNotFound-Count'
            g(a ? f + ':mobile:' + c : f + ':desktop:' + c)
          },
          logLatencyMetric: function (a, c, f) {
            a = 'QuantitySelector-TimeTo-' + a
            w.ue &&
              w.ue.count &&
              a &&
              'undefined' !== typeof w.ue_t0 &&
              ((c -= w.ue_t0), ue.count(a, c), ue.count(a + 'Hundredths', Math.floor(c / 10)))
          },
          incrementQsWidgetFailToRender: function () {
            g('QuantitySelector-QsWidgetFailToRender-Count')
          },
          logCsm: function (a, g) {
            var h = c.aState.state(f.getQsWidgetConfigurationId(a))
            if (
              h &&
              ((a = 'mobile' == h.viewType.toLowerCase() ? 'mob' : 'dsk'),
              (h = h.qsCsm) && h.almBrandRefMarker && h.pageRefMarker)
            ) {
              a: {
                var k = h.sellingUomDimension
                var d = h.pricingUomDimension
                if (k && d) {
                  var m = 's'
                  switch (k) {
                    case 'count':
                      m += 'u'
                      break
                    case 'weight':
                      m += 'w'
                      break
                    default:
                      k = void 0
                      break a
                  }
                  m += 'p'
                  switch (d) {
                    case 'count':
                      m += 'u'
                      break
                    case 'weight':
                      m += 'w'
                      break
                    default:
                      k = void 0
                      break a
                  }
                  k = m
                } else k = void 0
              }
              k &&
                ((g = {
                  pageType: h.pageType,
                  subPageType: h.subPageType,
                  pageTypeId: h.pageTypeId,
                  storeName: h.tabId,
                  programRegionId: h.programRegionId,
                  hitType: h.hitType,
                  refMarker:
                    h.almBrandRefMarker + '_' + a + '_' + h.pageRefMarker + '_qs_' + g + '_' + k,
                  fromTabName: h.fromTabName,
                  toTabName: h.toTabName,
                }),
                w.ue &&
                  w.ue.event &&
                  ue.event(
                    g,
                    'quantityselector_attr',
                    'quantityselector.QuantityselectorMetrics.2',
                  ))
            }
          },
        }
      },
    )
  })
  ;('use strict')
  q.when('QSAssetDuplicationGuard').execute('qsState-duplication-guard', function (n) {
    n.when(
      'A',
      'QuantitySelectorConstants',
      'QuantitySelectorMetrics',
      'QuantitySelectorAUIDeps',
    ).register('QuantitySelectorState', function (f, a, c, h) {
      function g(c) {
        var d = h.aState.state(a.getQsWidgetConfigurationId(c))
        G(c) || (k(c), (d = h.aState.state(a.getQsWidgetConfigurationId(c))))
        return d
      }
      function k(c) {
        if (c) {
          var d = a.getQsWidgetConfigurationId(c),
            e = a.getQsWidgetStateScriptSelectorQuery(c)
          try {
            var l = f.$(e).first(),
              r = JSON.parse(l.html())
            h.aState.state(d, r)
            if (r && r.staticData) {
              var m = JSON.parse(r.staticData).asin
              t(m, c)
            }
          } catch (O) {
            if (((c = a.getQsWidgetConfigurationJsonString()), l.html().includes(c))) throw O
          }
        }
      }
      function G(c) {
        return (c = h.aState.state(a.getQsWidgetConfigurationId(c))) && c.id ? !0 : !1
      }
      function v(a) {
        var c = g(a),
          e = c.selectedId
        c = c.selectedQuantity
        0 == c || c ? d(a, c) : e && p(a, e)
      }
      function p(c, d) {
        d = { previousSelectedId: d, previousSelectedQuantity: null }
        h.aState.state(a.getQsWidgetConfigurationId(c), d)
      }
      function d(c, d) {
        d = { previousSelectedQuantity: d, previousSelectedId: null }
        h.aState.state(a.getQsWidgetConfigurationId(c), d)
      }
      function m() {
        for (
          var c = [],
            d = f.$(a.getQsWidgetGenericStateSelectorQuery()),
            e = a.getQsWidgetConfigurationId(''),
            l = 0;
          l < d.length;
          l++
        )
          try {
            var m = d[l].getAttribute('data-a-state'),
              g = JSON.parse(m).key
            if (g && g.substring(0, e.length) == e) {
              var h = g.substring(e.length)
              c.push(h)
            }
          } catch (D) {
            var k = a.getQsWidgetStateAttributeJsonString()
            if (m.includes(k)) throw D
          }
        return c
      }
      function t(a, c) {
        var d
        if ((d = a && c)) d = 'f3cart' !== g(c).clientId
        d && e(c) && (l[a] || (l[a] = new Set()), l[a].add(c))
      }
      function e(c) {
        c = g(c)
        return (
          c.shapeType === a.getQsWidgetStepperShapeType() ||
          c.shapeType === a.getQsWidgetSimplifiedStepperShapeType()
        )
      }
      var l = {}
      f.on(a.getQsWidgetEventConfigureList(), function (a) {
        'function' === typeof a && a(m())
      })
      f.on(a.getQsWidgetEventConfigureGet(), function (a, c) {
        a = g(a)
        'function' === typeof c && c(a)
      })
      f.on(a.getQsWidgetEventConfigureSet(), function (c, d) {
        h.aState.state.replace(a.getQsWidgetConfigurationId(c), d)
        f.trigger(a.getQsWidgetEventInitialize(), !0, c)
      })
      return {
        getQsWidgetConfiguration: g,
        loadQsWidgetStateConfiguration: function (a) {
          if (!G(a)) k(a)
          else if (a)
            try {
              var c = g(a),
                d = JSON.parse(c.staticData).asin
              t(d, a)
            } catch (y) {}
        },
        reloadQsWidgetStateConfiguration: k,
        saveOriginalSettings: function (a) {},
        setEnable: function (c, d) {
          d = { enable: d }
          h.aState.state(a.getQsWidgetConfigurationId(c), d)
        },
        setInitialized: function (c) {
          h.aState.state(a.getQsWidgetConfigurationId(c), { initialized: !0 })
        },
        setSelectedId: function (c, d, e) {
          'SIMPLIFIED_QUANTITY_STEPPER' !== g(c).shapeType &&
            (e || v(c),
            (d = { selectedId: d, selectedQuantity: null }),
            h.aState.state(a.getQsWidgetConfigurationId(c), d))
        },
        setSelectedQuantity: function (c, d, e) {
          e || v(c)
          d = { selectedId: null, selectedQuantity: d }
          h.aState.state(a.getQsWidgetConfigurationId(c), d)
        },
        setPreviousSelectedId: p,
        setPreviousSelectedQuantity: d,
        setData: function (c, d) {
          h.aState.state(a.getQsWidgetConfigurationId(c), d)
        },
        getQsUIDs: m,
        getQsWidgetMapSet: function (a) {
          return l[a]
        },
        isStepper: e,
      }
    })
  })
  ;('use strict')
  q.when('QSAssetDuplicationGuard').execute('qsTemplates-duplication-guard', function (n) {
    n.when(
      'A',
      'QuantitySelectorState',
      'QuantitySelectorConstants',
      'QuantitySelectorAUIDeps',
      'QuantitySelectorUtils',
    ).register('QuantitySelectorTemplates', function (f, a, c, h, g) {
      function k(a, c) {
        f.$('#' + a + ' .replace-qsUID').each(function () {
          var a = f.$(this).attr('id')
          f.$(this).attr('id', a.replace('qsUID', c))
        })
      }
      return {
        generateBottomSheet: function (h) {
          var v = g.getQsWidgetBottomSheetTemplateElement().clone(!0)
          v.appendTo(g.getQsWidgetContainer(h))
          v.attr('id', c.getQsWidgetBottomSheetContainerId(h))
          var p = a.getQsWidgetConfiguration(h)
          v.attr('cel_widget_id', 'qs-widget-metric-' + p.qsMetricID + '-bottomsheet')
          v.addClass(p.cssClass)
          k(c.getQsWidgetBottomSheetContainerId(h), h)
          g.getQsWidgetBottomSheetSelectQuantityTextElement(h).text(
            g.replaceNbspWithPlainTextNbsp(p.bottomSheetSelectQuantityText),
          )
          g.getQsWidgetBottomSheetUnitTextElement(h).text(
            g.replaceNbspWithPlainTextNbsp(p.bottomSheetSelectQuantityUnitText),
          )
          g.getQsWidgetBottomSheetUnitTextElement(h).attr(
            'aria-label',
            p.bottomSheetSelectQuantityUnitAriaLabelText,
          )
          g.getQsWidgetBottomSheetPpuTextElement(h).text(
            g.replaceNbspWithPlainTextNbsp(p.bottomSheetPricePerUnitText),
          )
          g.getQsWidgetBottomSheetPriceTextElement(h).text(
            g.replaceNbspWithPlainTextNbsp(p.estTotalPriceText),
          )
          g.getQsWidgetBottomSheetImageElement(h).attr('src', p.bottomSheetImageUrl)
          p.summaryDisclaimerText
            ? g
                .getQsWidgetSummaryDisclaimerElement(h)
                .text(g.replaceNbspWithPlainTextNbsp(p.summaryDisclaimerText))
            : (g
                .getQsWidgetBottomSheetTableElement(h)
                .attr('style', 'border-bottom: 0px solid !important;'),
              g.getQsWidgetSummaryDisclaimerContainerElement(h).remove())
          'right' === p.currencySymbolPosition &&
            g
              .getQsWidgetSummaryPriceSymbolElement(h)
              .insertAfter(g.getQsWidgetSummaryPriceFractionElement(h))
          v = g.getQsWidgetSummaryAtcButtonAsComponent(h)
          a.isStepper(h)
            ? v.text(g.replaceNbspWithPlainTextNbsp(p.bottomSheetUpdateCartText))
            : v.text(g.replaceNbspWithPlainTextNbsp(p.bottomSheetAddToCartText))
          f.declarative.create(g.getQsWidgetSummaryAtcButton(h), c.getQsWidgetSummaryAtcDecl(), {
            qsUID: h,
          })
        },
      }
    })
  })
  ;('use strict')
  q.when('QSAssetDuplicationGuard').execute('qsUtils-duplication-guard', function (n) {
    n.when(
      'A',
      'QuantitySelectorState',
      'QuantitySelectorConstants',
      'QuantitySelectorAUIDeps',
      'QuantitySelectorMetrics',
    ).register('QuantitySelectorUtils', function (f, a, c, h, g) {
      function k(b) {
        return 'true' == b || 1 == b ? !0 : !1
      }
      function n(b) {
        b = a.getQsWidgetConfiguration(b)
        return b.clientId ? b.clientId : 'unrec-client'
      }
      function v(b) {
        return 'mobile' == a.getQsWidgetConfiguration(b).viewType.toLowerCase() ? !0 : !1
      }
      function p(b) {
        return a.getQsWidgetConfiguration(b).shapeType === c.getQsWidgetSimplifiedStepperShapeType()
      }
      function d(b) {
        var c = a.getQsWidgetConfiguration(b)
        return p(b) ||
          ('undefined' != typeof c.showATCButtonWhenZeroQuantity && c.showATCButtonWhenZeroQuantity)
          ? !0
          : !1
      }
      function m(b) {
        b = a.getQsWidgetConfiguration(b)
        return k(b.showConfirmationView) ? !0 : !1
      }
      function t(b) {
        b = a.getQsWidgetConfiguration(b)
        return k(b.allowZeroQuantity) ? !0 : !1
      }
      function e(b) {
        return a.getQsWidgetConfiguration(b).initialView.toLowerCase() ==
          c.getQsWidgetInitialViewChooseQuantity()
          ? !0
          : !1
      }
      function l(b) {
        b = y(b)
        return null == b || 1 > b.length ? !1 : !0
      }
      function r(b) {
        if (b)
          try {
            var c = a.getQsWidgetConfiguration(b)
            return JSON.parse(c.staticData).storeId
          } catch (P) {}
      }
      function u(b) {
        b = a.getQsWidgetConfiguration(b).variationSelectorListsMap
        if (null == b) return null
        b = Object.keys(b)
        return null == b || 1 > b.length ? null : b[0]
      }
      function q(b, c) {
        var x = a.getQsWidgetConfiguration(b).variationSelectorListsMap
        if (null == x) return null
        null == c && (c = u(b))
        return null == c ? null : x[c]
      }
      function y(b, a) {
        b = q(b, a)
        return null == b ? null : b.selectorItems
      }
      function A(b) {
        return a.getQsWidgetConfiguration(b).bottomSheetChangeCurrentQuantityText
      }
      function N(b, a) {
        b = B(b, a).quantityText
        return '+' == b.substr(b.length - 1)
          ? { result: !0, initialQuantityText: b.substr(0, b.length - 1) }
          : { result: !1 }
      }
      function O(b, c) {
        var d = a.getQsWidgetConfiguration(b),
          x = d.qsItems.length
        d = d.allowZeroQuantity
        if (D(b)) {
          if (1 == c || (d && 2 == c)) return !0
        } else if (c == x || (c == x - 1 && d)) return !0
        return !1
      }
      function F(b, c) {
        var d = a.getQsWidgetConfiguration(b).qsItems
        if (D(b)) {
          if (c == d.length) return !0
        } else if (1 == c) return !0
        return !1
      }
      function D(b) {
        b = a.getQsWidgetConfiguration(b).qsItems
        return z(b[b.length - 1]) > z(b[0]) ? !0 : !1
      }
      function L(b) {
        var a = Q(b)
        a && f.trigger(c.getQsWidgetEventSelectQuantity(), b, a, !1)
        S(b)
        f.trigger(c.getQsWidgetEventInitialized(), b)
      }
      function T(b) {
        b.removeClass('aok-hidden')
      }
      function ha(b) {
        var a = f.$('#' + c.getQsWidgetQuantityChangelinkId(b))
        b = f.$('#' + c.getQsWidgetTextInputUpdateButtonId(b))
        a.attr('draggable', 'false')
        b.attr('draggable', 'false')
      }
      function I(b) {
        return f.$('#' + c.getQsWidgetContainerId(b))
      }
      function ia(b) {
        return f.$('#' + c.getQsWidgetButtonContainerId(b))
      }
      function J(b) {
        return h.aButton('#' + c.getQsWidgetButtonId(b))
      }
      function U(b) {
        return f.$('#' + c.getQsWidgetStepperId(b))
      }
      function V(b) {
        return h.aButton('#' + c.getQsWidgetAtcButtonId(b))
      }
      function W(b) {
        return h.aButton('#' + c.getQsWidgetPlusButtonId(b))
      }
      function X(b) {
        return f.$('#' + c.getQsWidgetButtonId(b) + '-announce')
      }
      function ja(b) {
        return f.$('#' + c.getQsWidgetDropdownContainerId(b))
      }
      function ka(b) {
        return f.$('#' + c.getQsWidgetDropdownViewId(b))
      }
      function R(b) {
        return f.$('#' + c.getQsWidgetVariationDropdownViewId(b))
      }
      function Y(b) {
        return f.$('#' + c.getQsWidgetDropdownUnorderedListId(b))
      }
      function la(b) {
        return f.$('#' + c.getQsWidgetTextInputContainerId(b))
      }
      function K(b) {
        return f.$('#' + c.getQsWidgetTextInputId(b))
      }
      function ma(b) {
        return f.$('#' + c.getQsWidgetTextInputUpdateButtonContainerId(b))
      }
      function na(b) {
        return f.$('#' + c.getQsWidgetSummaryAtcId(b))
      }
      function oa(b) {
        return h.aButton('#' + c.getQsWidgetSummaryAtcId(b))
      }
      function pa(b) {
        return f.$('#' + c.getQsWidgetBottomSheetPriceTextId(b))
      }
      function Z(b) {
        return f.$('#' + c.getQsWidgetStepperDecrementMinusIconId(b))
      }
      function aa(b) {
        return f.$('#' + c.getQsWidgetStepperDecrementTrashIconId(b))
      }
      function B(b, c) {
        try {
          var d = a.getQsWidgetConfiguration(b)
          if (d.qsItems) {
            var x = d.qsItems[parseInt(c) - 1]
            return x.id === c ? x : qa(b, c)
          }
        } catch (C) {
          return qa(b, c)
        }
      }
      function qa(b, c) {
        b = a.getQsWidgetConfiguration(b)
        for (var d = 0; d < b.qsItems.length; d++) if (b.qsItems[d].id == c) return b.qsItems[d]
      }
      function z(b) {
        return parseFloat(JSON.parse(b.data).quantity)
      }
      function ra(b, a) {
        var d = q(b, a)
        if (null == d) return null
        d = d[c.getQsWidgetVariationSelectorSelectedIdKey()]
        if (null == d) return sa(b)
        b = y(b, a)
        if (null == b) return null
        for (a = 0; a < b.length; a++) if (b[a].id == d) return b[a]
        return null
      }
      function sa(b, a) {
        b = y(b, a)
        if (null == b) return null
        for (a = 0; a < b.length; a++) if (k(b[a].isSelected)) return b[a]
        return null
      }
      function ba(b) {
        var c = a.getQsWidgetConfiguration(b).selectedId
        return c ? c : ta(b)
      }
      function ta(b) {
        b = a.getQsWidgetConfiguration(b)
        if (b.qsItems && 0 != b.qsItems.length) {
          for (var c = 0; c < b.qsItems.length; c++)
            if (k(b.qsItems[c].isSelected)) return b.qsItems[c].id
          return b.qsItems[0].id
        }
      }
      function ua(b, a) {
        var d = q(b, a)
        if (null == d) return null
        d = d[c.getQsWidgetVariationSelectorSelectedIdKey()]
        return null != d ? d : va(b, a)
      }
      function va(b, a) {
        b = sa(b)
        return null == b ? null : b.id
      }
      function Q(b) {
        return a.getQsWidgetConfiguration(b).selectedQuantity
      }
      function wa(b, a) {
        return 0 > a ? b[0].id : a >= b.length ? b[b.length - 1].id : b[a].id
      }
      function xa(b, a) {
        if (null == b) return 0
        for (var c = 0; c < b.length; c++) if (a == b[c].id) return c
      }
      function ca(b, a) {
        return (b = A(b)) ? a + b : 'Current quantity ' + a
      }
      function da(b, a) {
        return (t(b) ? /^(([0-9]\d{0,2}))$/ : /^(([1-9]\d{0,2})|(0[1-9]\d?)|(00[1-9]))$/).test(a)
      }
      function ya(b, a) {
        var c = la(b),
          d = ma(b)
        ia(b).addClass('aok-hidden')
        T(c)
        var e = K(b)
        a && e.val(a)
        a = e.val()
        da(b, a) && Q(b) !== a ? T(d) : d.addClass('aok-hidden')
        v(b)
          ? e.focus()
          : setTimeout(function () {
              e.focus()
            }, 200)
      }
      function S(b) {
        if (b) {
          var a = f.$('#' + c.getQsWidgetCheckboxId(b)),
            d = I(b)
          b = f.$('#' + c.getQsWidgetSpinnerId(b))
        } else
          (a = f.$(c.getQsWidgetInputSelectorQueryForCheckboxes())),
            (b = f.$(c.getQsWidgetDivSelectorQueryForSpinners())),
            (d = f.$(c.getQsWidgetDivSelectorQueryForWidgetContainers()))
        a.remove()
        b.remove()
        d.removeClass('qs-widget-hidden')
      }
      function za(b, c) {
        c = c.displayTextWithQuantityList
        var d = a.getQsWidgetConfiguration(b).qsItems
        b = ba(b)
        for (var e = 0; e < d.length; e++) if (d[e].id == b) return c[e]
        return null
      }
      function Aa(b, a) {
        null == a && (a = u(b))
        if (null == a) return {}
        var d = ra(b, a)
        if (null == d) return {}
        var e = v(b) ? d.displayTextForMobile : d.dissplayTextForDesktop
        b = za(b, d)
        var x = {}
        x[a] = JSON.parse(d.data)
        x[a][c.getQsWidgetVariationSelectorDisplayTextKey()] = e
        x[a][c.getQsWidgetVariationSelectorDisplayTextWithQuantityKey()] = b
        return x
      }
      function Ba(b, a) {
        b = q(b, a)
        return null == b || null == b.actionTriggerId || '' == b.actionTriggerId
          ? null
          : b.actionTriggerId
      }
      function ea(b, d, e, h, m) {
        m = a.getQsWidgetConfiguration(b)
        var x = m.selectedId,
          P = m.selectedQuantity,
          g = a.isStepper(b)
        h = g && h != c.getQsWidgetStepperAddToCartReftag()
        var E = a.getQsWidgetConfiguration(b)
        var r = E.previousSelectedQuantity
        E = E.previousSelectedId
        r = r ? r : E ? z(B(b, E)) : null
        E = JSON.parse(m.staticData)
        var k = m.sellingUnit,
          t = m.sellingDimension
        if (x)
          for (var u = 0; u < m.qsItems.length; u++)
            if (m.qsItems[u].id == x) {
              var C = JSON.parse(m.qsItems[u].data)
              C = f.$.extend(
                {
                  qsUID: b,
                  prevSelectedQty: r,
                  isStepperFlag: g,
                  setQuantityFlag: h,
                  tunneledData: d,
                  quantityData: C,
                  sellingUnit: k,
                  sellingDimension: t,
                },
                E,
                C,
              )
              l(b) && (C = f.$.extend(C, Aa(b, e)))
            }
        if (P || 0 == P)
          (C = f.$.extend(
            {
              qsUID: b,
              prevSelectedQty: r,
              isStepperFlag: g,
              setQuantityFlag: h,
              tunneledData: d,
              sellingUnit: k,
              sellingDimension: t,
            },
            E,
            { quantity: P },
          )),
            l(b) && (C = f.$.extend(C, Aa(b, e)))
        return C
      }
      function Ca(b) {
        var c = a.getQsWidgetConfiguration(b)
        if (p(b)) return c.pricePerUnitText ? c.pricePerUnitText : 'bcPrice'
        b = B(b, 1)
        if (!b || !b.price) return ''
        b = b.price
        return b.currencySymbol + b.wholeValue + b.decimalSeparator + b.fractionValue
      }
      function fa(b) {
        return b.replace(/&nbsp;/g, '')
      }
      var H = []
      f.on(c.getQsWidgetEventTriggerAction(), function (b, d, e, l, m) {
        var x = a.getQsWidgetConfiguration(b)
        d || (d = x.actionId)
        x = 'mobile' == x.viewType.toLowerCase()
        var h = !1
        ;(b = ea(b, e, null, l, m)) && b.ref && null != l && (b.reftag = b.ref + l)
        b &&
          (f.trigger(c.getQsWidgetEventAction(d), b),
          g.incrementTriggerActionCount(d, !0, x),
          (h = !0))
        h || g.incrementTriggerActionCount(d, !1, x)
      })
      f.on(c.getQsWidgetVariationEventTriggerAction(), function (b, d, e, l) {
        var x = 'mobile' == a.getQsWidgetConfiguration(b).viewType.toLowerCase()
        e = ea(b, e)
        null == d && (d = Ba(b, l))
        null != d &&
          (f.trigger(c.getQsWidgetEventAction(d), e), g.incrementTriggerActionCount(d, !1, x))
      })
      return {
        isInitialized: function (b) {
          return (b = a.getQsWidgetConfiguration(b)) ? b.initialized : !1
        },
        isMobile: v,
        isSimplifiedStepper: p,
        isQsWidgetEnabled: function (b) {
          b = a.getQsWidgetConfiguration(b)
          return b.hasOwnProperty('enable') ? k(b.enable) : !0
        },
        isQsWidgetQuantityZero: function (b) {
          var c = a.getQsWidgetConfiguration(b)
          return (c.selectedId && 0 == z(B(b, c.selectedId))) ||
            (c.selectedQuantity && '0' == c.selectedQuantity)
            ? !0
            : !1
        },
        isConfirmationViewEnabled: m,
        isAllowZeroQuantityEnabled: t,
        isInitialViewDropdown: function (b) {
          return a.getQsWidgetConfiguration(b).initialView.toLowerCase() ==
            c.getQsWidgetInitialViewDropdown()
            ? !0
            : !1
        },
        isInitialViewTextLink: function (b) {
          return a.getQsWidgetConfiguration(b).initialView.toLowerCase() ==
            c.getQsWidgetInitialViewTextLink()
            ? !0
            : !1
        },
        isInitialViewChooseQuantity: e,
        isVariationSelectorEnabled: l,
        getVariationSelectorItemList: q,
        getQsWidgetBottomSheetConfig: function (b) {
          var d = a.getQsWidgetConfiguration(b),
            e = c.getQsWidgetBottomSheetHeightConfig(d.enabledBottomSheetWith2DSupport),
            f = 0
          d.summaryDisclaimerText ||
            (f = m(b) ? e.disclaimerTextAdjustmentWithAtc : e.disclaimerTextAdjustment)
          return m(b)
            ? { closeMessage: d.bottomSheetCancelText, height: e.heightWithAtc - f }
            : { closeMessage: d.bottomSheetDoneText, height: e.height - f }
        },
        getQsWidgetBottomSheetChangeCurrentQuantityText: A,
        isActionTriggerOnConfirmation: function (b) {
          return a.getQsWidgetConfiguration(b).actionTrigger.toLowerCase() ==
            c.getQsWidgetActionTriggerOnConfirmation()
            ? !0
            : !1
        },
        isActionTriggerOnSelect: function (b) {
          return a.getQsWidgetConfiguration(b).actionTrigger.toLowerCase() ==
            c.getQsWidgetActionTriggerOnSelect()
            ? !0
            : !1
        },
        isVariationSelectorTriggerOnSelect: function (b) {
          return null == b
            ? !1
            : b.actionTriggerType.toLowerCase() == c.getQsWidgetActionTriggerOnSelect()
        },
        isVariationSelectorTriggerOnConfirmation: function (b) {
          return null == b
            ? !1
            : b.actionTriggerType.toLowerCase() == c.getQsWidgetActionTriggerOnConfirmation()
        },
        isTextInputRequired: N,
        isOrderMin: O,
        isOrderMax: F,
        isAscending: D,
        initializeWidget: function (b) {
          if (p(b)) L(b)
          else {
            var d = ba(b),
              e = Q(b),
              m = a.getQsWidgetConfiguration(b)
            if (m.qsItems)
              for (var h = 0; h < m.qsItems.length; h++)
                parseFloat(e) === z(m.qsItems[h]) && ((d = m.qsItems[h].id), (e = null))
            e
              ? f.trigger(c.getQsWidgetEventSelectQuantity(), b, e, !1, function () {
                  ha(b)
                })
              : d &&
                f.trigger(c.getQsWidgetEventSelectId(), b, d, !1, function () {
                  ha(b)
                })
            l &&
              ((d = ua(b)),
              null != d &&
                f.trigger(c.getQsWidgetVariationEventSelectId(), b, d, !1, function () {}))
            S(b)
            f.trigger(c.getQsWidgetEventInitialized(), b)
          }
        },
        activateWidget: function (b) {
          var a = H.indexOf(b)
          ;-1 < a && H.splice(a, 1)
          setTimeout(function () {
            H.push(b)
          }, c.getQsWidgetActivateDebounce())
        },
        deactivateWidget: function (b) {
          b = H.indexOf(b)
          ;-1 < b && H.splice(b, 1)
        },
        getActivatedQsWidgets: function () {
          return H
        },
        hideComponent: function (b, a) {
          b.addClass('aok-hidden')
        },
        showComponent: T,
        isComponentVisible: function (b) {
          return !b.hasClass('aok-hidden')
        },
        isElementVisible: function (b) {
          return 'hidden' !== b.css('visibility')
        },
        setElementVisibility: function (b, a) {
          a ? b.css('visibility', 'visible') : b.css('visibility', 'hidden')
        },
        setHtml: function (b, a) {
          b.html(a)
        },
        setAtcButtonStepperText: function (b) {
          if (a.isStepper(b) && e(b)) {
            var c = a.getQsWidgetConfiguration(b),
              d = oa(b)
            d.text(fa(c.bottomSheetUpdateCartText))
            ;((c.selectedId && 0 == z(B(b, c.selectedId))) || '0' == c.selectedQuantity) &&
              d.text(fa(c.bottomSheetAddToCartText))
          }
        },
        setQsWidgetContainerMinWidthAndHeight: function (b) {
          b = I(b)
          b.css('min-width', b.width() + 'px')
          b.css('min-height', b.height() + 'px')
        },
        resetQsWidgetContainerMinWidthAndHeight: function (b) {
          b = I(b)
          b.css('min-width', '0px')
          b.css('min-height', '0px')
        },
        enableQsWidget: function (b) {
          a.setEnable(b, !0)
          if (!p()) {
            var c = J(b)
            b = K(b)
            c.enable()
            b.removeClass('a-form-disabled')
            b.addClass('a-form-normal')
            b.removeAttr('disabled')
          }
        },
        disableQsWidget: function (b) {
          a.setEnable(b, !1)
          if (!p()) {
            var c = J(b)
            b = K(b)
            c.disable()
            b.removeClass('a-form-normal')
            b.addClass('a-form-disabled')
            b.attr('disabled', 'disabled')
          }
        },
        popOutDropDownContainer: function (b) {
          var c = I(b),
            d = c.offset(),
            e = ja(b),
            l = d.left,
            m = d.top,
            h = 'unset',
            g = f.$(w).height(),
            r = a.getQsWidgetConfiguration(b).dropdownAnchorId
          b = r.startsWith('qs-widget-container') ? c : f.$('#' + r)
          if (r && b.length) {
            for (r = b; !r.is(document) && 'static' === r.css('position'); ) r = r.parent()
            m -= null === r.offset() ? 0 : r.offset().top
            l -= null === r.offset() ? 0 : r.offset().left
            e.appendTo(b)
            r.is(document) || (g = r.height())
          } else e.appendTo(document.body)
          l + e.width() > w.scrollX + f.$(w).width() && (l = l + c.width() - e.width())
          d.top - w.scrollY + e.height() > f.$(w).height() &&
            ((h = g - m - c.height()), (m = 'unset'))
          e.css({ left: l, top: m, bottom: h })
        },
        getQsWidgetContainer: I,
        getQsWidgetButtonContainer: ia,
        getQsWidgetButtonAsComponent: J,
        getQsWidgetStepperElement: U,
        getQsWidgetAtcButtonAsComponent: V,
        getQsWidgetButton: X,
        getQsWidgetDropdownContainer: ja,
        getQsWidgetDropdownElement: function (b) {
          return f.$('#' + c.getQsWidgetDropdownId(b))
        },
        getQsWidgetDropdownViewSelector: ka,
        getQsWidgetVariationDropdownViewSelector: R,
        getQsWidgetDropdownUnorderedListElement: Y,
        getQsWidgetDropdownVariationUnorderedListElement: function (b) {
          return f.$('#' + c.getQsWidgetDropdownVariationUnorderedListId(b))
        },
        getQsWidgetDropdownItemElement: function (b, a) {
          return f.$('#' + c.getQsWidgetDropdownItemAriaId(b, a))
        },
        getQsWidgetPlusButtonAsComponent: W,
        getQsWidgetTextInputContainer: la,
        getQsWidgetTextInputElement: K,
        getQsWidgetTextInputUpdateButtonContainer: ma,
        getQsWidgetQuantityContainer: function (b) {
          return f.$('#' + c.getQsWidgetQuantityContainerId(b))
        },
        getQsWidgetQuantityElement: function (b) {
          return f.$('#' + c.getQsWidgetQuantityId(b))
        },
        getQsWidgetQuantitySuffixElement: function (b) {
          return f.$('#' + c.getQsWidgetQuantitySuffixId(b))
        },
        getQsWidgetInitialViewSuffixElement: function (b) {
          return f.$('#' + c.getQsWidgetInitialViewSuffixId(b))
        },
        getQsWidgetSummaryAtcButton: na,
        getQsWidgetSummaryAtcButtonAsComponent: oa,
        getQsWidgetSummaryPriceContainerElement: function (b) {
          return f.$('#' + c.getQsWidgetSummaryPriceId(b))
        },
        getQsWidgetSummaryPriceSymbolElement: function (b) {
          return f.$('#' + c.getQsWidgetSummaryPriceSymbolId(b))
        },
        getQsWidgetSummaryPriceWholeElement: function (b) {
          return f.$('#' + c.getQsWidgetSummaryPriceWholeId(b))
        },
        getQsWidgetSummaryPriceFractionElement: function (b) {
          return f.$('#' + c.getQsWidgetSummaryPriceFractionId(b))
        },
        getQsWidgetSummaryPriceDecimalElement: function (b) {
          return f.$('#' + c.getQsWidgetSummaryPriceDecimalId(b))
        },
        getQsWidgetSummaryDisclaimerElement: function (b) {
          return f.$('#' + c.getQsWidgetSummaryDisclaimerId(b))
        },
        getQsWidgetSummaryDisclaimerContainerElement: function (b) {
          return f.$('#' + c.getQsWidgetSummaryDisclaimerContainerId(b))
        },
        getQsWidgetFooterPriceContainer: function (b) {
          return f.$('#' + c.getQsWidgetFooterPriceContainerId(b))
        },
        getQsWidgetFooterPriceSymbolElement: function (b) {
          return f.$('#' + c.getQsWidgetFooterPriceSymbolId(b))
        },
        getQsWidgetFooterPriceWholeElement: function (b) {
          return f.$('#' + c.getQsWidgetFooterPriceWholeId(b))
        },
        getQsWidgetFooterPriceFractionElement: function (b) {
          return f.$('#' + c.getQsWidgetFooterPriceFractionId(b))
        },
        getQsWidgetFooterPriceDecimalElement: function (b) {
          return f.$('#' + c.getQsWidgetFooterPriceDecimalId(b))
        },
        getQsWidgetFooterQuantitySuffixContainer: function (b) {
          return f.$('#' + c.getQsWidgetFooterQuantitySuffixContainerId(b))
        },
        getQsWidgetFooterQuantitySuffixElement: function (b) {
          return f.$('#' + c.getQsWidgetFooterQuantitySuffixId(b))
        },
        getQsWidgetBottomSheetQuantitySuffixElement: function (b) {
          return f.$('#' + c.getQsWidgetBottomSheetQuantitySuffixId(b))
        },
        getQsWidgetBottomSheetPriceTextElement: pa,
        getQsWidgetBottomSheetTemplateElement: function () {
          return f.$('#' + c.getQsWidgetBottomSheetTemplateId())
        },
        getQsWidgetBottomSheetSelectQuantityTextElement: function (b) {
          return f.$('#' + c.getQsWidgetBottomSheetSelectQuantityTextId(b))
        },
        getQsWidgetBottomSheetImageElement: function (b) {
          return f.$('#' + c.getQsWidgetBottomSheetImageId(b))
        },
        getQsWidgetBottomSheetUnitTextElement: function (b) {
          return f.$('#' + c.getQsWidgetBottomSheetUnitTextId(b))
        },
        getQsWidgetBottomSheetTableElement: function (b) {
          return f.$('#' + c.getQsWidgetBottomSheetTableId(b))
        },
        getQsWidgetBottomSheetPpuTextElement: function (b) {
          return f.$('#' + c.getQsWidgetBottomSheetPpuTextId(b))
        },
        getQsWidgetInitialViewTextLinkElement: function (b) {
          return f.$('#' + c.getQsWidgetInitialViewTextLinkId(b))
        },
        getQsWidgetAtcButton: function (b) {
          return f.$('#' + c.getQsWidgetAtcButtonId(b))
        },
        getQsWidgetPlusButton: function (b) {
          return f.$('#' + c.getQsWidgetPlusButtonId(b))
        },
        getQsWidgetMinusButton: function (b) {
          return f.$('#' + c.getQsWidgetMinusButtonId(b))
        },
        getQsWidgetStepperDecrementMinusIconElement: Z,
        getQsWidgetStepperDecrementTrashIconElement: aa,
        getQsItem: B,
        getQsItemQuantity: z,
        getClientId: n,
        getClosestDecrementalQsItem: function (b, c) {
          b = a.getQsWidgetConfiguration(b).qsItems
          for (var d = Number.MAX_SAFE_INTEGER, e = 0, f = 0; f < b.length; f++) {
            var l = c - z(b[f])
            0 <= l && l < d && ((d = l), (e = f))
          }
          return b[e]
        },
        getClosestIncrementalQsItem: function (b, c) {
          b = a.getQsWidgetConfiguration(b).qsItems
          for (var d = Number.MAX_SAFE_INTEGER, e = 0, f = 0; f < b.length; f++) {
            var l = z(b[f]) - c
            0 <= l && l < d && ((d = l), (e = f))
          }
          return b[e]
        },
        getNextDecrementQsItem: function (b, c) {
          var d = a.getQsWidgetConfiguration(b).qsItems
          c = parseInt(c)
          D(b) && 0 < c - 1 ? --c : !D(b) && c + 1 <= d.length && (c += 1)
          return B(b, c)
        },
        getNextIncrementQsItem: function (b, c) {
          var d = a.getQsWidgetConfiguration(b).qsItems
          c = parseInt(c)
          D(b) && c + 1 <= d.length ? (c += 1) : !D(b) && 0 < c - 1 && --c
          return B(b, c)
        },
        getVariationSelectorItemById: function (b, a, c) {
          b = y(b, c)
          if (null == b) return null
          for (c = 0; c < b.length; c++) if (b[c].id == a) return b[c]
          return null
        },
        getSelectedVariationSelectorItem: ra,
        getSelectedQsItemId: ba,
        getInitialSelectedQsItemId: ta,
        getSelectedQuantity: Q,
        getInitialSelectedVariationSelectorItemId: va,
        getSelectedVariationSelectorItemIdData: function (a, d, e) {
          null == e && (e = u(a))
          if (null == e) return null
          a = {}
          a[c.getQsWidgetVariationSelectorSelectedIdKey()] = d
          d = {}
          d[c.getQsWidgetVariationSelectorListMapKey()] = {}
          d[c.getQsWidgetVariationSelectorListMapKey()][e] = a
          return d
        },
        getSelectedVariationSelectorItemId: ua,
        getQsItemFromQuantityTextOrQuantity: function (b, c) {
          b = a.getQsWidgetConfiguration(b).qsItems
          if (!b) return null
          for (var d = 0; d < b.length; d++)
            if (
              ('string' === typeof c && c.toLowerCase() == b[d].quantityText.toLowerCase()) ||
              parseFloat(c) == z(b[d])
            )
              return b[d]
        },
        getQsItemFromQuantity: function (b, c) {
          b = a.getQsWidgetConfiguration(b)
          b = b.qsItems ? b.qsItems : {}
          c = parseFloat(c)
          for (var d = 0; d < b.length; d++) if (z(b[d]) == c) return b[d]
        },
        getFocusedQsItemIdInBottomSheet: function (b) {
          var d = ka(b).scrollTop(),
            e = c.getQsWidgetBottomSheetDropDownScrollFactor()
          d = parseInt((d - e.constant + e.adjustment) / e.increment)
          b = a.getQsWidgetConfiguration(b).qsItems
          return wa(b, d)
        },
        getFocusedVariationSelectorItemIdInBottomSheet: function (a, d) {
          var b = R(a)
          if (null == b) return null
          b = b.scrollTop()
          var e = c.getQsWidgetBottomSheetDropDownScrollFactor()
          b = parseInt((b - e.constant + e.adjustment) / e.increment)
          a = y(a, d)
          return wa(a, b)
        },
        getIndexFromIdInBottomSheet: function (b, c) {
          b = a.getQsWidgetConfiguration(b).qsItems
          return xa(b, c)
        },
        getAriaLabelTextForSelectOption: ca,
        getVariationSelectorIndexFromIdInBottomSheet: function (a, c, d) {
          a = y(a, d)
          return xa(a, c)
        },
        saveQsWidgetDropdownTopPosition: function (b) {
          var c = Y(b)
          c && c.position() && ((c = c.position().top), a.setData(b, { scrollTop: c }))
          return !1
        },
        setQsWidgetDropdownScrolled: function (b) {
          a.setData(b, { scrollTop: -65536 })
        },
        clearQsWidgetDropdownScrolled: function (b) {
          a.setData(b, { scrollTop: c.getQsWidgetDropdownScrollMetricThreshold() })
        },
        isQsWidgetDropdownScrolled: function (b) {
          var d = Y(b)
          return d
            ? ((d = d.position().top),
              (b = a.getQsWidgetConfiguration(b).scrollTop)
                ? Math.abs(d - b) > c.getQsWidgetDropdownScrollMetricThreshold()
                : !1)
            : !1
        },
        generateQsDropdownDOM: function (b) {
          var d = '',
            e = a.getQsWidgetConfiguration(b),
            f = e.qsItems
          e = e.selectedId
          var m = v(b)
          if (!f) return g.incrementQsWidgetFailToRender(), ''
          for (var h = 0; h < f.length; h++) {
            var r = f[h].id,
              k = f[h].quantityText,
              t = f[h].quantityTextAbbreviatedSuffix
            if (m) {
              var u = b
              var n = t,
                p = B(u, r)
              t = k
              if (n) {
                var q = n.indexOf('\x3c')
                if (-1 != q) {
                  var y = n.indexOf('\x3c', q + 1)
                  if ((n = n.substring(q, y)))
                    (n = n.split('\x3e')[1]),
                      (t += '. '),
                      (q = n),
                      (n = a.getQsWidgetConfiguration(u).estText),
                      (t += n ? n + ' ' + q : 'Total est. ' + q)
                } else t = t + '.' + n
              }
              p = p.price
              n = pa(u).html()
              t =
                t +
                '. ' +
                n +
                ' ' +
                (p.currencySymbol + p.wholeValue + p.decimalSeparator + p.fractionValue)
              p = l(u)
                ? c.getQsWidget2DBottomSheetQuantitySelectorCssClass()
                : c.getQsWidget1DBottomSheetSelectorCssClass()
              n = c.getQsWidgetDropdownItemId(u, r)
              q = c.getQsWidgetDropdownItemDecl()
              u =
                '\x3cspan class\x3d"a-declarative" data-action\x3d"' +
                q +
                '" data-' +
                q +
                '\x3d"{\x26quot;qsUID\x26quot;:\x26quot;' +
                u +
                '\x26quot;,\x26quot;id\x26quot;:' +
                r +
                '}"\x3e\x3cli tabindex\x3d"-1" role\x3d"option" id\x3d"' +
                n +
                '" aria-label\x3d"' +
                t +
                '" class\x3d"' +
                p +
                '"\x3e' +
                k +
                '\x3c/li\x3e\x3c/span\x3e'
            } else {
              u = b
              var w = t
              t = f[h].id == e
              p = c.getQsWidgetDropdownItemId(u, r)
              n = c.getQsWidgetDropdownItemAriaId(u, r)
              var M = c.getQsWidgetDropdownItemQuantitySuffixId(u, r)
              q = c.getQsWidgetDropdownDecl(u)
              y = ''
              w &&
                (y =
                  '\x3cspan id\x3d"' +
                  M +
                  '" class\x3d"a-size-mini a-color-tertiary"\x3e' +
                  w +
                  '\x3c/span\x3e')
              w = 'false'
              M = 'qs-widget-dropdown-link'
              t && ((w = 'true'), (M += ' qs-widget-dropdown-link-active aok-block aok-nowrap'))
              u =
                '\x3cspan class\x3d"a-declarative" data-action\x3d"' +
                q +
                '" data-' +
                q +
                '\x3d"{\x26quot;qsUID\x26quot;:\x26quot;' +
                u +
                '\x26quot;,\x26quot;id\x26quot;:' +
                r +
                '}"\x3e\x3cli tabindex\x3d"-1" role\x3d"option" id\x3d"' +
                p +
                '" aria-labelledby\x3d"' +
                n +
                '" aria-checked\x3d"' +
                w +
                '" class\x3d"qs-widget-dropdown-item"\x3e\x3ca tabindex\x3d"0" href\x3d"javascript:void(0)" draggable\x3d"false" id\x3d"' +
                n +
                '" class\x3d"' +
                M +
                '"\x3e' +
                k +
                '\x26nbsp;\x26nbsp;' +
                y +
                '\x3c/a\x3e\x3c/li\x3e\x3c/span\x3e'
            }
            d += u
          }
          return d
        },
        generateVariationSelectorDOM: function (a, d) {
          if (!v(a)) return ''
          d = y(a, d)
          for (var b = '', e = 0; e < d.length; e++) {
            var f = a,
              l = d[e].id,
              h = d[e].displayTextForMobile,
              m = d[e].ariaLabelText,
              g = c.getQsWidget2DBottomSheetVariationSelectorCssClass(),
              r = c.getQsWidgetDropdownItemId(f, l)
            c.getQsWidgetDropdownItemAriaId(f, l)
            var t = c.getQsWidgetVariationDropdownItemDecl()
            b +=
              '\x3cspan class\x3d"a-declarative" data-action\x3d"' +
              t +
              '" data-' +
              t +
              '\x3d"{\x26quot;qsUID\x26quot;:\x26quot;' +
              f +
              '\x26quot;,\x26quot;id\x26quot;:\x26quot;' +
              l +
              '\x26quot;}"\x3e\x3cli tabindex\x3d"-1" role\x3d"option" id\x3d"' +
              r +
              '" aria-label\x3d"' +
              m +
              '" class\x3d"' +
              g +
              '"\x3e' +
              h +
              '\x3c/li\x3e\x3c/span\x3e'
          }
          return b
        },
        isQsWidgetTextInputValid: da,
        validateQsWidgetTextInput: function (a) {
          var b = K(a),
            d = b.val()
          a = da(a, d)
          var e = b.parent().hasClass(c.getQsWidgetAuiInputTextWrapperClass()) ? b.parent() : b
          if (a)
            return (
              b.val(d.replace(/^0{2,}$/, '0').replace(/^0+(\d+)/g, '$1')),
              e.removeClass('a-form-error'),
              e.addClass('a-form-normal'),
              !0
            )
          e.removeClass('a-form-normal')
          e.addClass('a-form-error')
          return !1
        },
        isUserClickInDropdown: function (a) {
          var b = c.getQsWidgetDropdownContainerGenericId()
          for (a = null == a ? null : a.target; null != a; ) {
            if (a.id.substring(0, b.length) === b) return !0
            a = a.parentElement
          }
          return !1
        },
        updateQsWidgetStepper: function (b, c) {
          if (a.isStepper(b)) {
            var e = B(b, c),
              f = e.selectedText
            J(b).text(f)
            X(b).attr('aria-label', ca(b, f))
            var l = Z(b),
              h = aa(b),
              m = W(b)
            f = U(b)
            var g = V(b)
            O(b, c) || 0 == z(e)
              ? (l.addClass('aok-hidden'), h.removeClass('aok-hidden'))
              : (l.removeClass('aok-hidden'), h.addClass('aok-hidden'))
            F(b, c)
              ? ((c = N(b, c)),
                c.result ? ya(b, c.initialQuantityText) : 'icdp' == n(b) ? m.hide() : m.disable())
              : 'icdp' == n(b)
                ? m.show()
                : m.enable()
            c = a.getQsWidgetConfiguration(b)
            d(b) &&
              (0 == z(e) || '0' == c.selectedQuantity
                ? (f.addClass('aok-hidden'), g.show())
                : (g.hide(), f.removeClass('aok-hidden')))
          }
        },
        updateSimplifiedQsWidgetStepper: function (b, c) {
          if (p(b)) {
            var d = a.getQsWidgetConfiguration(b)
            J(b).text(c)
            X(b).attr('aria-label', ca(b, c))
            var e = Z(b),
              f = aa(b),
              l = W(b),
              m = U(b)
            b = V(b)
            0 == c || 1 == c
              ? (e.addClass('aok-hidden'), f.removeClass('aok-hidden'))
              : (e.removeClass('aok-hidden'), f.addClass('aok-hidden'))
            c >= d.maxQuantity ? l.disable() : l.enable()
            0 == c ? (m.addClass('aok-hidden'), b.show()) : (b.hide(), m.removeClass('aok-hidden'))
          }
        },
        showTextInput: ya,
        hideSpinner: S,
        EnableVariationSelector: function (a) {
          a && R(a).removeClass('qs-widget-disable')
        },
        DisableVariationSelector: function (a) {
          a && R(a).addClass('qs-widget-disable')
        },
        getVariationSelectorDisplayTextWithQuantity: za,
        getVariationSelectorActionTriggerId: Ba,
        getQsWidgetSelectionPayload: ea,
        isSUPU: function (b) {
          var c = a.getQsWidgetConfiguration(b).qsCsm
          if (c && ((b = c.sellingUomDimension), (c = c.pricingUomDimension), b && c))
            return 'count' == b && 'count' == c ? !0 : !1
        },
        showATCButtonWhenZeroQuantity: d,
        isConfirmationVisible: function (a) {
          return na(a).is(':visible')
        },
        isBottomSheetExist: function (a) {
          return h.aSheet.get(c.getQsWidgetBottomSheetId(a)) ? !0 : !1
        },
        getStoreId: r,
        syncStepperQuantities: function (b, d, e, l, m, h, g) {
          ;(b = a.getQsWidgetMapSet(b)) &&
            (d || 0 == d) &&
            b.forEach(function (b) {
              var t = r(b),
                k = n(b).includes('fresh-dp'),
                u = a.isStepper(b) && (g || l != b),
                p
              if (!(p = k || !l))
                a: {
                  if (l && b) {
                    p = Ca(l)
                    var q = Ca(b)
                    if ('bcPrice' == p || 'bcPrice' == q) {
                      p = !0
                      break a
                    }
                    if (p && q) {
                      p = p === q
                      break a
                    }
                  }
                  p = !1
                }
              u &&
                p &&
                (e && t && !k
                  ? e == t && f.trigger(c.getQsWidgetEventSelectQuantityClientUpdate(), b, d, m, h)
                  : f.trigger(c.getQsWidgetEventSelectQuantityClientUpdate(), b, d, m, h))
            })
        },
        isStepper: function (b) {
          return a.isStepper(b)
        },
        replaceNbspWithPlainTextNbsp: fa,
        getQsUidsFromDom: function () {
          var a = [],
            c = document.querySelectorAll('[id^\x3d"qs-widget-container-"]')
          if (c)
            for (var d = 0; d < c.length; d++) a.push(c[d].id.replace('qs-widget-container-', ''))
          return a
        },
      }
    })
  })
  ;('use strict')
  q.when('QSAssetDuplicationGuard').execute('qsWidget-duplication-guard', function (n) {
    n.when(
      'A',
      'QuantitySelectorUtils',
      'QuantitySelectorState',
      'QuantitySelectorConstants',
      'QuantitySelectorMetrics',
    ).register('QuantitySelectorWidget', function (f, a, c, h, g) {
      function k(c) {
        a.deactivateWidget(c)
        var d = a.getQsWidgetButtonContainer(c),
          g = a.getQsWidgetDropdownContainer(c),
          e = a.getQsWidgetDropdownElement(c),
          l = a.getQsWidgetQuantityContainer(c),
          r = a.getQsWidgetSummaryAtcButton(c),
          k = a.getQsWidgetFooterPriceContainer(c),
          n = a.getQsWidgetFooterQuantitySuffixContainer(c)
        a.setElementVisibility(k, !0)
        a.setElementVisibility(n, !0)
        k = a.getQsWidgetTextInputContainer(c)
        a.isComponentVisible(k) || a.showComponent(d)
        a.hideComponent(g)
        a.hideComponent(e)
        a.hideComponent(l)
        a.hideComponent(r)
        a.resetQsWidgetContainerMinWidthAndHeight(c)
        f.trigger(h.getQsWidgetEventHideDropdown(), c)
        c = a.getQsWidgetButton(c)
        c.length && c.focus()
      }
      function n(d, m, g) {
        var e = a.getQsItem(d, m),
          l = e.quantityText,
          r = e.quantityTextAbbreviatedSuffix,
          k = e.quantityTextFullSuffix,
          t = e.selectedText
        e = e.price
        var n = a.getQsWidgetSummaryPriceSymbolElement(d),
          p = a.getQsWidgetSummaryPriceWholeElement(d),
          q = a.getQsWidgetSummaryPriceFractionElement(d),
          v = a.getQsWidgetSummaryPriceDecimalElement(d)
        a.setHtml(n, e.currencySymbol)
        a.setHtml(p, e.wholeValue)
        a.setHtml(q, e.fractionValue)
        a.setHtml(v, e.decimalSeparator)
        n = a.getQsWidgetQuantityElement(d)
        a.setHtml(n, l)
        l = a.getQsWidgetQuantitySuffixElement(d)
        r && k
          ? (a.setHtml(l, r), (r = a.getQsWidgetInitialViewSuffixElement(d)), a.setHtml(r, k))
          : a.setHtml(l, '')
        r = a.getQsWidgetFooterPriceSymbolElement(d)
        l = a.getQsWidgetFooterPriceWholeElement(d)
        n = a.getQsWidgetFooterPriceFractionElement(d)
        p = a.getQsWidgetFooterPriceDecimalElement(d)
        a.setHtml(r, e.currencySymbol)
        a.setHtml(l, e.wholeValue)
        a.setHtml(n, e.fractionValue)
        a.setHtml(p, e.decimalSeparator)
        k && ((e = a.getQsWidgetFooterQuantitySuffixElement(d)), a.setHtml(e, k))
        k = 'Current quantity ' + t
        a.isInitialViewDropdown(d)
          ? (a.getQsWidgetButtonAsComponent(d).text(t),
            a.getQsWidgetButton(d).attr('aria-label', k + NaN))
          : a.isInitialViewTextLink(d) &&
            ((e = a.getQsWidgetInitialViewTextLinkElement(d)), e.text(t), e.attr('aria-label', k))
        a.setAtcButtonStepperText(d)
        c.setPreviousSelectedId(d, c.getQsWidgetConfiguration(d).selectedId)
        c.setSelectedId(d, m)
        c.isStepper(d) && a.updateQsWidgetStepper(d, m)
        g && f.trigger(h.getQsWidgetEventTriggerAction(), d)
      }
      function q(d, m) {
        if (!a.isSimplifiedStepper(d)) {
          var g = a.getQsWidgetTextInputElement(d),
            e = g.val(),
            l = a.getQsWidgetButtonContainer(d),
            r = a.getQsWidgetTextInputContainer(d),
            k = a.getQsWidgetTextInputUpdateButtonContainer(d),
            p = a.getQsItemFromQuantityTextOrQuantity(d, e),
            q = c.isStepper(d)
          a.hideComponent(k)
          q && a.getQsWidgetButtonAsComponent(d).text(e)
          p
            ? (a.hideComponent(r), a.showComponent(l), n(d, p.id, m))
            : (a.hideComponent(l),
              a.showComponent(r),
              g.blur(),
              c.setSelectedQuantity(d, e),
              (g = c.getQsWidgetConfiguration(d)),
              q &&
                a.isInitialViewChooseQuantity(d) &&
                0 == g.selectedQuantity &&
                ((g = a.getQsWidgetStepperElement(d)),
                (k = a.getQsWidgetAtcButtonAsComponent(d)),
                a.hideComponent(r),
                a.showComponent(l),
                a.hideComponent(g),
                k.show()),
              m && f.trigger(h.getQsWidgetEventTriggerAction(), d))
          q &&
            a.isInitialViewChooseQuantity(d) &&
            0 < e &&
            ((g = a.getQsWidgetStepperElement(d)),
            (k = a.getQsWidgetAtcButtonAsComponent(d)),
            (d = a.getQsWidgetAtcButton(d)),
            a.isComponentVisible(d) && (a.showComponent(g), k.hide()))
        }
      }
      var p = null
      f.on(h.getQsWidgetEventSelectId(), function (c, f, h, e) {
        n(c, f, h)
        f = a.getQsWidgetButtonContainer(c)
        h = a.getQsWidgetTextInputContainer(c)
        c = a.getQsWidgetTextInputUpdateButtonContainer(c)
        a.hideComponent(c)
        a.hideComponent(h)
        a.showComponent(f)
        e && e()
      })
      f.on(h.getQsWidgetEventSelectQuantity(), function (d, f, h, e) {
        a.isSimplifiedStepper(d)
          ? ((f = f.toString()),
            c.setSelectedQuantity(d, f),
            a.updateSimplifiedQsWidgetStepper(d, f))
          : (g.incrementQsItemNotFound(!0, a.getClientId(d)),
            a.getQsWidgetTextInputElement(d).val(f),
            q(d, h))
        e && e()
      })
      f.on(h.getQsWidgetEventSyncStepperQuantity(), function (c, f, h, e, l, g, k) {
        a.syncStepperQuantities(c, f, h, e, l, g, k)
      })
      f.on('commit-c5d19d5c', function () {})
      f.on(h.getQsWidgetEventSelectQuantityClientUpdate(), function (d, m, k, e) {
        var l = a.getQsItemFromQuantityTextOrQuantity(d, m)
        l
          ? f.trigger(h.getQsWidgetEventSelectId(), d, l.id, k, e)
          : a.isSimplifiedStepper(d)
            ? ((m = m.toString()),
              c.setSelectedQuantity(d, m),
              a.updateSimplifiedQsWidgetStepper(d, m))
            : (g.incrementQsItemNotFound(!0, a.getClientId(d)),
              a.getQsWidgetTextInputElement(d).val(m),
              q(d, k))
        e && e()
      })
      return {
        hideAllPopover: function () {
          for (var c = a.getActivatedQsWidgets(), f = 0; f < c.length; f++) k(c[f])
        },
        showPopover: function (d) {
          a.activateWidget(d)
          a.setQsWidgetContainerMinWidthAndHeight(d)
          var f = a.getQsWidgetDropdownUnorderedListElement(d),
            h = a.getQsWidgetButtonContainer(d),
            e = a.getQsWidgetDropdownContainer(d),
            l = a.getQsWidgetDropdownElement(d),
            g = a.getQsWidgetQuantityContainer(d),
            k = a.getQsWidgetSummaryAtcButton(d)
          a.setHtml(f, a.generateQsDropdownDOM(d))
          f = a.getQsWidgetFooterPriceContainer(d)
          var n = a.getQsWidgetFooterQuantitySuffixContainer(d)
          a.setElementVisibility(f, !1)
          a.setElementVisibility(n, !1)
          a.showComponent(l)
          a.hideComponent(g)
          a.hideComponent(k)
          a.showComponent(e)
          a.hideComponent(h)
          a.popOutDropDownContainer(d)
          e = c.getQsWidgetConfiguration(d)
          if ((h = e.qsItems))
            (e = e.selectedId),
              null === e && (e = h[0].id),
              a.getQsWidgetDropdownItemElement(d, e).focus()
        },
        showConfirmation: function (c) {
          a.activateWidget(c)
          var d = a.getQsWidgetButtonContainer(c),
            f = a.getQsWidgetDropdownContainer(c),
            e = a.getQsWidgetDropdownElement(c),
            l = a.getQsWidgetQuantityContainer(c)
          c = a.getQsWidgetSummaryAtcButton(c)
          a.hideComponent(e)
          a.showComponent(l)
          a.showComponent(c)
          a.showComponent(f)
          a.hideComponent(d)
        },
        showPrice: function (c, f) {
          f = a.getQsItem(c, f).price
          var d = a.getQsWidgetSummaryPriceSymbolElement(c),
            e = a.getQsWidgetSummaryPriceWholeElement(c),
            l = a.getQsWidgetSummaryPriceFractionElement(c)
          c = a.getQsWidgetSummaryPriceDecimalElement(c)
          a.setHtml(d, f.currencySymbol)
          a.setHtml(e, f.wholeValue)
          a.setHtml(l, f.fractionValue)
          a.setHtml(c, f.decimalSeparator)
        },
        selectOption: n,
        validateAndSelectQuantity: q,
        selectConfirmation: function (d) {
          if (a.isActionTriggerOnConfirmation(d)) {
            if (c.isStepper(d)) {
              var g = a.getSelectedQsItemId(d)
              a.updateQsWidgetStepper(d, g)
            }
            f.trigger(h.getQsWidgetEventTriggerAction(), d)
          }
          k(d)
        },
        stepperIncrement: function (d) {
          var g = c.getQsWidgetConfiguration(d),
            k = a.isQsWidgetQuantityZero(d)
          if (a.isSimplifiedStepper(d)) {
            var e = g.selectedQuantity
            if (!e) return
            e = (parseInt(e) + 1).toString()
            c.setSelectedQuantity(d, e)
            a.updateSimplifiedQsWidgetStepper(d, e)
          } else {
            if (g.selectedId) {
              e = g.selectedId
              var l = a.getNextIncrementQsItem(d, g.selectedId).id
            } else
              g.selectedQuantity || '0' == g.selectedQuantity
                ? ((e = g.selectedQuantity),
                  (l = a.getClosestIncrementalQsItem(d, g.selectedQuantity).id),
                  a.getQsItemQuantity(a.getQsItem(d, l)) == g.selectedQuantity &&
                    (l = a.getNextIncrementQsItem(d, l).id))
                : (l = a.getSelectedQsItemId(d))
            if (e === l) return
            c.setSelectedId(d, l)
            a.updateQsWidgetStepper(d, l)
          }
          if (
            a.showATCButtonWhenZeroQuantity(d) &&
            ((e = a.getQsWidgetButton(d)),
            a.getClientId(d).includes('p13n-buyagain-cards') &&
              (a.getQsWidgetPlusButton(d).find('input[type\x3d"submit"]').is(':focus') ||
                (e.length && e.focus())),
            k)
          ) {
            c.isStepper(d)
              ? (f.trigger(
                  h.getQsWidgetEventTriggerAction(),
                  d,
                  null,
                  null,
                  h.getQsWidgetStepperAddToCartReftag(),
                ),
                e.length && e.focus())
              : f.trigger(h.getQsWidgetEventTriggerAction(), d)
            return
          }
          null != p && clearTimeout(p)
          p = setTimeout(function () {
            f.trigger(h.getQsWidgetEventTriggerAction(), d)
          }, g.stepperDebounceTime)
        },
        stepperDecrement: function (d) {
          var g = c.getQsWidgetConfiguration(d)
          if (a.isSimplifiedStepper(d)) {
            var k = g.selectedQuantity
            if (!k) return
            k = parseInt(k) - 1
            var e = k.toString()
            if (0 >= k) {
              c.setSelectedQuantity(d, '0')
              f.trigger(h.getQsWidgetEventTriggerAction(), d)
              g = a.getQsWidgetStepperElement(d)
              g.addClass('aok-hidden')
              g = a.getQsWidgetAtcButtonAsComponent(d)
              g.show()
              return
            }
            c.setSelectedQuantity(d, e)
            a.updateSimplifiedQsWidgetStepper(d, e)
          } else {
            if (g.selectedId) {
              if (((k = a.getNextDecrementQsItem(d, g.selectedId).id), k == g.selectedId)) {
                c.setSelectedId(d, null)
                c.setSelectedQuantity(d, '0')
                f.trigger(h.getQsWidgetEventTriggerAction(), d)
                a.showATCButtonWhenZeroQuantity(d) &&
                  ((g = a.getQsWidgetStepperElement(d)),
                  g.addClass('aok-hidden'),
                  (g = a.getQsWidgetAtcButtonAsComponent(d)),
                  g.show())
                return
              }
            } else if (g.selectedQuantity || '0' == g.selectedQuantity) {
              if (
                ((k = a.getClosestDecrementalQsItem(d, g.selectedQuantity).id),
                '0' == g.selectedQuantity)
              ) {
                c.setSelectedQuantity(d, '0')
                f.trigger(h.getQsWidgetEventTriggerAction(), d)
                a.showATCButtonWhenZeroQuantity(d) &&
                  ((g = a.getQsWidgetStepperElement(d)),
                  g.addClass('aok-hidden'),
                  (g = a.getQsWidgetAtcButtonAsComponent(d)),
                  g.show())
                return
              }
            } else k = a.getSelectedQsItemId(d)
            a.updateQsWidgetStepper(d, k)
            c.setSelectedId(d, k)
          }
          null != p && clearTimeout(p)
          p = setTimeout(function () {
            f.trigger(h.getQsWidgetEventTriggerAction(), d)
          }, g.stepperDebounceTime)
        },
      }
    })
  })
  ;('use strict')
  q.when('QSAssetDuplicationGuard').execute('QuantitySelector-duplication-guard', function (n) {
    n.when(
      'A',
      'QuantitySelectorWidget',
      'QuantitySelectorUtils',
      'QuantitySelectorState',
      'QuantitySelectorConstants',
      'QuantitySelectorMetrics',
      'QuantitySelectorAUIDeps',
      'QuantitySelectorMetadata',
      'QuantitySelectorTemplates',
    ).register('QuantitySelector', function (f, a, c, h, g, k, n, v, p) {
      function d(a, d) {
        try {
          var e = c.isMobile(d)
        } catch (u) {
          u instanceof TypeError && k.incrementInvalidIdCount()
          return
        }
        try {
          if (!c.isInitialized(d) || a)
            eval(v.getMetaConfiguration(d, 'script')),
              h.setInitialized(d),
              c.initializeWidget(d),
              c.isQsWidgetEnabled(d) ? c.enableQsWidget(d) : c.disableQsWidget(d),
              k.incrementInitializeCount(!0, e)
        } catch (u) {
          k.incrementInitializeCount(!1, e)
        }
      }
      function m(a) {
        h.loadQsWidgetStateConfiguration(a)
        d(!0, a)
      }
      function t() {
        for (var a = h.getQsUIDs(), d = 0; d < a.length; d++) {
          var f = a[d]
          c.isInitialized(f) || m(f)
        }
      }
      f.declarative(g.getQsWidgetButtonDecl(), 'click', function (d) {
        var e = d.data.qsUID
        d = c.isMobile(e)
        var f = h.isStepper(e),
          g = c.isSimplifiedStepper(e),
          m = c.isSUPU(e),
          n = h.getQsWidgetConfiguration(e).selectedId,
          p = c.isElementVisible(c.getQsWidgetAtcButton(e))
        if (g || (m && f && !n)) {
          if (c.showATCButtonWhenZeroQuantity(e) && !p) return
          d && !c.isBottomSheetExist(e) && a.getBottomSheet(e)
          a.stepperIncrement(e)
        } else d ? a.showBottomSheet(e) : a.showPopover(e)
        k.incrementShowPopup(d)
        c.isInitialViewDropdown(e) ? k.logCsm(e, 'cqd') : k.logCsm(e, 'ccq')
        setTimeout(function () {
          c.saveQsWidgetDropdownTopPosition(e)
        }, 250)
      })
      f.declarative(g.getQsWidgetDropdownDecl(), 'click', function (d) {
        var e = d.data.qsUID
        d = d.data.id
        var f = c.isActionTriggerOnSelect(e),
          g = c.isTextInputRequired(e, d),
          h = c.isConfirmationViewEnabled(e),
          m = c.isQsWidgetDropdownScrolled(e)
        h
          ? m
            ? (c.setQsWidgetDropdownScrolled(e), k.logCsm(e, 'dcq_scl'))
            : (c.clearQsWidgetDropdownScrolled(e), k.logCsm(e, 'dcq'))
          : m
            ? k.logCsm(e, 'dsq_scl')
            : k.logCsm(e, 'dsq')
        a.selectOption(e, d, f && !g.result)
        g.result
          ? (c.showTextInput(e, g.initialQuantityText), a.hideAllPopover())
          : h
            ? a.showConfirmation(e)
            : a.hideAllPopover()
      })
      f.declarative(g.getQsWidgetStepperIncrementDecl(), 'click', function (d) {
        d = d.data.qsUID
        var e = c.getQsWidgetPlusButtonAsComponent(d),
          f = c.getQsWidgetPlusButton(d)
        c.isElementVisible(f) && e.isEnabled() && a.stepperIncrement(d)
      })
      f.declarative(g.getQsWidgetStepperDecrementDecl(), 'click', function (d) {
        d = d.data.qsUID
        var e = c.getQsWidgetMinusButton(d)
        c.isElementVisible(e) && a.stepperDecrement(d)
      })
      f.declarative(g.getQsWidgetDropdownItemDecl(), 'click', function (d) {
        var e = d.data.qsUID
        a.alignQsItem(e, d.data.id)
        c.isConfirmationViewEnabled(e)
          ? c.getQsWidgetSummaryAtcButton(e).attr('tabindex', '-1').focus()
          : a.getBottomSheetContainer(e).attr('tabindex', '-1').focus()
      })
      f.declarative(g.getQsWidgetVariationDropdownItemDecl(), 'click', function (c) {
        a.alignVariationSelectorItem(c.data.qsUID, c.data.id)
      })
      f.declarative(g.getQsWidgetDropdownDecl(), 'focusin', function (c) {
        a.showPrice(c.data.qsUID, c.data.id)
      })
      f.declarative(g.getQsWidgetDropdownDecl(), 'mouseenter', function (c) {
        a.showPrice(c.data.qsUID, c.data.id)
      })
      f.declarative(g.getQsWidgetDropdownDecl(), 'mouseleave', function (d) {
        d = d.data.qsUID
        var e = c.getSelectedQsItemId(d)
        a.showPrice(d, e)
      })
      f.declarative(g.getQsWidgetQuantityChangelinkDecl(), 'click', function (d) {
        d = d.data.qsUID
        h.setSelectedId(d, h.getQsWidgetConfiguration(d).previousSelectedId)
        a.showPopover(d)
        k.incrementChangeLinkCount()
        c.saveQsWidgetDropdownTopPosition(d)
        k.logCsm(d, 'ccl')
      })
      f.declarative(g.getQsWidgetSummaryAtcDecl(), 'click', function (d) {
        d = d.data.qsUID
        a.selectConfirmation(d)
        c.isQsWidgetDropdownScrolled(d) ? k.logCsm(d, 'atc_scl') : k.logCsm(d, 'atc')
      })
      f.declarative(g.getQsWidgetTextInputDecl(), 'keydown', function (a) {
        var d = a.data.qsUID,
          e = a.$event.which
        8 == e ||
          9 == e ||
          13 == e ||
          (37 <= e && 40 >= e) ||
          46 == e ||
          (!((48 <= e && 57 >= e) || (96 <= e && 105 >= e)) ||
          a.$event.shiftKey ||
          a.$event.altKey ||
          a.$event.ctrlKey ||
          a.$event.metaKey
            ? a.$event.preventDefault()
            : 3 <= c.getQsWidgetTextInputElement(d).val().length && a.$event.preventDefault())
      })
      f.declarative(g.getQsWidgetTextInputDecl(), 'keyup', function (d) {
        var e = d.data.qsUID
        c.validateQsWidgetTextInput(e) && 13 == d.$event.keyCode
          ? ((d = c.isActionTriggerOnSelect(e) || h.isStepper(e)),
            a.validateAndSelectQuantity(e, d))
          : c.showTextInput(e)
      })
      f.declarative(g.getQsWidgetTextInputDecl(), 'focusout', function (a) {
        a = a.data.qsUID
        if ('' === c.getQsWidgetTextInputElement(a).val()) {
          var d = (d = h.getQsWidgetConfiguration(a).selectedId)
            ? c.getQsItem(a, d).selectedText
            : c.getSelectedQuantity(a)
          c.showTextInput(a, d)
          c.validateQsWidgetTextInput(a)
        }
      })
      f.declarative(g.getQsWidgetTextInputDecl(), 'change', function (a) {
        c.showTextInput(a.data.qsUID)
      })
      f.declarative(g.getQsWidgetTextInputUpdateButtonDecl(), 'click', function (d) {
        var e = d.data.qsUID
        c.validateQsWidgetTextInput(e) &&
          ((e = d.data.qsUID),
          (d = c.isActionTriggerOnSelect(e) || c.isActionTriggerOnConfirmation(e)),
          a.validateAndSelectQuantity(e, d))
      })
      f.$(document).click(function (d) {
        0 == c.getActivatedQsWidgets().length ||
          c.isUserClickInDropdown(d) ||
          ((d = c.getActivatedQsWidgets()[0]),
          c.isConfirmationVisible(d) &&
            h.setSelectedId(d, h.getQsWidgetConfiguration(d).previousSelectedId),
          a.hideAllPopover())
      })
      f.$(w).resize(function () {
        a.hideAllPopover()
      })
      f.on(g.getQsWidgetEventInitialize(), function (a, c) {
        n.initialize()
        if ('string' == typeof c) d(a, c)
        else {
          c = h.getQsUIDs()
          for (var e = 0; e < c.length; e++) d(a, c[e])
        }
      })
      f.on(g.getQsWidgetEventLoadStatesAndInitialize(), function () {
        try {
          t()
        } catch (e) {
          if (e instanceof SyntaxError)
            f.delay(function () {
              try {
                t()
              } catch (l) {
                q.logError(l)
              }
            }, 200)
          else throw e
        }
      })
      f.on(g.getQsWidgetEventConfigureEnable(), function (a) {
        c.enableQsWidget(a)
      })
      f.on(g.getQsWidgetEventConfigureDisable(), function (a) {
        c.disableQsWidget(a)
      })
      f.on(g.getQsWidgetEventConfigureReset(), function (a) {
        for (var c = h.getQsUIDs(), d = 0; d < c.length; d++) {
          var e = c[d]
          if ('string' !== typeof a || a == e)
            h.reloadQsWidgetStateConfiguration(e), f.trigger(g.getQsWidgetEventInitialize(), !0, e)
        }
      })
      c.hideSpinner()
      p = f.now()
      k.logLatencyMetric('JSReady', p)
      return { loadStateAndInitializeWidget: m }
    })
  })
})
/* ******** */
;(function (m) {
  var r = window.AmazonUIPageJS || window.P,
    w = r._namespace || r.attributeErrors,
    q = w ? w('QuantitySliderAssets', '') : r
  q.guardFatal
    ? q.guardFatal(m)(q, window)
    : q.execute(function () {
        m(q, window)
      })
})(function (m, r, w) {
  function q(t, n) {
    try {
      m.register(t, n)
    } catch (f) {
      if (-1 === f.message.indexOf('reregistered by QuantitySliderAssets')) throw f
    }
  }
  function y() {
    var t = arguments
    return {
      register: function (n, f) {
        try {
          m.when.apply(m, t).register(n, f)
        } catch (h) {
          if (-1 === h.message.indexOf('reregistered by QuantitySliderAssets')) throw h
        }
      },
    }
  }
  m.when('QuantitySliderAssetDuplicationGuard').execute(function (t) {
    t.when('A', 'quantity-slider-utils', 'qs-cart-update-utils').register(
      'qs-cart-update-handler',
      function (n, f, h) {
        function l(a) {
          p || (p = 'quantity-slider-widget-' + a)
          return p
        }
        function e(a, b) {
          if (!b.atcFormSubmitDisabled) {
            if ((a = a.$target && a.$target.closest('.qs-atc-form')) && 0 !== a.length) return a
            m.log('Missing $form object', 'ERROR', l(b.clientName))
          }
        }
        function b(b, x, k) {
          n.trigger(f.ACTIONS.ADD_TO_CART_SUBMIT_START, {
            asin: b,
            cartType: x.cartType,
            clientName: x.clientName,
            isQSAction: k,
            request: x,
          })
          a(b, x, !0, k)
        }
        function a(a, b, k, e) {
          var p = b.cartType,
            c = JSON.stringify(e ? h.getQSRequestObject(b, k, p) : h.getATCRequestObject(b, p)),
            d = h.getAjaxUrl(b, k, p)
          d &&
            g.ajax({
              url: d,
              type: h.getHttpMethodType(k, p),
              data: c,
              headers: h.getHeadersForRequest(b, k, p),
              xhrFields: { withCredentials: !0 },
              success: function (d, c, g) {
                d.jqXHR = g
                delete u[a]
                ;(d = h.adaptResponseObject(d, b, k, b.cartType))
                  ? (f.setUpdatedQSParamsForAsinOffer(
                      a,
                      b.additionalParams && b.additionalParams.storeId,
                      { quantityInCart: d.quantity, cartItemId: d.itemId },
                    ),
                    n.trigger(
                      k
                        ? f.ACTIONS.ADD_TO_CART_SUBMIT_SUCCESS
                        : f.ACTIONS.REMOVE_FROM_CART_SUBMIT_SUCCESS,
                      {
                        asin: a,
                        cartType: b.cartType,
                        request: b,
                        response: d,
                        clientName: b.clientName,
                        attribution: l(b.clientName),
                        isQSAction: e,
                        isDecreaseQuantityAction: !k,
                      },
                    ),
                    f.logUrl(b.loggingUrl))
                  : m.log('Invalid Response from the server', 'ERROR', l(b.clientName))
              },
              error: function (d) {
                delete u[a]
                d = d || {}
                m.log(
                  'Ajax request failed with type: ' +
                    (k ? 'addItems' : 'modifyItems') +
                    ', status code: ' +
                    d.status +
                    ', error: ' +
                    d.responseText,
                  'ERROR',
                  l(b.clientName),
                )
                n.trigger(f.ACTIONS.QS_CART_SUBMIT_ERROR, {
                  asin: a,
                  cartType: p,
                  clientName: b.clientName,
                  isQSAction: e,
                  isDecreaseQuantityAction: !k,
                  isMaxOrderQuantityReached: b.quantityInCart >= b.maxOrderQuantity,
                  response: d,
                  request: b,
                })
                k && b.$form && b.$form.submit()
              },
            })
        }
        var g = n.$,
          p = '',
          u = {}
        n.declarative('qs-add-to-cart-trigger', 'click', function (a) {
          var g = a.data && a.data.asin,
            k = f.getQsParamsFromTargetAsinOffer(a, g)
          a.$event && a.$event.preventDefault()
          u[g] ||
            ((u[g] = !0),
            (k.isMultipleAsinsSubmitting = 1 < Object.keys(u).length),
            (k.$form = e(a, k)),
            (k.triggeringEvent = a),
            b(g, k, !1))
        })
        n.declarative('qs-slider-widget-trigger', 'click', function (g) {
          var h = g.data && g.data.asin,
            k = f.getQsParamsFromTargetAsinOffer(g, h),
            l = (g.$target[0] && g.$target[0].className) || '',
            p = n.contains(l, 'qs-increase-quantity') || n.contains(l, 'qs-decrease-quantity')
          l = n.contains(l, 'qs-decrease-quantity')
          g.$event && g.$event.preventDefault()
          p &&
            !u[h] &&
            ((u[h] = !0),
            (k.isMultipleAsinsSubmitting = 1 < Object.keys(u).length),
            (k.triggeringEvent = g),
            l
              ? (n.trigger(f.ACTIONS.REMOVE_FROM_CART_SUBMIT_START, {
                  asin: h,
                  cartType: k.cartType,
                  clientName: k.clientName,
                  isQSAction: !0,
                  isDecreaseQuantityAction: !0,
                  request: k,
                }),
                a(h, k, !1, !0))
              : ((k.$form = e(g, k)), b(h, k, !0)))
        })
        return {
          setAttribution: function (a) {
            p = a
          },
        }
      },
    )
  })
  ;('use strict')
  m.when('QuantitySliderAssetDuplicationGuard').execute(function (m) {
    m.when('A', 'qs-fresh-cart-update-utils').register('qs-cart-update-utils', function (n, f) {
      function h(d) {
        var c = d.quantityInCart || 0
        return {
          items: [
            {
              asin: d.asinId,
              offerListingId: d.offerListingId,
              quantity: c < d.minOrderQuantity ? d.minOrderQuantity - c : 1,
            },
          ],
        }
      }
      function l(d, c, a) {
        return (e.isFunction(c[a]) ? c[a] : c.DEFAULT)(d)
      }
      var e = n.$,
        b = { DEFAULT: h, UFG: f.getUfgCartRequestObject },
        a = { DEFAULT: h, UFG: f.getUfgCartRequestObject },
        g = {
          DEFAULT: function (d) {
            var c = d.quantityInCart || 0
            var a = d.cartItemId
            a = !a || ('C' !== a[0] && 'S' !== a[0]) ? a : a.substring(1)
            return { items: [{ id: a, quantity: c <= d.minOrderQuantity ? 0 : c - 1 }] }
          },
          UFG: f.getUfgCartRequestObject,
        },
        p = {
          DEFAULT: function (d) {
            return d.ajaxCartUrl
          },
          UFG: function (d) {
            return d.addToCartUrl
          },
        },
        u = {
          DEFAULT: function (d) {
            return d.ajaxCartUrl
          },
        },
        m = {
          DEFAULT: function (d) {
            return (d = d.entity && d.entity.items && d.entity.items[0])
              ? { itemId: d.id, quantity: d.quantity, isTotal: !0 }
              : null
          },
          UFG: f.ufgCartResponseAdapter,
        },
        t = {
          DEFAULT: function (d, c) {
            d = (c.quantityInCart || 0) - 1
            return 0 > d ? null : { itemId: d ? c.cartItemId : '', quantity: d, isTotal: !0 }
          },
          UFG: f.ufgCartResponseAdapter,
        },
        k = { DEFAULT: 'POST', UFG: 'POST' },
        q = { DEFAULT: 'PUT', UFG: 'POST' },
        r = {
          DEFAULT: function (d) {
            return {
              'x-api-csrf-token': d.csrfToken,
              'x-amzn-encrypted-slate-token': e('meta[name\x3d"encrypted-slate-token"]').prop(
                'content',
              ),
              Accept: 'application/vnd.com.amazon.api+json; type\x3d"cart.add-items/v1"',
              'Content-Type':
                'application/vnd.com.amazon.api+json; type\x3d"cart.add-items.request/v1"',
            }
          },
          UFG: function (d) {
            return {
              'Content-Type': 'application/json',
              'x-amzn-encrypted-slate-token': e('meta[name\x3d"encrypted-slate-token"]').prop(
                'content',
              ),
            }
          },
        },
        c = {
          DEFAULT: function (d) {
            return {
              'x-api-csrf-token': d.csrfToken,
              'x-amzn-encrypted-slate-token': e('meta[name\x3d"encrypted-slate-token"]').prop(
                'content',
              ),
              Accept: 'application/vnd.com.amazon.api+json; type\x3d"cart.modify-items/v1"',
              'Content-Type':
                'application/vnd.com.amazon.api+json; type\x3d"cart.modify-items.request/v1"',
            }
          },
          UFG: function (d) {
            return {
              'Content-Type': 'application/json',
              'x-amzn-encrypted-slate-token': e('meta[name\x3d"encrypted-slate-token"]').prop(
                'content',
              ),
            }
          },
        }
      return {
        getATCRequestObject: function (d, c) {
          return l(d, b, c)
        },
        getQSRequestObject: function (d, c, b) {
          return l(d, c ? a : g, b)
        },
        adaptResponseObject: function (d, c, a, b) {
          a = a ? m : t
          return (e.isFunction(a[b]) ? a[b] : a.DEFAULT)(d, c)
        },
        getHttpMethodType: function (c, a) {
          c = c ? k : q
          return c[a] ? c[a] : c.DEFAULT
        },
        getHeadersForRequest: function (d, a, b) {
          a = a ? r : c
          return (e.isFunction(a[b]) ? a[b] : a.DEFAULT)(d)
        },
        getAjaxUrl: function (c, a, b) {
          return l(c, a ? p : u, b)
        },
      }
    })
  })
  ;('use strict')
  m.when('QuantitySliderAssetDuplicationGuard').execute(function (m) {
    m.when('A').register('qs-fresh-cart-update-utils', function (n) {
      function f(f, l) {
        return l && l.items
          ? l.items.find(function (e) {
              return e.ASIN === f
            })
          : null
      }
      return {
        getUfgCartRequestObject: function (f) {
          return f.additionalInput
        },
        ufgCartResponseAdapter: function (h, l) {
          return (l = f(l.asinId, h.clientResponseModel))
            ? { itemId: l.itemId, quantity: l.quantity, isTotal: !0, rawResponse: h }
            : { itemId: 'invalidItemId', quantity: 0, isTotal: !0, rawResponse: h }
        },
      }
    })
  })
  ;('use strict')
  m.when('QuantitySliderAssetDuplicationGuard').execute(function (m) {
    m.when('A', 'quantity-slider-utils').register(
      'quantity-slider-metrics-handler',
      function (n, f) {
        function h(a, b) {
          return 'QuantitySliderWidget::' + a + '::' + (b ? b + '::' : '')
        }
        function l(a) {
          var b = r.ue
          'undefined' !== typeof b && b.count(a, 1)
        }
        function e(a, g) {
          f.assert(a && g.clientName, 'Missing required properties while logging metrics')
          if (g.isQSAction)
            if (g.isDecreaseQuantityAction) {
              var e = b.QS_DECREASE
              a = h(g.clientName, g.cartType) + a + '::' + e
              l(a)
            } else (e = b.QS_INCREASE), (a = h(g.clientName, g.cartType) + a + '::' + e), l(a)
          else (e = b.ATC), (a = h(g.clientName, g.cartType) + a + '::' + e), l(a)
        }
        var b = { ATC: 'ATC', QS_INCREASE: 'QSIncrease', QS_DECREASE: 'QSDecrease' }
        return {
          logRequestStartMetrics: function (a) {
            e('CountStart', a)
          },
          logRequestSuccessMetrics: function (a) {
            e('CountSuccess', a)
          },
          logRequestErrorMetrics: function (a) {
            e('CountError', a)
          },
          logMaxQuantityReachedMetric: function (a) {
            a = h(a.clientName, a.cartType) + 'MaxQuantityReached'
            l(a)
          },
          logMultipleAsinsSubmittingMetric: function (a) {
            a = h(a.clientName, a.cartType) + 'MultipleAsinsSubmitting'
            l(a)
          },
        }
      },
    )
  })
  ;('use strict')
  m.when('QuantitySliderAssetDuplicationGuard').execute(function (m) {
    m.when(
      'A',
      'quantity-slider-utils',
      'qs-cart-update-handler',
      'quantity-slider-metrics-handler',
    ).register('quantity-slider-widget', function (n, f, h, l) {
      function e(c, a, b, e) {
        c = k(c, a, e)
        b ? f.disableButton(c) : f.enableButton(c)
      }
      function b(c, a, b) {
        e('.' + c + '-qs-slider-button .qs-decrease-quantity', c, a, b)
      }
      function a(c, a, b) {
        e('.' + c + '-qs-slider-button .qs-increase-quantity', c, a, b)
      }
      function g(c, a, b) {
        e('.' + c + '-qs-add-to-cart-button .qs-slider-atc-button', c, a, b)
      }
      function p(c) {
        if (c.isQSAction) {
          var a = c.asin,
            b = m(c)
          c.isDecreaseQuantityAction
            ? f.deselectButton(k('.' + a + '-qs-slider-button .qs-decrease-quantity', a, b))
            : f.deselectButton(k('.' + a + '-qs-slider-button .qs-increase-quantity', a, b))
        }
      }
      function m(a) {
        return (a = (a = a.request) && a.additionalInput) && a.storeId
      }
      function q(c) {
        var d = c.asin,
          e = m(c),
          h = k('.' + d + '-qs-slider-spinner', d, e)
        f.toggleDomNodeVisibility(h, !1)
        c.isQSAction ? (b(d, !1, e), a(d, !1, e)) : g(d, !1, e)
        p(c)
        d = c.asin
        f.assert(
          d && c.request && c.response && c.response.quantity !== w,
          'Required properties missing in payload object for UpdateQSWidget',
        )
        e = m(c)
        t(d, c.response.quantity, c.request.maxOrderQuantity, e)
        c.request.enableQuantityLimitMessage &&
          ((d = k('.' + d + '-qs-quantity-limit-message', d, e)),
          f.toggleDomNodeVisibility(d, c.response.quantity >= c.request.maxOrderQuantity))
        f.updateTotalCartCountOnUI(c, c.cartType)
        l.logRequestSuccessMetrics(c)
      }
      function r(c) {
        var d = c.asin,
          e = m(c),
          h = k('.' + d + '-qs-slider-spinner', d, e)
        f.toggleDomNodeVisibility(h, !0)
        c.isQSAction ? (b(d, !0, e), a(d, !0, e)) : g(d, !0, e)
        l.logRequestStartMetrics(c)
        c.request && c.request.isMultipleAsinsSubmitting && l.logMultipleAsinsSubmittingMetric(c)
      }
      function k(a, b, e) {
        if (!e) return v(a)
        b = '.' + b + '-qs-slider-data'
        a = document.querySelectorAll(a)
        for (var c = [], d = 0; d < a.length; d++) {
          var f = a[d],
            g = f && v(f).closest('.qs-widget-container')
          ;(g = (g = g && v(g).children(b)) && v(g).data('qs-model')) &&
            g.additionalInput &&
            g.additionalInput.storeId === e &&
            c.push(f)
        }
        return v(c)
      }
      function t(c, b, e, g) {
        var d = k('.' + c + '-qs-add-to-cart-button', c, g),
          h = k('.' + c + '-qs-slider-button', c, g)
        0 < b
          ? (f.changeATCtoQS(d, h),
            (d = Math.min(b, e)),
            (h = k('.' + c + '-qs-qty-present-in-cart', c, g)),
            Number.isInteger(d) && h.html(d),
            a(c, b >= e, g))
          : (f.changeQStoATC(d, h), a(c, !1, g))
      }
      var v = n.$
      Number.isInteger ||
        (Number.isInteger = function (a) {
          return (
            'number' === typeof a &&
            isFinite(a) &&
            -9007199254740992 < a &&
            9007199254740992 > a &&
            Math.floor(a) === a
          )
        })
      n.on(f.ACTIONS.ADD_TO_CART_SUBMIT_START, function (a) {
        r(a)
      })
      n.on(f.ACTIONS.ADD_TO_CART_SUBMIT_SUCCESS, function (a) {
        q(a)
        a.response.quantity === a.request.maxOrderQuantity && l.logMaxQuantityReachedMetric(a)
      })
      n.on(f.ACTIONS.REMOVE_FROM_CART_SUBMIT_START, function (a) {
        r(a)
      })
      n.on(f.ACTIONS.REMOVE_FROM_CART_SUBMIT_SUCCESS, function (a) {
        q(a)
      })
      n.on(f.ACTIONS.QS_CART_SUBMIT_ERROR, function (c) {
        var d = c.asin,
          e = m(c),
          h = k('.' + d + '-qs-slider-spinner', d, e)
        f.toggleDomNodeVisibility(h, !1)
        c.isQSAction && c.isMaxOrderQuantityReached
          ? b(d, !1, e)
          : c.isQSAction
            ? (b(d, !1, e), a(d, !1, e))
            : g(d, !1, e)
        p(c)
        l.logRequestErrorMetrics(c)
      })
      return { ACTIONS: f.ACTIONS, setAttribution: h.setAttribution, updateQuantitySliderWidget: t }
    })
  })
  ;('use strict')
  m.when('QuantitySliderAssetDuplicationGuard').execute(function (q) {
    q.when('A', 'a-button').register('quantity-slider-utils', function (n, f) {
      function h(b) {
        return e('.' + b + '-qs-slider-data')
          .first()
          .data('qs-model')
      }
      function l(b, a) {
        var g = h(b)
        e('.' + b + '-qs-slider-data').data(n.extend(g, a))
      }
      var e = n.$
      return {
        ACTIONS: {
          ADD_TO_CART_SUBMIT_START: 'quantity-slider:add-to-cart-start',
          ADD_TO_CART_SUBMIT_SUCCESS: 'quantity-slider:add-to-cart-success',
          REMOVE_FROM_CART_SUBMIT_START: 'quantity-slider:remove-from-cart-start',
          REMOVE_FROM_CART_SUBMIT_SUCCESS: 'quantity-slider:remove-from-cart-success',
          QS_CART_SUBMIT_ERROR: 'quantity-slider:cart-submit-error',
        },
        assert: function (b, a) {
          if (!b) throw Error(a)
        },
        changeATCtoQS: function (b, a) {
          e(b).hasClass('aok-hidden') ||
            (e(b).addClass('aok-hidden'), e(a).removeClass('aok-hidden'))
        },
        changeQStoATC: function (b, a) {
          e(a).hasClass('aok-hidden') ||
            (e(a).addClass('aok-hidden'), e(b).removeClass('aok-hidden'))
        },
        disableButton: function (b) {
          f(e(b)).disable()
        },
        deselectButton: function (b) {
          b = f(e(b))
          b.isEnabled() && b.setStatus('normal')
        },
        enableButton: function (b) {
          f(e(b)).enable()
        },
        getQSParamsForAsin: h,
        getQsParamsFromTargetAsinOffer: function (b, a) {
          var g = '.' + a + '-qs-slider-data'
          return (g =
            (b = b.$event && e(b.$event.target).closest('.qs-widget-container')) &&
            b.children(g).data('qs-model'))
            ? g
            : h(a)
        },
        setUpdatedQSParamsForAsin: l,
        setUpdatedQSParamsForAsinOffer: function (b, a, g) {
          a
            ? e('.' + b + '-qs-slider-data').map(function (b, f) {
                b = e(f)
                ;(f = b.data('qs-model')) && f.storeId === a && b.data(n.extend(f, g))
              })
            : l(b, g)
        },
        toggleDomNodeVisibility: function (b, a) {
          a ? e(b).removeClass('aok-hidden') : e(b).addClass('aok-hidden')
        },
        updateTotalCartCountOnUI: function (b, a) {
          n.extend({}, b).onSuccess = function (a) {
            r.$Nav &&
              r.$Nav.when('api.setCartCount').run(function (b) {
                b(a)
              })
            m.when('mash').execute('quantity-slider-mash-update', function (b) {
              b.cart && e.isFunction(b.cart.didUpdate) && b.cart.didUpdate({ newCartQuantity: a })
            })
          }
        },
        logUrl: function (b) {
          b && n.post(b)
        },
      }
    })
  })
  ;('use strict')
  q('QuantitySliderAssetDuplicationGuard', function () {
    return { register: q, when: y }
  })
})
/* ******** */
;(function (e) {
  var h = window.AmazonUIPageJS || window.P,
    n = h._namespace || h.attributeErrors,
    r = n ? n('ALMCartActionAssets', '') : h
  r.guardFatal
    ? r.guardFatal(e)(r, window)
    : r.execute(function () {
        e(r, window)
      })
})(function (e, h, n) {
  function r(c, b) {
    try {
      e.register(c, b)
    } catch (d) {
      if (!d.message.includes('reregistered by ALMCartActionAssets')) throw d
    }
  }
  function E() {
    var c = arguments
    return {
      register: function (b, d) {
        try {
          e.when.apply(e, c).register(b, d)
        } catch (a) {
          if (!a.message.includes('reregistered by ALMCartActionAssets')) throw a
        }
      },
    }
  }
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.when('A', 'afx-csm-metrics-utils').register(
      'alm-cart-action-query-string-utils',
      function (b, d) {
        function a(a, d) {
          var k = f(a),
            c = g(a)
          k
            ? (d['discoveredAsins.0'] = a.asin)
            : c &&
              ((a = b.filter(a.items, function (a) {
                return f(a)
              })),
              (a = b.map(a, function (a) {
                return a.asin
              })),
              b.each(a, function (a, b) {
                d['discoveredAsins.' + b.toString()] = a
              }))
          return d
        }
        function g(a) {
          return a && a.items && b.$.isArray(a.items) && 0 < a.items.length
        }
        function f(a) {
          return a && a.asin && 'string' === typeof a.asin && '' !== a.asin
        }
        return {
          addQueryStringParamsToUrl: function (g, f) {
            var c = {}
            if (f && f.reftag) {
              var k = f.reftag
              'string' === typeof k && '' !== k && (c.ref_ = k)
            }
            if (f && f.queryLogInfoParams) {
              k = f.queryLogInfoParams
              for (var e in k)
                k.hasOwnProperty(e) &&
                  'string' === typeof e &&
                  '' !== e &&
                  'string' === typeof k[e] &&
                  '' !== k[e] &&
                  (c[e] = k[e])
            }
            a(f, c)
            try {
              var l = new URLSearchParams(h.location.search).get('almBrandId')
              l && (c.almBrandId = l)
            } catch (v) {
              d.increment('ATFC_INVALID_URL_ALMBRANDID')
            }
            try {
              var q = new URLSearchParams(h.location.search).get('gsc')
              q && (c.gsc = q)
            } catch (v) {
              d.increment('ATFC_INVALID_URL_GSC')
            }
            ;(f = b.$.param(c)) && 'string' === typeof f && '' !== f && (g += '?' + f)
            return g
          },
        }
      },
    )
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.when('A', 'jQuery').register('afx-add-all-helper', function (b, d) {
      return {
        updateQuantityForAsin: function (a, b, f) {
          a &&
            b &&
            !isNaN(f) &&
            d('#' + a)
              .closest('form')
              .find('#afx-add-all-' + b + '-quantity')
              .attr('value', f)
        },
      }
    })
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.when('A', 'jQuery', 'a-button').register('fx-atfc-button-utils', function (b, d, a) {
      function g(a) {
        return 'atfc-spinner-' + (a.asin ? a.asin : a.clientId ? a.clientId : 'noAsin')
      }
      var f = !1
      return {
        hideButtonAndRenderSpinner: function (a) {
          var b = a.$currentTarget.find('.a-button')
          if (b && b.length) {
            f = !0
            a = g(a.data)
            var c = b.not('.aok-hidden').not('.non-spinner')
            c &&
              a.length &&
              (c.wrap('\x3cdiv id\x3d"' + a + '" class\x3d"atfc-spinner"\x3e\x3c/div\x3e'),
              d('#' + a).css({ width: c.outerWidth() + 'px' }),
              d('#' + a).css({ height: c.outerHeight() + 'px' }))
            b.css('visibility', 'hidden')
          }
        },
        showButtonAndRemoveSpinner: function (a) {
          var b = a.$currentTarget.find('.a-button'),
            c = g(a.data)
          c = d('#' + c)
          b &&
            b.length &&
            c &&
            c.length &&
            ((f = !1),
            b.each(function () {
              d(this).parent().hasClass('atfc-spinner') && d(this).unwrap()
            }),
            b.css('visibility', 'visible'))
          a.data &&
            a.data.qsUID &&
            !1 === a.data.setQuantityFlag &&
            e.when('QuantitySelectorUtils').execute(function (b) {
              b = b.getQsWidgetButton(a.data.qsUID)
              b.length && b.focus()
            })
        },
        shouldDisableButtonClicks: function () {
          return f
        },
      }
    })
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.when('fresh-shared-add-to-cart-v2', 'qs-fresh-shared-add-to-cart').register(
      'fresh-add-to-cart',
      function (b, d) {
        function a(a) {
          b.attachCallbacks(a)
        }
        b.initialize('desktop')
        d.initialize('desktop')
        return {
          addToFreshCart: function (b) {
            a(b)
          },
          attachCallbacks: a,
          attachPrehooks: function (a) {
            b.attachPrehooks(a)
          },
          updateAddAllQuantityForAsin: b.updateAddAllQuantityForAsin,
          updateQuantity: b.updateQuantity,
        }
      },
    )
  })
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.when(
      'A',
      'alm-cart-action-assets-device',
      'afx-metrics-helper',
      'afx-csm-metrics-utils',
    ).register('alm-cart-action-assets-metrics', function (b, d, a, g) {
      b = a.getMetricsForDevice(d.getDevice())
      g.increment(b.ATFC_ASSET_LOAD)
      return {}
    })
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.when('shared-alm-multi-add-to-cart').register('alm-multi-add-to-cart', function (b) {
      function d(a) {
        b.attachCallbacks(a)
      }
      b.initialize('desktop')
      return {
        multiAddToCart: function (a) {
          d(a)
        },
        attachCallbacks: d,
        attachPreHandler: function (a) {
          b.attachPreHandler(a)
        },
      }
    })
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.when('A', 'alm-cart-action-query-string-utils').register(
      'afx-atfc-v2-proxy',
      function (b, d) {
        return {
          addToFreshCart: function (a) {
            var g = d.addQueryStringParamsToUrl('/alm/addtofreshcart', a.data)
            b.$.ajax(g, {
              type: 'POST',
              contentType: 'application/json',
              data: JSON.stringify(a.data),
            })
              .done(a.success)
              .fail(a.error)
          },
          showGenericErrorModal: function (a) {
            b.post('/alm/atfcGenericErrorModal/', {
              timeout: 5e3,
              success: a.success,
              error: a.error,
            })
          },
        }
      },
    )
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.when('A').register('fx-atfo-proxy', function (b) {
      return {
        addToFreshOrder: function (d) {
          var a = '/fom/add-to-fresh-order'
          d.reftag !== n && (a += '/ref\x3d' + d.reftag)
          d.data !== n &&
            d.data.csrfToken &&
            (a += '?csrf\x3d' + encodeURIComponent(d.data.csrfToken))
          b.post(a, {
            success: d.success,
            error: d.error,
            params: JSON.stringify(d.data),
            paramsFormat: 'json',
            contentType: 'application/json',
          })
        },
        getFallbackErrorModalHtml: function () {
          return {
            header: 'Item was not added to the order',
            errorMessage:
              "We're sorry, there was an error and \x3cb\x3ethis item was not added to your order.\x3c/b\x3e Please try again.",
            footer:
              "\x3cspan class\x3d'a-declarative' data-action\x3d'a-popover-close'data-a-popover-close\x3d'{}'\x3e\n\x3cspan class\x3d'a-button primary-fresh-btn'\x3e\x3cspan class\x3d'a-button-inner'\x3e\x3cinput class\x3d'a-button-input'type\x3d'submit'\x3e\x3cspan class\x3d'a-button-text' aria-hidden\x3d'true'\x3eOK\n\x3c/span\x3e\x3c/span\x3e\x3c/span\x3e\n\x3c/span\x3e",
          }
        },
      }
    })
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.when('A').register('afx-atfc-cart-conflicts-proxy', function (b) {
      function d(a) {
        a.ref = a.reftag
        a.client = 'atfc'
        return a
      }
      return {
        getConflictSummary: function (a) {
          var g = d(a.data)
          b.post('/afx/cartconflicts/getconflictsummary', {
            timeout: 5e3,
            success: a.success,
            error: a.error,
            params: g,
          })
        },
        resolve: function (a) {
          var g = d(a.data)
          b.post('/afx/cartconflicts/resolve', {
            timeout: 5e3,
            success: a.success,
            error: a.error,
            params: g,
          })
        },
        substitute: function (a) {
          a = d(a.data)
          a.sourceUrl = h.location.pathname + h.location.search
          a = b.$.param(a)
          h.location.href = '/afx/cartconflicts/resolve/substitute?' + a
        },
      }
    })
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.when('A').register('afx-get-cart-count', function (b) {
      return function (d) {
        b.get('/alm/addtofreshcart/cartcount', {
          timeout: 5e3,
          success: function (a) {
            d.success && d.success({ isOK: !0, total: { numActiveItem: a.cartCount } })
          },
          error: function (a) {
            d.error && d.error(a)
          },
        })
      }
    })
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.when('A', 'alm-cart-action-query-string-utils').register(
      'alm-multi-add-to-cart-proxy',
      function (b, d) {
        return {
          multiAddToCart: function (a) {
            var g = d.addQueryStringParamsToUrl('/alm/addtocart/multiple', a.data)
            b.$.ajax(g, {
              type: 'POST',
              contentType: 'application/json',
              data: JSON.stringify(a.data),
            })
              .done(a.success)
              .fail(a.error)
          },
        }
      },
    )
  })
  ;('use strict')
  r('ALMCartActionAssetDuplicationGuard', function () {
    return { register: r, when: E }
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.register('afx-callbacks-helper', function (b) {
      function d(b) {
        var g = b in a
        !g && e.log('Unable to retrieve callback for ' + b, 'Error')
        return g
      }
      var a = {}
      return {
        addCallbacks: function (b) {
          a[b.clientID || 'default'] = b
        },
        success: function (b, c, e) {
          b = b in a ? b : 'default'
          d(b) && a[b].success && a[b].success(c, e)
        },
        error: function (b, c, e, l) {
          b = b in a ? b : 'default'
          d(b) && a[b].error && a[b].error(c, e, l)
        },
      }
    })
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.when('A').register('alm-cart-action-assets-device', function (b) {
      return {
        getDevice: function () {
          return 'desktop'
        },
      }
    })
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.register('afx-preHandler-helper', function (b) {
      var d = {}
      return {
        addPreHandler: function (a) {
          d[a.clientID || 'default'] = a
        },
        getPreHandler: function (a) {
          return d[a]
        },
      }
    })
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.register('afx-prehooks-helper', function (b) {
      function d(b) {
        var d = b in a ? b : 'default'
        d = d in a && a[d].invoke
        !d && e.log('Unable to retrieve prehook for ' + b, 'Error')
        return d
      }
      var a = {}
      return {
        addPrehooks: function (b) {
          a[b.clientID || 'default'] = b
        },
        invoke: function (b, c) {
          var g = b.clientId in a ? b.clientId : 'default'
          d(b.clientId) && a[g].invoke(b.triggerEvent, c, b.scope, b.success, b.failure, b.device)
        },
        validatePrehook: d,
        prehooksWeblabEnabled: !1,
      }
    })
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.register('afx-csm-metrics-utils', function () {
      var b = {},
        d = function (a, b) {
          h.ue && h.ue.count && a && b && h.ue.count(a, b)
        }
      return {
        startWidgetTimer: function (a) {
          b[a] = Date.now()
        },
        endWidgetTimer: function (a, c) {
          a = Date.now() - b[a]
          d(c, a)
        },
        setWidgetClickTimestamp: function (a) {
          h.ue && h.uet && a && h.uet('tc', a, { wb: 1 })
        },
        setWidgetTimestamp: function (a, b) {
          h.ue && h.uet && a && b && h.uet(a, b, { wb: 1 })
        },
        increment: function (a) {
          h.ue && h.ue.count && a && h.ue.count(a, (h.ue.count(a) || 0) + 1)
        },
        setCount: d,
        sendWidgetMetrics: function (a) {
          h.ue && h.uex && a && h.uex('ld', a, { wb: 1 })
        },
      }
    })
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.register('add-to-cart-common-utils', function () {
      return {
        vibrate: function () {
          return (
            h.amazon &&
            h.amazon.cordova &&
            h.amazon.cordova.notification &&
            h.amazon.cordova.notification.vibrate &&
            h.amazon.cordova.notification.vibrate(50)
          )
        },
      }
    })
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.when('A', 'a-modal').register('fresh-atfc-modal-utils', function (b, d) {
      return {
        removeModal: function () {
          var a = d.get('fresh-add-to-cart-modal')
          a && d.remove(a)
        },
        showModal: function (a, c, e) {
          c &&
            ((c = {
              name: 'fresh-add-to-cart-modal',
              header: c.header,
              inlineContent: c.body,
              footer: c.footer,
            }),
            'desktop' === e && (c.width = 325),
            d.create(a.$currentTarget, c).show(),
            b.on('a:popover:afterHide:'.concat('fresh-add-to-cart-modal'), function (a) {
              d.remove(a.popover)
            }))
        },
      }
    })
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.when(
      'A',
      'jQuery',
      'afx-atfc-v2-proxy',
      'afx-csm-metrics-utils',
      'afx-metrics-helper',
      'afx-quantity-helper',
      'fresh-atfc-ewc-helper',
      'fresh-atfc-fallback-error-modal-helper',
    ).register('fresh-atfc-error-modal-utils', function (b, d, a, c, f, k, l, h) {
      function g(a, c, d, f) {
        e.when('a-modal').execute('showModal', function (w) {
          c || m(a)
          a.data.quantity &&
            (k.updateQuantity('fresh-clear-slot-button', a.data.quantity),
            k.updateQuantity('alcohol-warning-fresh-add-to-cart-button', a.data.quantity),
            k.updateQuantity(
              'regions-out-of-sync-inline-fresh-add-to-cart-button',
              a.data.quantity,
            ))
          var e = {
            name: 'fresh-add-to-cart-error-modal',
            header: c.header,
            inlineContent: c.errorMessage,
            footer: c.footer,
            data: { event: a, response: f },
          }
          'desktop' === d && (e.width = 325)
          w.create(a.$currentTarget, e).show()
          b.on('a:popover:afterHide:'.concat('fresh-add-to-cart-error-modal'), function (b) {
            l.refreshCart(a.data.sessionID)
            w.remove(b.popover)
          })
        })
      }
      function m(c, w) {
        a.showGenericErrorModal({
          success: function (a, b, e) {
            a && ((a = d.parseJSON(e.http.response)), q(c, a, w))
          },
          error: function () {
            e.log('Failed to get the generic error modal', 'Error')
            var a = h.getFallbackErrorModal()
            c.data.qsUID &&
              c.data.prevSelectedQty &&
              c.data.isStepperFlag &&
              (b.isListening('quantity-selector-widget:sync-stepper-quantity')
                ? b.trigger(
                    'quantity-selector-widget:sync-stepper-quantity',
                    c.data.asin,
                    c.data.prevSelectedQty,
                    c.data.storeId,
                  )
                : b.trigger(
                    'quantity-selector-widget:selectQuantity:clientUpdate',
                    c.data.qsUID,
                    c.data.prevSelectedQty,
                    !1,
                  ))
            g(c, a, w)
          },
        })
      }
      function t(a, b) {
        if (a.data.asin && a.data.storeId && b.clientResponseModel && b.clientResponseModel.items) {
          var c = b.clientResponseModel.items.filter(function (b) {
            return b.ASIN === a.data.asin
          })
          1 < c.length &&
            (c = c.filter(function (b) {
              return b.ASIN === a.data.asin && b.storeId === a.data.storeId
            }))
          if (1 === c.length && c[0].hasOwnProperty('amountInCart'))
            return parseFloat(c[0].amountInCart)
          if (
            b.clientResponseModel.uberCartStatus &&
            a.data.prevSelectedQty &&
            'INTERNAL_SERVER_ERROR' === b.clientResponseModel.uberCartStatus.errorStatusCode
          )
            return parseFloat(a.data.prevSelectedQty)
        }
        return 0
      }
      function q(a, d, e) {
        var w = d.errorModalHtml,
          k = f.getMetricsForDevice(e)
        d.clientResponseModel &&
          d.clientResponseModel.uberCartStatus &&
          d.clientResponseModel.uberCartStatus.errorStatusCode in k &&
          c.increment(k[d.clientResponseModel.uberCartStatus.errorStatusCode])
        a.data.qsUID &&
          ((k = t(a, d)),
          null != k &&
            a.data.isStepperFlag &&
            (b.isListening('quantity-selector-widget:sync-stepper-quantity')
              ? b.trigger(
                  'quantity-selector-widget:sync-stepper-quantity',
                  a.data.asin,
                  k,
                  a.data.storeId,
                )
              : b.trigger(
                  'quantity-selector-widget:selectQuantity:clientUpdate',
                  a.data.qsUID,
                  k,
                  !1,
                )))
        g(a, w, e, d)
      }
      return {
        removeModal: function () {
          e.when('a-modal').execute('removeModal', function (a) {
            var b = a.get('fresh-add-to-cart-error-modal')
            b && a.remove(b)
          })
        },
        showModal: g,
        showGenericErrorModal: m,
        parseResponseAndShowErrorModal: q,
        getItemInCartQuantityFromResponse: t,
      }
    })
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.when('A', 'jQuery', 'afx-atfc-v2-proxy', 'afx-get-cart-count').register(
      'fresh-atfc-ewc-helper',
      function (b, c, a, g) {
        function d(a) {
          g({
            sessionID: a,
            success: function (a) {
              a && a.isOK && a.total && k(a.total.numActiveItem)
            },
            error: function () {
              e.log('Failed to get cart count', 'Error', a)
            },
          })
        }
        function k(a) {
          e.when('nav.setCartCount').execute(function (b) {
            b(a)
          })
          e.when('mash').execute(function (b) {
            b.cart &&
              'function' === typeof b.cart.didUpdate &&
              b.cart.didUpdate({ newCartQuantity: a })
          })
        }
        var l
        e.when('EWC').execute('add-to-cart-refresh', function (a) {
          l = a
        })
        e.when('nav.getFlyout').execute(function (a) {
          a('ewc')
        })
        return {
          refreshCart: function (a) {
            l !== n && 'function' === typeof l.refresh ? l.refresh() : d(a)
          },
        }
      },
    )
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.when(
      'A',
      'afx-storeIntroductionSheet-helper',
      'afx-cpi-helper',
      'afx-notification-helper',
    ).register('f3-consumables-atc-helper', function (b, c, a, e) {
      return {
        handleAddToCart: function (d, g, l) {
          ;(g.storeIntroductionSheetHtml && g.storeIntroductionSheetHtml.content) ||
          (d.additionalParams && d.additionalParams.shouldRenderSIS)
            ? c.render(d, g, l)
            : g.renderUFGCartProgressIndicator
              ? a.render(d)
              : b.trigger('fresh-atfc:success', 'false', { almBrandId: d.brandId })
          e.handleAddToCart(g, l)
        },
      }
    })
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.register('afx-metrics-helper', function () {
      var b = {
        ATFC_COUNT: 'afxAddToFreshCartCount',
        ALM_MULTI_ATC_COUNT: 'almMultiAddToCartCount',
        ATFC_ASSET_LOAD: 'almAssetLoadCount',
        ATFC_SUCCESSFUL_ADD_COUNT: 'afxAddToFreshCartSuccessfulAddCount',
        ALM_MULTI_ATC_COUNT_SUCCESS: 'almMultiAddToCartCountSuccess',
        ATFC_ERROR_MODAL_COUNT: 'afxAddToFreshCartErrorModalCount',
        ALM_MULTI_ATC_COUNT_ERROR_MODAL: 'almMultiAddToCartCountErrorModal',
        ATFC_UNEXPECTED_ERROR_COUNT: 'afxAddToFreshCartUnexpectedErrorCount',
        ALM_MULTI_ATC_COUNT_ERROR_UNEXPECTED: 'almMultiAddToCartCountErrorUnexpected',
        ATFC_LATENCY_SCOPE: 'afxAddToFreshCartLatencyScope',
        ATFC_ERROR_MODAL_LATENCY_SCOPE: 'afxAddToFreshCartErrorModalLatencyScope',
        ATFC_CTCF: 'afxAddToFreshCartCTCF',
        ATFC_STORE_INTRODUCTION_SHEET: 'afxStoreIntroductionSheet',
        ATFC_OCX_STORE_INTRODUCTION_SHEET: 'afxOfferComparisonStoreIntroductionSheet',
        CLEAR_SLOT_ATFC_CTCF: 'afxClearSlotAndAddToFreshCartCTFC',
        CART_SERVICE_RESPONSE_FALSE: 'afxCartServiceResponseIsNotOKErrorCount',
        ATFC_NOTIFICATION_RETRY: 'afxAddToCartNotificationRetryCount',
        ATFC_NOTIFICATION_FAILURE: 'afxAddToCartNotificationFailureCount',
        ITEM_NOT_AVAILABLE: 'afxItemNotAvailableErrorModalCount',
        ITEM_PARTIALLY_AVAILABLE: 'afxItemPartiallyAvailableErrorModalCount',
        ITEM_PARTIALLY_AVAILABLE_FOR_RESERVATION: 'afxItemPartiallyAvailableErrorModalCount',
        ADDRESS_NOT_SELECTED: 'afxAddressNotSelectedErrorCount',
        INPUT_INVALID: 'afxGeneralErrorModalCount',
        ITEM_NOT_AVAILABLE_FOR_RESERVATION: 'afxItemNotAvailableForReservationErrorModalCount',
        INTERNAL_SERVER_ERROR: 'afxGeneralErrorModalCount',
        PRICE_UNAVAILABLE: 'afxItemNotAvailableErrorModalCount',
        QUANTITY_OVERFLOW: 'afxUniqueItemQuantityOverflowErrorModalCount',
      }
      return {
        getMetricsForDevice: function (c) {
          var a = {}
          Object.keys(b).forEach(function (d) {
            a[d] = b[d] + ':' + c
          })
          return a
        },
      }
    })
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.when('A').register('afx-quantity-helper', function (b) {
      var c = {}
      return {
        updateQuantity: function (a, b) {
          'undefined' !== typeof a && null !== a && !isNaN(b) && 0 < b && (c[a] = b || 1)
        },
        getQuantity: function (a) {
          a = a.closest('.a-button')
          return 0 < a.length ? c[a.attr('id')] || 1 : 1
        },
      }
    })
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.when('A', 'afx-csm-metrics-utils', 'afx-metrics-helper', 'f3-glowchangeaddress').register(
      'afx-storeIntroductionSheet-helper',
      function (b, c, a, g) {
        function d(a) {
          e.when('a-sheet').execute(function (b) {
            b.create({ inlineContent: a, closeType: 'icon', height: 190 }).show()
            h('mobile', !1)
          })
        }
        function k(a, c, d) {
          var f = a.additionalParams
          if (a.asin && a.brandId && a.offerListingDiscriminator && a.storeId) {
            var g = {
              almBrandId: a.brandId,
              almStoreId: a.storeId,
              asin: a.asin,
              isDelivery: c.delivery,
              offerListingDiscriminator: a.offerListingDiscriminator,
              isAlmDetailPageBopis: c.almDetailPageBopis,
            }
            c.newGlowAddressId && (g.newGlowAddressId = c.newGlowAddressId)
            a.clientID && (g.clientId = a.clientID)
            f && f.sisDeliveryMessage && (g.deliveryMessage = 'DELIVERY_MESSAGE_PLACEHOLDER')
            b.get('/mulon/alm-sis', {
              params: g,
              accepts: 'text/html; charset\x3dutf-8',
              timeout: 3e3,
              success: function (a) {
                var b = document.getElementById('almStoreIntroductionSheet')
                b ||
                  ((b = document.createElement('div')),
                  b.setAttribute('id', 'almStoreIntroductionSheet'),
                  document.body.appendChild(b))
                l(b, a, f.sisDeliveryMessage)
                h(d, !0)
              },
              error: function (a, b, c) {
                e.log('Failed to render store introduction sheet: ' + c, 'Error')
              },
            })
          } else e.log('Failed to render store introduction sheet: Missing Parameters', 'Error')
        }
        function l(a, b, c) {
          a.innerHTML = b
          if ((b = a.querySelector('#store-introduction-sheet-delivery-message span')))
            b.innerHTML = c
          a.querySelectorAll('script').forEach(function (a) {
            var b = document.createElement('script')
            Array.from(a.attributes).forEach(function (a) {
              b.setAttribute(a.name, a.value)
            })
            b.appendChild(document.createTextNode(a.innerHTML))
            a.parentNode.replaceChild(b, a)
          })
        }
        function h(b, d) {
          b = a.getMetricsForDevice(b)
          d
            ? c.increment(b.ATFC_OCX_STORE_INTRODUCTION_SHEET)
            : c.increment(b.ATFC_STORE_INTRODUCTION_SHEET)
        }
        function n(a, c) {
          var d = a.newGlowAddressId,
            e = a.storeFrontUrl,
            f = a.isAlmDetailPageBopis
          if (d)
            if (
              (g.setAddress({ addressId: d, almBrandId: a.almBrandId }), b.capabilities.isAmazonApp)
            )
              m(e, f, c)
            else
              b.on('packard:glow:destinationChangeNavAck', function () {
                m(e, f, c)
              })
          else m(e, f, c)
        }
        function m(a, b, c) {
          b ? (c ? q() : p()) : a && (location.href = a)
        }
        function p() {
          e.when('a-sheet').execute(function (a) {
            var b = a.get('alm-store-introduction-sheet')
            a.hideSheet(b)
            b.destroy()
          })
        }
        function q() {
          var a = b.$('#store-introduction-sheet-side-sheet-container').width() + 30
          v({ right: '-' + a + 'px' }, function () {
            b.$('#store-introduction-sheet-side-sheet-container').remove()
          })
          b.$('body').css({ overflow: 'visible' })
          b.hide(b.$('#store-introduction-sheet-background'))
          b.$('#store-introduction-sheet-background').remove()
        }
        function v(a, c) {
          b.animate(b.$('#store-introduction-sheet-side-sheet-container'), a, 300, 'ease-out', c)
        }
        b.declarative('sis-storefront-button-action', 'click', function (a) {
          n(a.data, !0)
        })
        b.declarative('sis-storefront-button-action-mobile', 'click', function (a) {
          n(a.data, !1)
        })
        return {
          render: function (a, b, c) {
            a.additionalParams && a.additionalParams.shouldRenderSIS
              ? b && b.storeIntroductionSheetEnabled && k(a, b, c)
              : 'mobile' === c && d(b.storeIntroductionSheetHtml.content)
          },
        }
      },
    )
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.when('A').register('afx-cpi-helper', function (b) {
      return { render: function (b) {} }
    })
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.when('A').register('f3-glowchangeaddress', function (b) {
      function c(c, d) {
        var f = {}
        c = g(c)
        '' == c
          ? e.log(
              'CSRF Token not available in response from get-rendered-address-selections response',
              'Error',
            )
          : ((f.addressId = d.addressId),
            (f.almBrandId = d.almBrandId),
            (f.actionSource = 'f3-pickup-conflict'),
            (f.locationType = 'ACCOUNT_ADDRESS'),
            (f.deviceType = 'web'),
            (f.pageType = h.ue_pty),
            b.post('/portal-migration/hz/glow/address-change?actionSource\x3dglow', {
              headers: { 'Content-Type': 'application/json', 'anti-csrftoken-a2z': c },
              params: f,
              paramsFormat: 'json',
              success: function (b) {
                a()
              },
              error: function () {
                e.log('Unable to set GLOW address', 'ERROR')
              },
            }))
      }
      function a() {
        b.capabilities.isAmazonApp
          ? e.when('BottomSheetPlugin').execute(
              function (a) {
                a.UpdateGlowIngress({})
              }.bind(this),
            )
          : b.trigger('packard:glow:destinationChangeNav')
      }
      function g(a) {
        var b = a.indexOf('"', a.indexOf('CSRF_TOKEN')) + 1
        if (0 != b) {
          var c = a.indexOf('"', b)
          return a.substring(b, c)
        }
        return ''
      }
      return {
        setAddress: function (a) {
          b.get(
            '/portal-migration/hz/glow/get-rendered-address-selections?deviceType\x3ddesktop\x26pageType\x3dDetail\x26storeContext\x3dgrocery\x26actionSource\x3ddesktop-modal',
            {
              headers: {
                'Content-Type': 'application/json',
                'anti-csrftoken-a2z': b.$('#glowValidationToken').val() || '',
              },
              success: function (b) {
                c(b, a)
              },
              error: function () {
                e.log('Unable to get rendered address content', 'ERROR')
              },
            },
          )
        },
        refreshGlowIngress: a,
      }
    })
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.when('A').register('search-add-to-cart-helper', function (b) {
      return {
        start: function () {
          e.now('rush-framework', 'rush-dispatcher').execute(function (b, a) {
            b !== n && a !== n && a.trigger('search-add-to-cart:start', {})
          })
        },
        success: function (b, a) {
          e.now('rush-framework', 'rush-dispatcher').execute(function (c, d) {
            c !== n && d !== n && d.trigger('search-add-to-cart:success', { response: a, event: b })
          })
        },
        error: function () {
          e.now('rush-framework', 'rush-dispatcher').execute(function (b, a) {
            b !== n && a !== n && a.trigger('search-add-to-cart:error', {})
          })
        },
      }
    })
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.when('A', 'afx-csm-metrics-utils', 'afx-metrics-helper').register(
      'afx-notification-helper',
      function (b, c, a) {
        return { handleAddToCart: function (a, b) {} }
      },
    )
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.when('A', 'afx-atfc-cart-conflicts-proxy').register(
      'afx-atfc-cart-conflicts-executor',
      function (b, c) {
        return {
          execute: function (a) {
            c.getConflictSummary({
              data: a.data,
              success: function (d, e, k) {
                !0 === d.isSuccess
                  ? !0 === d.hasConflicts
                    ? c.substitute({ data: a.data })
                    : c.resolve({
                        data: a.data,
                        success: function () {
                          b.trigger('fresh-cart-conflict-resolution:success')
                          location.reload()
                        },
                        error: a.error,
                      })
                  : a.error(k, e, 'Failed to call getconflictsummary')
              },
              error: a.error,
            })
          },
        }
      },
    )
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.when(
      'A',
      'afx-atfc-v2-proxy',
      'fx-atfo-proxy',
      'fx-atfc-button-utils',
      'afx-csm-metrics-utils',
      'afx-metrics-helper',
      'afx-quantity-helper',
      'afx-prehooks-helper',
      'afx-callbacks-helper',
      'afx-atfc-cart-conflicts-executor',
      'fresh-atfc-error-modal-utils',
      'fresh-atfc-ewc-helper',
      'afx-add-all-helper',
      'f3-consumables-atc-helper',
      'add-to-cart-common-utils',
      'f3-glowchangeaddress',
      'search-add-to-cart-helper',
    ).register(
      'fresh-shared-add-to-cart-v2',
      function (b, c, a, g, f, k, h, t, y, m, p, q, v, w, r, F, A) {
        return {
          updateQuantity: h.updateQuantity,
          attachPrehooks: t.addPrehooks,
          attachCallbacks: y.addCallbacks,
          updateAddAllQuantityForAsin: v.updateQuantityForAsin,
          initialize: function (d) {
            function l(a) {
              return a.isItemSoldByCount
                ? !JSON.parse(a.isItemSoldByCount)
                : a.pickingStrategy
                  ? 'bulk' === a.pickingStrategy || 'catch' === a.pickingStrategy
                  : !1
            }
            function v(a, b, c, e) {
              r.vibrate()
              a.data.amountInUom === n &&
                l(a.data) &&
                ((a.data.amountInUom = a.data.quantity), (a.data.quantity = 1))
              var u = {
                  clientId: a.data.clientID,
                  triggerEvent: a,
                  scope: b,
                  success: c,
                  failure: e,
                  device: d,
                },
                g = C(a, b, e)
              t && t.prehooksWeblabEnabled && t.validatePrehook(u.clientId)
                ? t.invoke(u, {
                    success: D,
                    error: function (a, b, c) {
                      g(a, b, c)
                    },
                  })
                : D(a, b, c, e)
            }
            function C(a, b, c) {
              return function (e, u, h) {
                var k = x.ATFC_CTCF,
                  m = e.responseText
                p.removeModal()
                if (m) {
                  var l = JSON.parse(m)
                  k = x.ATFC_CTCF + ':lineItemBucket:' + B(l.clientResponseModel)
                }
                400 === e.status && l
                  ? (f.increment(x.ATFC_ERROR_MODAL_COUNT),
                    p.parseResponseAndShowErrorModal(a, l, d))
                  : 403 === e.status
                    ? location.reload()
                    : (f.increment(x.ATFC_UNEXPECTED_ERROR_COUNT),
                      p.showGenericErrorModal(a, d),
                      y.error(a.data.clientID, a, e, u, h),
                      A.error())
                f.endWidgetTimer(b, k)
                a.data.setQuantityFlag || g.showButtonAndRemoveSpinner(a)
                c && c()
              }
            }
            function D(a, e, h, k) {
              var u = C(a, e, k)
              A.start()
              c.addToFreshCart({
                data: a.data,
                success: function (c, u, k) {
                  if (200 === k.status)
                    if (
                      (f.increment(x.ATFC_SUCCESSFUL_ADD_COUNT),
                      (u = x.ATFC_CTCF + ':lineItemBucket:' + B(c)),
                      f.endWidgetTimer(e, u),
                      (u = p.getItemInCartQuantityFromResponse(a, c)),
                      b.isListening('commit-c5d19d5c') &&
                      a.data.setQuantityFlag !== n &&
                      a.data.qsUID
                        ? b.trigger(
                            'quantity-selector-widget:sync-stepper-quantity',
                            a.data.asin,
                            u,
                            a.data.storeId,
                            a.data.qsUID,
                            !1,
                            !1,
                            !a.data.setQuantityFlag,
                            a.data.clientID,
                          )
                        : a.data.setQuantityFlag && a.data.qsUID
                          ? b.trigger(
                              'quantity-selector-widget:sync-stepper-quantity',
                              a.data.asin,
                              u,
                              a.data.storeId,
                              a.data.qsUID,
                            )
                          : b.trigger(
                              'quantity-selector-widget:sync-stepper-quantity',
                              a.data.asin,
                              u,
                              a.data.storeId,
                            ),
                      q.refreshCart(a.data.sessionID),
                      y.success(a.data.clientID, a, c.clientResponseModel),
                      A.success(a, c.clientResponseModel),
                      c.refreshGlowLabel)
                    ) {
                      if ((F.refreshGlowIngress(), c.storefrontUrl))
                        if (b.capabilities.isAmazonApp) location.href = c.storefrontUrl
                        else
                          b.on('packard:glow:destinationChangeNavAck', function () {
                            location.href = c.storefrontUrl
                          })
                    } else
                      c.shouldRedirectToOgs
                        ? c.ogsUrl
                          ? setTimeout(function () {
                              location.href = c.ogsUrl
                            }, 3e3)
                          : location.reload()
                        : w.handleAddToCart(a.data, c, d)
                  p.removeModal()
                  a.data.setQuantityFlag || g.showButtonAndRemoveSpinner(a)
                  h && h()
                },
                error: function (a, b, c) {
                  u(a, b, c)
                },
              })
            }
            function G(a, c) {
              f.startWidgetTimer(c)
              b.post('/afx/slotselection/cancel', {
                timeout: 5e3,
                params: { token: a.data.additionalParams.csrfToken },
                success: function () {
                  a.data.quantity = h.getQuantity(a.$target)
                  v(a, c, function () {
                    location.reload()
                  })
                },
                error: function () {
                  e.log('Failed to clear reservation')
                  p.showGenericErrorModal(a, d)
                },
              })
            }
            function B(a) {
              return a.items && Math.ceil(a.items.length / 5)
            }
            var x = k.getMetricsForDevice(d),
              z = x.ATFC_LATENCY_SCOPE + Date.now()
            b.on('quantity-selector-widget:action:AddToCartAction', function (a) {
              a.additionalParams && (a.additionalParams = b.$.parseJSON(a.additionalParams))
              a.queryLogInfoParams && (a.queryLogInfoParams = b.$.parseJSON(a.queryLogInfoParams))
              var c = { data: a }
              if (a.tunneledData && a.tunneledData.$target) {
                var d = a.tunneledData.$target
                c = b.$.extend(c, { $target: d, $currentTarget: d, $declarativeTarget: d })
                delete a.tunneledData
              } else
                (a = b.$('#qs-widget-button-container-' + a.qsUID)),
                  (c = b.$.extend(c, { $target: a, $currentTarget: a, $declarativeTarget: a })),
                  c.data.setQuantityFlag || g.hideButtonAndRenderSpinner(c)
              v(c, z)
            })
            b.declarative('fresh-clear-slot', 'click', function (a) {
              a.$currentTarget.context.disabled = !0
              G(a, z)
            })
            b.declarative('fresh-add-to-cart', 'click', function (a) {
              f.startWidgetTimer(z)
              f.increment(x.ATFC_COUNT)
              g.shouldDisableButtonClicks() ||
                a.$currentTarget.find('input').is(':disabled') ||
                (a.data.setQuantityFlag || g.hideButtonAndRenderSpinner(a),
                a.data.qsUID
                  ? b.trigger(
                      'quantity-selector-widget:triggerAction',
                      a.data.qsUID,
                      'AddToCartAction',
                      { $target: a.$currentTarget },
                    )
                  : ((a.data.quantity = h.getQuantity(a.$target)), v(a, z)))
            })
            b.declarative('fresh-add-to-cart-alcohol', 'click', function (a) {
              a.$currentTarget.context.disabled = !0
              f.startWidgetTimer(z)
              a.data.quantity = h.getQuantity(a.$target)
              b.trigger(
                'quantity-selector-widget:sync-stepper-quantity',
                a.data.asin,
                a.data.quantity,
              )
              v(a, z)
            })
            b.declarative('fresh-add-to-cart-regions-resolve', 'click', function (a) {
              a.$currentTarget.context.disabled = !0
              p.removeModal()
              m.execute({
                data: a.data,
                error: function (b, c, e) {
                  p.showGenericErrorModal(a, d)
                  y.error(a.data.clientID, a, b, c, e)
                },
              })
            })
            b.declarative('fresh-add-to-order', 'click', function (b) {
              g.shouldDisableButtonClicks() ||
                (g.hideButtonAndRenderSpinner(b),
                r.vibrate(),
                a.addToFreshOrder({
                  data: b.data,
                  success: function (a, c, d) {
                    200 === d.http.status && y.success(b.data.clientID, b, a.clientResponseModel)
                    g.showButtonAndRemoveSpinner(b)
                  },
                  error: function (c, e, f) {
                    p.removeModal()
                    if (400 === c.http.status)
                      (c = JSON.parse(c.responseText)), p.parseResponseAndShowErrorModal(b, c, d)
                    else if (401 === c.http.status) location.reload()
                    else {
                      var h = a.getFallbackErrorModalHtml()
                      p.showModal(b, h, d)
                      y.error(b.data.clientID, b, c, e, f)
                    }
                    g.showButtonAndRemoveSpinner(b)
                  },
                }))
            })
          },
        }
      },
    )
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.when(
      'A',
      'alm-multi-add-to-cart-proxy',
      'fx-atfc-button-utils',
      'afx-csm-metrics-utils',
      'afx-metrics-helper',
      'afx-callbacks-helper',
      'afx-preHandler-helper',
      'fresh-atfc-error-modal-utils',
      'fresh-atfc-ewc-helper',
      'f3-consumables-atc-helper',
      'add-to-cart-common-utils',
    ).register('shared-alm-multi-add-to-cart', function (b, c, a, e, f, h, l, t, r, m, p) {
      return {
        attachCallbacks: h.addCallbacks,
        attachPreHandler: l.addPreHandler,
        initialize: function (d) {
          function g(f, g, l, q) {
            p.vibrate()
            c.multiAddToCart({
              data: f.data,
              success: function (c, g, p) {
                200 === p.status &&
                  (e.increment(k.ALM_MULTI_ATC_COUNT_SUCCESS),
                  r.refreshCart(f.data.sessionID),
                  b.trigger('multipleAddToCart:success', f.data),
                  h.success(f.data.clientId, f, c),
                  m.handleAddToCart(f.data, c, d))
                t.removeModal()
                a.showButtonAndRemoveSpinner(f)
                l && l()
              },
              error: function (b, c, g) {
                a.showButtonAndRemoveSpinner(f)
                t.removeModal()
                if (b.responseText)
                  try {
                    var m = JSON.parse(b.responseText)
                  } catch (B) {
                    m = n
                  }
                400 === b.status && m
                  ? (e.increment(k.ALM_MULTI_ATC_COUNT_ERROR_MODAL),
                    t.parseResponseAndShowErrorModal(f, m, d))
                  : 403 === b.status
                    ? location.reload()
                    : (e.increment(k.ALM_MULTI_ATC_COUNT_ERROR_UNEXPECTED),
                      t.showGenericErrorModal(f, d))
                h.error(f.data.clientId, f, b, c, g)
                q && q()
              },
            })
          }
          var k = f.getMetricsForDevice(d),
            q = k.ATFC_LATENCY_SCOPE + Date.now()
          b.declarative('alm-multi-add-to-cart', 'click', function (b) {
            e.increment(k.ALM_MULTI_ATC_COUNT)
            var c = l.getPreHandler(b.data.clientId)
            c && c.preHandle && (c = c.preHandle(b)) && (b = c)
            c = b.$currentTarget.find('input')
            !b.data.items ||
              1 > b.data.items.length ||
              a.shouldDisableButtonClicks() ||
              c.is(':disabled') ||
              (a.hideButtonAndRenderSpinner(b), g(b, q))
          })
        },
      }
    })
  })
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    c.when(
      'A',
      'f3-consumables-atc-helper',
      'fresh-atfc-ewc-helper',
      'afx-callbacks-helper',
      'fresh-atfc-error-modal-utils',
      'add-to-cart-common-utils',
    ).register('qs-fresh-shared-add-to-cart', function (b, c, a, e, f, h) {
      return {
        initialize: function (d) {
          function g(a) {
            return 'UFG' == a.cartType && a.response && a.request && a.request.additionalInput
              ? !0
              : !1
          }
          function k(b) {
            if (g(b) && b.response.rawResponse) {
              var h = b.response.rawResponse,
                k = h.jqXHR,
                m = b.request,
                l = m.triggeringEvent
              l.data = m.additionalInput
              l.data && (l.data.isDecreaseQuantityAction = b.isDecreaseQuantityAction)
              200 === k.status &&
                (a.refreshCart(m.sessionId),
                e.success(b.clientName, l, h.clientResponseModel),
                c.handleAddToCart(l.data, h, d))
              f.removeModal()
            }
          }
          b.on('quantity-slider:add-to-cart-start', function (a) {
            h.vibrate()
          })
          b.on('quantity-slider:remove-from-cart-start', function (a) {
            h.vibrate()
          })
          b.on('quantity-slider:remove-from-cart-success', function (a) {
            k(a)
          })
          b.on('quantity-slider:add-to-cart-success', function (a) {
            k(a)
          })
          b.on('quantity-slider:cart-submit-error', function (a) {
            if (g(a)) {
              var b = a.request.triggeringEvent,
                c = a.response,
                h = c.responseText,
                k
              f.removeModal()
              h && (k = JSON.parse(h))
              b.data = a.request.additionalInput
              400 === c.status && k
                ? f.showModal(b, k.errorModalHtml, d)
                : 403 === c.status
                  ? location.reload()
                  : (f.showGenericErrorModal(b, d),
                    e.error(a.clientName, b, c, 'error', c.statusText))
            }
          })
        },
      }
    })
  })
  ;('use strict')
  e.when('ALMCartActionAssetDuplicationGuard').execute(function (c) {
    var b = {
      en: {
        header: 'Item was not added to the cart',
        errorMessage:
          "We're sorry, there was an error and \x3cb\x3ethis item was not added to your cart.\x3c/b\x3e Please try again.",
        footer:
          '\x3cspan class\x3d"a-declarative" data-action\x3d"a-popover-close"data-a-popover-close\x3d"{}"\x3e\n\x3cspan class\x3d"a-button primary-fresh-btn"\x3e\x3cspan class\x3d"a-button-inner"\x3e\x3cinput class\x3d"a-button-input"type\x3d"submit"\x3e\x3cspan class\x3d"a-button-text" aria-hidden\x3d"true"\x3eOK\n    \x3c/span\x3e\x3c/span\x3e\x3c/span\x3e\n\x3c/span\x3e',
      },
      es: {
        header: 'Producto no aadido a la cesta',
        errorMessage:
          'Se ha producido un error y este producto \x3cb\x3eno se ha aadido a tu cesta.\x3c/b\x3e Intntalo de nuevo.',
        footer:
          '\x3cspan class\x3d"a-declarative" data-action\x3d"a-popover-close"data-a-popover-close\x3d"{}"\x3e\n\x3cspan class\x3d"a-button primary-fresh-btn"\x3e\x3cspan class\x3d"a-button-inner"\x3e\x3cinput class\x3d"a-button-input"type\x3d"submit"\x3e\x3cspan class\x3d"a-button-text" aria-hidden\x3d"true"\x3eAceptar\n    \x3c/span\x3e\x3c/span\x3e\x3c/span\x3e\n\x3c/span\x3e',
      },
      ar: {
        header: '      ',
        errorMessage:
          '            .    ',
        footer:
          '\x3cspan class\x3d"a-declarative" data-action\x3d"a-popover-close"data-a-popover-close\x3d"{}"\x3e\n\x3cspan class\x3d"a-button primary-fresh-btn"\x3e\x3cspan class\x3d"a-button-inner"\x3e\x3cinput class\x3d"a-button-input"type\x3d"submit"\x3e\x3cspan class\x3d"a-button-text" aria-hidden\x3d"true"\x3e\n \x3c/span\x3e\x3c/span\x3e\x3c/span\x3e\n\x3c/span\x3e',
      },
      bn: {
        header: '    ',
        errorMessage:
          ' ,                 ',
        footer:
          '\x3cspan class\x3d"a-declarative" data-action\x3d"a-popover-close"data-a-popover-close\x3d"{}"\x3e\n\x3cspan class\x3d"a-button primary-fresh-btn"\x3e\x3cspan class\x3d"a-button-inner"\x3e\x3cinput class\x3d"a-button-input"type\x3d"submit"\x3e\x3cspan class\x3d"a-button-text" aria-hidden\x3d"true"\x3e \n    \x3c/span\x3e\x3c/span\x3e\x3c/span\x3e\n\x3c/span\x3e',
      },
      cs: {
        header: 'Artikel nicht zum Einkaufswagen hinzufgefgt',
        errorMessage:
          'Leider ist ein Fehler aufgetreten und dieser Artikel wurde nicht zu Ihrem Einkaufswagen hinzugefgt. Bitte versuchen Sie es erneut.',
        footer:
          '\x3cspan class\x3d"a-declarative" data-action\x3d"a-popover-close"data-a-popover-close\x3d"{}"\x3e\n\x3cspan class\x3d"a-button primary-fresh-btn"\x3e\x3cspan class\x3d"a-button-inner"\x3e\x3cinput class\x3d"a-button-input"type\x3d"submit"\x3e\x3cspan class\x3d"a-button-text" aria-hidden\x3d"true"\x3eOK\n \x3c/span\x3e\x3c/span\x3e\x3c/span\x3e\n\x3c/span\x3e',
      },
      da: {
        header: 'Artikel nicht zum Einkaufswagen hinzufgefgt',
        errorMessage:
          'Leider ist ein Fehler aufgetreten und dieser Artikel wurde nicht zu Ihrem Einkaufswagen hinzugefgt. Bitte versuchen Sie es erneut.',
        footer:
          '\x3cspan class\x3d"a-declarative" data-action\x3d"a-popover-close"data-a-popover-close\x3d"{}"\x3e\n\x3cspan class\x3d"a-button primary-fresh-btn"\x3e\x3cspan class\x3d"a-button-inner"\x3e\x3cinput class\x3d"a-button-input"type\x3d"submit"\x3e\x3cspan class\x3d"a-button-text" aria-hidden\x3d"true"\x3eOK\n \x3c/span\x3e\x3c/span\x3e\x3c/span\x3e\n\x3c/span\x3e',
      },
      de: {
        header: 'Artikel nicht zum Einkaufswagen hinzufgefgt',
        errorMessage:
          'Leider ist ein Fehler aufgetreten und dieser Artikel wurde nicht zu Ihrem Einkaufswagen hinzugefgt. Bitte versuchen Sie es erneut.',
        footer:
          '\x3cspan class\x3d"a-declarative" data-action\x3d"a-popover-close"data-a-popover-close\x3d"{}"\x3e\n\x3cspan class\x3d"a-button primary-fresh-btn"\x3e\x3cspan class\x3d"a-button-inner"\x3e\x3cinput class\x3d"a-button-input"type\x3d"submit"\x3e\x3cspan class\x3d"a-button-text" aria-hidden\x3d"true"\x3eOK\n    \x3c/span\x3e\x3c/span\x3e\x3c/span\x3e\n\x3c/span\x3e',
      },
      fr: {
        header: 'Article non ajout au panier',
        errorMessage:
          "Nous sommes dsols, il y a eu une erreur et cet article n'a pas t ajout  votre panier. Veuillez ressayer.",
        footer:
          '\x3cspan class\x3d"a-declarative" data-action\x3d"a-popover-close"data-a-popover-close\x3d"{}"\x3e\n\x3cspan class\x3d"a-button primary-fresh-btn"\x3e\x3cspan class\x3d"a-button-inner"\x3e\x3cinput class\x3d"a-button-input"type\x3d"submit"\x3e\x3cspan class\x3d"a-button-text" aria-hidden\x3d"true"\x3eOK\n    \x3c/span\x3e\x3c/span\x3e\x3c/span\x3e\n\x3c/span\x3e',
      },
      hi: {
        header: '     ',
        errorMessage:
          '  ,              .     ',
        footer:
          '\x3cspan class\x3d"a-declarative" data-action\x3d"a-popover-close"data-a-popover-close\x3d"{}"\x3e\n\x3cspan class\x3d"a-button primary-fresh-btn"\x3e\x3cspan class\x3d"a-button-inner"\x3e\x3cinput class\x3d"a-button-input"type\x3d"submit"\x3e\x3cspan class\x3d"a-button-text" aria-hidden\x3d"true"\x3e \n    \x3c/span\x3e\x3c/span\x3e\x3c/span\x3e\n\x3c/span\x3e',
      },
      it: {
        header: 'Articolo non aggiunto al carrello',
        errorMessage:
          'Desculpe, ocorreu um erro e este item \x3cb\x3eno foi adicionado ao seu carrinho.\x3c/b\x3e Por favor, tente novamente.',
        footer:
          '\x3cspan class\x3d"a-declarative" data-action\x3d"a-popover-close"data-a-popover-close\x3d"{}"\x3e\n\x3cspan class\x3d"a-button primary-fresh-btn"\x3e\x3cspan class\x3d"a-button-inner"\x3e\x3cinput class\x3d"a-button-input"type\x3d"submit"\x3e\x3cspan class\x3d"a-button-text" aria-hidden\x3d"true"\x3eOK\n    \x3c/span\x3e\x3c/span\x3e\x3c/span\x3e\n\x3c/span\x3e',
      },
      ja: {
        header: '',
        errorMessage:
          '\x3cb\x3e\x3c/b\x3e',
        footer:
          '\x3cspan class\x3d"a-declarative" data-action\x3d"a-popover-close"data-a-popover-close\x3d"{}"\x3e\n\x3cspan class\x3d"a-button primary-fresh-btn"\x3e\x3cspan class\x3d"a-button-inner"\x3e\x3cinput class\x3d"a-button-input"type\x3d"submit"\x3e\x3cspan class\x3d"a-button-text" aria-hidden\x3d"true"\x3eOK\n    \x3c/span\x3e\x3c/span\x3e\x3c/span\x3e\n\x3c/span\x3e',
      },
      kn: {
        header: '   ',
        errorMessage:
          ' ,          .   .',
        footer:
          '\x3cspan class\x3d"a-declarative" data-action\x3d"a-popover-close"data-a-popover-close\x3d"{}"\x3e\n\x3cspan class\x3d"a-button primary-fresh-btn"\x3e\x3cspan class\x3d"a-button-inner"\x3e\x3cinput class\x3d"a-button-input"type\x3d"submit"\x3e\x3cspan class\x3d"a-button-text" aria-hidden\x3d"true"\x3e\n    \x3c/span\x3e\x3c/span\x3e\x3c/span\x3e\n\x3c/span\x3e',
      },
      ml: {
        header: '  ',
        errorMessage:
          ',  ,    .  .',
        footer:
          '\x3cspan class\x3d"a-declarative" data-action\x3d"a-popover-close"data-a-popover-close\x3d"{}"\x3e\n\x3cspan class\x3d"a-button primary-fresh-btn"\x3e\x3cspan class\x3d"a-button-inner"\x3e\x3cinput class\x3d"a-button-input"type\x3d"submit"\x3e\x3cspan class\x3d"a-button-text" aria-hidden\x3d"true"\x3e\n    \x3c/span\x3e\x3c/span\x3e\x3c/span\x3e\n\x3c/span\x3e',
      },
      mr: {
        header: '    ',
        errorMessage:
          '  ,           .    .',
        footer:
          '\x3cspan class\x3d"a-declarative" data-action\x3d"a-popover-close"data-a-popover-close\x3d"{}"\x3e\n\x3cspan class\x3d"a-button primary-fresh-btn"\x3e\x3cspan class\x3d"a-button-inner"\x3e\x3cinput class\x3d"a-button-input"type\x3d"submit"\x3e\x3cspan class\x3d"a-button-text" aria-hidden\x3d"true"\x3e\n    \x3c/span\x3e\x3c/span\x3e\x3c/span\x3e\n\x3c/span\x3e',
      },
      nl: {
        header: 'Artikel nicht zum Einkaufswagen hinzufgefgt',
        errorMessage:
          'Leider ist ein Fehler aufgetreten und dieser Artikel wurde nicht zu Ihrem Einkaufswagen hinzugefgt. Bitte versuchen Sie es erneut.',
        footer:
          '\x3cspan class\x3d"a-declarative" data-action\x3d"a-popover-close"data-a-popover-close\x3d"{}"\x3e\n\x3cspan class\x3d"a-button primary-fresh-btn"\x3e\x3cspan class\x3d"a-button-inner"\x3e\x3cinput class\x3d"a-button-input"type\x3d"submit"\x3e\x3cspan class\x3d"a-button-text" aria-hidden\x3d"true"\x3eOK\n \x3c/span\x3e\x3c/span\x3e\x3c/span\x3e\n\x3c/span\x3e',
      },
      pl: {
        header: 'Artikel nicht zum Einkaufswagen hinzufgefgt',
        errorMessage:
          'Leider ist ein Fehler aufgetreten und dieser Artikel wurde nicht zu Ihrem Einkaufswagen hinzugefgt. Bitte versuchen Sie es erneut.',
        footer:
          '\x3cspan class\x3d"a-declarative" data-action\x3d"a-popover-close"data-a-popover-close\x3d"{}"\x3e\n\x3cspan class\x3d"a-button primary-fresh-btn"\x3e\x3cspan class\x3d"a-button-inner"\x3e\x3cinput class\x3d"a-button-input"type\x3d"submit"\x3e\x3cspan class\x3d"a-button-text" aria-hidden\x3d"true"\x3eOK\n \x3c/span\x3e\x3c/span\x3e\x3c/span\x3e\n\x3c/span\x3e',
      },
      pt: {
        header: 'O item no foi adicionado ao carrinho',
        errorMessage:
          'Desculpe, ocorreu um erro e este item \x3cb\x3eno foi adicionado ao seu carrinho.\x3c/b\x3e Por favor, tente novamente.',
        footer:
          '\x3cspan class\x3d"a-declarative" data-action\x3d"a-popover-close"data-a-popover-close\x3d"{}"\x3e\n\x3cspan class\x3d"a-button primary-fresh-btn"\x3e\x3cspan class\x3d"a-button-inner"\x3e\x3cinput class\x3d"a-button-input"type\x3d"submit"\x3e\x3cspan class\x3d"a-button-text" aria-hidden\x3d"true"\x3eOK\n    \x3c/span\x3e\x3c/span\x3e\x3c/span\x3e\n\x3c/span\x3e',
      },
      ta: {
        header: '  ',
        errorMessage:
          ',  ,     .  .',
        footer:
          '\x3cspan class\x3d"a-declarative" data-action\x3d"a-popover-close"data-a-popover-close\x3d"{}"\x3e\n\x3cspan class\x3d"a-button primary-fresh-btn"\x3e\x3cspan class\x3d"a-button-inner"\x3e\x3cinput class\x3d"a-button-input"type\x3d"submit"\x3e\x3cspan class\x3d"a-button-text" aria-hidden\x3d"true"\x3e\n    \x3c/span\x3e\x3c/span\x3e\x3c/span\x3e\n\x3c/span\x3e',
      },
      te: {
        header: '  ',
        errorMessage:
          ' ,          .   .',
        footer:
          '\x3cspan class\x3d"a-declarative" data-action\x3d"a-popover-close"data-a-popover-close\x3d"{}"\x3e\n\x3cspan class\x3d"a-button primary-fresh-btn"\x3e\x3cspan class\x3d"a-button-inner"\x3e\x3cinput class\x3d"a-button-input"type\x3d"submit"\x3e\x3cspan class\x3d"a-button-text" aria-hidden\x3d"true"\x3e\n    \x3c/span\x3e\x3c/span\x3e\x3c/span\x3e\n\x3c/span\x3e',
      },
      tr: {
        header: 'Artikel nicht zum Einkaufswagen hinzufgefgt',
        errorMessage:
          'Leider ist ein Fehler aufgetreten und dieser Artikel wurde nicht zu Ihrem Einkaufswagen hinzugefgt. Bitte versuchen Sie es erneut.',
        footer:
          '\x3cspan class\x3d"a-declarative" data-action\x3d"a-popover-close"data-a-popover-close\x3d"{}"\x3e\n\x3cspan class\x3d"a-button primary-fresh-btn"\x3e\x3cspan class\x3d"a-button-inner"\x3e\x3cinput class\x3d"a-button-input"type\x3d"submit"\x3e\x3cspan class\x3d"a-button-text" aria-hidden\x3d"true"\x3eOK\n \x3c/span\x3e\x3c/span\x3e\x3c/span\x3e\n\x3c/span\x3e',
      },
      zh: {
        header: '',
        errorMessage: '\x3cb\x3e\x3c/b\x3e',
        footer:
          '\x3cspan class\x3d"a-declarative" data-action\x3d"a-popover-close"data-a-popover-close\x3d"{}"\x3e\n\x3cspan class\x3d"a-button primary-fresh-btn"\x3e\x3cspan class\x3d"a-button-inner"\x3e\x3cinput class\x3d"a-button-input"type\x3d"submit"\x3e\x3cspan class\x3d"a-button-text" aria-hidden\x3d"true"\x3e\n    \x3c/span\x3e\x3c/span\x3e\x3c/span\x3e\n\x3c/span\x3e',
      },
    }
    c.when('A').register('fresh-atfc-fallback-error-modal-helper', function (c) {
      return {
        getFallbackErrorModal: function () {
          var a = document.querySelector('html[lang]')
          return a && ((a = a.getAttribute('lang')), a !== n && ((a = a.split('-')), a.length))
            ? b[a[0]]
            : b.en
        },
      }
    })
  })
})
/* ******** */
;(function (b) {
  var c = window.AmazonUIPageJS || window.P,
    d = c._namespace || c.attributeErrors,
    a = d ? d('USSAlmCartActionAssets', '') : c
  a.guardFatal
    ? a.guardFatal(b)(a, window)
    : a.execute(function () {
        b(a, window)
      })
})(function (b, c, d) {
  'use strict'
  b.when('A').register('uss-alm-atc-constants', function (a) {
    return {
      clientIdList: {
        USS_ALM_WIDGET_DP_MOBILE: 'uss-alm-widget-dp-mobile',
        USS_ALM_WIDGET_DP_DESKTOP: 'uss-alm-widget-dp-desktop',
        USS_ALM_WIDGET_SEARCH_MOBILE: 'uss-alm-widget-search-mobile',
        USS_ALM_WIDGET_SEARCH_DESKTOP: 'uss-alm-widget-search-desktop',
      },
      metrics: {
        SECONDARY_ALM_ADD_TO_CART_CLICK_SUCCESS_COUNTER: 'secondaryAlmAtcClickSuccess',
        SECONDARY_ALM_ADD_TO_CART_CLICK_ERROR_COUNTER: 'secondaryAlmAtcClickError',
      },
    }
  })
})
/* ******** */
;(function (c) {
  var b = window.AmazonUIPageJS || window.P,
    d = b._namespace || b.attributeErrors,
    a = d ? d('DetailPageUSSPromotionNudgesAssets', '') : b
  a.guardFatal
    ? a.guardFatal(c)(a, window)
    : a.execute(function () {
        c(a, window)
      })
})(function (c, b, d) {})
/* ******** */
;(function (f) {
  var r = window.AmazonUIPageJS || window.P,
    t = r._namespace || r.attributeErrors,
    e = t ? t('DetailPageUSSAssets', '') : r
  e.guardFatal
    ? e.guardFatal(f)(e, window)
    : e.execute(function () {
        f(e, window)
      })
})(function (f, r, t) {
  f.when('A').register('uss-constants-common', function (e) {
    return {
      classList: {
        SHOW_ELEMENT: 'aok-block',
        HIDE_ELEMENT: 'aok-hidden',
        STOP_SCROLLING: 'uss-u-no-scroll',
        LIGHT_BOX_JS_HOOK: 'js-light-box',
        LIGHT_BOX_IDENTIFIER: 'uss-o-light-box',
        RIGHT_SIDE_SHEET: 'uss-o-right-side-sheet',
        RIGHT_SIDE_SHEET_LAYOUT: 'uss-l-right-side-sheet',
        SHEET_OPEN: 'is-open',
        SHEET_CLOSE: 'is-close',
        USS_SHEET_VIEW_IDENTIFIER: 'uss-sheet-view',
        CLOSE_ICON: 'uss-o-close-icon',
        CLOSE_ICON_MEDIUM: 'uss-o-close-icon-medium',
        USS_SHEET_VIEW_CLOSE_ICON: 'uss-sheet-view-close-icon',
        PROMISING_UI_ELEMENT: 'uss-o-promising-ui-element',
        PROMISING_UI_ELEMENT_ANIMATION: 'uss-o-promising-ui-element-animation',
        IS_LOADING: 'is-loading',
        IS_RESOLVED: 'is-resolved',
        UI_PROMISE: 'ui-promise',
        UI_VALUE: 'ui-value',
        TEMPLATE_STORE: 'uss-template-store',
        TEMPLATE: 'uss-template',
        TEMPLATE_NAME: 'template-name',
        ATC_ACKNOWLEDGEMENT_MESSAGE: 'atc-acknowledgement-message',
        ATC_GENERIC_ERROR: 'atc-generic-error',
        ATC_STATUS_MESSAGE_COMPONENT: 'uss-c-atc-status-msg',
        ATC_SUCCESS: 'uss-mobile-atc-success',
        ATC_ERROR: 'atc-error',
        ITEM_IN_CART: 'item-in-cart',
        SHIPPING_DETAILS: 'uss-c-shipping-details',
        SHIPPING_MESSAGE_PLACEHOLDER: 'shipping-message-placeholder',
        MAIN_IMAGE: 'main-image',
        FACEOUT_IMAGE: 'p13n-sc-list-image-container',
        FACEOUT_TITLE: 'uss-asin-title',
        FACEOUT_REVIEW_STARS: 'uss-review-stars',
        FACEOUT_BEST_SELLER: 'p13n-best-seller',
        FACEOUT_PRICE: 'uss-price',
        ADDITIONAL_RECOMMENDATIONS_TOGGLE_ACTION: 'uss-additional-recommendations-toggle-button',
        CONTINUE_SHOPPING_LINK: 'continue-shopping',
        SUCCESS_ELEMENT: '.p13n-sc-atc-success',
        ERROR_ELEMENT: '.p13n-sc-atc-error',
        REMOVE_FROM_CART_ERROR_ELEMENT: '.p13n-sc-remove-from-cart-error',
        BUTTON_ELEMENT: '.a-button-primary',
        DISABLE_BUTTON: 'a-button-disabled',
        QS_GRID_ELEMENT: '.uss-qs-widget-container',
        QS_INC_BUTTON: '.qs-increase-quantity',
        QS_DEC_BUTTON: '.qs-decrease-quantity',
        QS_LABEL_ELEMENT: '.qs-quantity-label-text',
        QS_MAX_ORDER_LIMIT: '.max-order-quantity-message',
        QS_OPACITY: 'uss-qs-opacity',
        QS_TRASH_CAN: '.qs-decrease-quantity-trash-can',
        QS_DEC_BUTTON_HYPHEN: '.uss-qs-decrease-quantity-hyphen',
      },
      fatalMessagesList: {
        INVALID_SHEET_ID: 'sheetID must be valid string',
        INVALID_CONSTRUCTOR_USAGE: "Constructor needs to be called with 'new' keyword",
        INCORRECT_PARAMETER_PASSED: 'Incorrect parameter passed.',
      },
      quantityStepperUpdateType: { INCREMENT: 'increment', DECREMENT: 'decrement' },
      pageType: { detailPage: { mobileApp: 'DetailWebView', mobileWeb: 'DetailAW' } },
      subPageType: 'mobile-uss',
      widgetType: {
        WIDGET: 'uss-widget',
        RECOMMENDATION_WIDGET: 'uss-recommendation-widget',
        NO_RECOMMENDATION_WIDGET: 'uss-no-recommendation-widget',
        LIST_RECOMMENDATION: 'uss-list-recommendation-widget',
        CAROUSEL_RECOMMENDATION: 'uss-carousel-recommendation-widget',
        PRIMARY_ACTION_STATUS_WIDGET: 'uss-primary-action-status-widget',
        ATCStatusWidget: 'uss-c-atc-status-widget',
        ATC_STATUS_IMB_WIDGET: 'atc-status-imb-widget',
      },
      layout: {
        defaultLayout: {
          DEFAULT_LAYOUT: 'uss-l-default-layout',
          HEAD: 'uss-c-head',
          BODY: 'uss-c-body',
          HEAD_DIVIDER: 'uss-c-head-divider',
          BOTTOM_MARGIN_BETWEEN_WIDGETS: 'a-spacing-medium',
          TOP_MARGIN_BETWEEN_WIDGETS: 'a-spacing-top-medium',
          SKELETON_LOADER: 'uss-loading-skeleton',
          RECOMMENDATION_LOADING_MESSAGE: 'loading-message',
          RECOMMENDATION_LOADED_MESSAGE: 'uss-recommendations-loaded-message',
        },
        quantityStepper: { CONTAINER_ID_PREFIX: '#uss-qs-container-' },
      },
      actionSources: {
        DP_ATC_CLICK: 'dp-atc-click',
        USS_INGRESS_CLICK: 'uss-ingress-click',
        USS_INLINE_ATC_CLICK: 'uss-inline-atc-click',
        SHEET_CLOSE_BUTTON_CLICK: 'sheet-close',
        CONTINUE_SHOPPING_CLICK: 'continue-shopping-click',
      },
      stores: {
        ATC_STATUS_STORE: 'uss-atc-status-store',
        RECOMMENDATION_DATA_STORE: 'uss-recommendation-data-store',
        USS_SHEET_STORE: 'uss-sheet-store',
      },
      actions: {
        USS_OPEN: 'uss-open',
        USS_CLOSE: 'uss-close',
        RECOMMENDATION_DATA_RECEIVE: 'recommendation-data-receive',
        ATC_RECEIVE: 'atc-receive',
      },
      metrics: {
        CART_API_PROMISE_RESOLVED_TIMER: 'cartApiPromiseResolve',
        PRODUCTV2IMAGES_API_PROMISE_RESOLVED_TIMER: 'productV2ImagesApiPromiseResolve',
        ATC_PROMISE_RESOLVED_TIMER: 'atcPromiseResolve',
        SECONDARY_ATC_PROMISE_RESOLVED_TIMER: 'secondaryAtcPromiseResolve',
        PRIMARY_ATC_STATUS_PROMISE_RESOLVED_TIMER: 'primaryAtcStatusPromiseResolve',
        SECONDARY_ATC_STATUS_PROMISE_RESOLVED_TIMER: 'secondaryAtcStatusPromiseResolve',
        PRIMARY_ADDITEMS_API_PROMISE_RESOLVED_TIMER: 'primaryAddItemsApiPromiseResolve',
        SECONDARY_ADDITEMS_API_PROMISE_RESOLVED_TIMER: 'secondaryAddItemsApiPromiseResolve',
        PERCOLATE_DATA_PROMISE_RESOLVED_TIMER: 'percolateDataPromiseResolve',
        PERCOLATE_DATA_PROMISE_RESOLVED_LONG_TIME_COUNTER: 'percolateDataPromiseResolveLongTime',
        USS_PRIMARY_ATC_TIMER: 'ussPrimaryAtc',
        USS_AFTER_PRIMARY_ATC_TIMER: 'ussAfterPrimaryAtc',
        CART_API_PROMISE_REJECTED_COUNTER: 'cartApiPromiseRejected',
        PRODUCTV2IMAGES_API_PROMISE_REJECTED_COUNTER: 'productV2ImagesApiPromiseRejected',
        USS_PRIMARY_ADD_ITEMS_API_CALL_COUNTER: 'ussPrimaryAddItemsApiCall',
        USS_PRIMARY_ATC_MASON_CALL_COUNTER: 'ussPrimaryAtcMasonCall',
        USS_PRIMARY_ATC_AW_MASH_CALL_COUNTER: 'ussPrimaryAtcAwMashCall',
        USS_PRIMARY_AW_MASH_GURUPA_COUNTER: 'ussPrimaryAtcAwMashCallGurupa',
        USS_PRIMARY_AW_MASH_NATC_COUNTER: 'ussPrimaryAtcAwMashCallNatc',
        USS_PRIMARY_AW_MASH_SERVER_FAILURE_COUNTER: 'ussPrimaryAtcAwMashServerFailure',
        USS_PRIMARY_AW_MASH_NATC_FAILURE_COUNTER: 'ussPrimaryAtcAwMashNatcFailure',
        USS_PRIMARY_AW_MASH_GURUPA_FAILURE_COUNTER: 'ussPrimaryAtcAwMashGurupaFailure',
        PRIMARY_ATC_NATC_PARAM_V1_COUNTER: 'primaryAtcNatcParamV1',
        PRIMARY_ATC_NATC_PARAM_V2_COUNTER: 'primaryAtcNatcParamV2',
        PRIMARY_ATC_NATC_PARAM_INVALID_COUNTER: 'primaryAtcNatcParamInvalid',
        ATC_PROMISE_REJECTED_COUNTER: 'atcPromiseRejected',
        PRIMARY_ATC_STATUS_PROMISE_REJECTED_COUNTER: 'primaryAtcStatusPromiseRejected',
        PRIMARY_ATC_MASON_CALL_REJECTED_COUNTER: 'primaryAtcMasonCallRejected',
        SECONDARY_ATC_STATUS_PROMISE_REJECTED_COUNTER: 'secondaryAtcStatusPromiseRejected',
        PRIMARY_ADDITEMS_API_PROMISE_REJECTED_COUNTER: 'primaryAddItemsApiPromiseRejected',
        SECONDARY_ADDITEMS_API_PROMISE_REJECTED_COUNTER: 'secondaryAddItemsApiPromiseRejected',
        PERCOLATE_DATA_PROMISE_REJECTED_COUNTER: 'percolateDataPromiseRejected',
        SECONDARY_ADD_TO_CART_CLICK_COUNTER: 'secondaryAtcClick',
        COMPATIBLE_BROWSER_COUNTER: 'compatibleBrowser',
        NON_COMPATIBLE_BROWSER_COUNTER: 'nonCompatibleBrowser',
        FACEOUT_IMAGE_CLICK_COUNTER: 'faceout:imageClick',
        FACEOUT_REVIEW_STARS_CLICK_COUNTER: 'faceout:reviewStarClick',
        FACEOUT_TITLE_CLICK_COUNTER: 'faceout:titleClick',
        FACEOUT_PRICE_CLICK_COUNTER: 'faceout:priceClick',
        FACEOUT_BEST_SELLER_CLICK_COUNTER: 'faceout:bestSellerClick',
        SEE_MORE_EXISTENCE_COUNTER: 'ussListWidget:seeMore',
        SEE_MORE_CLICK_COUNTER: 'ussListWidget:seeMoreClick',
        SEE_LESS_CLICK_COUNTER: 'ussListWidget:seeLessClick',
        CONTINUE_SHOPPING_CLICK: 'continueShoppingClick',
        PAGE_LANDING_PRECONDITIONS_PASSED: 'pageLandingPreconditionsPassed',
        POST_ATC_PRECONDITIONS_FAILED: 'postATCPreconditionsFailed',
        PROGRAM_ELIGIBILITY_REGISTRY_OVERWRITTEN: 'programEligibilityRegistryOverwritten',
        USS_WEBLAB_IN_TREATMENT: 'ussWeblabInTreatment',
        POST_ATC_WARRANTY_SELECTED_OR_INVALID_ACTION: 'postATCFailedForWarrantyOrInvalidAction',
        POST_ATC_WEBLAB_DISABLED: 'postATCFailedWeblabIsDisabled',
        PRIMARY_ADD_TO_CART_CLICK_COUNTER: 'primaryAtcClick',
        USS_PRIMARY_ATC_DEFAULT_ENDPOINT_SUCCESS_RESPONSE:
          'primaryAtcSuccessMobileWebUsingDefaultEndpoint',
        USS_PRIMARY_ATC_DEFAULT_ENDPOINT_FAIL_RESPONSE:
          'primaryAtcFailureMobileWebUsingDefaultEndpoint',
        PRIMARY_ATC_SUCCESS_COUNTER: 'ussAtcSuccess',
        PRIMARY_ATC_SUCCESS_USS_ELIGIBLE_COUNTER: 'ussAtcSuccessWithUssEligibleTrue',
        PRIMARY_ATC_WARRANTY_SELECTED_USS_ELIGIBLE:
          'PrimaryAtcWarrantySelectedInBuyboxAndUssEligible',
        PRIMARY_ADD_TO_CART_SUCCESS_METHOD_CALLED: 'onPrimaryAddToCartSuccessCalled',
        AFTER_PRIMARY_ATC_ACTION_METHOD_CALLED: 'callAfterPrimaryATCActionCalled',
        QUANTITY_STEPPER_CLICK: 'ussQuantityStepperClick',
        QUANTITY_STEPPER_INCREMENT_CLICK: 'ussQuantityStepperIncrementClick',
        QUANTITY_STEPPER_DECREMENT_CLICK: 'ussQuantityStepperDecrementClick',
        QUANTITY_STEPPER_QUANTITY_UPDATE_FAILURE: 'ussQuantityStepperQuantityUpdateFailure',
        QUANTITY_STEPPER_MODIFY_ITEMS_API_PROMISE_RESOLVED_TIMER:
          'ussQuantityStepperModifyItemsApiPromiseResolve',
        QUANTITY_STEPPER_MAX_ORDER_QUANTITY_REACHED: 'ussQuantityStepperMaxOrderQuantityReached',
        QUANTITY_STEPPER_SUMMARY_API_CALL_FAILURE: 'ussQuantityStepperSummaryApiCallFailure',
        EMPTY_SLATE_TOKEN: 'emptySlateToken',
      },
      transitionTimingFunction: {
        EVEN_EASE: 'cubic-bezier(0.4, 0, 0.6, 1)',
        ENTER_EASE: 'cubic-bezier(0, 0, 0.2, 1)',
        EXIT_EASE: 'cubic-bezier(0.4, 0, 1, 1)',
        EASE_IN: 'ease-in',
        EASE_OUT: 'ease-out',
      },
      animationType: { FADE_IN: 'fadeIn', NO_ANIMATION: 'noAnimation' },
      nexusConstants: { PRODUCER_ID: 'uss', SCHEMA_ID: 'uss.CounterData.', SCHEMA_VERSION: '3' },
      cartApiConstants: {
        USS_CART_TYPE: 'RETAIL',
        USS_SHIPPING_MESSAGE:
          '\n\n      \n\n\n\n  \x3cdiv class\x3d"a-row a-spacing-base"\x3e\n    \n\n  \x3c/div\x3e\n',
        USS_ENVIRONMENT_PROD: 'prod',
        USS_ENVIRONMENT_DEV: 'dev',
        USS_PRODUCTV2IMAGES_PROD_URL_PATH: 'https://m.media-amazon.com/images/I/',
        USS_PRODUCTV2IMAGES_DEV_URL_PATH: 'https://media-origin-na-ssl.integ.amazon.com/images/I/',
        USS_PRODUCTV2IMAGES_DIMENSIONS: '._SS40_.',
        USS_SECONDARY_ATC_QUANTITY: 1,
        USS_PRIMARY_ATC_REFTAG: 'mw_pa_dp_buy_crt',
        BASE_10: 10,
      },
      queryStrings: { qid: 'qid', sr: 'sr' },
      events: {
        PRIMARY_ATC_SUCCESS_EVENT: 'dpx:add-to-cart:success',
        QUANTITY_STEPPER_UPDATE_EVENT: 'uss-qs-update-quantity',
      },
    }
  })
  f.when('dp-flux-attribution', 'uss-constants-common').register('uss-constants', function (e, f) {
    f.ussCTI = { CATEGORY: 'Website', TYPE: 'Detail Page', ITEM: 'USS' }
    f.metrics.PREFIX = 'uss:'
    f.ajaxParams = {
      BASE_URL: '/gp/product/handle-buy-box',
      REFTAG: 'dp_start-bbf_1_glance',
      ASIN: 'ASIN',
      OFFER_LISTING_ID: 'offerListingID',
      AJAX_TIMEOUT: 1e4,
    }
    f.actionSources.SHEET_CLOSE_BUTTON_CLICK = 'sheet-close-button-click'
    f.ussCommonAttribution = new e('uss-common', f.ussCTI.CATEGORY, f.ussCTI.TYPE, f.ussCTI.ITEM)
    f.defaultAtcAnimationType = f.animationType.FADE_IN
    f.atcAnimationStatusEvent = 'uss:atc:animation:status:resolved'
    return f
  })
  f.when('dp-flux-utils', 'uss-constants', 'nexus-util', 'uss-utils').register(
    'uss-logger-service',
    function (e, f, m, n) {
      function d(a, b) {
        if (e.isNonEmptyString(a))
          (a = n.getMetricsPrefix() + a),
            ue && ue.count && (b === t && (b = 1), ue.count(a, b), m.emitCounterData(a, b))
        else throw Error('counterKey must be non empty string')
      }
      function a(a) {
        if (e.isNonEmptyString(a)) (this._timerName = a), (this._startTime = 0)
        else throw Error('timerName must be non empty string')
      }
      a.prototype = {
        start: function () {
          this._startTime = Date.now()
        },
        stop: function () {
          this._startTime && d(this._timerName, Date.now() - this._startTime)
        },
        stopWithCounter: function (a, b, h) {
          if (this._startTime) {
            var l = Date.now() - this._startTime
            d(this._timerName, l)
            l > a && d(b, h)
          }
        },
      }
      return { logCounter: d, Timer: a }
    },
  )
  f.when('A', 'uss-utils', 'uss-logger-service', 'uss-constants').register(
    'uss-preconditions',
    function (e, f, m, n) {
      function d(a) {
        a = e.$('#' + a + '_feature_div').html()
        null !== a && (a = a.trim())
        return null !== a && 0 < a.length
      }
      function a() {
        return e.capabilities.transform && e.capabilities.transition && f.isFlexBoxSupported()
      }
      function c() {
        return e.$('#uss-weblabTreatment').val()
      }
      var b = /^T[0-9]+$/
      a()
        ? m.logCounter(n.metrics.COMPATIBLE_BROWSER_COUNTER)
        : m.logCounter(n.metrics.NON_COMPATIBLE_BROWSER_COUNTER)
      return {
        isUssConditionsPassed: function () {
          var b
          if ((b = 'true' === e.$('#uss-serverPreconditionsPassed').val())) {
            if ((b = a() && !d('scheduledDelivery') && !d('partialStateBuyBox')))
              (b = e.$('#add-to-cart-button')), (b = b.length && 'submit' == b.prop('type'))
            b =
              b &&
              !(
                e.$('#attach-accessory-card-deck').length &&
                (f.isMobileApp() || e.$('#attach-accessory-mobile-web-mbs').length)
              )
          }
          return b
        },
        isUssWeblabInTreatment: function () {
          return b.test(c())
        },
        triggerUSSWeblabValue: function () {
          return b.test(e.$('#uss-miniFrameworkWeblabTreatment').val())
            ? e.$('#uss-weblabValue').val()
            : 1
        },
        ussWeblabTreatmentValue: c,
        checkIfSnsInterstitialExists: function () {
          return d('snsInterstitialWidget')
        },
        getSnsInterstitialTrigger: function () {
          return 'show-sns-interstitial'
        },
        isBrowserUssCompatible: a,
        isMobileAppUssEligible: function () {
          return e.$('#ussEligible').length && '1' === e.$('#ussEligible').val()
        },
      }
    },
  )
  f.when('A', '3p-promise', 'uss-constants').register('uss-utils', function (e, f, m) {
    function n() {
      return 'true' === e.$('#uss-mobileApp').val()
    }
    function d(a) {
      var b = null
      k.hasOwnProperty(a) && (b = k[a])
      return b
    }
    function a() {}
    function c(a) {}
    var b = e.$,
      h = m.classList,
      l = m.pageType,
      g = m.subPageType,
      p = b('body'),
      k = {},
      u = ['isPreview', 'forceWidgets', 'previewCampaigns', 'auditEnabled']
    ;(function () {
      var a = r.location.search,
        a = a.substr(1)
      a.split('\x26').forEach(function (a) {
        a = a.split('\x3d')
        2 === a.length && (k[a[0]] = a[1])
      })
    })()
    return {
      loadImage: function (a, k) {
        return new f(function (g, c) {
          k = k || ''
          var l = b("\x3cimg src\x3d'" + a + "' alt\x3d'" + k + "'\x3e")
          l.load(function () {
            g(l)
          })
          l.error(function (a) {
            c(a)
          })
          l[0].complete && g(l)
        })
      },
      isFlexBoxSupported: function () {
        var a = e.$('\x3cdiv\x3e\x3c/div\x3e')[0]
        return '' === a.style.flex ||
          '' === a.style.webkitFlex ||
          '' === a.style.msFlex ||
          '' === a.style.MozBoxFlex ||
          '' === a.style.webkitBoxFlex
          ? !0
          : !1
      },
      disablePageScroll: function () {
        p.addClass(h.STOP_SCROLLING)
      },
      enablePageScroll: function () {
        p.removeClass(h.STOP_SCROLLING)
      },
      isMobileApp: n,
      getPageType: function () {
        return !1 === n() ? l.detailPage.mobileWeb : l.detailPage.mobileApp
      },
      getSubPageType: function () {
        return g
      },
      getDebugParams: function () {
        var a = {}
        u.forEach(function (k) {
          var b = d(k)
          b && (a[k] = b)
        })
        return a
      },
      shouldFireAndForgetWeblabTrigger: function () {
        var a = !1
        0 != b('#uss-shouldFireAndForgetWeblabTrigger').length &&
          (a = 'true' === b('#uss-shouldFireAndForgetWeblabTrigger').val())
        return a
      },
      fireAndForgetWeblabTrigger: function (a, k) {
        var b = '/ussx/weblab-trigger?',
          b = /^T[0-9]+$/.test(e.$('#uss-miniFrameworkWeblabTreatment').val())
            ? b + ('weblabValue\x3d' + a + '\x26treatment\x3d' + k)
            : b + ('triggerWeblab\x3d' + a + '\x26treatment\x3d' + k)
        r.navigator && navigator.sendBeacon
          ? navigator.sendBeacon(b) || e.$.ajax({ url: b })
          : e.$.ajax({ url: b })
      },
      showATCSuccess: function () {
        e.$('#atc-toast').length &&
          e.$('#atc-success').length &&
          (e.$('#atc-toast').css('display', 'block'),
          e.$('#atc-toast').addClass('atc-toast-success-styles'),
          e.$('#atc-success').css('display', 'block'),
          setTimeout(function () {
            e.$('#atc-success').css('display', 'none')
            e.$('#atc-toast').css('display', 'none')
            e.$('#atc-toast').removeClass('atc-toast-success-styles')
          }, 1500))
      },
      showATCFailure: function () {
        e.$('#atc-toast').length &&
          e.$('#atc-failed').length &&
          (e.$('#atc-toast').css('display', 'block'),
          e.$('#atc-toast').addClass('atc-toast-failure-styles'),
          e.$('#atc-failed').css('display', 'block'),
          setTimeout(function () {
            e.$('#atc-failed').css('display', 'none')
            e.$('#atc-toast').css('display', 'none')
            e.$('#atc-toast').removeClass('atc-toast-failure-styles')
          }, 1500))
      },
      vibrateMobileApp: function () {
        return (
          r.amazon &&
          r.amazon.cordova &&
          r.amazon.cordova.notification &&
          r.amazon.cordova.notification.vibrate &&
          r.amazon.cordova.notification.vibrate(50)
        )
      },
      handleATCAnimationEnd: function () {
        e.$('.inst-button-space').length &&
          e.$('.inst-indicator').length &&
          (e.$('.inst-button-space').addClass('aok-hidden'),
          e.$('.inst-indicator').addClass('aok-hidden'),
          e.$('.atc-button-text').removeClass('aok-hidden'),
          e.$('#add-to-cart-button').removeAttr('disabled'),
          e.$('body').removeClass('inst-btn-opacity'))
      },
      handleATCAnimationEndWeb: function () {
        e.$('#add-to-cart-button').removeAttr('disabled')
        var a = e.$('#a-page')
        0 !== a.length && a[0].style.removeProperty('opacity')
      },
      updateCartCount: function (b) {
        r.amazon &&
          r.amazon.mash &&
          r.amazon.mash.cart &&
          r.amazon.mash.cart.didUpdate &&
          'function' === typeof r.amazon.mash.cart.didUpdate &&
          r.amazon.mash.cart.didUpdate({ newCartQuantity: b, successCallback: a, failCallback: c })
      },
      getUrlParameter: d,
      getQuantityStepperContainer: function (a, b) {
        return document.querySelector(
          b
            ? m.layout.quantityStepper.CONTAINER_ID_PREFIX + a + '-' + b
            : m.layout.quantityStepper.CONTAINER_ID_PREFIX + a,
        )
      },
      getMetricsPrefix: function () {
        return n() ? 'uss:mobileApp:' : 'uss:mobile:'
      },
    }
  })
  f.when('A', 'atf', 'uss-utils').register('uss-init-helper', function (e, q, m, n) {
    return {
      loadUssCommonAssetsAfterPreload: function () {
        f.when('uss-constants', 'dp-flux-action', 'uss-dispatcher', 'uss-utils').register(
          'uss-action-creator-helper',
          function (d, a, c, b) {
            function h() {
              e.$('#add-to-cart-button').removeAttr('disabled')
            }
            return {
              primaryATCClick: function (l, g) {
                var p = new a(d.actions.USS_OPEN, d.actionSources.DP_ATC_CLICK, {
                  recommendationBaseIdentifier: l,
                })
                g.percolateData.then(
                  function (b) {
                    var u = { isContainsRecommendation: !1, widgets: [] }
                    b.recommendationData && (u.widgets = b.recommendationData.widgets || [])
                    h()
                    u.widgets.length ||
                      (u.widgets.push({ widgetType: d.widgetType.NO_RECOMMENDATION_WIDGET }),
                      (u.recommendationBaseIdentifier = l))
                    c.dispatch(p)
                    g.atcData.then(
                      function (b) {
                        var k = {}
                        1 === b.isOk ? (k = b.atcStatusData) : (k.isAtcGenericError = !0)
                        b = new a(d.actions.ATC_RECEIVE, d.actionSources.DP_ATC_CLICK, k)
                        c.dispatch(b)
                      },
                      function () {
                        var b = new a(d.actions.ATC_RECEIVE, d.actionSources.DP_ATC_CLICK, {
                          isAtcGenericError: !0,
                        })
                        c.dispatch(b)
                      },
                    )
                    u.recommendationBaseIdentifier = l
                    b = new a(
                      d.actions.RECOMMENDATION_DATA_RECEIVE,
                      d.actionSources.DP_ATC_CLICK,
                      u,
                    )
                    c.dispatch(b)
                  },
                  function () {
                    g.atcData.then(
                      function (a) {
                        h()
                        1 === a.isOk ? b.showATCSuccess() : b.showATCFailure()
                      },
                      function () {
                        b.showATCFailure()
                      },
                    )
                  },
                )
              },
              secondaryATCClick: function (b, g) {
                b.atcData.then(
                  function (b) {
                    var k = {}
                    1 === b.isOk ? (k = b.atcStatusData) : (k.isAtcGenericError = !0)
                    k.params = g
                    b = new a(d.actions.ATC_RECEIVE, d.actionSources.USS_INLINE_ATC_CLICK, k)
                    c.dispatch(b)
                  },
                  function () {},
                )
              },
            }
          },
        )
      },
      loadUssCommonAssets: function () {
        f.when('dp-flux-dispatcher').register('uss-dispatcher', function (d) {
          return new d()
        })
        f.when('A', 'uss-constants').register('promising-ui-element', function (d, a) {
          var c = a.classList
          return d.createClass({
            _element: null,
            _uiPromiseElement: null,
            _uiValueElement: null,
            _isResolved: !1,
            init: function (a) {
              var d = a.find('.' + c.UI_PROMISE),
                l = a.find('.' + c.UI_VALUE)
              if (
                (a.hasClass(c.PROMISING_UI_ELEMENT) ||
                  a.hasClass(c.PROMISING_UI_ELEMENT_ANIMATION)) &&
                d.length &&
                l.length
              )
                (this._uiPromiseElement = d),
                  (this._uiValueElement = l),
                  (this._element = a),
                  this.showUIPromise()
              else
                throw Error(
                  'PromisingUIElement.init()...: HTML structure is not compatible with PromisingUIElement',
                )
            },
            showUIPromise: function () {
              this._element.addClass(c.IS_LOADING)
              this._element.removeClass(c.IS_RESOLVED)
              this._isResolved = !1
            },
            showUIValue: function () {
              this._element.addClass(c.IS_RESOLVED)
              this._element.removeClass(c.IS_LOADING)
              this._isResolved = !0
            },
            getValueElement: function () {
              return this._uiValueElement
            },
            getElement: function () {
              return this._element
            },
            isResolved: function () {
              return this._isResolved
            },
          })
        })
        f.when(
          'A',
          'uss-sheet-component',
          'uss-constants',
          'uss-logger-service',
          'uss-store-repository',
          'dp-flux-attribution',
          'uss-final-layout',
          'dp-flux-view',
          'widget-creation-helper',
          'dp-flux-action',
          'uss-dispatcher',
        ).register('uss-sheet-view', function (d, a, c, b, h, l, g, p, k, u, v) {
          function e() {
            F = !0
            var A = c.classList,
              m = c.ussCTI,
              q = h.getStore(c.stores.USS_SHEET_STORE),
              n = h.getStore(c.stores.RECOMMENDATION_DATA_STORE),
              r = [q, n],
              m = new l('uss-sheet-view', m.CATEGORY, m.TYPE, m.ITEM)
            d.declarative(A.ADDITIONAL_RECOMMENDATIONS_TOGGLE_ACTION, 'click', function (a) {
              a = a.$target
              var k = f(a.context.parentElement.parentElement.parentElement.childNodes.item(3)),
                g = a.context.nextElementSibling.nextElementSibling.nextElementSibling
              'false' === g.value
                ? ((g.value = 'true'),
                  (g = a.context.nextElementSibling),
                  k.context.classList.remove(A.HIDE_ELEMENT),
                  (a.context.textContent = g.value),
                  b.logCounter(c.metrics.SEE_MORE_CLICK_COUNTER))
                : ((g.value = 'false'),
                  (g = a.context.nextElementSibling.nextElementSibling),
                  k.context.classList.add(A.HIDE_ELEMENT),
                  (a.context.textContent = g.value),
                  b.logCounter(c.metrics.SEE_LESS_CLICK_COUNTER))
            })
            d.on('a:expander:ussWidgetExpander:toggle:expand', function (a) {
              b.logCounter(c.metrics.SEE_MORE_CLICK_COUNTER)
              a.expander.$expander.find('li:eq(3)').focus()
            })
            d.on('a:expander:ussWidgetExpander:toggle:collapse', function (a) {
              b.logCounter(c.metrics.SEE_LESS_CLICK_COUNTER)
              a.expander.$expander.focus()
            })
            var w = new a(A.USS_SHEET_VIEW_IDENTIFIER, {
                beforeClose: function () {
                  v.dispatch(new u(c.actions.USS_CLOSE, c.actionSources.SHEET_CLOSE_BUTTON_CLICK))
                },
              }),
              E = w.getSheetElement(),
              y = new g(E)
            new p(m, r, function (a) {
              var b
              if (-1 !== f.inArray(q, a))
                if (((b = q.getState()), b.isSheetOpen())) {
                  if (b.getActionSource() === c.actionSources.DP_ATC_CLICK) {
                    y.reset()
                    var g = k.createAtcStatusWidget()
                    b = k.createIMBWidget(b.getActionSource())
                    y.renderWidgets([g, b])
                  }
                  w.open()
                } else b.getActionSource() !== c.actionSources.SHEET_CLOSE_BUTTON_CLICK && w.close()
              ;-1 !== f.inArray(n, a) && y.renderWidgets(k.createRecommendationWidget(n))
            })
          }
          var f = d.$,
            F = !1
          return {
            initializeUSSSheetView: function () {
              F || e()
            },
          }
        })
        f.when('A', 'uss-constants', 'uss-template-store', 'uss-widget-factory').register(
          'widget-creation-helper',
          function (d, a, c, b) {
            return {
              createAtcStatusWidget: function () {
                var d = {
                  content: c.getTemplate(a.widgetType.ATCStatusWidget),
                  widgetType: a.widgetType.ATCStatusWidget,
                }
                return b.getWidget(d)
              },
              createRecommendationWidget: function (a) {
                var c,
                  g = []
                a = a.getState().getNewRecommendations()
                d.each(a, function (a) {
                  ;(c = b.getWidget(a)) && g.push(c)
                })
                return g
              },
              createIMBWidget: function () {
                return b.getWidget({
                  content: '\x3cdiv\x3e\x3c/div\x3e',
                  widgetType: a.widgetType.ATC_STATUS_IMB_WIDGET,
                })
              },
            }
          },
        )
        f.when('A', 'dp-flux-store', 'uss-dispatcher').register(
          'uss-store-repository',
          function (d, a, c) {
            var b = {}
            return {
              registerStore: function (d, l, g) {
                l = new a(d, l, c, g)
                return (b[d.getName()] = l)
              },
              getStore: function (a) {
                return b[a]
              },
              getDispatcher: function () {
                return c
              },
            }
          },
        )
        f.when(
          'A',
          'uss-store-repository',
          'dp-flux-attribution',
          'uss-sheet-store',
          'uss-constants',
        ).register('uss-recommendation-data-store', function (d, a, c, b, h) {
          function l(a, b, g) {
            this._unprocessedChunkIndex = g || 0
            this._recommendationBaseIdentifier = a
            this._dataChunks = b || []
          }
          var g = d.$,
            p = h.ussCTI
          c = new c(h.stores.RECOMMENDATION_DATA_STORE, p.CATEGORY, p.TYPE, p.ITEM)
          b = a.getStore(h.stores.USS_SHEET_STORE)
          l.prototype = {
            _getRecommendations: function (a) {
              var b = []
              a < this._dataChunks.length &&
                d.each(this._dataChunks, function (g, c) {
                  c >= a &&
                    d.each(g, function (a) {
                      b.push(a)
                    })
                })
              return b
            },
            getAllRecommendations: function () {
              return this._getRecommendations(0)
            },
            getNewRecommendations: function () {
              return this._getRecommendations(this._unprocessedChunkIndex)
            },
            getRecommendationBaseIdentifier: function () {
              return this._recommendationBaseIdentifier
            },
            addRecommendationChunk: function (a) {
              var b = []
              d.each(a, function (a) {
                a.widgetType = a.widgetType || h.widgetType.RECOMMENDATION_WIDGET
              })
              b = g.merge(b, this._dataChunks)
              b = g.merge(b, [a])
              return new l(this._recommendationBaseIdentifier, b, this._dataChunks.length)
            },
          }
          p = new l()
          return a.registerStore(
            c,
            function (k, g) {
              var c = k,
                d = h.actions
              switch (g.getName()) {
                case d.USS_OPEN:
                  a.getDispatcher().waitFor([b.getDispatchToken()])
                  b.getState().getActionSource() === h.actionSources.DP_ATC_CLICK &&
                    (c = new l(b.getState().getRecommendationBaseIdentifier()))
                  break
                case d.RECOMMENDATION_DATA_RECEIVE:
                  ;(d = b.getState().getRecommendationBaseIdentifier()),
                    (g = g._metadata),
                    g.recommendationBaseIdentifier === d &&
                      (c = k.addRecommendationChunk(g.widgets))
              }
              return c
            },
            p,
          )
        })
        f.when('uss-store-repository', 'dp-flux-attribution', 'uss-constants').register(
          'uss-sheet-store',
          function (d, a, c) {
            function b(a, b, k) {
              this._isSheetOpen = a || !1
              this._actionSource = b
              this._recommendationBaseIdentifier = k
            }
            var h = c.actions,
              l = c.ussCTI
            a = new a(c.stores.USS_SHEET_STORE, l.CATEGORY, l.TYPE, l.ITEM)
            b.prototype = {
              isSheetOpen: function () {
                return this._isSheetOpen
              },
              getActionSource: function () {
                return this._actionSource
              },
              getRecommendationBaseIdentifier: function () {
                return this._recommendationBaseIdentifier
              },
            }
            l = new b(!1)
            return d.registerStore(
              a,
              function (a, d) {
                var k = a
                switch (d.getName()) {
                  case h.USS_OPEN:
                    a.isSheetOpen() ||
                      (d.getSource() === c.actionSources.DP_ATC_CLICK
                        ? (k = new b(
                            !0,
                            d.getSource(),
                            d.getMetaData().recommendationBaseIdentifier,
                          ))
                        : d.getSource() === c.actionSources.USS_INGRESS_CLICK &&
                          a.getRecommendationBaseIdentifier() &&
                          (k = new b(!0, d.getSource(), a.getRecommendationBaseIdentifier())))
                    break
                  case h.USS_CLOSE:
                    a.isSheetOpen() &&
                      (k = new b(!1, d.getSource(), a.getRecommendationBaseIdentifier()))
                }
                return k
              },
              l,
            )
          },
        )
        f.when(
          'A',
          'uss-store-repository',
          'dp-flux-attribution',
          'uss-constants',
          'dp-flux-utils',
        ).register('uss-atc-status-store', function (d, a, c, b, h) {
          function l() {
            this.status = t
            this.mainImage = {}
            this.isAtcGenericError = this.shippingMessageHTML = this.imbHTML = t
          }
          d = new c('uss-atc-status-store', b.ussCTI.CATEGORY, b.ussCTI.TYPE, b.ussCTI.ITEM)
          l.prototype = {
            setStatus: function (a) {
              this.status =
                1 === a || a === b.classList.ATC_SUCCESS
                  ? b.classList.ATC_SUCCESS
                  : b.classList.ATC_ERROR
            },
            setMainImage: function (a, b) {
              h.isNonEmptyString(a) &&
                ((this.mainImage.src = a),
                h.isNonEmptyString(b) ? this.mainImage.altText : (this.mainImage.altText = ''))
            },
            setImbHTML: function (a) {
              h.isNonEmptyString(a) && (this.imbHTML = a)
            },
            setShippingMessageHTML: function (a) {
              h.isNonEmptyString(a) && (this.shippingMessageHTML = a)
            },
            setIsAtcGenericError: function (a) {
              this.isAtcGenericError = a
            },
          }
          c = new l()
          a.registerStore(
            d,
            function (a, d) {
              var k = a
              switch (d.getName()) {
                case b.actions.ATC_RECEIVE:
                  var c = d.getMetaData()
                  d.getSource() === b.actionSources.DP_ATC_CLICK
                    ? ((k = new l()),
                      c.isAtcGenericError
                        ? k.setIsAtcGenericError(!0)
                        : (k.setStatus(c.status),
                          k.setMainImage(c.mainImage.src, c.mainImage.altText),
                          k.setImbHTML(c.imbHTML),
                          k.setShippingMessageHTML(c.shippingMessageHTML)))
                    : d.getSource() !== b.actionSources.USS_INLINE_ATC_CLICK ||
                      c.isAtcGenericError ||
                      ((k = new l()),
                      k.setStatus(a.status),
                      k.setMainImage(a.mainImage.src, a.mainImage.altText),
                      k.setImbHTML(a.imbHTML),
                      k.setShippingMessageHTML(a.shippingMessageHTML))
                  break
                case b.actions.USS_OPEN:
                  d.getSource() === b.actionSources.DP_ATC_CLICK && (k = new l())
              }
              return k
            },
            c,
          )
        })
        f.when('A', 'uss-constants').register('uss-template-store', function (d, a) {
          var c = d.$,
            b = a.classList,
            h = {}
          return {
            init: function () {
              var a = c('.' + b.TEMPLATE_STORE),
                d
              1 === a.length &&
                a.find('.' + b.TEMPLATE).each(function (a, k) {
                  d = c('\x3cdiv\x3e\x3c/div\x3e')
                  k = c(k)
                  d.append(k)
                  ;(a = k.data(b.TEMPLATE_NAME)) && (h[a] = d.html())
                })
            },
            getTemplate: function (a) {
              return h[a]
            },
            _nameToTemplateMap: h,
          }
        })
        f.when(
          'A',
          'dp-flux-attribution',
          'dp-flux-utils',
          'uss-store-repository',
          'uss-widget',
          'uss-constants',
        ).register('uss-widget-factory', function (d, a, c, b, h, l) {
          var g = d.$,
            p = {}
          p[l.widgetType.WIDGET] = h
          d = l.ussCTI
          var k = new a('uss-widget-factory', d.CATEGORY, d.TYPE, d.ITEM)
          return {
            registerWidgetType: function (a, b) {
              if (!c.isNonEmptyString(a))
                throw Error(
                  'uss-widget-factory.registerWidgetType()... : name parameter must be valid string. provided name param is \x3d ' +
                    a,
                )
              if (!(b.prototype instanceof h))
                throw Error(
                  'uss-widget-factory.registerWidgetType()... : constructor.prototype must be instance of Widget. provided constructor param is \x3d ' +
                    b,
                )
              p[a] = b
            },
            getWidgetType: function (a) {
              return p[a]
            },
            getWidget: function (b) {
              var d,
                c = k
              try {
                var h = b.widgetType || l.widgetType.WIDGET,
                  e = p[h]
                if (!e)
                  return (
                    f.log(
                      'Widget.getWidget()... : Constructor not exist for type : ' + h,
                      'FATAL',
                      c.getAttribution(),
                    ),
                    d
                  )
                var m = e.getAttribution && e.getAttribution()
                m && (c = m)
                if (b.attribution)
                  var q = b.attribution,
                    c = new a(q.name, q.category, q.type, q.item)
                var n = g(b.content),
                  r = g('\x3cdiv\x3e\x3c/div\x3e')
                r.append(n)
                d = new e(c, r)
              } catch (t) {
                f.log(
                  'Widget.getWidget()... : ' + t.message,
                  'FATAL',
                  c.getAttribution && c.getAttribution(),
                )
              }
              return d
            },
          }
        })
        f.when(
          'A',
          'uss-constants',
          'dp-flux-view',
          'uss-store-repository',
          'uss-dispatcher',
        ).register('uss-widget', function (d, a, c, b, h) {
          function l(a) {
            var c = []
            d.each(a, function (a) {
              var k = b.getStore(a)
              if (k) c.push(k)
              else
                throw Error(
                  'Widget.getWidget().getStores()... : store with name \x3d ' + a + ' not exists',
                )
            })
            return c
          }
          var g = a.classList,
            p = a.widgetType
          return d.createClass({
            init: function (a, b) {
              this._element = b
              this._element.addClass(p.WIDGET)
              this._element.addClass(g.HIDE_ELEMENT)
              this._attribution = a
              this._dispacther = h
              this.getStoreNames().length &&
                ((b = l(this.getStoreNames())),
                (this._fluxView = new c(a, b, this.update.bind(this))),
                this.update(b))
            },
            show: function (b) {
              b = b || {}
              b = b.showWidgetAnimation || {}
              var c = a.animationType
              b.animationType = b.animationType || c.NO_ANIMATION
              switch (b.animationType) {
                case c.FADE_IN:
                  d.fadeIn(
                    this._element,
                    b.timeDuration || 100,
                    b.transitionTimingFunction || a.transitionTimingFunction.EVEN_EASE,
                  )
                  break
                case c.NO_ANIMATION:
                  this._element.addClass(g.SHOW_ELEMENT), this._element.removeClass(g.HIDE_ELEMENT)
              }
            },
            hide: function () {
              this._element.addClass(g.HIDE_ELEMENT)
              this._element.removeClass(g.SHOW_ELEMENT)
            },
            beforeRender: function () {},
            afterRender: function () {},
            getElement: function () {
              return this._element
            },
            getAttribution: function () {
              return this._attribution
            },
            getDispatcher: function () {
              return this._dispacther
            },
            update: function (a) {},
            getStoreNames: function () {
              return []
            },
            deleteWidget: function () {
              this._element.remove()
              this._fluxView && this._fluxView.unregisterStores()
            },
          })
        })
        f.when('A', 'uss-constants', 'uss-widget-factory', 'uss-logger-service').register(
          'uss-recommendation-widget',
          function (d, a, c, b) {
            var h = a.widgetType,
              l = c.getWidgetType(h.WIDGET),
              g = a.metrics
            a = l.extend({
              init: function (a, b) {
                this._super(a, b)
                this._element.addClass(h.RECOMMENDATION_WIDGET)
              },
            })
            ;(function () {
              d.declarative(g.FACEOUT_IMAGE_CLICK_COUNTER, 'click', function (a) {
                b.logCounter(g.FACEOUT_IMAGE_CLICK_COUNTER)
              })
              d.declarative(g.FACEOUT_REVIEW_STARS_CLICK_COUNTER, 'click', function (a) {
                b.logCounter(g.FACEOUT_REVIEW_STARS_CLICK_COUNTER)
              })
              d.declarative(g.FACEOUT_PRICE_CLICK_COUNTER, 'click', function (a) {
                b.logCounter(g.FACEOUT_PRICE_CLICK_COUNTER)
              })
              d.declarative(g.FACEOUT_TITLE_CLICK_COUNTER, 'click', function (a) {
                b.logCounter(g.FACEOUT_TITLE_CLICK_COUNTER)
              })
              d.declarative(g.FACEOUT_BEST_SELLER_CLICK_COUNTER, 'click', function (a) {
                b.logCounter(g.FACEOUT_BEST_SELLER_CLICK_COUNTER)
              })
            })()
            c.registerWidgetType(h.RECOMMENDATION_WIDGET, a)
            return a
          },
        )
        f.when(
          'A',
          'uss-constants',
          'uss-widget-factory',
          'dp-flux-attribution',
          'uss-template-store',
          'dp-flux-action',
          'uss-logger-service',
        ).register('uss-no-recommendation-widget', function (d, a, c, b, h, l, g) {
          var p = a.widgetType
          d = c.getWidgetType(p.WIDGET)
          var k = a.ussCTI,
            u = new b(a.widgetType.NO_RECOMMENDATION_WIDGET, k.CATEGORY, k.TYPE, k.ITEM)
          b = d.extend({
            init: function (b, c) {
              this._super(b, c)
              this._element.addClass(p.NO_RECOMMENDATION_WIDGET)
              b = h.getTemplate(a.widgetType.NO_RECOMMENDATION_WIDGET)
              this._element.append(b)
              this._continueShoppingLink = this._element.find(
                '.' + a.classList.CONTINUE_SHOPPING_LINK,
              )
              this._continueShoppingLink.click(
                function (b) {
                  b.preventDefault()
                  g.logCounter(a.metrics.CONTINUE_SHOPPING_CLICK)
                  this.getDispatcher().dispatch(
                    new l(a.actions.USS_CLOSE, a.actionSources.CONTINUE_SHOPPING_CLICK),
                  )
                }.bind(this),
              )
            },
          })
          b.getAttribution = function () {
            return u
          }
          c.registerWidgetType(p.NO_RECOMMENDATION_WIDGET, b)
          return b
        })
        f.when('A', 'uss-constants', 'uss-widget-factory').register(
          'primary-action-status-widget',
          function (d, a, c) {
            var b = a.widgetType
            d = c.getWidgetType(b.WIDGET).extend({
              init: function (a, c) {
                this._super(a, c)
                this.getElement().addClass(b.PRIMARY_ACTION_STATUS_WIDGET)
              },
            })
            c.registerWidgetType(b.PRIMARY_ACTION_STATUS_WIDGET, d)
            return d
          },
        )
        f.when('A', 'promising-ui-element', 'uss-utils', 'uss-constants').register(
          'promising-image',
          function (d, a, c, b) {
            var h = d.$,
              l = b.classList
            return a.extend({
              init: function (a, b) {
                this._element = h(b)
                this._attribution = a
                this._super(this._element)
                this._eventHandle = t
              },
              _showTickMarkImage: function (a) {
                switch (a) {
                  case l.ATC_SUCCESS:
                    this._showSuccessTickMark()
                    break
                  case l.ATC_ERROR:
                    this._showErrorTickMark()
                    break
                  default:
                    return
                }
                d.off(this._eventHandle.event, this._eventHandle.callback)
              },
              _showSuccessTickMark: function () {
                h('.main-image')
                  .find('.success-tick-mark-placeholder')
                  .addClass('success-tick-mark-image')
              },
              _showErrorTickMark: function () {
                var a = h('.main-image').find('.error-tick-mark-placeholder')
                a.addClass('error-tick-mark-image')
                d.fadeIn(a, 200, b.transitionTimingFunction.EASE_OUT)
              },
              showUIValue: function (a, l, k) {
                var u = this,
                  e = b.defaultAtcAnimationType,
                  m = this._super.bind(this)
                e === b.animationType.FADE_IN &&
                  (this._eventHandle = d.on(
                    b.atcAnimationStatusEvent,
                    this._showTickMarkImage.bind(this, k),
                  ))
                return c.loadImage(a, l).then(
                  function (a) {
                    if (e === b.animationType.FADE_IN) {
                      var c = h('.main-image').find('.ui-promise')
                      d.fadeOut(c, 200, b.transitionTimingFunction.EASE_IN, function () {
                        u._appendImageToUIValue(a)
                        m()
                        var c = h('.main-image').find('.ui-value')
                        d.fadeIn(c, 200, b.transitionTimingFunction.EASE_OUT)
                      })
                    } else this._appendImageToUIValue(a), m()
                    return !0
                  }.bind(this),
                  function () {
                    f.log(
                      'PromisingImage.showUIValue() ... : failed to load image',
                      'FATAL',
                      this._attribution.getAttribution(),
                    )
                    return !1
                  }.bind(this),
                )
              },
              _appendImageToUIValue: function (a) {
                this.getValueElement().empty()
                this.getValueElement().append(a)
              },
            })
          },
        )
        f.when('A', 'promising-ui-element', 'uss-constants').register(
          'atc-status-msg',
          function (d, a, c) {
            var b = c.classList
            return a.extend({
              init: function (a) {
                this._atcStatusElement = a
                this._super(this._atcStatusElement)
              },
              _showSuccessMessage: function () {
                this._atcStatusElement.addClass(b.ATC_SUCCESS)
                this._atcStatusElement.removeClass(b.ATC_ERROR)
                this._atcStatusElement.removeClass(b.ITEM_IN_CART)
              },
              _showSuccessMessageDesktop: function () {
                this._atcStatusElement.addClass(b.ATC_SUCCESS_DESKTOP)
                this._atcStatusElement.removeClass(b.ATC_ERROR)
                this._atcStatusElement.removeClass(b.ITEM_IN_CART)
              },
              _showFailureMessage: function () {
                this._atcStatusElement.addClass(b.ATC_ERROR)
                this._atcStatusElement.removeClass(b.ATC_SUCCESS)
                this._atcStatusElement.removeClass(b.ITEM_IN_CART)
              },
              _showItemInCartMessage: function () {
                this._atcStatusElement.addClass(b.ITEM_IN_CART)
                this._atcStatusElement.removeClass(b.ATC_ERROR)
                this._atcStatusElement.removeClass(b.ATC_SUCCESS)
              },
              showUIValue: function (a) {
                var l = this,
                  g = c.defaultAtcAnimationType
                switch (a) {
                  case b.ATC_SUCCESS:
                    this._showSuccessMessage()
                    break
                  case b.ATC_SUCCESS_DESKTOP:
                    this._showSuccessMessageDesktop()
                    break
                  case b.ATC_ERROR:
                    this._showFailureMessage()
                    break
                  case b.ITEM_IN_CART:
                    this._showItemInCartMessage()
                    break
                  default:
                    return
                }
                this._super()
                g === c.animationType.FADE_IN &&
                  ((a = this._atcStatusElement.find('.' + b.UI_PROMISE)),
                  d.fadeOut(a, 200, c.transitionTimingFunction.EASE_IN, function () {
                    var a = l._atcStatusElement.find('.' + b.UI_VALUE)
                    d.fadeIn(a, 200, c.transitionTimingFunction.EASE_OUT, function () {
                      d.trigger(c.atcAnimationStatusEvent)
                    })
                  }))
              },
            })
          },
        )
        f.when('A', 'uss-constants').register('uss-shipping-details', function (d, a) {
          var c = d.$
          return {
            getInstance: function (b) {
              var h = b.find('.' + a.classList.SHIPPING_DETAILS),
                l = h.find('.' + a.classList.SHIPPING_MESSAGE_PLACEHOLDER),
                g = a.defaultAtcAnimationType,
                p = t,
                k = function () {
                  var a = l.find('.a-row').find('a'),
                    b = a.attr('onclick')
                  if ('undefined' !== typeof b && b.includes('amz_js_PopWin')) {
                    var d = []
                    c.each(a[0].attributes, function (a, b) {
                      d.push(b.name)
                    })
                    c.each(d, function (b, c) {
                      a.removeAttr(c)
                    })
                    a.attr('href', '/gp/help/customer/display.html?nodeId\x3d527692')
                  }
                },
                e = {
                  hide: function () {
                    h.addClass(a.classList.HIDE_ELEMENT)
                    h.removeClass(a.classList.SHOW_ELEMENT)
                  },
                  atcAnimationStatusResolved: function () {
                    setTimeout(
                      function () {
                        h.addClass('uss-c-shipping-details-transition')
                        d.off(p.event, p.callback)
                      }.bind(),
                      200,
                    )
                  },
                  show: function (b) {
                    l.empty()
                    l.append(d.$(b))
                    k()
                    h.addClass(a.classList.SHOW_ELEMENT)
                    h.removeClass(a.classList.HIDE_ELEMENT)
                    g === a.animationType.FADE_IN &&
                      (p = d.on(a.atcAnimationStatusEvent, e.atcAnimationStatusResolved.bind()))
                  },
                }
              e.hide()
              return e
            },
          }
        })
        f.when(
          'A',
          'uss-constants',
          'primary-action-status-widget',
          'dp-flux-attribution',
          'uss-widget-factory',
          'atc-status-msg',
          'promising-image',
          'uss-shipping-details',
        ).register('atc-status-widget', function (d, a, c, b, h, l, g, p) {
          var k = a.ussCTI,
            e = a.widgetType,
            v = a.classList,
            f = new b(a.widgetType.ATCStatusWidget, k.CATEGORY, k.TYPE, k.ITEM)
          c = c.extend({
            init: function (a, b) {
              this._atcGenericError = b.find('.' + v.ATC_GENERIC_ERROR)
              this._atcAcknowledgementMessage = b.find('.' + v.ATC_ACKNOWLEDGEMENT_MESSAGE)
              this._mainImage = new g(a, this._atcAcknowledgementMessage.find('.' + v.MAIN_IMAGE))
              this._atcStatusMessage = new l(
                this._atcAcknowledgementMessage.find('.' + v.ATC_STATUS_MESSAGE_COMPONENT),
              )
              this._shippingDetails = p.getInstance(this._atcAcknowledgementMessage)
              this._viewState = {}
              this._super(a, b)
            },
            update: function (b) {
              var c
              d.each(
                b,
                function (b) {
                  b.getStoreAttribution().getName() === a.stores.ATC_STATUS_STORE &&
                    ((c = b.getState()),
                    c.isAtcGenericError
                      ? this.showGenericError()
                      : ((b = d.diff(this._viewState, c)),
                        b.status && c.status && this._atcStatusMessage.showUIValue(c.status),
                        b.mainImage.src &&
                          c.mainImage.src &&
                          this._mainImage.showUIValue(
                            c.mainImage.src,
                            c.mainImage.altText,
                            c.status,
                          ),
                        b.shippingMessageHTML &&
                          c.shippingMessageHTML &&
                          this._shippingDetails.show(c.shippingMessageHTML)),
                    (this._viewState = c))
                }.bind(this),
              )
            },
            showGenericError: function () {
              this._atcAcknowledgementMessage.addClass(v.HIDE_ELEMENT)
              this._atcAcknowledgementMessage.removeClass(v.SHOW_ELEMENT)
              this._atcGenericError.removeClass(v.HIDE_ELEMENT)
              this._atcGenericError.addClass(v.SHOW_ELEMENT)
            },
            getStoreNames: function () {
              return [a.stores.ATC_STATUS_STORE]
            },
          })
          c.getAttribution = function () {
            return f
          }
          h.registerWidgetType(e.ATCStatusWidget, c)
          return c
        })
        f.when('A', 'uss-constants', 'dp-flux-attribution', 'uss-widget-factory').register(
          'atc-status-imb-widget',
          function (d, a, c, b) {
            var h = b.getWidgetType(a.widgetType.WIDGET),
              l = a.ussCTI,
              g = new c('atc-status-imb-widget', l.CATEGORY, l.TYPE, l.ITEM)
            c = h.extend({
              init: function (b, c) {
                c.addClass(a.widgetType.ATC_STATUS_IMB_WIDGET)
                this._super(b, c)
              },
              update: function (b) {
                var c
                d.each(
                  b,
                  function (b) {
                    if (b.getStoreAttribution().getName() === a.stores.ATC_STATUS_STORE)
                      if (((c = b.getState()), c.imbHTML)) {
                        this.getElement().empty()
                        b = d.$(c.imbHTML)
                        var l = b.children().length
                        if (1 <= l) {
                          b.find('.a-declarative a').unwrap()
                          var h = b.find('.a-declarative span')
                          h.removeClass('a-color-link huc-cursor-pointer')
                          h.unwrap()
                          this.getElement().append(b)
                          this.show()
                          1 < l &&
                            f.log(
                              'ImbWidget.update(...): More than one IMB message exist : html \x3d ' +
                                c.imbHTML,
                              'WARN',
                              g.getAttribution(),
                            )
                        } else this.hide()
                      } else this.hide()
                  }.bind(this),
                )
              },
              afterRender: function () {
                this.hide()
              },
              getStoreNames: function () {
                return [a.stores.ATC_STATUS_STORE]
              },
            })
            c.getAttribution = function () {
              return g
            }
            b.registerWidgetType(a.widgetType.ATC_STATUS_IMB_WIDGET, c)
            return c
          },
        )
        f.when('A').register('uss-base-layout', function (d) {
          return d.createClass({
            init: function (a) {
              this._ussSheetElement = a
            },
            renderWidgets: function (a) {
              throw Error('Layout.renderWidgets()...: Subclass must implement update method')
            },
            reset: function () {
              throw Error('Layout.reset()...: Subclass must implement reset method')
            },
            getUssSheetElement: function () {
              return this._ussSheetElement
            },
          })
        })
        f.when(
          'A',
          'uss-base-layout',
          'promising-ui-element',
          'uss-constants',
          'primary-action-status-widget',
          'atc-status-imb-widget',
        ).register('uss-default-layout', function (d, a, c, b, h, l) {
          var g = b.layout.defaultLayout
          return a.extend({
            init: function (a) {
              this._super(a)
              this._element = a.find('.' + g.DEFAULT_LAYOUT)
              this._ussHead = this._element.find('.' + g.HEAD)
              this._ussBody = this._element.find('.' + g.BODY)
              this._widgetList = []
              this._recommendationLoader = d.$('.' + g.SKELETON_LOADER)
              this._recommendationLoadingMessage = d.$('.' + g.RECOMMENDATION_LOADING_MESSAGE)
              this._recommendationLoadedMessage = d.$('.' + g.RECOMMENDATION_LOADED_MESSAGE)
              this._ussBody.append(this._recommendationLoader)
              this._recommendationLoaderFadeOutOptions = {
                timeDuration: 200,
                transitionTimingFunction: b.transitionTimingFunction.EASE_IN,
              }
              this._recommendationLoaderFadeInOptions = {
                timeDuration: 200,
                transitionTimingFunction: b.transitionTimingFunction.EASE_OUT,
              }
              this._recommendationWidgetOptions = {
                showWidgetAnimation: {
                  animationType: b.animationType.FADE_IN,
                  timeDuration: 200,
                  transitionTimingFunction: b.transitionTimingFunction.EASE_OUT,
                },
              }
            },
            renderWidgets: function (a) {
              var b,
                c = !1
              d.each(
                a,
                function (a) {
                  b = {}
                  a.beforeRender()
                  this._widgetList.push(a)
                  if (a instanceof h) this._ussHead.prepend(a.getElement())
                  else if (
                    (a.getElement().addClass(g.BOTTOM_MARGIN_BETWEEN_WIDGETS),
                    a.getElement().addClass(g.TOP_MARGIN_BETWEEN_WIDGETS),
                    a instanceof l)
                  )
                    this._ussBody.prepend(a.getElement())
                  else {
                    if (!c) {
                      c = !0
                      var e = this
                      d.fadeOut(
                        this._recommendationLoader,
                        this._recommendationLoaderFadeOutOptions.timeDuration,
                        this._recommendationLoaderFadeOutOptions.transitionTimingFunction,
                        function () {
                          d.fadeIn(
                            e._recommendationLoadedMessage,
                            e._recommendationLoaderFadeInOptions.timeDuration,
                            e._recommendationLoaderFadeInOptions.transitionTimingFunction,
                          )
                        },
                      )
                    }
                    b = this._recommendationWidgetOptions
                    this._ussBody.append(a.getElement())
                  }
                  a.show(b)
                  a.afterRender()
                }.bind(this),
              )
            },
            reset: function () {
              d.each(this._widgetList, function (a) {
                a.deleteWidget()
              })
              this._widgetList = []
              this._ussBody.empty()
              this._ussBody.append(this._recommendationLoader)
              this._ussBody.append(this._recommendationLoadedMessage)
              this._recommendationLoader.css({ display: 'block' })
              this._recommendationLoadingMessage.css({ display: 'none' })
              this._recommendationLoadedMessage.css({ display: 'none' })
              this.resetScrollPosition()
            },
            resetScrollPosition: function () {
              this._ussBody.scrollTop(0)
            },
          })
        })
        f.when('uss-constants', 'dp-flux-action', 'uss-dispatcher', 'uss-utils').register(
          'uss-action-creator-helper',
          function (d, a, c, b) {
            function h() {
              e.$('#add-to-cart-button').removeAttr('disabled')
            }
            return {
              primaryATCClick: function (l, g) {
                var e = new a(d.actions.USS_OPEN, d.actionSources.DP_ATC_CLICK, {
                  recommendationBaseIdentifier: l,
                })
                g.percolateData.then(
                  function (b) {
                    var f = { isContainsRecommendation: !1, widgets: [] }
                    b.recommendationData && (f.widgets = b.recommendationData.widgets || [])
                    h()
                    f.widgets.length ||
                      (f.widgets.push({ widgetType: d.widgetType.NO_RECOMMENDATION_WIDGET }),
                      (f.recommendationBaseIdentifier = l))
                    c.dispatch(e)
                    g.atcData.then(
                      function (b) {
                        var k = {}
                        1 === b.isOk ? (k = b.atcStatusData) : (k.isAtcGenericError = !0)
                        b = new a(d.actions.ATC_RECEIVE, d.actionSources.DP_ATC_CLICK, k)
                        c.dispatch(b)
                      },
                      function () {
                        var b = new a(d.actions.ATC_RECEIVE, d.actionSources.DP_ATC_CLICK, {
                          isAtcGenericError: !0,
                        })
                        c.dispatch(b)
                      },
                    )
                    f.recommendationBaseIdentifier = l
                    b = new a(
                      d.actions.RECOMMENDATION_DATA_RECEIVE,
                      d.actionSources.DP_ATC_CLICK,
                      f,
                    )
                    c.dispatch(b)
                  },
                  function () {
                    g.atcData.then(
                      function (a) {
                        h()
                        1 === a.isOk ? b.showATCSuccess() : b.showATCFailure()
                      },
                      function () {
                        b.showATCFailure()
                      },
                    )
                  },
                )
              },
              secondaryATCClick: function (b, g) {
                b.atcData.then(
                  function (b) {
                    var k = {}
                    1 === b.isOk ? (k = b.atcStatusData) : (k.isAtcGenericError = !0)
                    k.params = g
                    b = new a(d.actions.ATC_RECEIVE, d.actionSources.USS_INLINE_ATC_CLICK, k)
                    c.dispatch(b)
                  },
                  function () {},
                )
              },
            }
          },
        )
      },
      initializeUSSComponents: function () {
        f.when(
          'uss-template-store',
          'uss-sheet-store',
          'uss-recommendation-data-store',
          'uss-store-repository',
          'uss-widget',
          'uss-recommendation-widget',
          'primary-action-status-widget',
          'uss-widget-factory',
          'uss-sheet-view',
          'uss-final-layout',
        ).register('uss-framework-ready', function (d) {
          d.init()
        })
        f.when('uss-sheet-view', 'uss-framework-ready').register(
          'uss-sheet-view-ready',
          function (d) {
            d.initializeUSSSheetView()
          },
        )
      },
      initializeAtcInterceptor: function () {
        f.when(
          'uss-atc-interceptor',
          'atc-status-widget',
          'atc-status-imb-widget',
          'uss-atc-status-store',
          'uss-framework-ready',
          'uss-sheet-view-ready',
        ).execute(function (d) {
          d.init()
        })
      },
      initializeBuyBox: function () {
        f.when(
          'buy-box-override',
          'atc-status-widget',
          'atc-status-imb-widget',
          'uss-atc-status-store',
          'uss-framework-ready',
          'uss-sheet-view-ready',
        ).execute(function (d) {
          d.init()
        })
      },
    }
  })
  f.when('A', 'uss-constants', 'uss-logger-service').register(
    'uss-eligibility',
    function (e, f, m) {
      var n = e.$,
        d = f.metrics,
        a = {}
      return {
        getUssEligibility: function (c, b) {
          var d = n('#uss-isPrimaryAsinVirtualBundle').val()
          return {
            primaryAsinData: d
              ? { asin: c, offerListingId: b, isVirtualBundle: d }
              : { asin: c, offerListingId: b },
            eligibility: a,
          }
        },
        registerProgramEligibility: function (c, b) {
          c &&
            (a[c] && m.logCounter(d.PROGRAM_ELIGIBILITY_REGISTRY_OVERWRITTEN + '.' + programName),
            (a[c] = b))
        },
      }
    },
  )
  f.when(
    'A',
    'atf',
    'uss-init-helper',
    'uss-preconditions',
    'uss-logger-service',
    'uss-constants',
  ).register('uss-init', function (e, q, m, n, d, a) {
    function c() {
      m.loadUssCommonAssets()
      f.when('A', '3p-promise', 'uss-light-box', 'uss-constants', 'uss-logger-service').register(
        'uss-sheet-component',
        function (a, b, c, d, h) {
          function e(b, g) {
            if (!(this instanceof e)) throw Error(n.INVALID_CONSTRUCTOR_USAGE)
            if ('string' === typeof b)
              if (((this._sheet = f('#' + b)), 1 === this._sheet.length))
                (this._sheetID = b),
                  this._sheet.addClass(m.RIGHT_SIDE_SHEET),
                  this._sheet.addClass(m.RIGHT_SIDE_SHEET_LAYOUT),
                  this._sheet.addClass(m.SHEET_CLOSE),
                  this._sheet.attr('role', 'dialog'),
                  this._sheet.appendTo(G),
                  (this._closeIcon = this._createCloseIcon()),
                  this._closeIcon.click(
                    function () {
                      var a = this.close()
                      g.beforeClose && g.beforeClose(a)
                      h.logCounter(this._sheetID + ':closeIconClick')
                    }.bind(this),
                  ),
                  this._sheet.append(this._closeIcon),
                  c.getElement().click(
                    function () {
                      var a = this.close()
                      g.beforeClose && g.beforeClose(a)
                      h.logCounter(this._sheetID + ':lightBoxClick')
                    }.bind(this),
                  ),
                  this._sheet.removeClass(m.HIDE_ELEMENT),
                  a.on(d.atcAnimationStatusEvent, function () {
                    t.is(':visible') && a.fadeIn(C, 200, q.EASE_OUT)
                  })
              else throw Error("Unique element with id '" + b + "' must exist inside a DOM")
            else throw Error(n.INVALID_SHEET_ID)
          }
          var f = a.$,
            m = d.classList,
            q = d.transitionTimingFunction,
            n = d.fatalMessagesList,
            r = d.layout.defaultLayout,
            G = f('body'),
            t = f('.' + r.SKELETON_LOADER),
            C = f('.' + r.RECOMMENDATION_LOADING_MESSAGE)
          e.prototype.open = function () {
            var d = this
            return new b(function (b) {
              var k = d._getSheetSize()
              d._sheet.css({ right: '-' + k + 'px' })
              c.show()
              a.animationFrameDelay(function () {
                a.animate(d._sheet, { right: 0 }, 400, q.ENTER_EASE, function () {
                  d._sheet.removeClass(m.SHEET_CLOSE)
                  d._sheet.addClass(m.SHEET_OPEN)
                  d.showCloseIcon()
                  b(!0)
                  h.logCounter(d._sheetID + ':open')
                })
              })
              d._closeIcon.css({ right: k + 15 + 'px' })
            })
          }
          e.prototype.close = function () {
            return new b(
              function (b) {
                var d = '-' + this._getSheetSize() + 'px'
                a.animate(
                  this._sheet,
                  { right: d },
                  300,
                  q.EXIT_EASE,
                  function () {
                    this._sheet.removeClass(m.SHEET_OPEN)
                    this._sheet.addClass(m.SHEET_CLOSE)
                    b(!0)
                    h.logCounter(this._sheetID + ':close')
                  }.bind(this),
                )
                this.hideCloseIcon()
                c.hide()
              }.bind(this),
            )
          }
          e.prototype.getSheetElement = function () {
            return this._sheet
          }
          e.prototype._getSheetSize = function () {
            return this._sheet.outerWidth()
          }
          e.prototype._createCloseIcon = function () {
            return f(
              "\x3cdiv class \x3d '" +
                (m.CLOSE_ICON + ' ' + m.CLOSE_ICON_MEDIUM + '  ' + m.HIDE_ELEMENT) +
                "'\x3e\x3c/div\x3e",
            )
          }
          e.prototype.showCloseIcon = function () {
            a.fadeIn(this._closeIcon, 200, q.EVEN_EASE)
          }
          e.prototype.hideCloseIcon = function () {
            a.fadeOut(this._closeIcon, 200, q.EVEN_EASE)
          }
          return e
        },
      )
      f.when('A', 'uss-constants', 'uss-utils').register('uss-light-box', function (a, b, c) {
        var d = a.$,
          h = b.classList,
          e = d(
            "\x3cdiv class\x3d'" +
              h.LIGHT_BOX_IDENTIFIER +
              ' ' +
              h.LIGHT_BOX_JS_HOOK +
              ' ' +
              h.HIDE_ELEMENT +
              "'\x3e\x3c/div\x3e",
          )
        d('body').append(e)
        return {
          show: function () {
            e.addClass(h.SHOW_ELEMENT)
            e.removeClass(h.HIDE_ELEMENT)
            c.disablePageScroll()
            a.animationFrameDelay(function () {
              a.animate(e, { opacity: 0.6 }, 400, b.transitionTimingFunction.EVEN_EASE)
            })
          },
          hide: function () {
            e.removeClass(h.SHOW_ELEMENT)
            a.animate(e, { opacity: 0 }, 300, b.transitionTimingFunction.EVEN_EASE, function () {
              e.addClass(h.HIDE_ELEMENT)
              e.removeClass(h.SHOW_ELEMENT)
              c.enablePageScroll()
            })
          },
          getElement: function () {
            return e
          },
        }
      })
      f.when(
        'A',
        'uss-constants',
        'dp-flux-attribution',
        'dp-flux-view',
        'uss-store-repository',
        'uss-atc-status-store',
      ).register('nav-bar-cart-count-view', function (a, b, c, d, h, e) {
        var f = a.$
        a = b.ussCTI
        c = new c('nav-bar-cart-count-view', a.CATEGORY, a.TYPE, a.ITEM)
        e = h.getStore(b.stores.ATC_STATUS_STORE)
        new d(c, [e], function (a) {
          if (-1 !== f.inArray(e, a)) {
            var b = e.getState()
            r.$Nav.when('api.setCartCount').run(function (a) {
              b.cart.count && a(b.cart.count)
            })
          }
        })
      })
      f.when('A').register('buy-box-utility', function (a) {
        var b = a.$
        return {
          isWarrantySelectedInBuyBox: function () {
            var a = !1
            b('#abbWrapper .abbListItem input[type\x3dcheckbox]').each(function () {
              a = a || b(this).prop('checked')
            })
            return a
          },
        }
      })
      f.when(
        'A',
        'uss-action-creator-helper',
        'uss-preconditions',
        'uss-logger-service',
        'uss-constants',
        'uss-utils',
        'uss-eligibility',
        'uss.cart.add-items',
        'aapi-handler',
        'percolateUI-ajax-utility',
      ).register('uss-atc', function (a, b, c, d, h, e, f, m, q, n) {
        function r() {
          a.$('#add-to-cart-button').attr('disabled', !0)
          var b = a.$('#a-page')
          0 !== b.length && (b[0].style.opacity = 0.3)
        }
        function t(a) {
          this.widgetName = a
          this.isPrimaryAtc = 'DetailPageBuyBox' === a
        }
        function H() {
          var b = a.$('body')
          return (b = a.parseJSON(b.find('[data-a-state*\x3datc-page-state]').html())) &&
            b.shouldUseNatc
            ? b.shouldUseNatc
            : !1
        }
        function C() {
          var a = '',
            b = w('#addToCart')
          0 != b.length && (a = b.attr('action'))
          return a
        }
        var w = a.$,
          E = h.ajaxParams.AJAX_TIMEOUT,
          y = {},
          x = h.metrics,
          B = h.queryStrings
        t.prototype._addQueryParams = function (a) {
          var b = '',
            c = e.getUrlParameter(B.qid),
            d = e.getUrlParameter(B.sr)
          null != c && null != d && (b = B.qid + '\x3d' + c + '\x26' + B.sr + '\x3d' + d)
          a.queryString = b
          return a
        }
        t.prototype._addUssParameters = function (a) {
          a.params.isUSSAjax = 1
          this.isPrimaryAtc &&
            ((a.params.isPrimaryATC = 1),
            e.shouldFireAndForgetWeblabTrigger() ||
              (a.params.triggerUSSWeblab = c.triggerUSSWeblabValue()))
          a = this._addEligibilityParameters(a)
          var b = e.getDebugParams()
          Object.keys(b).forEach(function (c) {
            a.params[c] = b[c]
          })
          return a
        }
        t.prototype._addEligibilityParameters = function (a) {
          var b = f.getUssEligibility(
            a.params[h.ajaxParams.ASIN],
            a.params[h.ajaxParams.OFFER_LISTING_ID],
          )
          a.params.ussEligibility = JSON.stringify(b)
          return a
        }
        t.prototype._callback = function () {
          var a = arguments[0],
            b = Array.prototype.slice.call(arguments, 1)
          'function' === typeof a && a.apply(this, b)
        }
        var D = function (a, c, h, e, l, f) {
            e
              ? (d.logCounter(x.PRIMARY_ADD_TO_CART_CLICK_COUNTER),
                (f = n.callPercolateUI(a, c)),
                (l.percolateData = f),
                b.primaryATCClick(a, l))
              : ((c = {}),
                (c.baseAsin = a),
                (c.baseReftag = h),
                d.logCounter(x.SECONDARY_ADD_TO_CART_CLICK_COUNTER),
                b.secondaryATCClick(l, c))
          },
          z = function (a, b, c, d, k, h, g, l) {
            q.atcStatusDataByApi(a, d)
              .then(function (e) {
                e.atcStatusData.status = g
                h.resolve(e)
                D(a, b, c, d, k, l)
              })
              .catch(function (f) {
                h.reject()
                d && g ? (e.handleATCAnimationEndWeb(), e.showATCSuccess()) : D(a, b, c, d, k, l)
              })
            k.atcData = h
          },
          I = function (b, c, h, e, g, f, p, m, u) {
            var q = 0
            a.post(u, {
              params: f.params,
              success: function (a, l, u) {
                f.hasOwnProperty('success') && self._callback(f.success, a, l, u)
                d.logCounter(x.USS_PRIMARY_ATC_DEFAULT_ENDPOINT_SUCCESS_RESPONSE)
                q = 1
                z(b, c, h, e, p, g, q, m)
              },
              error: function (a, l, u) {
                f.hasOwnProperty('error') && self._callback(f.error, a, l, u)
                d.logCounter(x.USS_PRIMARY_ATC_DEFAULT_ENDPOINT_FAIL_RESPONSE)
                z(b, c, h, e, p, g, q, m)
              },
              abort: function (a) {
                f.hasOwnProperty('abort') && self._callback(f.abort, a)
                z(b, c, h, e, p, g, q, m)
              },
              timeout: f.timeout || E,
            })
          },
          J = function (a, b, c, h, e, g, l, f, p) {
            var u = 0,
              q = new d.Timer(x.SECONDARY_ADDITEMS_API_PROMISE_REJECTED_COUNTER)
            q.start()
            f.done(function (a) {
              q.stop()
            })
            f.fail(function () {
              d.logCounter(x.SECONDARY_ADDITEMS_API_PROMISE_REJECTED_COUNTER)
              q.stop()
            })
            g.inputs = g.params
            var n = g.inputs
            n &&
              n['items[0.base][additionalParameters][giftOptions][includeGiftReceipt]'] &&
              (n['items[0.base][additionalParameters][giftOptions][includeGiftReceipt]'] =
                'true' ===
                n['items[0.base][additionalParameters][giftOptions][includeGiftReceipt]'])
            m.addItems(g, h)
              .then(function (a) {
                f.resolve(a)
              })
              .catch(function (a) {
                f.reject(a)
              })
            l.addItems = f
            l.addItems.then(
              function (d) {
                u = 1
                z(a, b, c, h, l, e, u, p)
              },
              function (d) {
                z(a, b, c, h, l, e, u, p)
              },
            )
          }
        t.prototype._addToCart = function (a, b) {
          this.isPrimaryAtc && c.isUssWeblabInTreatment() && r()
          b = this._addUssParameters(b)
          b = this._addQueryParams(b)
          var e = w.Deferred(),
            g = w.Deferred(),
            l = w.Deferred(),
            f = {},
            m = b.params.a
          a = a.ref
          var q = b.params[h.ajaxParams.OFFER_LISTING_ID],
            n = this.isPrimaryAtc,
            v = C()
          f.atcData = e
          var t = new d.Timer(
            n
              ? x.PRIMARY_ATC_STATUS_PROMISE_RESOLVED_TIMER
              : x.SECONDARY_ATC_STATUS_PROMISE_RESOLVED_TIMER,
          )
          t.start()
          e.done(function (a) {
            t.stop()
          })
          e.fail(function () {
            t.stop()
          })
          n && !H() ? I(m, q, a, n, e, b, f, l, v) : J(m, q, a, n, e, b, f, l, g)
          return f
        }
        return {
          addToCart: function (a, b, c) {
            if (!a || !a.trim().length || 'object' !== typeof b)
              throw h.fatalMessagesList.INCORRECT_PARAMETER_PASSED
            y[a] || (y[a] = new t(a))
            return y[a]._addToCart(c, b)
          },
          callToActionCreator: D,
        }
      })
      f.when(
        'A',
        'uss-atc',
        'uss-action-creator-helper',
        'uss-preconditions',
        'uss-logger-service',
        'uss-constants',
        'buy-box-utility',
        'uss-utils',
      ).register('buy-box-override', function (a, b, c, d, e, h, f, m) {
        var q = a.$
        a = {
          actionButton: null,
          AllowedActions: { 'submit.add-to-cart': 1 },
          init: function () {
            this.checkPreconditionsAndManipulateBuyBox()
          },
          checkPreconditionsAndManipulateBuyBox: function () {
            this.buyBoxForm = q('#addToCart')
            d.isUssConditionsPassed() && this.attachFormHandler()
          },
          attachFormHandler: function () {
            this.buyBoxForm.submit(this.submitForm.bind(this))
            this.buyBoxForm.find('input[type\x3dsubmit], input[type\x3dbutton]').click(
              function (a) {
                this.actionButton = a.target
              }.bind(this),
            )
          },
          isValidAction: function () {
            return this.actionButton && this.actionButton.name in this.AllowedActions
          },
          submitForm: function (a) {
            if (!f.isWarrantySelectedInBuyBox() && this.isValidAction())
              if (d.isUssWeblabInTreatment()) {
                a.preventDefault()
                a = { params: this.getAddToCartParameters() }
                var c = { ref: h.ajaxParams.REFTAG }
                m.shouldFireAndForgetWeblabTrigger() &&
                  m.fireAndForgetWeblabTrigger(
                    d.triggerUSSWeblabValue(),
                    d.ussWeblabTreatmentValue(),
                  )
                b.addToCart('DetailPageBuyBox', a, c)
              } else
                e.logCounter(h.metrics.POST_ATC_WEBLAB_DISABLED),
                  m.shouldFireAndForgetWeblabTrigger()
                    ? m.fireAndForgetWeblabTrigger(
                        d.triggerUSSWeblabValue(),
                        d.ussWeblabTreatmentValue(),
                      )
                    : this.addHiddenUSSField('triggerUSSWeblab', d.triggerUSSWeblabValue())
            else e.logCounter(h.metrics.POST_ATC_WARRANTY_SELECTED_OR_INVALID_ACTION)
          },
          addHiddenUSSField: function (a, b) {
            q('\x3cinput\x3e')
              .attr({ type: 'hidden', id: a, name: a, value: b })
              .appendTo(this.buyBoxForm)
          },
          getAddToCartParameters: function () {
            var a = {},
              b = this.buyBoxForm.serializeArray()
            q.each(b, function (b, c) {
              a[c.name] = c.value
            })
            return a
          },
        }
        return { init: a.init.bind(a) }
      })
      f.when('A', 'uss-constants', 'uss-logger-service', 'uss-eligibility', 'uss-utils').register(
        'percolateUI-ajax-utility',
        function (a, b, c, d, h) {
          var e = b.ajaxParams.AJAX_TIMEOUT,
            f = h.getPageType(),
            m = h.getSubPageType(),
            q = b.metrics
          return {
            callPercolateUI: function (b, g) {
              var n = {
                pageType: f,
                baseAsin: b,
                subPageType: m,
                ussEligibility: JSON.stringify(d.getUssEligibility(b, g)),
              }
              b = a.$('#uss-mraiCategory').val()
              g = a.$('#uss-mraiGl').val()
              b && (n.mraiCategory = b)
              g && (n.mraiGl = g)
              var r = h.getDebugParams()
              Object.keys(r).forEach(function (a) {
                n[a] = r[a]
              })
              var t = a.$.Deferred(),
                w = new c.Timer(q.PERCOLATE_DATA_PROMISE_RESOLVED_TIMER)
              w.start()
              a.post('/ussx', {
                params: n,
                success: function (a, b, c) {
                  t.resolve(a)
                },
                error: function (a, b) {
                  t.reject()
                },
                timeout: e,
              })
              t.done(function (a) {
                w.stopWithCounter(2e3, q.PERCOLATE_DATA_PROMISE_RESOLVED_LONG_TIME_COUNTER, 1)
              })
              t.fail(function () {
                c.logCounter(q.PERCOLATE_DATA_PROMISE_REJECTED_COUNTER)
              })
              return t.promise()
            },
          }
        },
      )
    }
    function b() {
      n.isUssConditionsPassed() &&
        (d.logCounter(a.metrics.PAGE_LANDING_PRECONDITIONS_PASSED),
        h || (c(), (h = !0), m.initializeUSSComponents()),
        m.initializeBuyBox())
    }
    var h = !1
    e.on('PageRefresh:ATF', function () {
      b()
    })
    b()
  })
  ;('use strict')
  f.when(
    'jQuery',
    'A',
    'a-component',
    'uss-widget-footer',
    'uss-widget-partial-content',
    'uss-widget-full-content',
    'p13n-sc-call-on-visible',
    'p13n-sc-logger',
  ).register('uss-list-widget', function (e, f, m, n, d, a, c, b) {
    function h(a) {
      var b = 'a:expandControl:' + a._$footer.getName() + ':toggle'
      f.on(b, function () {
        var b = !a.isExpanded()
        a._$element.attr('data-a-expanded', b)
        g(a, b)
        a._$firstToggleEvent &&
          0 < a._$widgetImpressionElement.length &&
          ((a._$firstToggleEvent = 0),
          l(a._$widgetImpressionElement, a._$fullContent._$element, { action: 'see_more' }))
      })
    }
    function l(a, d, h) {
      c.register(
        a,
        function () {
          b.logAsyncAction(
            e.extend(
              !0,
              {},
              {
                featureElement: a,
                isEventComplete: function () {
                  return d.is(':visible')
                },
                logOnlyNew: !0,
                replicateAsinImpressions: !0,
              },
              h,
            ),
          )
        },
        { distance: 10 },
      )
    }
    function g(a, b) {
      a._$footer.toggleExpansion(b, !a.isExpanded(), a._$firstToggleEvent)
      a._$fullContent.toggleExpansion(b)
      a._$partialContent.toggleExpansion(b)
    }
    var p = m.create({
      _componentName: 'ussListWidget',
      init: function (c, e) {
        this._super(c, e)
        this._$partialContent = d(this._$element.find('.uss-partial-list-container'))
        this._$fullContent = a(this._$element.find('.uss-full-list-container'))
        this._$footer = n(this._$element.find('.uss-widget-footer'))
        this._$firstToggleEvent = 1
        this._$widgetImpressionElement = this._$element.find('.p13n-sc-static-list')
        0 < this._$widgetImpressionElement.length &&
          ('function' === typeof b.resetImpressions &&
            b.resetImpressions(this._$widgetImpressionElement.attr('data-p13n-feature-name')),
          l(this._$widgetImpressionElement, this._$partialContent._$element, {
            action: 'view',
            initialDelay: 0,
          }))
        h(this)
        g(this, this.isExpanded())
      },
      isExpanded: function () {
        return 'true' === this._$element.attr('data-a-expanded')
      },
    })
    return function (a, b) {
      return new p(a, b)
    }
  })
  f.when('jQuery', 'A').execute('uss-sp-help-link', function (e, f) {
    f.on('a:popover:beforeShow:uss-sp-help-link-popover', function (e) {
      e.popover.$container.css('z-index', 501)
    })
  })
  ;('use strict')
  f.when('jQuery', 'A', 'p13n-sc-line-truncator', 'a-component').register(
    'uss-widget-partial-content',
    function (e, f, m, n) {
      var d = n.create({
        _componentName: 'ussWidgetPartialContent',
        init: function (a, c) {
          this._super(a, c)
          this._$element.find('.p13n-sc-truncate').toggleClass('uss-asin-title')
          m.truncateLines(this._$element)
          f.loadDynamicImage(this._$element.find('.p13n-sc-list-image-container'))
        },
        toggleExpansion: function (a) {
          var c = this
          c._$element.attr('data-a-expanded', a)
          a
            ? c._$element.hide()
            : f.delay(function () {
                c._$element.show()
              }, 50)
        },
      })
      return function (a, c) {
        return new d(a, c)
      }
    },
  )
  ;('use strict')
  f.when('jQuery', 'A', 'p13n-sc-line-truncator', 'a-component').register(
    'uss-widget-full-content',
    function (e, f, m, n) {
      var d = n.create({
        _componentName: 'ussWidgetFullcontent',
        init: function (a, c) {
          this._super(a, c)
          this._$dynamicImagesLoaded = this._$isTitleTruncated = !1
          a = this._$element.find('.p13n-sc-truncate')
          a.toggleClass('uss-asin-title')
          a.attr('data-rows', '4')
        },
        toggleExpansion: function (a) {
          var c = this
          c._$element.attr('data-a-expanded', a)
          a
            ? f.delay(function () {
                c._$element.show()
                m.truncateLines(c._$element)
                c._$dynamicImagesLoaded ||
                  (f.loadDynamicImage(c._$element.find('.p13n-sc-list-image-container')),
                  (c._$dynamicImagesLoaded = !0))
              }, 50)
            : c._$element.hide()
        },
      })
      return function (a, c) {
        return new d(a, c)
      }
    },
  )
  ;('use strict')
  f.when(
    'jQuery',
    'A',
    'a-component',
    'uss-widget-see-more',
    'uss-widget-expander-icon',
    'uss-constants',
    'uss-logger-service',
  ).register('uss-widget-footer', function (e, f, m, n, d, a, c) {
    function b(a) {
      var b = a.getName()
      a = a.isExpanded()
      f.trigger('a:expandControl:' + b + ':toggle')
      a
        ? (c.logCounter(h.SEE_LESS_CLICK_COUNTER), c.logCounter(h.SEE_LESS_CLICK_COUNTER + ':' + b))
        : (c.logCounter(h.SEE_MORE_CLICK_COUNTER), c.logCounter(h.SEE_MORE_CLICK_COUNTER + ':' + b))
    }
    var h = a.metrics,
      l = function (a, b) {
        return a + ':' + b
      },
      g = m.create({
        _componentName: 'ussWidgetFooter',
        init: function (a, e) {
          var g = this
          g._super(a, e)
          g._$expanderIcon = d(g._$element.find('.uss-expander-icon-container'))
          g._$seeMore = n(g._$element.find('.uss-see-more'))
          g._$element.length &&
            (c.logCounter(h.SEE_MORE_EXISTENCE_COUNTER),
            c.logCounter(l(h.SEE_MORE_EXISTENCE_COUNTER, g.getName())))
          g._$element.click(function () {
            b(g)
          })
          g._$element.keypress(function (a) {
            var c = f.constants.keycodes
            a = a.which
            ;(a !== c.ENTER && a !== c.SPACE) || b(g)
          })
        },
        toggleExpansion: function (a, b, c) {
          var d = this
          d._$element.attr('data-a-expanded', a)
          f.fadeOut(d._$element, 200, 'linear', function () {
            d._$seeMore.toggleSeeMore(a)
            d._$expanderIcon.toggleExpanderIcon(a)
            f.fadeIn(d._$element, 200)
          })
          a || !b || c || d._$element.parent().get(0).scrollIntoView(!0)
        },
        isExpanded: function () {
          return 'true' === this._$element.attr('data-a-expanded')
        },
        getName: function () {
          return this._$element.attr('data-name')
        },
      })
    return function (a, b) {
      return new g(a, b)
    }
  })
  ;('use strict')
  f.when('jQuery', 'A', 'a-component').register('uss-widget-see-more', function (e, f, m) {
    var n = m.create({
      _componentName: 'ussWidgetSeeMore',
      init: function (d, a) {
        this._super(d, a)
        this._$seeMoreText = this._$element.find('.uss-see-more-text')
        this._$seeLessText = this._$element.find('.uss-see-less-text')
      },
      toggleSeeMore: function (d) {
        this._$seeMoreText.toggle(!d)
        this._$seeLessText.toggle(d)
      },
    })
    return function (d, a) {
      return new n(d, a)
    }
  })
  ;('use strict')
  f.when('jQuery', 'A', 'a-component').register('uss-widget-expander-icon', function (e, f, m) {
    var n = m.create({
      _componentName: 'ussWidgetExpanderIcon',
      init: function (d, a) {
        this._super(d, a)
        this._$icon = this._$element.find('.uss-expander-icon')
      },
      toggleExpanderIcon: function (d) {
        this._$icon.toggleClass('a-css-icon-expand', !d).toggleClass('a-css-icon-collapse', d)
      },
    })
    return function (d, a) {
      return new n(d, a)
    }
  })
  ;('use strict')
  f.when('jQuery', 'A', 'uss-atc').execute('uss-inline-atc', function (e, f, m) {
    function n(a) {
      var c = {}
      a.find('input[type\x3dhidden]').each(function (a, d) {
        c[d.name] = e(d).val()
      })
      return c
    }
    function d(a, c, b, d) {
      a.atcData.then(
        function (a) {
          d.hide()
          1 === a.isOk ? c.show() : b.show()
        },
        function () {
          d.hide()
          b.show()
        },
      )
    }
    ;(function () {
      e('body').delegate('.uss-list-widget .uss-add-to-cart-button', 'click', function (a) {
        a = e(a.currentTarget)
        var c = a.parent().find('input[name\x3dASIN]').val(),
          b = e('.uss-add-to-cart-form-' + c),
          c = b.siblings('.uss-atc-success'),
          h = b.siblings('.uss-atc-error'),
          f = b.siblings('.uss-atc-spinner')
        b.hide()
        f.show()
        var g = { params: n(b) },
          p = JSON.parse(b.attr('data-link-params')),
          b = { linkParams: e.param(p), ref: b.attr('data-ref') }
        a = m.addToCart(a.parents('.uss-widget-body').attr('data-p13n-feature-name'), g, b)
        d(a, c, h, f)
      })
    })()
  })
  f.when('uss-constants-common').register('nexus-util', function (e) {
    return {
      emitCounterData: function (f, m) {
        f = { counterName: f, counterValue: m }
        r.ue &&
          ue.event &&
          r.ue.event(
            f,
            e.nexusConstants.PRODUCER_ID,
            e.nexusConstants.SCHEMA_ID + e.nexusConstants.SCHEMA_VERSION,
          )
      },
    }
  })
  f.when('A', '3p-promise', 'uss-constants', 'uss-constants-common', 'uss-logger-service').register(
    'uss-amazonapi-client',
    function (e, f, m, n, d) {
      function a(a) {
        var c = e.$(b.ENDPOINT).val() + '/' + a.apiPath,
          d = []
        if (a.additionalParameters)
          for (var f in a.additionalParameters)
            a.additionalParameters.hasOwnProperty(f) &&
              d.push(f + '\x3d' + encodeURIComponent(a.additionalParameters[f]))
        d.length && (c += '?' + d.join('\x26'))
        return c
      }
      function c(a) {
        var c = e.$(b.CSRF_TOKEN).val(),
          g = e.$('meta[name\x3d"encrypted-slate-token"]').prop('content'),
          f
        f = ['application/vnd.com.amazon.api+json', 'type\x3d"' + a.responseType + '"']
        a.resourceInclusions && f.push('expand\x3d"' + a.resourceInclusions.join(',') + '"')
        f = f.join('; ')
        var k
        k = e.$(b.LANGUAGE_OF_PREFERENCE).val()
        a.languageOfPreference && (k = a.languageOfPreference)
        k = k.replace(/_/g, '-')
        c = {
          Accept: f,
          'Accept-Language': k,
          'x-api-csrf-token': c,
          'x-amzn-encrypted-slate-token': g,
        }
        ;(g !== t && null !== g && '' !== g) || d.logCounter(n.metrics.EMPTY_SLATE_TOKEN, 1)
        a.requestType &&
          (c['Content-Type'] =
            'application/vnd.com.amazon.api+json; type\x3d"' + a.requestType + '"')
        return c
      }
      var b = {
        CSRF_TOKEN: '#uss-amazonApiAjaxCsrfToken',
        ENDPOINT: '#uss-amazonApiAjaxEndpoint',
        LANGUAGE_OF_PREFERENCE: '#uss-languagePreference',
      }
      return {
        makeRequest: function (d) {
          return new f(function (f, g) {
            var m = a(d),
              k = c(d),
              n = d.data ? JSON.stringify(d.data) : t,
              q
            q =
              'integ.amazon.com' !== e.$(b.ENDPOINT).val().split('/')[2].substring(8, 24)
                ? 'prod'
                : void 0
            return e.$.ajax({
              type: d.method,
              url: m,
              headers: k,
              data: n,
              xhrFields: { withCredentials: !0 },
              dataType: 'json',
              success: function (a) {
                a.environment = q
                f(a)
              },
              error: function (a) {
                var b = { statusCode: a.status, xhr: a }
                if (a.responseText)
                  try {
                    b.data = JSON.parse(a.responseText)
                  } catch (c) {
                    b.data = a.responseText
                  }
                g(b)
              },
            })
          })
        },
      }
    },
  )
  f.when('productV2Images-api', '3p-promise', 'uss-constants', 'uss-logger-service').register(
    'aapi-handler',
    function (e, f, m, n) {
      var d = m.metrics,
        a = m.cartApiConstants,
        c = new n.Timer(d.PRODUCTV2IMAGES_API_PROMISE_RESOLVED_TIMER),
        b = function (b, f) {
          b = e.productV2Images(b)
          b.then(function (b) {
            if (
              !(
                b &&
                b.entity &&
                b.entity.productImages &&
                b.entity.productImages.entity &&
                b.entity.productImages.entity.images
              )
            )
              throw b
            var d = b.entity.productImages.entity.images[0].lowRes.physicalId,
              e = b.entity.productImages.entity.images[0].lowRes.extension,
              h = b.entity.productImages.entity.altText
            b =
              b.environment === a.USS_ENVIRONMENT_PROD
                ? a.USS_PRODUCTV2IMAGES_PROD_URL_PATH + d + a.USS_PRODUCTV2IMAGES_DIMENSIONS + e
                : a.USS_PRODUCTV2IMAGES_DEV_URL_PATH + d + a.USS_PRODUCTV2IMAGES_DIMENSIONS + e
            f.mainImage.altText = h
            f.mainImage.src = b
            c.stop()
          }).catch(function (a) {
            n.logCounter(d.PRODUCTV2IMAGES_API_PROMISE_REJECTED_COUNTER)
            c.stop()
            return a
          })
          return b
        }
      return {
        atcStatusDataByApi: function (e, l) {
          return new f(function (g, m) {
            var k = {
                imbHTML: '',
                mainImage: { altText: {}, src: {} },
                shippingMessageHTML: a.USS_SHIPPING_MESSAGE,
                status: 1,
              },
              r = []
            if (!0 === l) {
              c.start()
              var t = b(e, k)
              r.push(t)
            }
            f.all(r)
              .then(function () {
                g({ atcStatusData: k, isOk: 1 })
              })
              .catch(function () {
                n.logCounter(d.CART_API_PROMISE_REJECTED_COUNTER)
                m()
              })
          })
        },
      }
    },
  )
  f.when('A', 'uss-amazonapi-client', 'natc-utils', 'buy-box-utility', 'uss-constants').register(
    'uss.cart.add-items',
    function (e, f, m, n, d) {
      function a(a, c) {
        c.reftag && (a.additionalParameters.ref_ = c.reftag)
        ;(c.queryString !== t && '' !== c.queryString ? c.queryString : '')
          .split('\x26')
          .forEach(function (c) {
            c = c.split('\x3d')
            2 === c.length && (a.additionalParameters[c[0]] = c[1])
          })
      }
      var c = d.cartApiConstants
      return {
        addItems: function (b, d) {
          var e
          if (d) {
            e = m.constructAddItemsRequest(b)
            b.reftag = c.USS_PRIMARY_ATC_REFTAG
            var g = e.items,
              p = b.inputs.a
            if (g)
              for (var k = 0; k < g.length; ++k)
                if (p && p === g[k].asin) {
                  var r = n.getSelectedQuantityInMobileAppBuyBox()
                  r && !isNaN(r) ? (g[k].quantity = Number(r)) : (g[k].quantity = 1)
                }
          } else
            b
              ? ((e = b.cartArgs.offerListingID),
                (g = c.USS_SECONDARY_ATC_QUANTITY),
                (p = b.inputs.additionalParameters),
                (k = {}),
                (k.asin = b.inputs.a),
                (k.offerListingId = e),
                (k.quantity = g),
                p && (k.additionalParameters = p),
                (e = { items: [k] }))
              : (e = {})
          g =
            !d && b && b.reftag
              ? 'cart/carts/retail/items?ref_\x3d' + b.reftag.replace('?', '\x26')
              : 'cart/carts/retail/items'
          e = {
            apiPath: g,
            requestType: 'cart.add-items.request/v1',
            responseType: 'cart.add-items/v1',
            method: 'POST',
            data: e,
            additionalParameters: {},
          }
          d && b && a(e, b)
          return f.makeRequest(e)
        },
      }
    },
  )
  f.when('A', 'uss-amazonapi-client').register('uss.cart.modify-items', function (e, f) {
    return {
      modifyItems: function (e, n) {
        return f.makeRequest({
          apiPath: 'cart/carts/retail/items?ref_\x3d' + n,
          requestType: 'cart.modify-items.request/v1',
          responseType: 'cart.modify-items/v1',
          method: 'PUT',
          data: { items: e },
        })
      },
    }
  })
  f.when('uss-amazonapi-client').register('productV2Images-api', function (e) {
    'use-strict'
    return {
      productV2Images: function (f) {
        return e.makeRequest({
          apiPath: 'products/' + f,
          responseType: 'product/v2',
          method: 'GET',
          resourceInclusions: ['productImages(product.product-images/v2)'],
        })
      },
    }
  })
  f.when('A').register('natc-utils', function (e) {
    function f(a) {
      if (!a || !a.inputs) return d.INVALID
      a = a.inputs
      for (var c in a) {
        if (c.startsWith('items[0.base][asin]')) return d.V2
        if (c.startsWith('item[0].asin')) return d.V1
      }
      return d.INVALID
    }
    function m(a) {
      var c = a.inputs
      a = {}
      for (var b in c) {
        var d = b.replace('items[', '').slice(0, -1).split('][')
        d.reduce(function (a, e, f) {
          return a[e] || (a[e] = d.length - 1 === f ? c[b] : {})
        }, a)
      }
      return a
    }
    function n(a) {
      var c = a.inputs
      a = {}
      for (var b in c) {
        var d = b.replace(/item\[(\d+)\]/, '$1').split('.')
        d.reduce(function (a, e, f) {
          return a[e] || (a[e] = d.length - 1 === f ? c[b] : {})
        }, a)
      }
      return a
    }
    var d = {
      V1: 'NATC_Params_Version_1',
      V2: 'NATC_Params_Version_2',
      INVALID: 'NATC_Params_Version_Invalid',
    }
    String.prototype.startsWith ||
      Object.defineProperty(String.prototype, 'startsWith', {
        value: function (a, c) {
          c = 0 < c ? c | 0 : 0
          return this.substring(c, c + a.length) === a
        },
      })
    return {
      constructAddItemsRequest: function (a) {
        switch (f(a)) {
          case d.V2:
            a = m(a)
            break
          case d.V1:
            a = n(a)
            break
          default:
            throw Error('Could not determine or invalid NATC params version')
        }
        var c = [],
          b
        for (b in a) 'object' === typeof a[b] && a[b].asin && c.push(a[b])
        return { items: c }
      },
      determineNATCParamsVersion: f,
      PARAM_VERSIONS: d,
    }
  })
  f.when('uss-default-layout').register('uss-final-layout', function (e) {
    return e
  })
})
/* ******** */
;(function (q) {
  var r = window.AmazonUIPageJS || window.P,
    u = r._namespace || r.attributeErrors,
    b = u ? u('DetailPagePaymentOptionsJavascript', '') : r
  b.guardFatal
    ? b.guardFatal(q)(b, window)
    : b.execute(function () {
        q(b, window)
      })
})(function (q, r, u) {
  'use strict'
  q.when('A', 'payment-options-constants').register(
    'payment-options-client-side-metric',
    function (b, d) {
      function e() {
        return Date.now().toString(10) + Math.random().toString(16).substring(2, 13)
      }
      function f(c, a) {
        m(d.metricPrefix, c, a)
      }
      function k(c, a) {
        m(d.metricPrefixUFO, c, a)
      }
      function m(c, a, b) {
        if ('undefined' !== typeof h && 'undefined' !== typeof h.count && a && c) {
          if (b === u || null === b) b = 1
          c += a
          h.count(c, (h.count(c) || 0) + b)
          'undefined' !== typeof r.csa &&
            ((b = r.csa('Events', { producerId: 'dp-rpcx' })),
            (a = h.count(c)),
            b(
              'log',
              { schemaId: 'dpRpcx.CSALoggingSchema.5', eventName: c, valueToLog: a },
              { ent: 'all' },
            ))
        }
      }
      function l(c) {
        if (c) (this.timerName = c), (this.startTime = 0)
        else throw Error('timerName must be non empty string')
      }
      function g(c) {
        if (c) (this.timerName = c), (this.startTime = 0)
        else throw Error('timerName must be non empty string')
      }
      var h = r.ue
      l.prototype = {
        isStarted: !1,
        start: function () {
          this.isStarted = !0
          this.startTime = Date.now()
        },
        stop: function () {
          this.startTime && f(this.timerName, Date.now() - this.startTime)
        },
      }
      g.prototype = {
        isStarted: !1,
        start: function () {
          this.isStarted = !0
          this.startTime = Date.now()
        },
        stop: function () {
          this.startTime && f(this.timerName, Date.now() - this.startTime)
        },
      }
      return {
        increment: function (c) {
          f(c, 1)
        },
        incrementWithValue: f,
        incrementWithValuePriceBlockMessaging: function (c, a) {
          m(d.metricPrefixPriceblock, c, a)
        },
        logNexusEventForMonthlyPaymentSelection: function (c) {
          if (r.ue && h.event) {
            var a = {}
            a.requestId = c.data.requestId
            a.sessionId = c.data.sessionId
            a.marketplaceId = c.data.marketplaceId
            a.customerId = c.data.customerId
            a.asin = c.data.asin
            a.websiteDisplayGroup = c.data.websiteDisplayGroup
            a.parentAsin = c.data.parentASIN
            a.buyingOptionType = c.data.buyingOptionType
            a.financingId = c.data.optionId
            a.ranking = parseInt(c.data.executionInfo.offerRank)
            a.isRender = !0
            a.deviceType = c.data.deviceType
            a.isUfoSwatchExpanded = !0
            a.isOfferSelected = !0
            a.isOfferAddedToCart = !1
            a.isOfferUsedWithBuyNow = !1
            a.schemaId = d.nexus.schemaId
            a.producerId = d.nexus.producerId
            a.messageId = e()
            a.trackingId = 'undef'
            a.isPreselection = null
            a.sellerId = 'undef'
            a.asinExperience = 'undef'
            a.variantRendered = 'undef'
            a.locale = 'undef'
            a.isSelectFromPlansClicked = !1
            a.isOfferSelectionClicked = !1
            a.isOfferGroupingSelected = !1
            a.isConfirmPlanSelectionClicked = !0
            a.isChangePlanClicked = !1
            a.isCheckboxSelected = !1
            a.isCheckboxDeselected = !1
            a.isCancelPlanClicked = !1
            h.event(a, d.nexus.producerId, d.nexus.schemaId, { ssd: !0 })
            k('MonthlyPaymentSelection', 1)
          }
        },
        logNexusEventForComparePlansLink: function (c) {
          if (r.ue && h.event) {
            var a = {}
            a.requestId = c.data.requestId
            a.sessionId = c.data.sessionId
            a.marketplaceId = 'undef'
            a.customerId = c.data.customerId
            a.asin = 'undef'
            a.websiteDisplayGroup = 'undef'
            a.parentAsin = 'undef'
            a.buyingOptionType = 'undef'
            a.financingId = 'undef'
            a.ranking = -1
            a.isRender = !0
            a.deviceType = 'undef'
            a.isUfoSwatchExpanded = !1
            a.isOfferSelected = !1
            a.isOfferAddedToCart = !1
            a.isOfferUsedWithBuyNow = !1
            a.schemaId = d.nexus.schemaId
            a.producerId = d.nexus.producerId
            a.messageId = e()
            a.trackingId = 'undef'
            a.isPreselection = null
            a.sellerId = 'undef'
            a.asinExperience = 'undef'
            a.variantRendered = 'undef'
            a.locale = 'undef'
            a.isSelectFromPlansClicked = !0
            a.isOfferSelectionClicked = !1
            a.isOfferGroupingSelected = !1
            a.isConfirmPlanSelectionClicked = !1
            a.isChangePlanClicked = !1
            a.isCheckboxSelected = !1
            a.isCheckboxDeselected = !1
            a.isCancelPlanClicked = !1
            h.event(a, d.nexus.producerId, d.nexus.schemaId, { ssd: !0 })
            k('ComparePlansLink', 1)
          }
        },
        logNexusEventForSwatchExpansion: function (c) {
          if (r.ue && h.event) {
            var a = {}
            a.requestId = c.data.requestId
            a.sessionId = c.data.sessionId
            a.marketplaceId = c.data.marketplaceId
            a.customerId = c.data.customerId
            a.asin = c.data.asin
            a.websiteDisplayGroup = c.data.websiteDisplayGroup
            a.parentAsin = c.data.parentASIN
            a.buyingOptionType = c.data.buyingOptionType
            a.financingId = 'undef'
            a.ranking = -1
            a.isRender = !0
            a.deviceType = c.data.deviceType
            a.isUfoSwatchExpanded = !0
            a.isOfferSelected = !1
            a.isOfferAddedToCart = !1
            a.isOfferUsedWithBuyNow = !1
            a.schemaId = d.nexus.schemaId
            a.producerId = d.nexus.producerId
            a.messageId = e()
            a.trackingId = 'undef'
            a.isPreselection = null
            a.sellerId = 'undef'
            a.asinExperience = 'undef'
            a.variantRendered = 'undef'
            a.locale = 'undef'
            a.isSelectFromPlansClicked = !1
            a.isOfferSelectionClicked = !1
            a.isOfferGroupingSelected = !1
            a.isConfirmPlanSelectionClicked = !1
            a.isChangePlanClicked = !1
            a.isCheckboxSelected = !1
            a.isCheckboxDeselected = !1
            a.isCancelPlanClicked = !1
            h.event(a, d.nexus.producerId, d.nexus.schemaId, { ssd: !0 })
            k('SwatchExpansion', 1)
          }
        },
        logNexusEventForComparePlansOfferSelection: function (c) {
          if (r.ue && h.event) {
            var a = {}
            a.requestId = c.data.requestId
            a.sessionId = c.data.sessionId
            a.marketplaceId = c.data.marketplaceId
            a.customerId = c.data.customerId
            a.asin = c.data.asin
            a.websiteDisplayGroup = c.data.websiteDisplayGroup
            a.parentAsin = c.data.parentASIN
            a.buyingOptionType = c.data.buyingOptionType
            a.financingId = c.data.optionId
            a.ranking = -1
            a.isRender = !0
            a.deviceType = c.data.deviceType
            a.isUfoSwatchExpanded = !1
            a.isOfferSelected = !1
            a.isOfferAddedToCart = !1
            a.isOfferUsedWithBuyNow = !1
            a.schemaId = d.nexus.schemaId
            a.producerId = d.nexus.producerId
            a.messageId = e()
            a.trackingId = 'undef'
            a.isPreselection = null
            a.sellerId = 'undef'
            a.asinExperience = 'undef'
            a.variantRendered = 'undef'
            a.locale = 'undef'
            a.isSelectFromPlansClicked = !1
            a.isOfferSelectionClicked = !0
            a.isOfferGroupingSelected = !1
            a.isConfirmPlanSelectionClicked = !1
            a.isChangePlanClicked = !1
            a.isCheckboxSelected = !1
            a.isCheckboxDeselected = !1
            a.isCancelPlanClicked = !1
            h.event(a, d.nexus.producerId, d.nexus.schemaId, { ssd: !0 })
            k('ComparePlansOfferSelection', 1)
          }
        },
        logNexusEventForChangePlansLink: function (c) {
          if (r.ue && h.event) {
            var a = {}
            a.requestId = c.data.requestId
            a.sessionId = c.data.sessionId
            a.marketplaceId = 'undef'
            a.customerId = c.data.customerId
            a.asin = 'undef'
            a.websiteDisplayGroup = 'undef'
            a.parentAsin = 'undef'
            a.buyingOptionType = 'undef'
            a.financingId = 'undef'
            a.ranking = -1
            a.isRender = !0
            a.deviceType = 'undef'
            a.isUfoSwatchExpanded = !1
            a.isOfferSelected = !1
            a.isOfferAddedToCart = !1
            a.isOfferUsedWithBuyNow = !1
            a.schemaId = d.nexus.schemaId
            a.producerId = d.nexus.producerId
            a.messageId = e()
            a.trackingId = 'undef'
            a.isPreselection = null
            a.sellerId = 'undef'
            a.asinExperience = 'undef'
            a.variantRendered = 'undef'
            a.locale = 'undef'
            a.isSelectFromPlansClicked = !1
            a.isOfferSelectionClicked = !1
            a.isOfferGroupingSelected = !1
            a.isConfirmPlanSelectionClicked = !1
            a.isChangePlanClicked = !0
            a.isCheckboxSelected = !1
            a.isCheckboxDeselected = !1
            a.isCancelPlanClicked = !1
            h.event(a, d.nexus.producerId, d.nexus.schemaId, { ssd: !0 })
            k('ComparePlansChangePlan', 1)
          }
        },
        logNexusEventForCancelPlan: function (c) {
          if (r.ue && h.event) {
            var a = {}
            a.requestId = c.data.requestId
            a.sessionId = c.data.sessionId
            a.marketplaceId = c.data.marketplaceId
            a.customerId = c.data.customerId
            a.asin = c.data.asin
            a.websiteDisplayGroup = c.data.websiteDisplayGroup
            a.parentAsin = c.data.parentASIN
            a.buyingOptionType = c.data.buyingOptionType
            a.financingId = 'undef'
            a.ranking = -1
            a.isRender = !0
            a.deviceType = c.data.deviceType
            a.isUfoSwatchExpanded = !1
            a.isOfferSelected = !1
            a.isOfferAddedToCart = !1
            a.isOfferUsedWithBuyNow = !1
            a.schemaId = d.nexus.schemaId
            a.producerId = d.nexus.producerId
            a.messageId = e()
            a.trackingId = 'undef'
            a.isPreselection = null
            a.sellerId = 'undef'
            a.asinExperience = 'undef'
            a.variantRendered = 'undef'
            a.locale = 'undef'
            a.isSelectFromPlansClicked = !1
            a.isOfferSelectionClicked = !1
            a.isOfferGroupingSelected = !1
            a.isConfirmPlanSelectionClicked = !1
            a.isChangePlanClicked = !1
            a.isCheckboxSelected = !1
            a.isCheckboxDeselected = !1
            a.isCancelPlanClicked = !0
            h.event(a, d.nexus.producerId, d.nexus.schemaId, { ssd: !0 })
            k('ComparePlansCancelPlan', 1)
          }
        },
        Timer: l,
        TimerPriceBlockMessaging: g,
      }
    },
  )
  ;('use strict')
  q.when(
    'A',
    'payment-options-constants',
    'payment-options-expander-actions',
    'payment-options-client-side-metric',
  ).register('multi-card-exp-payment-options', function (b, d, e, f) {
    function k() {
      f.increment('Expander:Auto:Collapse')
      var d = b
        .$('[data-toggle-payment-options-expander]')
        .data('toggle-payment-options-expander').renderPreselection
      e.collapsePaymentOptions(d)
      b
        .$('[data-toggle-payment-options-expander]')
        .data('toggle-payment-options-expander').isExpand = !1
    }
    function m() {
      if (document.getElementById('payment-options-expander-header')) {
        var d = JSON.parse(
          b
            .$('[data-toggle-payment-options-expander]')
            .attr('data-toggle-payment-options-expander'),
        )
        d.isAutoExpand = !0
        d.forceExpand = !0
        b.trigger('a:declarative:expand-payment-options-expander', { data: d })
      }
    }
    return (function () {
      var e = b.$(d.selector.multiCardExperimentElement).data(d.selector.multiCardExperimentData)
      if (!e || !e.treatment) return {}
      var f = b.$(d.selector.activeTPlusCards).val()
      if (!f || !f.length) return {}
      f = f.split(',')
      return {
        expTreatment: e.treatment,
        isFirstCard: f[0] === d.featureRegistration.featureName,
        collapseCard: k,
        autoExpandCard: m,
      }
    })()
  })
  ;('use strict')
  q.when('A').register('payment-options-constants', function (b) {
    return {
      featureRegistration: { featureName: 'paymentOptions', featureAttribution: 'C/T/I' },
      nexus: { producerId: 'ufo-dev', schemaId: 'ufo_dev.DPXAwarenessAndConversion.6' },
      validators: {
        itemType: 'paymentOfferInfo',
        offerTypes: ['EQUAL_PAY', 'ONE_TIME_PAYMENT'],
        cartTypes: ['ADD_TO_CART'],
        cardTypes: ['PLCC'],
      },
      parameters: {
        itemType: 'paymentOfferInfo',
        selectionType: { ADD: 'add', DELETE: 'delete' },
        offerTypes: { equalPay: 'EQUAL_PAY', oneTimePayment: 'ONE_TIME_PAYMENT' },
        cartTypes: { addToCart: 'ADD_TO_CART', buyNow: 'BUY_NOW' },
        cardTypes: { plcc: 'PLCC' },
      },
      paymentOfferInputElement: { inputType: 'hidden', name: 'paymentOfferInfo' },
      imagesToLoad:
        '.payment-options-financing-option-card-image .payment-options-expander-heading-image-container .payment-options-side-sheet-header .payment-options-side-sheet-option-summary .payment-options-side-sheet-comparison-group-container .payment-options-comparison-sheet-comparison-card-option'.split(
          ' ',
        ),
      ajaxStatusText: { timeout: 'Request Timeout' },
      selector: {
        expanderContainer: '.payment-options-container',
        skeletonLoader: '.payment-option-skeleton-loader',
        twisterPlusFadeIn: 'twister-plus-cc-card-fadeIn',
        paymentOptionExpand: 'payment-options-expander-content-expand',
        skeletonLoaderExpand: 'payment-option-skeleton-loader-expand',
        checkmark: '.payment-options-selected-checkmark',
        subtitle: '.payment-options-subtitle',
        subtitleText: '.payment-options-subtitle-text',
        cardImage: '.payment-options-selected-card-image',
        expanderIcon: '.payment-options-expander-icon',
        toggleButton: '#payment-options-toggle-button',
        expanderContent: '.payment-options-expander-content',
        swatch: '.payment-options-swatch',
        oneTimePaymentOption: '.payment-options-default-option',
        financingOptions: '.payment-options-financing-option',
        financingOptionTitle: '.payment-options-financing-option-title',
        swatchOption: '.payment-options-option',
        swatchHeading: '.payment-options-option-heading',
        selectedHeading: 'payment-options-selected-heading',
        selectedOption: 'payment-options-selected-option',
        unavailableOption: 'payment-options-unavailable-option',
        unselectedHeading: 'payment-options-unselected-heading',
        swatchDetail: '.payment-options-option-detail',
        refreshCCText: '#payment_options_refresh_cc_text',
        refreshToggle: '#payment_options_refresh_cc_text_container',
        multiCardExperimentData: 'wireless-multi-card',
        multiCardExperimentElement: '[data-wireless-multi-card]',
        activeTPlusCards: '#twister-plus-active-cards',
        sideSheetButton: '.payment-option-side-sheet-comparison-button',
        selectedButton: 'payment-option-side-sheet-comparison-button-selected',
        unselectedButton: 'payment-option-side-sheet-comparison-button-unselected',
        disabledSwatch: 'payment-option-disabled',
        monthlyPaymentAction: 'payment-options-monthly-payment-action',
        paymentOptionsWeblabs: '#payment-options-weblabs',
        paymentOptionsWeblabsAttribute: 'data-enabled-weblabs',
        paymentOptionsDefaultPickupBuyingOptionData: '#payment-options-default-buyingOption-pickup',
        isBuyingOptionOverridePresentAttribute: 'data-is-pickup-buying-option-override-present',
        pickUpBuyingOptionIndex: 'data-pickup-buying-option-index',
        payPlanColumnSelector: '.payment-plan-column-selector',
        paymentDetailColumnSelector: '.payment-details-column-selector',
        interestColumnSelector: '.interest-column-selector',
        payPlanAplliesSelector: '.pay-plan-applies-to-column-selector',
        cardRewardColumnSelector: '.card-reward-column-selector',
        oneTimePaymentHeadButton: '.payment-option-onetimepayment-button',
        paymentOptionApplicabilityMessageLayout: '.payment-option-applicibility-message-layout',
        paymentOptionApplicabilityMessage:
          '.payment-option-applicibility-message-layout .payment-option-applicibility-message',
      },
      comparePlansSelector: {
        comparePlansSidesheetSelector: '#compare-all-plans-sideSheet',
        comparePlansContentSelector: '#compare-all-plans-content',
        viewModelFailedSelector: '#payment-options-viewmodel-failed',
        preselectiedOptionSelector: '#payment-options-preselected',
        paymentOptionsCountSelector: '#compare-all-plans-options-count',
        firsOfferIdSelector: '#payment-options-first-offer-id',
        ajaxErrorMessageSelector: '.compare-plans-sidesheet-ajax-error',
        skeletonLoaderClass: '.compare-plans-sidesheet-skeleton-loader',
        comparePlansPaymentOptionSelector: '.payment-plan-',
        comparePlansPaymentOptionWithLearnMoreSelector: '.payment-plan-column-',
        comparePlansButtonIdSelector: '#monthlyPaymentOption',
        comparePlansColumnSelector: '.payment-option-table-column',
        comparePlansColumnWithLearnMoreSelector: '.payment-option-table-monthly-payments-column',
        comparePlansButtonSelector: '.payment-option-side-sheet-comparison-button',
      },
      learnMoreSelector: {
        learnMoreSidesheetSelector: '#payment-option-learn-more-sideSheet',
        learnMoreContentSelector: '#payment-options-learn-more-ajax',
        viewModelFailedSelector: '#payment-options-viewmodel-failed',
        preselectiedOptionSelector: '#payment-options-preselected',
        paymentOptionsCountSelector: '#payment-options-learn-more-options-count',
        firsOfferIdSelector: '#payment-options-first-offer-id',
        ajaxErrorMessageSelector: '.learn-more-sidesheet-ajax-error',
        skeletonLoaderClass: '.learn-more-sidesheet-skeleton-loader',
      },
      ajaxErrorReasons: { timeoutStatus: 'Request Timeout' },
      classes: {
        hideSwatchMainViewClass: 'payment-option-list-item-hidden',
        paymentOptionsList: '.payment-options-list',
        unavailableCompareAllPlansOption: 'payment-options-comparison-sheet-unavailable-option',
        disabledComparisonPlanButton: 'payment-option-comparison-sheet-disabled',
        auiDisabledButtonClass: 'a-button-disabled',
        auiEnabledButtonClass: 'a-button-normal',
        popOverHideClass: 'popover-hide',
        popOverShowClass: 'popover-show',
        colLeftRightBorder: 'Payment-option-side-sheet-left-right-column-border',
        colTopBorder: 'Payment-option-side-sheet-top-border',
        colBottomBorder: 'Payment-option-side-sheet-bottom-border',
        cardRewardHideClass: 'payment-options-card-reward-hide',
        normalLeftBorder: 'payment-option-column-normal-left-border',
        normalRightBorder: 'payment-option-column-normal-right-border',
        selectedPaymentOptionBorder: 'payment-option-selected-column-border',
        normalPaymentOptionBorder: 'payment-option-column-normal-border',
        selectedButtonClass: 'payment-option-side-sheet-comparison-button-selected',
        unselectedButtonClass: 'payment-option-side-sheet-comparison-button-unselected',
        disabledPaymentOptionOrder: 'payment-option-disabled-column-order',
        disabledPaymentOptionClass: 'payment-option-disabled-column',
      },
      animationTimeoutUnit: 200,
      metricPrefix: 'DPX:TwisterPlusCCCard:PaymentOptions:',
      metricPrefixPriceblock: 'DPX:PriceBlockMessaging:PaymentOptions:',
      metricPrefixUFO: 'DPX:UnifiedFinancingOffers:PaymentOptions:',
      classSelector: '.',
      disabledPaymentOptionSelecter: 'titleSupplement',
      popOverText: 'popover',
    }
  })
  ;('use strict')
  q.when(
    'A',
    'cc-manager',
    'payment-options-constants',
    'payment-options-expander-state',
    'payment-options-expander-actions',
    'payment-options-client-side-metric',
    'multi-card-exp-payment-options',
    'payment-plan-state',
  ).register('payment-options-registration', function (b, d, e, f, k, m, l, g) {
    function h(a) {
      return 'string' === typeof a
    }
    function c(a) {
      for (var c = a.length - 1; 0 <= c; c--) {
        var b = a.get(c).id
        if (
          b !== u &&
          !t('#' + b)
            .parent()
            .parent()
            .parent()
            .hasClass(e.classes.hideSwatchMainViewClass)
        ) {
          t('#' + b)
            .parent()
            .parent()
            .parent()
            .addClass(e.classes.hideSwatchMainViewClass)
          break
        }
      }
    }
    function a() {
      var a
      var c =
        (a = t(e.selector.paymentOptionsDefaultPickupBuyingOptionData)) &&
        'true' === a.attr(e.selector.isBuyingOptionOverridePresentAttribute)
      a = a && c ? ((a = a.attr(e.selector.pickUpBuyingOptionIndex)) ? a : u) : void 0
      return (
        '#paymentOption_' +
        (a ? a : b.$('#buyBoxAccordion .a-accordion-active').attr('data-buying-option-index') || 0)
      )
    }
    function n(a) {
      var c = a.executionInfo
      c.cartType = e.parameters.cartTypes.addToCart
      return {
        itemType: e.parameters.itemType,
        price: a.price,
        selectionType: e.parameters.selectionType.ADD,
        enableIA: !1,
        priceAndTermCountDisplayString: a.priceAndTermCountDisplayString,
        interestDisplayString: a.interestDisplayString,
        interestAmount: a.interestAmount,
        orderSummaryDisplayString: a.orderSummaryDisplayString,
        invalidSelectionTitle: a.cardName,
        isOrderLevel: a.isOrderLevel,
        bottomSheetFootnoteDisplayString: a.bottomSheetFootnoteDisplayString,
        termCount: a.termCount,
        termType: a.termType,
        formData: [
          {
            inputType: e.paymentOfferInputElement.inputType,
            inputName: e.paymentOfferInputElement.name,
            inputValue: c,
          },
        ],
      }
    }
    var t = b.$
    l = l.expTreatment
    var p = 'T2' !== l && 'T3' !== l,
      v = e.featureRegistration.featureName
    d.registerFeature(e.featureRegistration, {
      init: function (c) {
        b.$(a()).removeClass('a-hidden')
      },
      validateInputParams: function (a) {
        return a &&
          a.formData &&
          1 === a.formData.length &&
          a.itemType === e.validators.itemType &&
          h(a.priceAndTermCountDisplayString) &&
          h(a.orderSummaryDisplayString) &&
          h(a.interestDisplayString) &&
          'number' === typeof a.price &&
          'number' === typeof a.interestAmount &&
          h(a.bottomSheetFootnoteDisplayString)
          ? !0
          : !1
      },
      cardCollapse: function () {
        var a = g.paymentOptionSelected.paymentOptionClickedFromSideSheet
        p &&
          !a &&
          (m.increment('Expander:Auto:Collapse'),
          (a = b
            .$('[data-toggle-payment-options-expander]')
            .data('toggle-payment-options-expander').renderPreselection),
          k.collapsePaymentOptions(a),
          (b
            .$('[data-toggle-payment-options-expander]')
            .data('toggle-payment-options-expander').isExpand = !1))
      },
      refreshCard: function () {
        b.$(e.selector.refreshToggle).removeClass('refresh-toggle')
        b.$('[data-toggle-payment-options-expander]').data('toggle-payment-options-expander')
          .isExpand && b.$(e.selector.refreshCCText).removeClass('a-hidden')
      },
      switchBuyingOption: function (a, m, l, g, p, h) {
        g = h && -1 !== h ? h : a
        b.$('[id^\x3dpaymentOption_]').addClass('a-hidden')
        a = b
          .$('.payment-options-selected-option')
          .closest("[data-action\x3d'payment-options-monthly-payment-action']")
          .data('payment-options-monthly-payment-action')
        var q
        b.$('[data-toggle-payment-options-expander]').data('toggle-payment-options-expander') !==
          u &&
          ((m = b
            .$('[data-toggle-payment-options-expander]')
            .data('toggle-payment-options-expander').renderPreselection),
          a === u &&
            !0 === m &&
            (q = b.$('[data-payment-options-emp-action]').data('payment-options-emp-action')))
        var r
        a && (r = a.offerGroup)
        b.$('#paymentOption_' + g).removeClass('a-hidden')
        var w = t('#paymentOption_' + g)
          .find('[data-toggle-payment-options-expander]')
          .data('toggle-payment-options-expander')
        m = t('#paymentOption_' + g + ' #oneTimePaymentOptionSwatch')
        b.$(m).click()
        b.delay(function () {
          w.isExpand || t(e.selector.subtitleText).text(w.collapseSubtitle)
        }, 100)
        l = m = !1
        d.ccRemovedSelectionsClear(v)
        a === u &&
          q !== u &&
          ((p = b
            .$('#paymentOption_' + g + ' [data-payment-options-emp-action]')
            .data('payment-options-emp-action')),
          (m = p !== u),
          !0 === m &&
            (t(e.selector.subtitleText).text(p.preselectionSubtitle),
            (f.expanderSubtitle.monthlyPaymentOptionsCollapsedSubtitle = p.preselectionSubtitle),
            (f.expanderSubtitle.monthlyPaymentOptionsExpandedSubtitle = p.preselectionSubtitle)),
          !1 === m && d.ccRemovedSelectionUpdate(v, n(q)))
        if (r) {
          q = t('#paymentOption_' + g + ' .payment-options-financing-option')
          g = q.length
          m = 0 < g
          for (p = 0; p < g; p++) {
            h = q.get(p)
            var x = b
                .$(h)
                .closest("[data-action\x3d'payment-options-monthly-payment-action']")
                .data('payment-options-monthly-payment-action'),
              y = t('#' + h.id)
                .parent()
                .parent()
                .parent(),
              z = y.hasClass(e.classes.hideSwatchMainViewClass)
            if (x && r === x.offerGroup) {
              l = !0
              z && (c(q), y.removeClass(e.classes.hideSwatchMainViewClass))
              b.$(h).click()
              var A = b
                .$('[data-toggle-payment-options-expander]')
                .data('toggle-payment-options-expander').renderPreselection
            }
          }
          ;(!m || (m && !l)) && d.ccRemovedSelectionUpdate(v, n(a))
          k.collapsePaymentOptions(A)
        }
      },
    })
  })
  ;('use strict')
  q.when('A', 'cc-manager', 'payment-options-constants', 'payment-options-registration').register(
    'cc-payment-options',
    function (b, d, e) {
      function f(c) {
        var a = l('form#buyNowCheckout')
        if (0 < a.length) {
          var b = a.find('input[name\x3d' + e.parameters.itemType + ']')
          c = c.executionInfo
          c.cartType = e.parameters.cartTypes.buyNow
          c = JSON.stringify(c)
          1 > b.length
            ? l('\x3cinput\x3e')
                .attr({
                  type: e.paymentOfferInputElement.inputType,
                  name: e.paymentOfferInputElement.name,
                  value: c,
                  id: 'bnMshopPaymentOfferInfo',
                })
                .appendTo(a)
            : ((a = l('#bnMshopPaymentOfferInfo')), 1 < b.length ? a.detach() : a.val(c))
        }
      }
      function k(c) {
        var a = c.executionInfo
        a.sessionId = c.sessionId
        a.customerId = c.customerId
        a.marketplaceId = c.marketplaceId
        a.requestId = c.requestId
        a.deviceType = c.deviceType
        a.asin = c.asin
        a.buyingOptionType = c.buyingOptionType
        a.parentASIN = c.parentASIN
        a.websiteDisplayGroup = c.websiteDisplayGroup
      }
      function m(c, a) {
        return {
          itemType: e.parameters.itemType,
          price: c.price,
          selectionType: e.parameters.selectionType.ADD,
          enableIA: !1,
          priceAndTermCountDisplayString: c.priceAndTermCountDisplayString,
          interestDisplayString: c.interestDisplayString,
          interestAmount: c.interestAmount,
          orderSummaryDisplayString: c.orderSummaryDisplayString,
          isOrderLevel: c.isOrderLevel,
          bottomSheetFootnoteDisplayString: c.bottomSheetFootnoteDisplayString,
          termCount: c.termCount,
          termType: 'mo',
          formData: a,
        }
      }
      var l = b.$,
        g = e.featureRegistration.featureName,
        h
      return {
        updatePaymentOptionSelection: function (c) {
          if (!c) return !1
          d.ccSelectionsClear(g)
          clearTimeout(h)
          l('#bnMshopPaymentOfferInfo').detach()
          var a = [],
            b
          if (
            c.hasOwnProperty('executionDetails') &&
            0 !== Object.keys(c.executionDetails).length
          ) {
            var t = c.executionDetails
            Object.keys(t).forEach(function (b) {
              if ('paymentOfferInfoType' === b) {
                var d = JSON.parse(c.executionDetails.paymentOfferInfoType)
                d.sessionId = c.sessionId
                d.customerId = c.customerId
                d.marketplaceId = c.marketplaceId
                d.requestId = c.requestId
                d.deviceType = c.deviceType
                d.asin = c.asin
                d.buyingOptionType = c.buyingOptionType
                d.parentASIN = c.parentASIN
                d.websiteDisplayGroup = c.websiteDisplayGroup
                c.executionDetails.paymentOfferInfoType = JSON.stringify(d)
                a.push([
                  {
                    inputType: e.paymentOfferInputElement.inputType,
                    inputName: e.paymentOfferInputElement.name,
                    inputValue: JSON.parse(t[b]),
                  },
                ])
              } else
                a.push([
                  {
                    inputType: e.paymentOfferInputElement.inputType,
                    inputName: b,
                    inputValue: t[b],
                  },
                ])
            })
            for (var p = 0; p < a.length; p++)
              if (((b = m(c, a[p])), (b = d.ccSelectionUpdate(g, b)), !b)) return !1
          } else if (c.hasOwnProperty('executionInfo') && 0 !== Object.keys(c.executionInfo).length)
            k(c),
              a.push([
                {
                  inputType: e.paymentOfferInputElement.inputType,
                  inputName: e.paymentOfferInputElement.name,
                  inputValue: c.executionInfo,
                },
              ]),
              (b = m(c, a[0])),
              (b = d.ccSelectionUpdate(g, b))
          else return !0
          f(c)
          h = setTimeout(function () {
            f(c)
          }, 1e3)
          return b
        },
      }
    },
  )
  ;('use strict')
  q.when('A', 'cc-payment-options').register('payment-options-actions', function (b, d) {
    b.declarative('select-payment-option', 'click', function (b) {
      d.updatePaymentOptionSelection(b.data)
    })
  })
  ;('use strict')
  q.when(
    'A',
    'po-sidesheet-ajax-state',
    'payment-plan-state',
    'payment-options-constants',
    'payment-options-state',
    'payment-options-client-side-metric',
  ).register('po-compare-plans-actions', function (b, d, e, f, k, m) {
    function l() {
      d.resetComparePlansState()
      n(f.comparePlansSelector.skeletonLoaderClass).addClass('aok-hidden')
      n(f.comparePlansSelector.ajaxErrorMessageSelector).removeClass('aok-hidden')
    }
    function g(a, b) {
      a = n(a)
      var d = f.comparePlansSelector.viewModelFailedSelector,
        e = f.comparePlansSelector.preselectiedOptionSelector,
        k = f.comparePlansSelector.paymentOptionsCountSelector,
        g = f.comparePlansSelector.firsOfferIdSelector,
        l = c(),
        e = e + '-' + l,
        k = k + '-' + l,
        g = g + '-' + l
      return 0 !== a.filter(d + '-' + l).length
        ? (m.incrementWithValue('Ajax:Inconsistency:ViewModelFailed', 1), !0)
        : 0 !== a.filter(e).length
          ? (m.incrementWithValue('Ajax:Inconsistency:PreselectionPresent', 1), !0)
          : a.filter(k).data('paymentPlansCount') !== b.numberOfPaymentOptions
            ? (m.incrementWithValue('Ajax:Inconsistency:OffersCountNotSame', 1), !0)
            : a.filter(g).data('firstOfferId') !== b.firstOfferId
              ? (m.incrementWithValue('Ajax:Inconsistency:OfferIdNotSame', 1), !0)
              : !1
    }
    function h(e) {
      n(f.comparePlansSelector.comparePlansSidesheetSelector).html(
        d.getComparePlansState('ajaxContent'),
      )
      var k = f.comparePlansSelector.comparePlansContentSelector + '-' + c()
      n(k).removeClass('aok-hidden')
      b.loadDescendantImagesManually(n('.payment-options-side-sheet-header'))
      b.loadDescendantImagesManually(n('.payment-options-side-sheet-option-summary'))
      b.loadDescendantImagesManually(n('.payment-options-side-sheet-comparison-group-container'))
      b.loadDescendantImagesManually(n('.payment-options-comparison-sheet-comparison-card-option'))
      a(e)
    }
    function c() {
      return b.$('#buyBoxAccordion .a-accordion-active').attr('data-buying-option-index') || 0
    }
    function a(a) {
      var b = e.paymentOptionSelected.paymentOptionSelectedButtonId,
        c = e.paymentOptionSelected.paymentOptionDisabledButtonId,
        d = a.data.selectText
      n(t.oneTimePaymentHeadButton).removeClass(t.selectedButton)
      n(t.oneTimePaymentHeadButton).addClass(t.unselectedButton)
      n(t.oneTimePaymentHeadButton).text(d)
      n(f.comparePlansSelector.comparePlansColumnSelector).removeClass(
        f.classes.selectedPaymentOptionBorder,
      )
      n(f.comparePlansSelector.comparePlansColumnSelector).addClass(
        f.classes.normalPaymentOptionBorder,
      )
      n(f.comparePlansSelector.comparePlansColumnSelector).removeClass(
        f.classes.disabledPaymentOptionClass,
      )
      n(f.comparePlansSelector.comparePlansColumnWithLearnMoreSelector).removeClass(
        f.classes.disabledPaymentOptionOrder,
      )
      n(f.comparePlansSelector.comparePlansButtonSelector).removeClass(
        f.classes.selectedButtonClass,
      )
      n(f.comparePlansSelector.comparePlansButtonSelector).removeClass(
        f.classes.auiDisabledButtonClass,
      )
      n(f.comparePlansSelector.comparePlansButtonSelector).addClass(f.classes.unselectedButtonClass)
      n(f.comparePlansSelector.comparePlansButtonSelector).text(d)
      a = a.data.selectedText
      '' !== b &&
        ('oneTimePaymentOption' === b
          ? (n(t.oneTimePaymentHeadButton).addClass(t.selectedButton),
            n(t.oneTimePaymentHeadButton).removeClass(t.unselectedButton),
            n(t.oneTimePaymentHeadButton).text(a))
          : ((d = f.comparePlansSelector.comparePlansPaymentOptionSelector + b.match(/\d+/g)[0]),
            n(d).addClass(f.classes.selectedPaymentOptionBorder),
            n(d).removeClass(f.classes.normalPaymentOptionBorder),
            n('#' + b).addClass(f.classes.selectedButtonClass),
            n('#' + b).removeClass(f.classes.unselectedButtonClass),
            n('#' + b).text(a)))
      c &&
        '' !== c &&
        ((b = c.match(/\d+/g)[0]),
        n('#' + f.disabledPaymentOptionSelecter + b).text(
          '(' + e.paymentOptionSelected.paymentOptionUnAvailableMsg + ')',
        ),
        (c = f.comparePlansSelector.comparePlansPaymentOptionSelector + b),
        (a = f.comparePlansSelector.comparePlansPaymentOptionWithLearnMoreSelector + b),
        n(f.comparePlansSelector.comparePlansButtonIdSelector + b).addClass(
          f.classes.auiDisabledButtonClass,
        ),
        n(a).addClass(f.classes.disabledPaymentOptionOrder),
        n(c).addClass(f.classes.disabledPaymentOptionClass),
        n('[id\x3d' + f.popOverText + b + 'cell]').addClass(f.classes.popOverShowClass),
        n('[id\x3d' + f.popOverText + b + 'cell]').removeClass(f.classes.popOverHideClass))
    }
    var n = b.$,
      t = f.selector
    b.on('PageRefresh:ATF', function () {
      d.resetComparePlansState()
    })
    return {
      loadAjaxContent: function (a) {
        var c = n('#twister-plus-asin').val()
        if (null === c || '' === c) m.incrementWithValue('Ajax:Inconsistency:AsinEmpty', 1), l()
        else if (d.getComparePlansState('isAjaxContentLoaded') && !d.checkInconsistentState()) h(a)
        else {
          var e = new m.Timer('Ajax:Loading:Time')
          e.start()
          n(f.comparePlansSelector.skeletonLoaderClass).removeClass('aok-hidden')
          n(f.comparePlansSelector.ajaxErrorMessageSelector).addClass('aok-hidden')
          b.ajax('/gp/product/ajax?', {
            method: 'get',
            timeout: 1e4,
            params: {
              asin: c,
              showFeatures: 'compareAllPlansSidesheetAjax,paymentOptions',
              experienceId: 'paymentOptionsAjaxExperience',
            },
            success: function (b) {
              null === b || /^\s*$/.test(b)
                ? (m.incrementWithValue('Ajax:Inconsistency:EmptyResponse', 1), l())
                : g(b, a.data)
                  ? l()
                  : (d.setComparePlansState('ajaxContent', b),
                    d.setComparePlansState('isAjaxContentLoaded', !0),
                    d.setComparePlansState('ajaxContentAsin', c),
                    h(a),
                    e.stop())
            },
            error: function (a, b) {
              b === f.ajaxErrorReasons.timeoutStatus
                ? m.incrementWithValue('Ajax:Failure:Timeout', 1)
                : m.incrementWithValue('Ajax:Failure', 1)
              l()
            },
          })
        }
      },
      renderPreselection: a,
    }
  })
  ;('use strict')
  q.when('A').register('po-sidesheet-ajax-state', function (b) {
    var d = b.$,
      e = { ajaxContent: '', isAjaxContentLoaded: !1, ajaxContentAsin: '' },
      f = { ajaxContent: '', isAjaxContentLoaded: !1, ajaxContentAsin: '' }
    return {
      getComparePlansState: function (b) {
        return e[b]
      },
      setComparePlansState: function (b, d) {
        e[b] = d
      },
      getLearnMoreState: function (b) {
        return f[b]
      },
      setLearnMoreState: function (b, d) {
        f[b] = d
      },
      checkInconsistentState: function () {
        if (e.isAjaxContentLoaded && f.isAjaxContentLoaded) {
          if (e.ajaxContentAsin !== f.ajaxContentAsin)
            return this.resetComparePlansState(), this.resetLearnMoreState(), !0
          var b = d('#twister-plus-asin').val()
          if (e.ajaxContentAsin !== b)
            return this.resetComparePlansState(), this.resetLearnMoreState(), !0
        }
        return !1
      },
      resetComparePlansState: function () {
        this.setComparePlansState('ajaxContent', '')
        this.setComparePlansState('isAjaxContentLoaded', !1)
        this.setComparePlansState('ajaxContentAsin', '')
      },
      resetLearnMoreState: function () {
        this.setLearnMoreState('ajaxContent', '')
        this.setLearnMoreState('isAjaxContentLoaded', !1)
        this.setLearnMoreState('ajaxContentAsin', '')
      },
    }
  })
  ;('use strict')
  q.when('A', 'payment-options-state', 'po-compare-plans-actions').register(
    'ufo-compare-payment-plans',
    function (b, d, e) {
      var f = b.$
      b.declarative('compare-payment-plans', 'click', function (f) {
        b.trigger('a:declarative:side-sheet:click', f)
        d.getWeblabData().isDesktopComparePlansAjaxEnabled
          ? b.trigger('a:declarative:compare-payment-plans-ajax:click', f)
          : e.renderPreselection(f)
      })
      b.declarative('price-block-compare-payment-plans', 'click', function (f) {
        b.trigger('a:declarative:open-payment-options-side-sheet:click', f)
        d.getWeblabData().isDesktopComparePlansAjaxEnabled
          ? b.trigger('a:declarative:compare-payment-plans-ajax:click', f)
          : e.renderPreselection(f)
      })
      b.declarative('compare-payment-plans-ajax', 'click', function (b) {
        e.loadAjaxContent(b)
      })
      b.declarative('overflow-sidesheet', 'click', function (d) {
        var e = f(d.$currentTarget)
        e !== u &&
          null !== e &&
          (f('#' + d.data.paymentOptionSelectButtonId)[0].classList.contains('a-button-disabled') ||
            b.trigger('a:declarative:monthly-payment-option-selection:click', d))
      })
    },
  )
  ;('use strict')
  q.when(
    'A',
    'po-sidesheet-ajax-state',
    'payment-options-constants',
    'payment-options-state',
    'payment-options-client-side-metric',
    'payment-plan-state',
  ).register('po-learn-more-actions', function (b, d, e, f, k, m) {
    function l() {
      d.resetLearnMoreState()
      p(e.learnMoreSelector.skeletonLoaderClass).addClass('aok-hidden')
      p(e.learnMoreSelector.ajaxErrorMessageSelector).removeClass('aok-hidden')
    }
    function g(a, b) {
      a = p(a)
      var d = c(),
        f = e.learnMoreSelector.preselectiedOptionSelector + '-' + d,
        m = e.learnMoreSelector.paymentOptionsCountSelector + '-' + d,
        g = e.learnMoreSelector.firsOfferIdSelector + '-' + d
      return 0 !== a.filter(e.learnMoreSelector.viewModelFailedSelector + '-' + d).length
        ? (k.incrementWithValue('Ajax:Inconsistency:ViewModelFailed', 1), !0)
        : 0 !== a.filter(f).length
          ? (k.incrementWithValue('Ajax:Inconsistency:PreselectionPresent', 1), !0)
          : a.filter(m).data('paymentPlansCount') !== b.numberOfPaymentOptions
            ? (k.incrementWithValue('Ajax:Inconsistency:OffersCountNotSame', 1), !0)
            : a.filter(g).data('firstOfferId') !== b.firstOfferId
              ? (k.incrementWithValue('Ajax:Inconsistency:OfferIdNotSame', 1), !0)
              : !1
    }
    function h(f, m, g) {
      p(e.learnMoreSelector.learnMoreSidesheetSelector).html(d.getLearnMoreState('ajaxContent'))
      g = e.learnMoreSelector.learnMoreContentSelector + '-' + g
      g += c()
      p(g).removeClass('aok-hidden')
      b.loadDescendantImagesManually(p('.payment-options-side-sheet-header'))
      b.loadDescendantImagesManually(p('.payment-options-side-sheet-option-summary'))
      b.loadDescendantImagesManually(p('.payment-options-side-sheet-comparison-group-container'))
      b.loadDescendantImagesManually(p('.payment-options-comparison-sheet-comparison-card-option'))
      a(f, m)
    }
    function c() {
      return b.$('#buyBoxAccordion .a-accordion-active').attr('data-buying-option-index') || 0
    }
    function a(a, b) {
      n(m.paymentOptionSelected.paymentOptionSelectedButtonId, a, b)
    }
    function n(a, b, c) {
      t(b)
      p(function () {
        p('[id\x3d' + a + ']').removeClass(v.unselectedButton)
        p('[id\x3d' + a + ']').addClass(v.selectedButton)
        p('[id\x3d' + a + ']')
          .children(0)
          .children(0)
          .text(c)
        p('[id\x3d' + a + ']').text(c)
      })
    }
    function t(a) {
      p(v.sideSheetButton).removeClass(v.selectedButton)
      p(v.sideSheetButton).addClass(v.unselectedButton)
      p(v.sideSheetButton).text(a)
      p(v.oneTimePaymentHeadButton).removeClass(v.selectedButton)
      p(v.oneTimePaymentHeadButton).addClass(v.unselectedButton)
      p(v.oneTimePaymentHeadButton).text(a)
    }
    var p = b.$,
      v = e.selector
    b.on('PageRefresh:ATF', function () {
      d.resetLearnMoreState()
    })
    return {
      loadAjaxContent: function (a) {
        var c = a.data.selectText,
          f = a.data.selectedText,
          m = p('#twister-plus-asin').val()
        null === m || '' === m
          ? (k.incrementWithValue('Ajax:Inconsistency:AsinEmpty', 1), l())
          : d.getLearnMoreState('isAjaxContentLoaded') && !d.checkInconsistentState()
            ? h(c, f, a.data.index)
            : (p(e.learnMoreSelector.skeletonLoaderClass).removeClass('aok-hidden'),
              p(e.learnMoreSelector.ajaxErrorMessageSelector).addClass('aok-hidden'),
              b.ajax('/gp/product/ajax?', {
                method: 'get',
                timeout: 1e4,
                params: {
                  asin: m,
                  showFeatures: 'paymentOptionsLearnMoreSidesheetAjax,paymentOptions',
                  experienceId: 'paymentOptionsAjaxExperience',
                },
                success: function (b) {
                  null === b || /^\s*$/.test(b)
                    ? (k.incrementWithValue('Ajax:Inconsistency:EmptyResponse', 1), l())
                    : g(b, a.data)
                      ? l()
                      : (d.setLearnMoreState('ajaxContent', b),
                        d.setLearnMoreState('isAjaxContentLoaded', !0),
                        d.setLearnMoreState('ajaxContentAsin', m),
                        h(c, f, a.data.index))
                },
                error: function (a, b) {
                  b === e.ajaxErrorReasons.timeoutStatus
                    ? k.incrementWithValue('Ajax:Failure:Timeout', 1)
                    : k.incrementWithValue('Ajax:Failure', 1)
                  l()
                },
              }))
      },
      stopEventPropagation: function (a) {
        a.$event.preventDefault()
        a.$event.stopImmediatePropagation()
      },
      preRenderSelectedFinancingOption: a,
    }
  })
  ;('use strict')
  q.when(
    'A',
    'payment-options-state',
    'po-learn-more-actions',
    'payment-options-client-side-metric',
  ).register('payment-options-learn-more-events', function (b, d, e, f) {
    b.declarative('payment-options-learn-more', 'click', function (k) {
      f.increment('SideSheet:Link:Click')
      e.stopEventPropagation(k)
      b.trigger('a:declarative:side-sheet:click', k)
      !k.data.isComparePlansEvent && d.getWeblabData().isDesktopLearnMoreAjaxEnabled
        ? b.trigger('a:declarative:payment-options-learn-more-ajax:click', k)
        : e.preRenderSelectedFinancingOption(k.data.selectText, k.data.selectedText)
    })
    b.declarative('payment-options-learn-more-ajax', 'click', function (b) {
      e.loadAjaxContent(b)
    })
  })
  ;('use strict')
  q.when(
    'A',
    'payment-options-expander-actions',
    'payment-options-expander-state',
    'payment-options-client-side-metric',
    'multi-card-exp-payment-options',
  ).execute(function (b, d, e, f, k) {
    function m(b) {
      if (a === u || null === a || null === b.data.isExpand || b.data.isExpand === u) {
        if (null === b.data.isExpand || b.data.isExpand === u)
          (g('[data-toggle-payment-options-expander]').data(
            'toggle-payment-options-expander',
          ).isExpand = !1),
            (b.data.isExpand = !1)
        d.initSubtitle(b)
        n && d.hideLoaderAnimation(b.data.isExpand)
      }
    }
    function l(b) {
      a = !0
      var c = b.data.renderPreselection
      e.autoScroll = !b.data.isAutoExpand
      c || n ? d.expandPaymentOptions(n, c) : (t.isStarted || t.start(), d.expandSkeletonLoader(c))
      f.logNexusEventForSwatchExpansion(b)
    }
    var g = b.$,
      h = k.expTreatment,
      c = (k.isFirstCard && 'T1' === h) || 'T2' === h || 'T3' === h,
      a,
      n = e.isLoaded,
      t = new f.Timer('Desktop:Expander:Loading:UserWaiting:Time'),
      p = new f.Timer('Desktop:Expander:Loading:Time')
    p.start()
    q.when('cc-payment-options').execute(function () {
      p.stop()
      t.isStarted && t.stop()
      n = !0
      d.hideLoaderAnimation(a)
      f.incrementWithValue('Container:Swatch:Amount', g('.payment-options-list-item').length)
    })
    b.declarative('toggle-payment-options-expander', 'click', function (c) {
      m(c)
      a = c.data.isExpand
      var e = c.data.renderPreselection
      !0 === a
        ? ((a = !1), f.increment('Desktop:Expander:Click:Collapse'), d.collapsePaymentOptions(e))
        : !1 === a && l(c)
      g('[data-toggle-payment-options-expander]').each(function () {
        g(this).data('toggle-payment-options-expander').isExpand = a
      })
      b.trigger('a:declarative:expander-update-visible-payment-options:click', c)
    })
    b.declarative('expand-payment-options-expander', function (a) {
      if (!h || a.data.forceExpand)
        m(a),
          l(a),
          g('[data-toggle-payment-options-expander]').each(function () {
            g(this).data('toggle-payment-options-expander').isExpand = !0
          })
    })
    c && k.autoExpandCard()
  })
  ;('use strict')
  q.when(
    'A',
    'payment-options-expander-state',
    'payment-options-constants',
    'payment-options-client-side-metric',
    'payment-options-swatch-actions',
    'cc-manager',
  ).register('payment-options-expander-actions', function (b, d, e, f, k, m) {
    function l() {
      if (d.autoScroll) {
        var b = c(a.expanderContainer),
          e = b.offset().top + b.outerHeight()
        if (c(r).scrollTop() + c(r).height() < e) {
          var e = b.offset().top,
            f = c(r).height(),
            b = b.height(),
            b = e - (f - b) / 2
          c('html, body').animate({ scrollTop: b }, d.animationTimeoutUnit)
        }
      }
    }
    function g(b, d) {
      b = b
        ? n.monthlyPaymentOptionsExpandedSubtitle
        : d
          ? n.monthlyPaymentOptionsExpandedSubtitle
          : n.loadingSubtitle
      c(a.subtitleText).text(b)
      !1 === d && c(a.cardImage).fadeOut(e.animationTimeoutUnit)
    }
    function h(b) {
      '' !== n.monthlyPaymentOptionsCollapsedSubtitle &&
        c(a.subtitleText).text(n.monthlyPaymentOptionsCollapsedSubtitle)
      !1 === b && c(a.cardImage).fadeIn(e.animationTimeoutUnit)
    }
    var c = b.$,
      a = e.selector,
      n = d.expanderSubtitle
    return {
      initSubtitle: function (a) {
        var b = a.data.expandSubtitle
        n.monthlyPaymentOptionsCollapsedSubtitle = a.data.collapseSubtitle
        n.monthlyPaymentOptionsExpandedSubtitle = b
      },
      expandPaymentOptions: function (d, n) {
        f.increment('Desktop:Expander:Click:Expand')
        f.increment('Desktop:Expander:Click:Expand:loading')
        c(a.expanderContent).addClass(a.paymentOptionExpand)
        c(a.expanderIcon).addClass('rotate')
        m.cardExpanded(e.featureRegistration.featureName)
        b.delay(function () {
          c(a.swatch).addClass(a.twisterPlusFadeIn)
          g(d, n)
          l()
        }, e.animationTimeoutUnit)
        b.$(a.refreshToggle).hasClass('refresh-toggle') ||
          b.$(a.refreshCCText).removeClass('a-hidden')
      },
      expandSkeletonLoader: function (d) {
        f.increment('Desktop:Expander:Click:Expand')
        c(a.expanderContent).addClass(a.skeletonLoaderExpand)
        c(a.expanderIcon).addClass('rotate')
        b.delay(function () {
          d || (c(a.skeletonLoader).addClass(a.twisterPlusFadeIn), g(!1, d), l())
        }, e.animationTimeoutUnit)
      },
      hideLoaderAnimation: function (d, f) {
        d && c(a.skeletonLoader).removeClass(a.twisterPlusFadeIn)
        b.delay(function () {
          c(a.skeletonLoader).hide()
          c(a.swatch).removeClass('invisible')
          d &&
            (c(a.subtitleText).text(n.monthlyPaymentOptionsExpandedSubtitle),
            c(a.expanderContent).addClass(a.paymentOptionExpand),
            b.delay(function () {
              c(a.swatch).addClass(a.twisterPlusFadeIn)
              g(!0, f)
              l()
            }, e.animationTimeoutUnit))
        }, e.animationTimeoutUnit)
      },
      collapsePaymentOptions: function (f) {
        c(a.swatch).removeClass(a.twisterPlusFadeIn)
        d.isLoaded || f || c(a.skeletonLoader).removeClass(a.twisterPlusFadeIn)
        c(a.expanderIcon).removeClass('rotate')
        b.delay(function () {
          c(a.expanderContent).removeClass(a.paymentOptionExpand)
          c(a.expanderContent).removeClass(a.skeletonLoaderExpand)
          h(f)
        }, e.animationTimeoutUnit)
        b.$(a.refreshCCText).hasClass('a-hidden') || b.$(a.refreshCCText).addClass('a-hidden')
      },
      showSubtitleInCollapsedView: h,
      showSubtitleInExpandedView: g,
      scrollToShowCompleteExpander: l,
    }
  })
  ;('use strict')
  q.when(
    'A',
    'payment-options-state',
    'payment-options-client-side-metric',
    'cc-manager',
    'payment-options-constants',
    'payment-options-actions',
  ).register('payment-options-auto-expand', function (b, d, e, f, k) {
    var m = !1,
      l = function () {
        var g = document.getElementById('payment-options-expander-header'),
          l = d.getWeblabData().isAutoExpandWeblabInT1 || d.getWeblabData().isAutoExpandWeblabInT2
        if (g) {
          if ((g = l))
            (g = f.getRenderedFeaturesList()),
              (l = g[0] === k.featureRegistration.featureName),
              (g = 1 === g.length && l)
          g &&
            ((g = JSON.parse(
              b
                .$('[data-toggle-payment-options-expander]')
                .attr('data-toggle-payment-options-expander'),
            )),
            (g.isAutoExpand = !0),
            b.trigger('a:declarative:expand-payment-options-expander', { data: g }),
            e.increment('Expander:AutoExpanded'),
            (m = !0))
        }
      }
    l()
    b.on('a:pageUpdate', l)
    return { isAutoExpanded: m }
  })
  ;('use strict')
  q.when('A').register('payment-options-expander-state', function (b) {
    return {
      expanderSubtitle: {
        monthlyPaymentOptionsCollapsedSubtitle: '',
        monthlyPaymentOptionsExpandedSubtitle: '',
        loadingSubtitle: 'Loading options...',
      },
      get isLoaded() {
        return this.property
      },
      set isLoaded(b) {
        this.property = b
      },
    }
  })
  ;('use strict')
  q.when(
    'A',
    'payment-options-swatch-actions',
    'payment-options-client-side-metric',
    'multi-card-exp-payment-options',
  ).execute(function (b, d, e, f) {
    var k = b.$,
      m = !f.expTreatment || 'T3' === f.expTreatment
    b.declarative('payment-options-otp-action', 'click', function (l) {
      e.increment('Swatch:OneTimePayment:Click')
      b.trigger('a:declarative:select-payment-option:click', { data: {} })
      var g = k(l.$currentTarget)
      g !== u &&
        null !== g &&
        (d.updateDefaultOptionSubtitle(l.data.defaultPOSubtitle, l.data.oneTimePaymentPOSubtitle),
        b.trigger('a:declarative:otp-selection:click', l),
        m || f.collapseCard())
    })
    b.declarative('payment-options-monthly-payment-action', 'click', function (d) {
      var g = k(d.$currentTarget)
      g !== u &&
        null !== g &&
        (b.trigger('a:declarative:monthly-payment-option-selection:click', d),
        m || f.collapseCard(),
        e.logNexusEventForMonthlyPaymentSelection(d))
    })
    b.declarative('payment-options-overflow', 'click', function (b) {
      d.manageOverflow(b)
    })
    b.declarative('expander-update-visible-payment-options', 'click', function (b) {
      var e = k(b.$currentTarget)
      e !== u && null !== e && d.resetOverflowDefaultOptions(b)
    })
    b.declarative('update-swatch', 'click', function (b) {
      'oneTimePaymentOption' === b.data.selectedPaymentOptionId
        ? d.updateSwatchStyle(b.data.selectedPaymentOptionId)
        : (d.updateSwatchStyle(b.data.selectedPaymentOptionId),
          d.updateFinancingOptionSubtitle(b.data.subtitleMessage, b.data.cardImageUrl))
    })
    b.declarative('disable-swatch', 'click', function (b) {
      d.disableSwatch(b.$currentTarget)
    })
    b.declarative('enable-swatch', 'click', function (b) {
      d.enableSwatch(b.$currentTarget)
    })
  })
  ;('use strict')
  q.when(
    'A',
    'payment-options-expander-state',
    'payment-options-constants',
    'payment-plan-state',
  ).register('payment-options-swatch-actions', function (b, d, e, f) {
    function k(a) {
      g(h.swatchOption).removeClass(h.selectedOption)
      ;('oneTimePaymentOption' === a ? g(h.oneTimePaymentOption) : g('#' + a + 'Swatch')).addClass(
        h.selectedOption,
      )
    }
    function m(a) {
      a.addClass(c.hideSwatchMainViewClass)
    }
    function l(a, b) {
      a.removeClass(c.hideSwatchMainViewClass)
      k(b)
      f.paymentOptionSelected.paymentOptionSelectedButtonId = b
      f.paymentOptionSelected.paymentOptionClickedFromSideSheet = !0
    }
    var g = b.$,
      h = e.selector,
      c = e.classes,
      a = d.expanderSubtitle
    return {
      updateSwatchStyle: k,
      updateDefaultOptionSubtitle: function (b, c) {
        a.monthlyPaymentOptionsCollapsedSubtitle = b
        a.monthlyPaymentOptionsExpandedSubtitle = c
        g(h.subtitleText).text(c)
        g(h.subtitle).removeClass('a-color-success')
        g(h.subtitle).addClass('a-color-tertiary')
        g(h.checkmark).addClass('a-hidden')
        g(h.cardImage).attr(
          'src',
          'https://images-na.ssl-images-amazon.com/images/G/01/x-locale/common/transparent-pixel._V192234675_.gif',
        )
      },
      updateFinancingOptionSubtitle: function (b, c) {
        a.monthlyPaymentOptionsCollapsedSubtitle = b
        a.monthlyPaymentOptionsExpandedSubtitle = b
        g(h.subtitleText).text(b)
        g(h.subtitle).removeClass('a-color-tertiary')
        g(h.subtitle).addClass('a-color-success')
        g(h.checkmark).removeClass('a-hidden')
        g(h.cardImage).attr('src', c)
      },
      disableSwatch: function (a) {
        var b = a.find(h.financingOptions)
        b.removeClass(h.selectedOption)
        b.addClass(h.unavailableOption)
        a.addClass(h.disabledSwatch)
      },
      enableSwatch: function (a) {
        a.find(h.financingOptions).removeClass(h.unavailableOption)
        a.removeClass(h.disabledSwatch)
      },
      manageOverflow: function (a) {
        f.paymentOptionSelected.paymentOptionUnAvailableMsg = a.data.unAvailableMsg
        var b = g('#' + a.data.paymentOptionSelectButtonId + 'Swatch')
          .parent()
          .parent()
          .parent()
        if (b.hasClass(c.hideSwatchMainViewClass)) {
          for (var d = g(c.paymentOptionsList)[0].children, e = '', h = d.length - 2; 0 <= h; h--)
            if (!g(d[h]).hasClass(c.hideSwatchMainViewClass)) {
              e = g(d[h])
              break
            }
          m(e)
          l(b, a.data.paymentOptionSelectButtonId)
        } else
          k(a.data.paymentOptionSelectButtonId),
            (f.paymentOptionSelected.paymentOptionSelectedButtonId =
              a.data.paymentOptionSelectButtonId),
            (f.paymentOptionSelected.paymentOptionClickedFromSideSheet = !0)
      },
      hideLastSwatch: m,
      unhideCorrespondingSwatch: l,
      resetOverflowDefaultOptions: function (a) {
        if (!(3 >= parseInt(a.data.numberOfPaymentOptions))) {
          var b = g(c.paymentOptionsList)[0].children
          a = ''
          for (var d = b.length - 2; 0 <= d; d--)
            if (!g(b[d]).hasClass(c.hideSwatchMainViewClass)) {
              a = g(b[d])
              break
            }
          b = g(g(g(a.children()[0]).children()[0]).children()[0])[0]
          b.classList.contains(h.selectedOption) ||
            '3' === b.id.match(/\d+/g)[0] ||
            (m(a),
            g('#monthlyPaymentOption03Swatch')
              .parent()
              .parent()
              .parent()
              .removeClass(c.hideSwatchMainViewClass))
        }
      },
    }
  })
  ;('use strict')
  q.when('A').register('payment-plan-state', function (b) {
    return {
      paymentOptionSelected: {
        paymentOptionSelectedButtonId: 'oneTimePaymentOption',
        paymentOptionClickedFromSideSheet: !1,
        paymentOptionDisabledButtonId: '',
        paymentOptionDisabledTitleSuppliment: '',
        paymentOptionUnAvailableMsg: '',
      },
      get isSelected() {
        return this.property
      },
      set isSelected(b) {
        this.property = b
      },
    }
  })
  ;('use strict')
  q.when(
    'A',
    'payment-plan-state',
    'payment-options-constants',
    'payment-options-client-side-metric',
  ).execute(function (b, d, e, f) {
    var k = b.$
    b.declarative('otp-selection', 'click', function (e) {
      var l = k(e.$currentTarget[0].parentNode)
      e = e.data.paymentOptionSelectButtonId
      'payment-options-list-item' === l[0].parentNode.className
        ? (d.paymentOptionSelected.paymentOptionClickedFromSideSheet = !1)
        : (f.increment('SideSheet:OneTimePayment:Click'),
          (d.paymentOptionSelected.paymentOptionClickedFromSideSheet = !0))
      d.paymentOptionSelected.paymentOptionSelectedButtonId = e
      b.trigger('a:declarative:update-swatch:click', {
        data: { selectedPaymentOptionId: d.paymentOptionSelected.paymentOptionSelectedButtonId },
      })
    })
    b.declarative('monthly-payment-option-selection', 'click', function (e) {
      e.data.hasOwnProperty('optionId') &&
        '' !== e.data.optionId &&
        f.increment('Swatch:Financing:' + e.data.optionId + ':Click')
      f.increment('Swatch:MonthlyPayment:Click')
      b.trigger('a:declarative:select-payment-option:click', e)
      var l = k(e.$currentTarget)
      if (l !== u && null !== l) {
        var l = e.data.posubtitle,
          g = e.data.cardImageUrl,
          h = k(e.$currentTarget[0].parentNode),
          c = e.data.paymentOptionSelectButtonId
        'payment-options-list-item' === h[0].parentNode.className
          ? (d.paymentOptionSelected.paymentOptionClickedFromSideSheet = !1)
          : (e.data.hasOwnProperty('optionId') && '' !== e.data.optionId
              ? f.increment('SideSheet:Financing:' + e.data.optionId + ':Click')
              : f.increment(
                  'SideSheet:Financing:' +
                    e.data.executionInfo.offerType +
                    ':' +
                    e.data.termType +
                    ':' +
                    e.data.termCount +
                    ':Click',
                ),
            (d.paymentOptionSelected.paymentOptionClickedFromSideSheet = !0))
        d.paymentOptionSelected.paymentOptionSelectedButtonId = c
        b.trigger('a:declarative:update-swatch:click', {
          data: {
            selectedPaymentOptionId: d.paymentOptionSelected.paymentOptionSelectedButtonId,
            subtitleMessage: l,
            cardImageUrl: g,
          },
        })
        b.trigger('a:declarative:payment-options-overflow:click', e)
      }
    })
    b.declarative('compare-payment-plans-disable', 'click', function (b) {
      d.paymentOptionSelected.paymentOptionUnAvailableMsg = b.data.paymentOptionUnAvailableMsg
      b = b.data.disabledPaymentOptionId
      var f = b.match(/\d+/g)[0],
        f = '#' + e.disabledPaymentOptionSelecter + f
      d.paymentOptionSelected.paymentOptionDisabledButtonId = b
      d.paymentOptionSelected.paymentOptionDisabledTitleSuppliment = k(f).text()
    })
    b.declarative('compare-payment-plans-enable', 'click', function (b) {
      ;(b = b.data.enablePaymentOptionId) &&
        '' !== b &&
        ((b = b.match(/\d+/g)[0]),
        (d.paymentOptionSelected.paymentOptionDisabledButtonId = ''),
        k('#' + e.disabledPaymentOptionSelecter + b).text(
          d.paymentOptionSelected.paymentOptionDisabledTitleSuppliment,
        ),
        (d.paymentOptionSelected.paymentOptionDisabledTitleSuppliment = ''),
        k('[id\x3d' + e.popOverText + b + 'cell]').removeClass(e.classes.popOverShowClass),
        k('[id\x3d' + e.popOverText + b + 'cell]').addClass(e.classes.popOverHideClass))
    })
  })
  ;('use strict')
  q.when('A', 'cc-payment-options', 'payment-options-client-side-metric').execute(
    function (b, d, e) {
      b.declarative('payment-options-emp-action', 'change', function (b) {
        d.updatePaymentOptionSelection(b.data)
      })
      var f = b.debounce(function () {
        var d = b.$,
          f = d('#PaymentOptionsEmpAction')
        0 < f.length && f.trigger('change')
        0 < d('#monthly-payments-not-applicable').length && e.increment('Container:Render:Error')
        0 < d('.payment-options-container').length && e.increment('Container:Render:Success')
      }, 100)
      f()
      b.on('PageRefresh:ATF', f)
    },
  )
  ;('use strict')
  q.when(
    'A',
    'payment-options-client-side-metric',
    'cc-payment-options',
    'payment-options-constants',
  ).execute(function (b, d, e, f) {
    var k = b.$
    d = new d.Timer('Expander:Loading:Images:Time')
    d.start()
    e = function () {
      b.loadDescendantImagesManually(k('.payment-options-financing-option-card-image'))
      b.loadDescendantImagesManually(k('.payment-options-expander-heading-image-container'))
      b.loadDescendantImagesManually(k('.payment-option-detailed-feature-scroll'))
      b.loadDescendantImagesManually(k('.payment-options-side-sheet-header'))
      b.loadDescendantImagesManually(k('.payment-options-side-sheet-option-summary'))
      b.loadDescendantImagesManually(k('.payment-options-side-sheet-comparison-group-container'))
      b.loadDescendantImagesManually(k('.payment-options-comparison-sheet-comparison-card-option'))
    }
    e()
    b.on('a:pageUpdate', e)
    d.stop()
  })
  ;('use strict')
  q.when(
    'A',
    'payment-options-swatch-actions',
    'payment-options-constants',
    'payment-options-state',
    'cc-manager',
  ).execute(function (b, d, e, f, k) {
    function m(a) {
      var b = a.executionInfo
      b.cartType = e.parameters.cartTypes.addToCart
      return {
        itemType: e.parameters.itemType,
        price: a.price,
        selectionType: e.parameters.selectionType.ADD,
        enableIA: !1,
        priceAndTermCountDisplayString: a.priceAndTermCountDisplayString,
        interestDisplayString: a.interestDisplayString,
        interestAmount: a.interestAmount,
        orderSummaryDisplayString: a.orderSummaryDisplayString,
        invalidSelectionTitle: a.cardName,
        isOrderLevel: !0,
        bottomSheetFootnoteDisplayString: a.bottomSheetFootnoteDisplayString,
        termCount: a.termCount,
        termType: a.termType,
        maxQuantity: a.maxQuantity,
        displayQuantityMessage: !0,
        formData: [
          {
            inputType: e.paymentOfferInputElement.inputType,
            inputName: e.paymentOfferInputElement.name,
            inputValue: b,
          },
        ],
      }
    }
    var l = b.$,
      g = e.selector,
      h = e.featureRegistration.featureName,
      c
    b.on('a:dropdown:selected:quantity', function (a) {
      var n = l('#buyBoxAccordion .a-accordion-active').attr('data-buying-option-index') || 0,
        q = l('#paymentOption_' + n + ' .payment-options-list-item'),
        n = l('#paymentOption_' + n + ' #oneTimePaymentOptionSwatch')
      a = a.value
      for (
        var p = b
            .$(e.classSelector + g.selectedOption)
            .closest('.payment-options-list-item')
            .find('span.a-declarative')
            .data(g.monthlyPaymentAction),
          v = 1;
        v < q.length;
        v++
      ) {
        var r = q.eq(v).find('span.a-declarative').data(g.monthlyPaymentAction),
          u = r.maxQuantity
        u &&
          (a > u
            ? (d.disableSwatch(q.eq(v)),
              (u = {
                data: {
                  paymentOptionUnAvailableMsg: r.unAvailableText,
                  numberOfPaymentOptions: r.numberOfPaymentOptions,
                  disabledPaymentOptionId: r.paymentOptionSelectButtonId,
                },
              }),
              f.getWeblabData().isComparePlansRefactorWeblabInT1
                ? b.trigger('a:declarative:compare-payment-plans-disable:click', u)
                : d.disableOptionInCompareAllPlans(u),
              p &&
                r.offerGroup === p.offerGroup &&
                (l(n).click(), k.ccRemovedSelectionUpdate(h, m(r)), (c = r.offerGroup)))
            : (d.enableSwatch(q.eq(v)),
              f.getWeblabData().isComparePlansRefactorWeblabInT1
                ? b.trigger('a:declarative:compare-payment-plans-enable:click', {
                    data: { enablePaymentOptionId: r.paymentOptionSelectButtonId },
                  })
                : d.enableOptionInCompareAllPlans(r.numberOfPaymentOptions),
              c &&
                r.offerGroup === c &&
                (l('.tp-bbm-info-message-quantity-restriction-container').hasClass(
                  'tp-bbm-info-message-displayable',
                ) &&
                  b.trigger('a:declarative:payment-options-monthly-payment-action:click', {
                    $currentTarget: q.eq(v).find('span.a-declarative'),
                    data: r,
                  }),
                k.ccRemovedSelectionsClear(h))))
      }
    })
  })
  ;('use strict')
  q.when('A', 'payment-options-constants').register('payment-options-state', function (b, d) {
    function e() {
      if (!k || 0 === Object.keys(k).length) {
        var b = f(d.selector.paymentOptionsWeblabs).attr(d.selector.paymentOptionsWeblabsAttribute)
        b && (k = JSON.parse(b))
      }
      return k
    }
    var f = b.$,
      k = {}
    b = { getWeblabData: e }
    e()
    return b
  })
  ;('use strict')
  q.when('A').register('payment-options-opt-out-state', function (b) {
    return {
      paymentOptionOptOutSelected: { isOneTimePaymentPreferenceSet: !1, changePlanEventData: '' },
      secondaryViewInstance: null,
    }
  })
  ;('use strict')
  q.when(
    'A',
    'a-modal',
    'payment-options-opt-out-state',
    'price-block-messaging-constants',
    'payment-options-client-side-metric',
    'ready',
  ).execute('payment-options-modal', function (b, d, e, f, k) {
    var m = {}
    b.declarative('open-priceblock-change-plan-modal', 'click', function (b) {
      k.incrementWithValuePriceBlockMessaging('Modal:PaymentOptions:Optout:Link:Click')
      var e = 'priceblock-change-plan-modal-' + b.data.buyingOptionIndex
      Object.hasOwn(m, e) ||
        (m[e] = d.create(b.$target, {
          header: b.data.optOutModalHeader,
          name: e,
          dataStrategy: 'preload',
          width: 484,
        }))
      m[e].show()
    })
    b.declarative('priceblock-change-plan-modal-cancel-button', 'click', function (b) {
      k.incrementWithValuePriceBlockMessaging('Modal:PaymentOptions:Optout:CancelButton:Click')
      m['priceblock-change-plan-modal-' + b.data.buyingOptionIndex].hide()
    })
    b.declarative('priceblock-change-plan-modal-continue-button', 'click', function (l) {
      k.incrementWithValuePriceBlockMessaging('Modal:PaymentOptions:Optout:ContinueButton:Click')
      l = e.paymentOptionOptOutSelected.changePlanEventData
      for (var g = Object.keys(m), h = 0; h < g.length; ++h) {
        var c = g[h]
        d.remove(c)
        delete m[c]
      }
      e.paymentOptionOptOutSelected.isOneTimePaymentPreferenceSet = !0
      g = b.copy(l)
      g.data.paymentOptionSelectButtonId = f.ONE_TIME_PAYMENT_OPTION_ID
      b.trigger('a:declarative:price-block-otp-action:click', g)
      l = b.copy(l)
      b.trigger('a:declarative:price-block-compare-payment-plans:click', l)
    })
  })
  ;('use strict')
  q.when('A', 'price-block-messaging-constants', 'payment-options-client-side-metric').register(
    'price-block-landing-page-events',
    function (b, d, e) {
      b.declarative('acquisition-offer-see-details', 'click', function (b) {
        e.incrementWithValuePriceBlockMessaging(
          d.metrics.ACQUISITION_OFFER_SEE_DETAILS_BUTTON_CLICK,
          1,
        )
        r.open(b.data.landingPageUrl, '_blank')
      })
      b.declarative('acquisition-offer-learn-more', 'click', function (b) {
        e.incrementWithValuePriceBlockMessaging(d.metrics.ACQUISITION_OFFER_LEARN_MORE_CLICK, 1)
        r.open(b.data.landingPageUrl, '_blank')
      })
    },
  )
})
/* ******** */
;(function (f) {
  var g = window.AmazonUIPageJS || window.P,
    k = g._namespace || g.attributeErrors,
    d = k ? k('DetailPageUssStrxAssets', '') : g
  d.guardFatal
    ? d.guardFatal(f)(d, window)
    : d.execute(function () {
        f(d, window)
      })
})(function (f, g, k) {
  f.when('A', 'atf').register('uss-strx-toggle', function (d, a) {
    return {}
  })
  f.when('A', 'uss-strx-toggle', 'uss-strx-constants', 'uss-strx-metrics').register(
    'uss-strx-eligibility-data',
    function (d, a, e, b) {
      function c(c, h) {
        ;(typeof c !== typeof k && !1 !== c) || b.updateAndLogCounter(h, 1)
      }
      var m = d.$,
        l = e.metrics
      b.init()
      return {
        getEligibilityData: function () {
          var b = null,
            h = m('#strx-uss-widget-container')
          if (h.length) {
            var b = h.attr('data-asin'),
              d = h.attr('data-displayable'),
              e = h.attr('data-offer-listing-id'),
              a = h.attr('data-marketplace-id'),
              f = h.attr('data-language-header'),
              g = h.attr('data-opt-strx-experiments'),
              k = h.attr('data-is-prime-customer'),
              h = h.attr('data-promo-id')
            c(b, l.MISSING_ASIN)
            c(d, l.MISSING_DISPLAYABLE)
            c(e, l.MISSING_OFFERLISTING)
            c(a, l.MISSING_MARKETPLACE)
            c(f, l.MISSING_LANGUAGE_HEADER)
            c(g, l.MISSING_STRX_EXPERIMENTS)
            c(k, l.MISSING_IS_CUSTOMER_PRIME)
            c(h, l.MISSING_PROMO_ID)
            b = {
              asin: b,
              displayable: d,
              offerListingId: e,
              marketplaceId: a,
              languageHeader: f,
              optStrxExperiments: g,
              isCustomerPrime: k,
              promoId: h,
            }
          }
          return b
        },
      }
    },
  )
  f.when('A', 'uss-strx-toggle').register('uss-strx-reftag', function (d, a) {
    function e(b) {
      for (
        var c = /([^&=]+)=([^&]*)/g, d = g.location.search.substring(1), e = {}, a;
        null !== (a = c.exec(d));

      ) {
        var h = a[1]
        a = a[2]
        try {
          e[decodeURIComponent(h)] = decodeURIComponent(a)
        } catch (f) {}
      }
      return e[b]
    }
    return {
      getRefTagInURL: function () {
        var b = e('ref_')
        b || (b = e('ref'))
        b || ((b = encodeURI(g.location.href)), (b = b.split('?')[0]), (b = b.split('ref\x3d')[1]))
        return b ? b : null
      },
    }
  })
  f.when('A', 'uss-strx-toggle', 'uss-strx-constants', 'uss-strx-metrics-logger', 'atf').register(
    'uss-strx-metrics',
    function (d, a, e, b) {
      var c
      return {
        init: function () {
          c = new b(e.logging.METRIC_PREFIX)
        },
        updateAndLogCounter: function (b, d) {
          c.updateAndLogCounter(b, d)
        },
        logCounter: function (b, d) {
          c.logCounter(b, d)
        },
        logNexusMetric: function (b, d, a) {
          c.logNexusMetric(b, d, a)
        },
      }
    },
  )
  f.when('A', 'uss-strx-toggle', 'atf').register('uss-strx-metrics-logger', function (d, a, e) {
    return function (b) {
      function c(b, c) {
        null !== c &&
          'number' === typeof c &&
          g.ue &&
          g.ue.count &&
          g.ue.count(a.attribution + b, c)
      }
      function d(b) {
        var c = 0
        g.ue && g.ue.count && (c = g.ue.count(a.attribution + b))
        return c
      }
      var a = this
      a.attribution = b || ''
      a.logCounter = c
      a.getCounter = d
      a.updateAndLogCounter = function (b, a) {
        var e = d(b)
        null !== e && 'number' === typeof e ? c(b, e + a) : c(b, a)
      }
      a.logNexusMetric = function (b, c, a) {}
    }
  })
  f.when('A', 'uss-strx-toggle', 'atf').register('uss-strx-constants', function (d, a, e) {
    return {
      strxCTI: { CATEGORY: 'Website', TYPE: 'STRX', ITEM: 'UPO' },
      eligibility: { ELIGIBILITY_TYPE: 'STRX' },
      ussStores: { USS_STRX_STORE: 'uss-strx-store' },
      logging: { METRIC_PREFIX: 'USS.STRX.' },
      metrics: {
        MISSING_ASIN: 'MissingASIN',
        MISSING_DISPLAYABLE: 'MissingDisplayableFlag',
        MISSING_OFFERLISTING: 'MissingOfferListingId',
        MISSING_MARKETPLACE: 'MissingMarketplaceId',
        MISSING_LANGUAGE_HEADER: 'MissingLanguageHeader',
        MISSING_STRX_EXPERIMENTS: 'MissingStrxExperiments',
        MISSING_IS_CUSTOMER_PRIME: 'MissingIsCustomerPrime',
        MISSING_PROMO_ID: 'MissingPromoId',
        BENEFIT_ACTIVATION_SUCCESS: 'BenefitActivationSuccess',
        BENEFIT_ACTIVATION_FAILURE: 'BenefitActivationFailure',
        PROMOTION_ACTIVATION_ON_LOAD: 'PromotionActivationOnLoad',
        PROMOTION_ACTIVATION_ON_ATC: 'PromotionActivationOnATC',
      },
    }
  })
  f.when(
    'A',
    'uss-strx-toggle',
    'uss-strx-constants',
    'uss-eligibility',
    'uss-strx-eligibility-data',
  ).register('uss-strx-eligibility', function (d, a, e, b, c) {
    ;(d = c.getEligibilityData()) &&
      'function' === typeof b.registerProgramEligibility &&
      b.registerProgramEligibility(e.eligibility.ELIGIBILITY_TYPE, d)
    return {}
  })
  f.when(
    'A',
    'uss-strx-constants',
    'uss-strx-metrics',
    'uss-strx-reftag',
    'uss-strx-eligibility-data',
  ).register('uss-strx-page-load-promo-trigger', function (d, a, e, b, c) {
    d = b.getRefTagInURL()
    c = c.getEligibilityData()
    d && c && c.asin && e.updateAndLogCounter(a.metrics.PROMOTION_ACTIVATION_ON_LOAD, 1)
    return {}
  })
  f.when(
    'uss-store-repository',
    'dp-flux-attribution',
    'uss-constants',
    'uss-strx-constants',
    'uss-strx-metrics',
  ).register('uss-strx-store', function (d, a, e, b, c) {
    function f() {}
    var g = e.actions,
      k = b.strxCTI
    a = new a(b.ussStores.USS_STRX_STORE, k.CATEGORY, k.TYPE, k.ITEM)
    c.init()
    f.prototype = {}
    k = new f()
    return d.registerStore(
      a,
      function (a, d) {
        var f = d.getMetaData()
        switch (d.getName()) {
          case g.ATC_RECEIVE:
            ;(d.getSource() === e.actionSources.DP_ATC_CLICK ||
              d.getSource() === e.actionSources.USS_INLINE_ATC_CLICK) &&
              !0 !== f.isAtcGenericError &&
              f &&
              f.params &&
              f.params.baseReftag &&
              f &&
              f.params &&
              f.params.baseAsin &&
              c.updateAndLogCounter(b.metrics.PROMOTION_ACTIVATION_ON_ATC, 1)
        }
        return a
      },
      k,
    )
  })
  f.when('A', 'atf').register('cid-strx-toggle', function (d, a) {
    return {}
  })
  f.when('A', 'cid-strx-toggle').register('strx-reftag', function (d, a) {
    function e() {
      var a = b('ref_')
      a || (a = b('ref'))
      a || ((a = encodeURI(g.location.href)), (a = a.split('?')[0]), (a = a.split('ref\x3d')[1]))
      c = a ? a : null
    }
    function b(a) {
      for (
        var b = /([^&=]+)=([^&]*)/g, c = g.location.search.substring(1), d = {}, e;
        null !== (e = b.exec(c));

      ) {
        var f = e[2]
        d[decodeURIComponent(e[1])] = decodeURIComponent(f)
      }
      return d[a]
    }
    var c
    c || e()
    return {
      getRefTagInURL: function () {
        return c
      },
    }
  })
  f.when('A', 'uss-strx-metrics-logger', 'atf').register('strx-metrics', function (d, a) {
    var e
    return {
      init: function (b) {
        e = new a(b)
      },
      updateAndLogCounter: function (a, c) {
        e.updateAndLogCounter(a, c)
      },
      logCounter: function (a, c) {
        e.logCounter(a, c)
      },
      logNexusMetric: function (a, c, d) {
        e.logNexusMetric(a, c, d)
      },
    }
  })
  f.when('A', 'cid-strx-toggle', 'atf').register('cid-strx-constants', function (d, a, e) {
    return { logging: { METRIC_PREFIX: 'CID.STRX.' } }
  })
  f.when('A', 'cid-strx-toggle', 'atf').register('strx-constants', function (d, a, e) {
    return {
      metrics: {
        BENEFIT_ACTIVATION_SUCCESS: 'BenefitActivationSuccess',
        BENEFIT_ACTIVATION_FAILURE: 'BenefitActivationFailure',
      },
    }
  })
  f.when('A', 'strx-reftag', 'strx-metrics', 'cid-strx-constants').register(
    'cid-strx-page-load-promo-trigger',
    function (d, a, e, b) {
      var c = d.$
      d = /strx-cid/g
      a = a.getRefTagInURL()
      c = c('#main-image')
      a && a.match(d) && c.length && e.init(b.logging.METRIC_PREFIX)
      return {}
    },
  )
  f.when('uss-strx-constants', 'uss-strx-eligibility-data', 'atc-eligibility').register(
    'atc-strx-eligibility',
    function (d, a, e) {
      ;(a = a.getEligibilityData()) &&
        'function' === typeof e.registerProgramEligibility &&
        e.registerProgramEligibility(d.eligibility.ELIGIBILITY_TYPE, a)
      return {}
    },
  )
})
/* ******** */
;(function (k) {
  var f = window.AmazonUIPageJS || window.P,
    m = f._namespace || f.attributeErrors,
    a = m ? m('DetailPageClimatePledgeFriendlyNewAssets', '') : f
  a.guardFatal
    ? a.guardFatal(k)(a, window)
    : a.execute(function () {
        k(a, window)
      })
})(function (k, f, m) {
  k.when('A', 'climate-pledge-friendly-csm-counters').register('cpf-dpx-handlers', function (a, c) {
    function e() {
      return a.capabilities.isAmazonApp
        ? 'map'
        : a.capabilities.tablet
          ? 'twb'
          : a.capabilities.mobile
            ? 'mwb'
            : 'dsk'
    }
    function n() {
      return (
        a.$('#cpf-manual-load').length && a.$('#cpf-manual-load').is('[data-cpf-manual-load-flag]')
      )
    }
    a.declarative('CPF-ATF-LandingPageLink', 'click', { allowLinkDefault: !0 }, function (a) {
      c.incrementCounter('cpf_dp_' + e() + '_dpcd_aflk')
    })
    a.declarative('CPF-BTF-LandingPageLink', 'click', { allowLinkDefault: !0 }, function (a) {
      c.incrementCounter('cpf_dp_' + e() + '_dpcd_bflk')
    })
    a.declarative('a-modal', 'click', function (a) {
      a = a.$currentTarget[0].id
      ;-1 !== a.indexOf('CPF-ATF-Card')
        ? c.incrementCounter('cpf_dp_' + e() + '_dppb_bgck')
        : -1 !== a.indexOf('CPF-BTF-Certificate-Card') &&
          c.incrementCounter('cpf_dp_' + e() + '_dpcd_cfcd')
    })
    a.declarative('CPF-OpenExternalLink', 'click', function (g) {
      var b = g.$currentTarget[0].firstChild.href
      c.incrementCounter('cpf_dp_' + e() + '_dpcd_excf')
      a.capabilities.isAmazonApp
        ? k.when('mash').execute(function (a) {
            f.location = b
          })
        : f.open(b, '_blank')
    })
    k.when('A', 'a-sheet').execute('dp-cpf-bottom-sheet-atf-declarative-action', function (a, b) {
      var f = a.$,
        h,
        g
      a.declarative('dp-cpf-sheet-atf', 'click', function (d) {
        d = (d && d.data) || {}
        c.recordClick()
        c.incrementCounter('cpf_dp_' + e() + '_dppb_bgck')
        h && h.destroy()
        d.preloadDomId ||
          k.log(
            'missing preloadDomId in ATF bottom sheet trigger',
            'ERROR',
            'DetailPageClimatePledgeFriendlyNewAssets',
          )
        var q = f('#' + d.preloadDomId)
        q.length && q.find('.climatePledgeFriendlyATFFooter').length
          ? ((h = b.create({
              name: 'dp-cpf-bottom-sheet-atf',
              preloadDomId: 'dp-cpf-bottom-sheet-atf',
              height: 1,
              closeType: 'icon',
              sheetLabel: d.sheetLabel,
              sheetDescription: d.sheetDescription,
            })),
            b.showSheet(h),
            a.on('a:sheet:afterShow:dp-cpf-bottom-sheet-atf', function (d) {
              var b = q.clone().removeAttr('id')
              b.find('.dp-cpf-container-bottom-sheet-atf').attr(
                'id',
                'dp-cpf-bottom-sheet-atf-content',
              )
              h.getContentContainer().append(b.html())
              var f =
                (g = h.getContentContainer().find('.dp-cpf-container-bottom-sheet-atf').first()) &&
                g.innerHeight()
              var l = function () {
                var a = g && g.find('.climatePledgeFriendlyATFFooter')
                a &&
                  a.position &&
                  a.position() &&
                  (a.is(':last-child') &&
                  7 <
                    h.getContentContainer()[0].scrollHeight -
                      h.getContentContainer()[0].offsetHeight -
                      h.getContentContainer()[0].scrollTop
                    ? a.addClass('climatePledgeFriendlyShadowBox')
                    : !a.is(':last-child') &&
                        a.position().top + a.outerHeight() >=
                          h.getContentContainer().outerHeight() - 7
                      ? a.addClass('climatePledgeFriendlyShadowBox')
                      : a.removeClass('climatePledgeFriendlyShadowBox'))
              }
              a.defer(function () {
                d.sheet.changeHeight({
                  height: g ? Math.ceil(g.innerHeight() + 1) : f,
                  duration: 0.3,
                })
                a.delay(l, 500)
              })
              h.getContentContainer().scroll(a.throttle(l, 150))
              c.incrementCounter('cpf_dp_' + e() + '_dpcd_atck')
              n() && a.loadDescendantImagesManually(h.getContentContainer())
            }))
          : c.incrementCounter('cpf_dp_' + e() + '_dppb_nr')
      })
      a.declarative('dp-cpf-sheet-atf-bottom', 'click', function (d) {
        d = (d && d.data) || {}
        d.preloadDomId ||
          k.log(
            'missing preloadDomId in ATF bottom sheet secondary trigger',
            'ERROR',
            'DetailPageClimatePledgeFriendlyNewAssets',
          )
        d = f('#' + d.preloadDomId)
        d.length
          ? ((d = d.clone().removeAttr('id')),
            d
              .find('.dp-cpf-container-bottom-sheet-atf-bottom')
              .attr('id', 'dp-cpf-bottom-sheet-atf-bottom-content'),
            h.getContentContainer().replaceWith(d.html()),
            h.changeHeight({
              height: document.querySelector('#dp-cpf-bottom-sheet-atf-bottom-content')
                .offsetHeight,
              duration: 0.2,
            }),
            n() && a.loadImageManually(f('.subAttributeCertIconATF')),
            c.incrementCounter('cpf_dp_' + e() + '_dpcd_abck'))
          : c.incrementCounter('cpf_dp_' + e() + '_dppb_snr')
      })
    })
    k.when('A').execute(function (a) {
      a.on('a:image:lazyLoaded', function (a) {
        a.hasClass('climatePledgeFriendlyLazyload') && c.recordLazyLoad()
      })
      a.on('a:image:load:cpf-leaf', function () {
        c.recordImageLoad()
      })
    })
    k.when('A', 'a-sheet').execute('dp-cpf-bottom-sheet-declarative-action', function (a, b) {
      var f = a.$,
        h
      a.declarative('dp-cpf-sheet', 'click', function (g) {
        g = (g && g.data) || {}
        h && h.destroy()
        g.preloadDomId ||
          k.log(
            'missing preloadDomId in BTF bottom sheet trigger',
            'ERROR',
            'DetailPageClimatePledgeFriendlyNewAssets',
          )
        var d = f('#' + g.preloadDomId)
        d.length
          ? ((h = b.create({
              name: 'dp-cpf-bottom-sheet',
              preloadDomId: 'dp-cpf-bottom-sheet',
              height: 1,
              closeType: 'icon',
              sheetLabel: g.sheetLabel,
              sheetDescription: g.sheetDescription,
            })),
            b.showSheet(h),
            a.on('a:sheet:afterShow:dp-cpf-bottom-sheet', function (b) {
              var g = d.clone().removeAttr('id')
              g.find('.dp-cpf-container-bottom-sheet').attr('id', 'dp-cpf-bottom-sheet-content')
              h.getContentContainer().append(g.html())
              b.sheet.changeHeight({
                height: document.querySelector('#dp-cpf-bottom-sheet-content').offsetHeight,
                duration: 0.3,
              })
              c.incrementCounter('cpf_dp_' + e() + '_dpcd_cfcd')
              n() && a.loadImageManually(f('.subAttributeCertIconBTF'))
            }))
          : c.incrementCounter('cpf_dp_' + e() + '_dppb_bnr')
      })
    })
    c.recordLatency()
  })
  ;('use strict')
  k.when('dp-latency-marker').register('climate-pledge-friendly-csm-counters', function () {
    return {
      incrementCounter: function (a, c) {
        c = c || 1
        c = (ue.count(a) || 0) + c
        ue.count(a, c)
      },
      recordLatency: function () {
        'function' === typeof f.uet && f.uet('bb', 'climate-pledge-friendly-dpx', { wb: 1 })
        'function' === typeof f.uet && f.uet('x1', 'climate-pledge-friendly-dpx', { wb: 1 })
        'function' === typeof f.uex && f.uex('ld', 'climate-pledge-friendly-dpx', { wb: 1 })
      },
      recordClick: function () {
        'function' === typeof f.uet && f.uet('af', 'climate-pledge-friendly-dpx-click', { wb: 1 })
        'function' === typeof f.uex && f.uex('ld', 'climate-pledge-friendly-dpx-click', { wb: 1 })
      },
      recordImageLoad: function () {
        'function' === typeof f.uet &&
          f.uet('be', 'climate-pledge-friendly-dpx-image-loading', { wb: 1 })
        'function' === typeof f.uex &&
          f.uex('ld', 'climate-pledge-friendly-dpx-image-loading', { wb: 1 })
      },
      recordLazyLoad: function () {
        'function' === typeof f.uet &&
          f.uet('cf', 'climate-pledge-friendly-dpx-image-loading', { wb: 1 })
        'function' === typeof f.uex &&
          f.uex('ld', 'climate-pledge-friendly-dpx-image-loading', { wb: 1 })
      },
    }
  })
  k.when('dp-latency-marker').register('cpf-dpx-common-constants', function () {
    return {
      ATTRIBUTION_STRING: 'DetailPageClimatePledgeFriendly',
      EVENT_ID_BOTTOM_SHEET_SHOW: 'cpf-dpx-sheet',
      EVENT_ID_BOTTOM_SHEET_SECONDARY_SHOW: 'cpf-dpx-sheet-secondary',
      EVENT_ID_BOTTOM_SHEET_SECONDARY_BACK: 'cpf-dpx-sheet-secondary-back',
      EVENT_ID_SIDE_SHEET_SHOW: 'cpf-dpx-sidesheet-open',
      EVENT_ID_SIDE_SHEET_HIDE: 'cpf-dpx-sidesheet-close',
      EVENT_ID_SIDE_SHEET_CAPTURE: 'cpf-dpx-sidesheet-capture',
      EVENT_ID_SIDE_SHEET_SECONDARY_SHOW: 'cpf-dpx-sidesheet-secondary',
      EVENT_ID_SIDE_SHEET_SECONDARY_BACK: 'cpf-dpx-sidesheet-secondary-back',
      SELECTOR_BOTTOM_SHEET_CONTAINER: '.cpf-dpx-container-bottom-sheet',
      SELECTOR_BOTTOM_SHEET_CONTAINER_SECONDARY: '.cpf-dpx-container-bottom-sheet-secondary',
      SELECTOR_BOTTOM_SHEET_SECONDARY_BACK_BUTTON: '.cpf-dpx-detail-view-secondary-back',
      SELECTOR_BOTTOM_SHEET_CAROUSEL: '.cpf-dpx-bottom-sheet-carousel',
      SELECTOR_PROGRAM_STICKY_FOOTER: '.cpf-dpx-sticky-footer',
      SELECTOR_SIDE_SHEET_SECONDARY_BACK_BUTTON: '.cpf-dpx-detail-view-secondary-back',
      SIDE_SHEET_CONTAINER_ID: 'cpf-dpx-sidesheet-container',
      SIDE_SHEET_START_ANCHOR_CLASSNAME: 'cpf-dpx-sidesheet-anchor-start',
      SIDE_SHEET_END_ANCHOR_CLASSNAME: 'cpf-dpx-sidesheet-anchor-end',
      CAROUSEL_INITIALIZED_CLASS: 'a-carousel-initialized',
      CAROUSEL_NOT_INITIALIZED_CLASS: 'a-carousel-static',
      KEYCODE_ESCAPE: 27,
      KEYCODE_TAB: 9,
      SCROLL_CORRECTION_OFFSET: 5,
      SCROLL_EVENT_THROTTLE_MS: 150,
      BOTTOM_SHEET_HEIGHT_CHANGE_DURATION: 0.3,
      SCROLL_EVENT_DELAY_MS: 1e3,
      SIDE_SHEET_OPEN_ANIMATION_DELAY_MS: 300,
      SIDE_SHEET_CLOSE_ANIMATION_DELAY_MS: 200,
      MS_CONVERT: 1e3,
      TRIGGER_URI: '/ussx/weblab-trigger?',
      QC_WEBLAB: 'CONSUMABLES_CPF_QUANTIFIABLE_CLAIMS_1080213',
    }
  })
  k.when(
    'A',
    'cpf-dpx-common-constants',
    'cpf-dpx-sidesheet-util',
    'cpf-dpx-trigger-utils',
    'ready',
  ).execute('cpf-dpx-sidesheet', function (a, c, e, n) {
    var g = (f.ue && f.ue.count) || function () {}
    a.declarative(c.EVENT_ID_SIDE_SHEET_SHOW, 'click', function (b) {
      var f = b.$currentTarget,
        h
      b.data.preloadDomId
        ? (b.data.ctMetric && g(b.data.ctMetric, 1),
          b.data.qcTrigger && n.triggerQCWeblab(b.data.qcTrigger, c.QC_WEBLAB),
          e.preloadSheet(
            b.data.preloadDomId,
            b.data.popoverLabel,
            b.data.closeButtonLabel,
            !!b.data.removeBackButton,
          ),
          e.showSheet(),
          a.one('cpf-dpx-sidesheet:afterShow', function (b) {
            a.loadDescendantImagesManually(b.sheet)
            h = a.now()
          }),
          a.one('cpf-dpx-sidesheet:afterHide', function () {
            var e
            f && f.length && (e = f.find('a').first()) && e.length && e.focus()
            b.data.dwellMetric && h && g(b.data.dwellMetric, (a.now() - h) / c.MS_CONVERT)
          }))
        : k.log('Sidesheet show error: missing DOM ID for loading', 'ERROR', c.ATTRIBUTION_STRING)
    })
    a.declarative(c.EVENT_ID_SIDE_SHEET_SECONDARY_SHOW, 'click', function (b) {
      b.data.preloadDomId && b.data.previousPreloadDomId
        ? a.$('#' + b.data.preloadDomId).length
          ? (b.data.ctMetric && g(b.data.ctMetric, 1),
            e.preloadSecondaryContent(b.data.preloadDomId),
            e.addBackActionData(
              b.data.ctDwellMetric,
              0 !== b.$target.length ? b.$target.attr('id') : b.data.previousPreloadDomId,
            ),
            e.showSecondaryContent())
          : (b.data.delayMetric && g(b.data.delayMetric, 1),
            k.log(
              'Can not find secondary sheetContent by preloadDomId in desktop side sheet',
              'INFO',
              c.ATTRIBUTION_STRING,
            ))
        : k.log(
            'Sidesheet secondary show error: missing DOM ID for loading',
            'ERROR',
            c.ATTRIBUTION_STRING,
          )
    })
    a.declarative(c.EVENT_ID_SIDE_SHEET_SECONDARY_BACK, 'click', function (b) {
      b.data && b.data.returnFocusId
        ? e.hideSecondaryContent(b.data.returnFocusId)
        : e.hideSecondaryContent()
      b.data &&
        b.data.ctDwellMetric &&
        b.data.ctDwellStart &&
        g(b.data.ctDwellMetric, (a.now() - b.data.ctDwellStart) / c.MS_CONVERT)
    })
    a.declarative(c.EVENT_ID_SIDE_SHEET_HIDE, 'click', function () {
      e.hideSheet()
    })
    a.declarative(c.EVENT_ID_SIDE_SHEET_CAPTURE, 'keydown', function (a) {
      'keydown' !== a.type ||
        (a.$event.keyCode !== c.KEYCODE_ESCAPE && a.$event.key !== c.KEYCODE_ESCAPE) ||
        e.hideSheet()
    })
    a.declarative(c.EVENT_ID_SIDE_SHEET_CAPTURE, 'focusin', function (b) {
      b.$target.length &&
        b.$target.hasClass(c.SIDE_SHEET_END_ANCHOR_CLASSNAME) &&
        a.delay(function () {
          e.focusOnFirst()
        }, 0)
    })
    a.declarative(c.EVENT_ID_SIDE_SHEET_CAPTURE, 'focusout', function (b) {
      b.$target.length &&
        a.delay(function () {
          a.$(document.activeElement).hasClass(c.SIDE_SHEET_START_ANCHOR_CLASSNAME) &&
            e.focusOnLast()
        }, 0)
    })
    a.on('a:expander:pc_sidesheet_expander:toggle:expand', function (a) {
      a.expander &&
        a.expander.$expander &&
        a.expander.$expander.data('eometric') &&
        g(a.expander.$expander.data('eometric'), 1)
    })
  })
  ;('use strict')
  k.when('A', 'jQuery', 'cpf-dpx-common-constants').register(
    'cpf-dpx-sidesheet-util',
    function (a, c, e) {
      function f() {
        return c('#' + e.SIDE_SHEET_CONTAINER_ID)
      }
      function g(a) {
        return a.find('#cpf-dpx-sidesheet-content-container')
      }
      function b(a) {
        return a.find('#cpf-dpx-sidesheet-background')
      }
      function p(a) {
        return a.find('#cpf-dpx-sidesheet-content')
      }
      function h(a) {
        return a.find('#cpf-dpx-sidesheet-secondary-content')
      }
      function m(d) {
        var b = f(),
          e = p(b),
          g = h(b)
        a.hide(g)
        a.show(e)
        g.attr('aria-hidden', 'true')
        e.attr('aria-hidden', 'false')
        b.find('.cpf-dpx-sidesheet-anchor-start').focus()
        d && ((d = c('#' + d)), d.length && d.focus())
      }
      return {
        preloadSheet: function (d, b, g, h) {
          var l = f()
          d = c('#' + d)
          ;(l && 0 !== l.length) ||
            ((l = c(document.createElement('div'))),
            l.attr('id', e.SIDE_SHEET_CONTAINER_ID),
            l.addClass('a-section a-spacing-none'),
            l.append(
              '\x3cspan class\x3d"a-declarative" data-action\x3d"' +
                e.EVENT_ID_SIDE_SHEET_CAPTURE +
                '"\x3e\x3cspan class\x3d"a-declarative" data-action\x3d"cpf-dpx-sidesheet-close" aria-label\x3d"' +
                g +
                '" tabindex\x3d"0"\x3e\x3cdiv id\x3d"cpf-dpx-sidesheet-background" class\x3d"cpf-dpx-sidesheet-background" aria-hidden\x3d"true"\x3e\x3c/div\x3e\x3c/span\x3e\x3cdiv id\x3d"cpf-dpx-sidesheet-content-container" class\x3d"cpf-dpx-sidesheet" aria-modal\x3d"true" role\x3d"dialog" aria-labelledby\x3d"cpf-dpx-sidesheet-label" aria-hidden\x3d"true"\x3e\x3cspan tabindex\x3d"0" class\x3d"' +
                e.SIDE_SHEET_START_ANCHOR_CLASSNAME +
                ' cpf-dpx-sidesheet-a11y-label"\x3e\x3c/span\x3e\x3cheader\x3e\x3cspan id\x3d"cpf-dpx-sidesheet-label" class\x3d"cpf-dpx-sidesheet-a11y-label aok-block" aria-hidden\x3d"true"\x3e' +
                b +
                '\x3c/span\x3e\x3cbutton class\x3d"a-declarative cpf-dpx-sidesheet-close-button" data-action\x3d"cpf-dpx-sidesheet-close" aria-label\x3d"' +
                g +
                '"\x3e\x3cdiv class\x3d"a-icon cpf-dpx-sidesheet-close-icon"\x3e\x3c/div\x3e\x3c/button\x3e\x3c/header\x3e\x3cdiv id\x3d"cpf-dpx-sidesheet-content" aria-hidden\x3d"true"\x3e\x3c/div\x3e\x3cdiv id\x3d"cpf-dpx-sidesheet-secondary-content" aria-hidden\x3d"true"\x3e\x3c/div\x3e\x3cspan tabindex\x3d"0" class\x3d"' +
                e.SIDE_SHEET_END_ANCHOR_CLASSNAME +
                ' cpf-dpx-sidesheet-a11y-label"\x3e\x3c/span\x3e\x3c/div\x3e\x3c/span\x3e',
            ),
            c('body').prepend(l))
          d && 0 !== d.length
            ? (p(l).html(d.html()),
              h && p(l).find(e.SELECTOR_SIDE_SHEET_SECONDARY_BACK_BUTTON).parent().remove(),
              a.loadDescendantImagesManually(l))
            : k.log(
                'Can not find the sheetContent by preloadDomId in desktop side sheet',
                'ERROR',
                e.ATTRIBUTION_STRING,
              )
        },
        showSheet: function () {
          var d = f(),
            h = b(d),
            l = g(d),
            k = p(d)
          a.show(d)
          m()
          l.attr('aria-hidden', 'false')
          k.attr('aria-hidden', 'false')
          d.find('.cpf-dpx-sidesheet-close-button').focus()
          c('#a-page').attr('aria-hidden', 'true')
          c('body').css('overflow', 'hidden')
          a.show(h)
          l.show(function () {
            a.animate(l, { right: '0' }, e.SIDE_SHEET_ANIMATION_DELAY_MS, 'ease-out', function () {
              a.trigger('cpf-dpx-sidesheet:afterShow', { sheet: d })
            })
          })
        },
        hideSheet: function () {
          var d = f(),
            h = b(d),
            l = g(d)
          l.attr('aria-hidden', 'true')
          c('#a-page').attr('aria-hidden', 'false')
          c('body').css('overflow', '')
          a.hide(h)
          a.animate(
            l,
            { right: '-500px' },
            e.SIDE_SHEET_ANIMATION_DELAY_MS,
            'ease-out',
            function () {
              a.hide(d)
              a.trigger('cpf-dpx-sidesheet:afterHide', { sheet: d })
            },
          )
        },
        addBackActionData: function (d, b) {
          var c = f()
          c = h(c).find(e.SELECTOR_SIDE_SHEET_SECONDARY_BACK_BUTTON).parent()
          d = { returnFocusId: b, ctDwellMetric: d, ctDwellStart: a.now() }
          a.declarative.create(c, e.EVENT_ID_SIDE_SHEET_SECONDARY_BACK, d)
          c.attr('data-action', e.EVENT_ID_SIDE_SHEET_SECONDARY_BACK)
          c.attr('data-' + e.EVENT_ID_SIDE_SHEET_SECONDARY_BACK, JSON.stringify(d))
          c.removeAttr('action-name')
          c.removeAttr('action-params')
        },
        preloadSecondaryContent: function (d) {
          var b = f()
          d = c('#' + d)
          b = h(b)
          d && 0 !== d.length
            ? (b.html(d.html()), a.loadDescendantImagesManually(b))
            : k.log(
                'Can not find secondary sheetContent by preloadDomId in desktop side sheet',
                'ERROR',
                e.ATTRIBUTION_STRING,
              )
        },
        hideSecondaryContent: m,
        showSecondaryContent: function () {
          var b = f(),
            c = p(b),
            e = h(b)
          a.hide(c)
          a.show(e)
          e.attr('aria-hidden', 'false')
          c.attr('aria-hidden', 'true')
          b.find('.cpf-dpx-sidesheet-anchor-start').focus()
        },
        focusOnFirst: function () {
          var a = f()
          g(a).find('a[href], button').first().focus()
        },
        focusOnLast: function () {
          var a = f()
          g(a).find('a[href], button').last().focus()
        },
      }
    },
  )
  k.when('A', 'cpf-dpx-common-constants').register('cpf-dpx-trigger-utils', function (a, c) {
    return {
      triggerQCWeblab: function (e, k) {
        var g = ''
        f.ue && (g = f.ue.id)
        e =
          c.TRIGGER_URI + 'weblabValue\x3d' + k + '\x26treatment\x3d' + e + '\x26requestId\x3d' + g
        navigator && navigator.sendBeacon ? navigator.sendBeacon(e) : a.$.ajax({ url: e })
      },
    }
  })
})
/* ******** */
;(function (g) {
  var k = window.AmazonUIPageJS || window.P,
    l = k._namespace || k.attributeErrors,
    b = l ? l('PulseStaplesActionAssets', '') : k
  b.guardFatal
    ? b.guardFatal(g)(b, window)
    : b.execute(function () {
        g(b, window)
      })
})(function (g, k, l) {
  String.prototype.startsWith ||
    Object.defineProperty(String.prototype, 'startsWith', {
      value: function (b, f) {
        f = 0 < f ? f | 0 : 0
        return this.substring(f, f + b.length) === b
      },
    })
  ;('use strict')
  g.when('A', 'pulse-staple-action-constants').register(
    'pulse-staples-action-proxy',
    function (b, f) {
      var c = function (a, d) {
        var c = a.success,
          e = a.error
        b.$.ajax({
          url: d,
          type: 'POST',
          data: JSON.stringify(a.data),
          contentType: 'application/json; charset\x3dutf-8',
          dataType: 'json',
          success: c,
          error: e,
          timeout: 1e4,
        })
      }
      return {
        addStaples: function (a) {
          var d = f.addStaplesBaseUrl + '?' + b.$.param({ reftag_: a.data.reftag })
          c(a, d)
        },
        updateStaple: function (a) {
          var d = f.updateStapleBaseUrl + '?' + b.$.param({ reftag_: a.data.reftag })
          c(a, d)
        },
      }
    },
  )
  ;('use strict')
  g.when(
    'A',
    'a-dropdown',
    'pulse-staple-action-error-modal-utils',
    'pulse-staple-action-constants',
  ).register('pulse-add-action-state-util', function (b, f, c, a) {
    var d = function (a) {
        return a.prop('enabled') === l || !0 === a.prop('enabled')
      },
      g = function (e, c) {
        return setTimeout(function () {
          var d = e.$currentTarget.closest(a.stapleActionRowSelector),
            h = d.nextAll(a.eduContentInitialViewSelector)
          h = 0 < h.length ? b.$.makeArray(d, h) : d
          b.fadeOut(h, 150, a.auiEaseOutAnimation, function () {
            var e = b.$(c)
            e.height(d.outerHeight())
            var h = e.filter(a.stapleActionRowSelector),
              g = d.nextAll(a.eduContentManageStaplesViewSelector)
            h = 0 < g.length ? b.$.makeArray(h, g) : h
            d.replaceWith(e)
            e = e.find('.a-dropdown-container select')
            ;(e = f.getSelect(e)) && e.val(e.val())
            b.fadeIn(h, 150, a.auiEaseOutAnimation)
          })
        }, 1e3)
      }
    return {
      addActionSuccessTransition: function (e, d) {
        var c = e.$currentTarget.nextAll(a.spinnerSelector),
          h = e.$currentTarget.nextAll(a.successSelector)
        e.data &&
        Array.isArray(e.data.templates) &&
        e.data.templates.includes('DO_NOT_RENDER_QUANTITY_CADENCE_SELECTOR')
          ? g(e, d)
          : b.fadeOut(c, 150, a.auiEaseOutAnimation, function () {
              b.fadeIn(h, 150, a.auiEaseOutAnimation, function () {
                return g(e, d)
              })
            })
      },
      addActionFailureTransition: function (e, b) {
        var h = e.$currentTarget.nextAll(a.spinnerSelector),
          f = e.$currentTarget.find(a.auiButtonSelector)
        d(f) ||
          (h.toggleClass(a.auiHiddenCssClass),
          f.prop('enabled', !0),
          f.show(),
          c.showModal(e.$target, b))
      },
      addActionInProgressTransition: function (b) {
        var e = b.$currentTarget.nextAll(a.spinnerSelector),
          c = b.$currentTarget.find(a.auiButtonSelector)
        if (d(c)) {
          var f = b.$currentTarget.find(a.auiButtonSelector).outerHeight()
          b.$currentTarget.closest(a.stapleActionRowSelector).height(f)
          e.toggleClass(a.auiHiddenCssClass)
          c.prop('enabled', !1)
          c.hide()
        }
      },
      itemAlreadyRepeatedTransition: function (e, d) {
        var c = e.$currentTarget.closest(a.stapleActionRowSelector)
        e = c.nextAll(a.eduContentInitialViewSelector)
        e = b.$.makeArray(c, e)
        b.fadeOut(e, 150, a.auiEaseOutAnimation, function () {
          var e = b.$(d)
          e.height(c.outerHeight())
          c.replaceWith(e)
          b.fadeIn(e, 150, a.auiEaseOutAnimation)
        })
      },
      isAddActionInProgress: function (b) {
        return !d(b.$currentTarget.find(a.auiButtonSelector))
      },
    }
  })
  ;('use strict')
  g.when('A', 'pulse-staple-action-error-modal-utils', 'pulse-staple-action-constants').register(
    'pulse-update-action-state-util',
    function (b, f, c) {
      return {
        renderUpdatedNextDropDate: function (a, d) {
          d && b.$(c.nextAddDateRowTextSelectorPrefix + '-' + a).text(d)
        },
        showErrorModalOnFailure: function (a, b) {
          return f.showModal(a, b)
        },
        renderUpdatedQuantityAndCadence: function (a, d) {
          d && b.$(c.cadenceRowTextSelectorPrefix + '-' + a).text(d)
        },
        toggleInProgressCx: function (a) {
          var d = b.$(c.updateStapleComponentSelectorPrefix + '-' + a),
            f = d.outerHeight()
          d.height(f)
          b.$(c.updateSpinnerContainerSelectorPrefix + '-' + a)
            .add(c.updateActionRowSelectorPrefix + '-' + a)
            .toggleClass(c.auiHiddenCssClass)
        },
      }
    },
  )
  ;('use strict')
  g.when('A', 'a-modal').register('pulse-staple-action-error-modal-utils', function (b, f) {
    b.on('a:popover:afterHide:pulse-staple-action-error-modal', function (b) {
      f.remove(b.popover)
    })
    var c = function (a) {
      try {
        return JSON.parse(a.responseText).errorModalHtml
      } catch (d) {
        return b.state('pulse-staple-action-error-messages').generic
      }
    }
    return {
      removeModal: function () {
        var b = f.get('pulse-staple-action-error-modal')
        b && f.remove(b)
      },
      showModal: function (b, d) {
        f.create(b, { name: 'pulse-staple-action-error-modal', inlineContent: c(d) }).show()
      },
    }
  })
  ;('use strict')
  g.when('A', 'a-popover', 'pulse-staple-action-constants').register(
    'pulse-staple-action-educational-content',
    function (b, f, c) {
      b.declarative(c.educationalContentLearnMoreDecAction, ['click', 'mouseenter'], function (b) {
        f.create(b.$target, {
          url:
            c.educationalContentBaseUrl +
            '?learnMoreManageStaplesLink\x3d' +
            b.data.learnMoreManageStaplesLink,
          position: 'triggerLeft',
          width: 320,
          closeButton: !1,
          padding: 'none',
        }).show()
      })
    },
  )
  ;('use strict')
  g.when('A').register('pulse-staple-action-constants', function () {
    return {
      addStaplesBaseUrl: '/repeatitems/psa/v1/add',
      updateStapleBaseUrl: '/repeatitems/psa/v1/update',
      educationalContentBaseUrl: '/repeatitems/psa/v1/educontent',
      educationalContentLearnMoreDecAction: 'pulse-staple-action-learn-more',
      educationalContentBottomSheetName: 'pulse-staple-action-learn-more-bottom-sheet',
      spinnerSelector: '.atsl-spinner-element',
      successSelector: '.atsl-success-element',
      stapleActionRowSelector: '.staple-action-row',
      eduContentInitialViewSelector: '.staple-action-learn-more-initial-view',
      eduContentManageStaplesViewSelector: '.update-staple-action-manage-staples-link',
      auiButtonSelector: '.a-button',
      auiHiddenCssClass: 'aok-hidden',
      auiEaseOutAnimation: 'ease-out',
      nextAddDateRowTextSelectorPrefix: '#pulse-staples-action-next-add-date-row-text',
      cadenceRowTextSelectorPrefix: '#pulse-staple-action-qty-cadence-row-text',
      updateSpinnerContainerSelectorPrefix: '#pulse-staple-update-spinner-container',
      updateActionRowSelectorPrefix: '#pulse-staple-update-action-row',
      updateStapleComponentSelectorPrefix: '#update-staple-component',
      updateStapleSuccessfulEventId: 'UpdateStapleSuccessfulEvent',
    }
  })
  ;('use strict')
  g.when('A').register('pulse-staple-action-metric-util', function () {
    return {
      logAddStapleLatencyMetric: function (b, f) {
        k.ue &&
          k.ue.count &&
          'undefined' !== typeof k.ue_t0 &&
          ue.count('AddStaple-TimeTo-' + b, f - k.ue_t0)
      },
    }
  })
  ;('use strict')
  g.when(
    'A',
    'pulse-staples-action-proxy',
    'pulse-add-action-state-util',
    'pulse-staple-action-metric-util',
  ).register('pulse-add-staple-action', function (b, f, c, a) {
    var d = function (a) {
      return b.$.extend({}, a, { clientContext: a, asins: [a.asin] })
    }
    b.declarative('pulse-add-to-staples-action', 'click', function (a) {
      c.isAddActionInProgress(a) ||
        (c.addActionInProgressTransition(a),
        f.addStaples({
          data: d(a.data),
          success: function (d) {
            'ItemAlreadyRepeated' === d.addOperationStatus
              ? c.itemAlreadyRepeatedTransition(a, d.nextViewHtml)
              : (c.addActionSuccessTransition(a, d.nextViewHtml),
                b.trigger('AddToStaplesSuccessfulEvent', a.data.asin))
          },
          error: function (b) {
            return c.addActionFailureTransition(a, b)
          },
        }))
    })
    var g = b.now()
    a.logAddStapleLatencyMetric('JSReady', g)
  })
  ;('use strict')
  g.when(
    'A',
    'pulse-staples-action-proxy',
    'pulse-update-action-state-util',
    'QuantitySelectorWidget',
    'QuantitySelectorConstants',
    'QuantitySelectorState',
    'QuantitySelectorUtils',
    'QuantitySelectorAUIDeps',
    'a-dropdown',
    'a-modal',
    'pulse-staple-action-constants',
  ).register('pulse-update-staple-action', function (b, f, c, a, d, g, e, h, k, l, m) {
    var n = function (b) {
        return k.getSelect('pulse-staple-cadence-selector-desktop-' + b)
      },
      q = function (a) {
        var d = g.getQsWidgetConfiguration(a).selectedId
        d = e.getQsItem(a, d)
        d = JSON.parse(d.data)
        var c = g.getQsWidgetConfiguration(a)
        c = JSON.parse(c.staticData)
        return b.$.extend({}, c, d, {
          quantity: { quantity: d.quantity, unit: c.quantityUnit },
          cadence: JSON.parse(n(a).val()),
          clientContext: c,
        })
      },
      p = function (a) {
        var c = b.state('pulse-original-cadence-' + a)
        n(a).val(JSON.stringify(c))
        c = d.getQsWidgetConfigurationId(a) + '-original'
        ;(c = h.aState.state(c)) &&
          c.id &&
          h.aState.state.replace(d.getQsWidgetConfigurationId(a), c)
        b.trigger(d.getQsWidgetEventInitialize(), !0, a)
      }
    b.on('a:popover:afterShow', function (a) {
      if ((a = a.popover) && a.name && a.name.startsWith('pulse-staple-action-qs')) {
        a = a.name.replace('pulse-staple-action-qs-', '')
        var c = d.getQsWidgetConfigurationId(a) + '-original'
        h.aState.state(c)
        var e = g.getQsWidgetConfiguration(a)
        h.aState.state(c, e)
        b.state('pulse-original-cadence-' + a, JSON.parse(n(a).val()))
      }
    })
    b.on('a:popover:hide', function (a) {
      ;(a = a.popover) &&
        a.name &&
        a.name.startsWith('pulse-staple-action-qs') &&
        ((a = a.name.replace('pulse-staple-action-qs-', '')),
        b.$(m.updateSpinnerContainerSelectorPrefix + '-' + a).hasClass(m.auiHiddenCssClass) && p(a))
    })
    b.declarative('pulse-update-staple-action', 'click', function (a) {
      var d = a.data.qsUID,
        e = a.$currentTarget.closest('.a-popover-modal')
      e = l.get(e)
      c.toggleInProgressCx(d)
      e.hide()
      f.updateStaple({
        data: q(d),
        success: function (a) {
          c.renderUpdatedQuantityAndCadence(d, a.renderableQuantityCadence)
          c.renderUpdatedNextDropDate(d, a.renderableNextDropDate)
          b.trigger(m.updateStapleSuccessfulEventId)
          c.toggleInProgressCx(d)
        },
        error: function (b) {
          c.showErrorModalOnFailure(a.$target, b)
          p(d)
          c.toggleInProgressCx(d)
        },
      })
    })
  })
})
/* ******** */
;(function (b) {
  var c = window.AmazonUIPageJS || window.P,
    f = c._namespace || c.attributeErrors,
    a = f ? f('DetailPageICartAssets', '') : c
  a.guardFatal
    ? a.guardFatal(b)(a, window)
    : a.execute(function () {
        b(a, window)
      })
})(function (b, c, f) {
  b.when('A', 'uss-eligibility', 'atf').register('uss-bmsm-eligibility', function (a, b) {
    a = a.$
    if ((a = a('#bmsm-uss-widget-container')) && a.length) {
      var g = a.attr('data-merchant-id'),
        d = a.attr('data-fulfillment-manager-id'),
        e = a.attr('data-sku'),
        c = a.attr('data-price')
      a = a.attr('data-is-customer-prime')
      g = { merchantId: g, fulfillmentManagerId: d, sku: e, price: c, isCustomerPrime: a }
    }
    ;(a = g) && b.registerProgramEligibility('BMSM', a)
  })
  ;('use strict')
  ;('use strict')
  b.when('A').register('bmsm-kvp-utils', function (a) {
    var b = a.$
    return {
      updateBMSMKVPByFormId: function (a) {
        a = b('#' + a)
        if (
          1 < a.find('input[name\x3dcustom-name\\.1\\.1]').length &&
          0 < a.find('input[name\x3dcustom-name\\.1\\.1][value\x3dincentivizedCart]').length
        ) {
          var d = 0
          a.find("input[name^\x3d'custom-name\\.1\\.']").each(function (a, b) {
            a = Number(b.name.split('.')[2])
            !isNaN(a) && 0 < a && (d = a > d ? a : d)
          })
          if (0 < d) {
            var e = parseInt(d) + 1,
              c = 'custom-name.1.' + e,
              e = 'custom-value.1.' + e
            a.find('input[name\x3dcustom-name\\.1\\.1][value\x3dincentivizedCart]')
              .attr('id', c)
              .attr('name', c)
            a.find('input[name\x3dcustom-value\\.1\\.1][class\x3dbmsmKVP]')
              .attr('id', e)
              .attr('name', e)
          }
        }
      },
    }
  })
  ;('use strict')
})
/* ******** */
;(function (e) {
  var g = window.AmazonUIPageJS || window.P,
    h = g._namespace || g.attributeErrors,
    l = h ? h('AllOffersDisplayIngressAssets', '') : g
  l.guardFatal
    ? l.guardFatal(e)(l, window)
    : l.execute(function () {
        e(l, window)
      })
})(function (e, g, h) {
  e.execute('all-offers-display-ingress-init', function () {
    var l = g.uet,
      n = g.uex
    'function' === typeof l && l('bb', 'aod-ingress-assets-load-time', { wb: 1 })
    e.when(
      'A',
      'jQuery',
      'all_offers_display_ingress_utils',
      'all-offers-display-register-state',
      'all_offers_display_ingress_csm_counters',
    ).execute('all_offers_display_ingress_load_AOD_assets', function (b, a, c, f, d) {
      function k(c) {
        e.now().execute(function (a) {
          a !== h ||
            f.isMarkerOverrideRegistered() ||
            ('function' === typeof p && p('bb', 'aod-main-assets-injection', { wb: 1 }),
            e.register('aodIngressClick'),
            e.register('aodDeclarativeEvent', function () {
              return c
            }),
            f.setMarkerOverrideTriggered())
        })
      }
      var p = g.uet
      b.state('aod:assetsLoaded', { isAodAssetsLoaded: !0 })
      d.triggerUnitCounter('aodIngressAssetsLoadCtr')
      b.declarative('show-all-offers-display', 'click', function (a) {
        a.$event.preventDefault()
        a.$event.stopPropagation()
        a &&
          a.data &&
          a.data.ingressName &&
          d.incrementAndTriggerCounter(a.data.ingressName + 'LoadAod')
        !b.state('aod:assets2Loaded') &&
          c.isClickOnAODIngressSupported(a) &&
          (k(a),
          e.when('aod-load-event-handler', 'aodDeclarativeEvent').execute(function (a, c) {
            c && c.data && (c.data.pc = 'dp')
            a.renderAodAction(c)
          }))
      })
      b.declarative('s-show-all-offers-display', 'click', function (a) {
        a.$event.preventDefault()
        a.$event.stopPropagation()
        !b.state('aod:assets2Loaded') &&
          c.isClickOnAODIngressSupported(a) &&
          (k(a),
          e.when('search-all-offers-display-util', 'aodDeclarativeEvent').execute(function (a, c) {
            a.searchOnClickHandler(c)
          }))
      })
      b.declarative('all-offers-display-show-from-morpheus', 'click', function (a) {
        a.$event.preventDefault()
        a.$event.stopPropagation()
        !b.state('aod:assets2Loaded') &&
          c.isClickOnAODIngressSupported(a) &&
          (k(a),
          e
            .when('all-offers-display-morpheus-util', 'aodDeclarativeEvent')
            .execute(function (a, c) {
              a.openAODFromMorpheus(c)
            }))
      })
    })
    e.when(
      'A',
      'jQuery',
      'all-offers-display-register-state',
      'all_offers_display_ingress_csm_counters',
    ).execute('all-offers-display-enable-compare', function (b, a, c, f) {
      var d = g.uet
      b.state('aod:assets2Loaded') ||
        ((b = g.location.href.split('?')),
        1 < b.length &&
          (b = b[1].toLowerCase().split(/[&,#]/)) &&
          -1 !== b.indexOf('aod\x3d1') &&
          e.now().execute(function (a) {
            a === h &&
              (c.isMarkerOverrideRegistered()
                ? f.incrementAndTriggerCounter('aodAutoLoadMarkerOverrideSetCtr')
                : (f.triggerUnitCounter('aodAutoLoadAssetsRequestedCtr'),
                  'function' === typeof d &&
                    d('bb', 'aod-main-assets-injection-auto-load', { wb: 1 }),
                  e.register('aodIngressClick'),
                  c.setMarkerOverrideTriggered()))
          }))
    })
    e.when('A', 'jQuery', 'all_offers_display_ingress_olp_hyperlink').register(
      'all_offers_display_ingress_utils',
      function (b, a, c) {
        return {
          isClickOnAODIngressSupported: function (a) {
            return c.getOlpHyperlink(a) ? !0 : !1
          },
        }
      },
    )
    e.register('all_offers_display_ingress_csm_counters', function () {
      var b = g.ue
      return {
        incrementAndTriggerCounter: function (a) {
          b && b.count && b.count(a, (b.count(a) || 0) + 1)
        },
        triggerUnitCounter: function (a) {
          b && b.count && b.count(a, 1)
        },
      }
    })
    e.when('all_offers_display_ingress_csm_counters').register(
      'all_offers_display_ingress_aod_supported',
      function (b) {
        return {
          isPropertySupported: function (a, c, f) {
            var d = typeof a[c] === f
            if (!d) {
              var k = {}
              a.tagName && (k.tagName = a.tagName)
              a.getAttribute &&
                'function' === typeof a.getAttribute &&
                (a.getAttribute('id') && (k.id = a.getAttribute('id')),
                a.getAttribute('class') && (k.class = a.getAttribute('class')),
                a.getAttribute('href') && (k.href = a.getAttribute('href')))
              a = 'aodPropertyUnsupportedMessage, element: ' + JSON.stringify(k)
              e.log(
                a + (', propertyName: ' + c + ', propertyType: ' + f),
                'WARN',
                'aodPropertyUnsupportedMessage',
              )
              b.triggerUnitCounter('aodPropertyUnsupportedMessage')
            }
            return d
          },
        }
      },
    )
    e.when('A', 'jQuery', 'all_offers_display_ingress_aod_supported').register(
      'all_offers_display_ingress_olp_hyperlink',
      function (b, a, c) {
        return {
          getOlpHyperlink: function (b) {
            if (b && b.$event && b.$event.target) {
              var d = b.$event.target
              if ('A' === d.nodeName && d.href) return d.href
              if (c.isPropertySupported(b.$event.target, 'closest', 'function'))
                return (b = d.closest('a')) ? b.href : null
              if ((b = a(d).closest('a'))) return b.attr('href')
            }
            return null
          },
        }
      },
    )
    e.when().register('all-offers-display-register-state', function () {
      var b = !1
      return {
        isMarkerOverrideRegistered: function () {
          return b
        },
        setMarkerOverrideTriggered: function () {
          b = !0
        },
      }
    })
    ;('use strict')
    e.when('A', 'mbc_constants', 'all_offers_display_ingress_csm_counters').register(
      'mbc_atc_cart_api_ajax_controller',
      function (b, a, c) {
        var f = h,
          d
        return {
          mbcAtcAjaxCall: function (d) {
            f
              ? c.incrementAndTriggerCounter(a.MBC_ATC_CLICK_CANCELLED_CSM_METRIC)
              : (f = b.$.ajax({
                  url: d.url,
                  type: d.type,
                  data: d.data,
                  cache: !1,
                  headers: d.headers,
                  xhrFields: d.xhrFields,
                  success: d.successHandler,
                  error: d.errorHandler,
                  timeout: d.timeout || 1e4,
                }))
          },
          updateCartCount: function (b) {
            e.when('EWC').execute(function (a) {
              d = a
            })
            d !== h && 'function' === typeof d.refresh
              ? (d.refresh(), c.triggerUnitCounter(a.MBC_EWC_REFRESH_API_CSM_METRIC_SCOPE_NAME))
              : (e.when('nav.setCartCount').execute(function (a) {
                  a(b)
                }),
                c.triggerUnitCounter(a.MBC_NAV_API_CSM_METRIC_SCOPE_NAME))
          },
          resetAjaxHandler: function () {
            f = h
          },
        }
      },
    )
    ;('use strict')
    e.when('A', 'mbc_constants', 'mbc_cart_api_handler').execute(
      'mbc_atc_action_handler',
      function (b, a, c) {
        b.declarative('mbc-atc-action', a.MBC_WIDGET_TRIGGER_EVENTS, function (a) {
          c.addToCart(a.data, !0)
        })
      },
    )
    ;('use strict')
    e.when(
      'A',
      'jQuery',
      'mbc_constants',
      'all_offers_display_ingress_csm_counters',
      'mbc_atc_cart_api_ajax_controller',
    ).register('mbc_cart_api_handler', function (b, a, c, e, d) {
      function f(b) {
        e.triggerUnitCounter(c.MBC_CART_API_ATC_CSM_FAILURE_METRIC_SCOPE_NAME)
        var d = b.offerIndex
        a(c.MBC_OFFER_ADDED_TO_CART + d).addClass(c.AUI_HIDE_ELEMENT_CSS_NAME)
        a(c.MBC_OFFER_NOT_ADDED_TO_CART + d).removeClass(c.AUI_HIDE_ELEMENT_CSS_NAME)
        g(b.offerIndex)
      }
      function g(b) {
        a(c.MBC_OFFER_VIEW_CART_BUTTON + b).removeClass(c.AUI_HIDE_ELEMENT_CSS_NAME)
        a(c.MBC_OFFER_ATC_BUTTON_ID + b).addClass(c.AUI_HIDE_ELEMENT_CSS_NAME)
      }
      return {
        addToCart: function (b, k) {
          var h = a(c.MBC_ATC_AJAX_ENDPOINT).val(),
            l = a(c.MBC_ATC_CSRF_TOKEN).val(),
            n = a(c.MBC_LANGUAGE_HEADER).val(),
            p = { items: [{ asin: b.asin, offerListingId: b.oid, quantity: b.minQty }] },
            q = document.querySelector('meta[name\x3d"encrypted-slate-token"]')
          h = {
            url:
              'https://' + h + '?ref\x3d' + b.refTag + '\x26sr\x3d' + b.sr + '\x26qid\x3d' + b.qid,
            type: 'POST',
            data: JSON.stringify(p),
            headers: {
              'Accept-Language': n,
              Accept: c.MBC_ATC_CART_API_HEADER_ACCEPT,
              'x-api-csrf-token': l,
              'Content-Type': c.MBC_ATC_CART_API_HEADER_CONTENT_TYPE,
              'x-amzn-encrypted-slate-token': q && q.content ? q.content : '',
            },
            xhrFields: { withCredentials: !0 },
            timeout: 1e4,
            successHandler: function (m) {
              m && m.entity && m.entity.items && m.entity.items[0] && 0 < m.entity.items[0].quantity
                ? (m.entity.count && m.entity.count.entity && m.entity.count.entity.items
                    ? d.updateCartCount(m.entity.count.entity.items)
                    : (e.triggerUnitCounter(c.MBC_CART_API_SUCCESS_COUNT_FAILURE_CSM_METRIC),
                      d.updateCartCount(m.entity.items[0].quantity)),
                  e.triggerUnitCounter(c.MBC_CART_API_ATC_CSM_SUCCESS_METRIC_SCOPE_NAME),
                  k &&
                    a(c.MBC_OFFER_ADDED_TO_CART + b.offerIndex).removeClass(
                      c.AUI_HIDE_ELEMENT_CSS_NAME,
                    ),
                  g(b.offerIndex))
                : f(b)
              d.resetAjaxHandler()
            },
            errorHandler: function (a) {
              422 === a.status &&
                (a = JSON.parse(a.responseText)) &&
                a.entity &&
                a.entity.items &&
                a.entity.items[0] &&
                (a.entity.count && a.entity.count.entity && a.entity.count.entity.items
                  ? d.updateCartCount(a.entity.count.entity.items)
                  : (e.triggerUnitCounter(c.MBC_CART_API_ERROR_COUNT_FAILURE_CSM_METRIC),
                    d.updateCartCount(a.entity.items[0].quantity)))
              f(b)
              d.resetAjaxHandler()
            },
          }
          d.mbcAtcAjaxCall(h)
        },
      }
    })
    e.register('mbc_constants', function () {
      return {
        MBC_ATC_AJAX_ENDPOINT: '#mbc-atc-ajax-endpoint',
        MBC_ATC_CSRF_TOKEN: '#mbc-atc-csrf-token',
        MBC_LANGUAGE_HEADER: '#mbc-language',
        MBC_OFFER_ADDED_TO_CART: '#mbc-offer-added-to-cart-',
        MBC_OFFER_NOT_ADDED_TO_CART: '#mbc-offer-not-added-to-cart-',
        MBC_OFFER_VIEW_CART_BUTTON: '#mbc-offer-view-cart-',
        MBC_OFFER_ATC_BUTTON_ID: '#mbc-buybutton-addtocart-',
        MBC_ATC_CLICK_CANCELLED_CSM_METRIC: 'mbc-atc-click-cancelled',
        MBC_ATC_CART_API_HEADER_ACCEPT:
          'application/vnd.com.amazon.api+json; type\x3d"cart.add-items/v1"',
        MBC_ATC_CART_API_HEADER_CONTENT_TYPE:
          'application/vnd.com.amazon.api+json; type\x3d"cart.add-items.request/v1"',
        MBC_NAV_API_CSM_METRIC_SCOPE_NAME: 'mbc-nav-api-called',
        MBC_EWC_REFRESH_API_CSM_METRIC_SCOPE_NAME: 'mbc-ewc-refresh-api-called',
        MBC_CART_API_SUCCESS_COUNT_FAILURE_CSM_METRIC:
          'mbc-cart-api-success-response-count-failure',
        MBC_CART_API_ERROR_COUNT_FAILURE_CSM_METRIC: 'mbc-cart-api-error-response-count-failure',
        MBC_CART_API_ATC_CSM_SUCCESS_METRIC_SCOPE_NAME: 'mbc-cart-api-atc-success',
        MBC_CART_API_ATC_CSM_FAILURE_METRIC_SCOPE_NAME: 'mbc-cart-api-atc-failure',
        MBC_WIDGET_TRIGGER_EVENTS: 'click',
        AUI_HIDE_ELEMENT_CSS_NAME: 'aok-hidden',
      }
    })
    'function' === typeof n && n('ld', 'aod-ingress-assets-load-time', { wb: 1 })
  })
})
/* ******** */
;(function (l) {
  var m = window.AmazonUIPageJS || window.P,
    h = m._namespace || m.attributeErrors,
    g = h ? h('DetailPageTwisterPlusSubAssets@utils', 'DetailPageTwisterPlusSubAssets') : m
  g.guardFatal
    ? g.guardFatal(l)(g, window)
    : g.execute(function () {
        l(g, window)
      })
})(function (l, m, h) {
  'use strict'
  l.when('A').register('twister-plus-constants', function (g) {
    return {
      ASIN: 'asin',
      PRICE: 'price',
      SAVINGS: 'savings',
      TOTAL_PRICE: 'totalPrice',
      YOU_SAVE: 'youSave',
      CASHBACK: 'cashback',
      PRICE_UNIT: 'priceUnit',
      OFFER_LISTING_ID: 'offerListingId',
      QUANTITY: 'quantity',
      TWISTER_REFRESH_EVENT: 'twister-refresh',
      CC_SELECTION_UPDATE_EVENT: 'cc-selection-update',
      TWISTER_PLUS_FRAMEWORK: 'TwisterPlusFramework',
      UNKNOWN: 'UNKNOWN',
      DEVICE_TYPE_WEB: 'web',
      DEFAULT_BUYING_OPTION_POSITION: 0,
      SPACE: ' ',
      OPENING_BRACKET: '(',
      CLOSING_BRACKET: ')',
      TP_AFTER_BUYBOX_UPDATE_EVENT: 'twisterPlus:selection:afterBuyBox:update',
      ATTRIBUTION: 'Website/ DetailPage/ TwisterPlus',
      DEFAULT_WEB_GROUP_NAME: 'desktop_buybox_group_1',
      DEFAULT_MOBILE_WEB_GROUP_NAME: 'mobile_buybox_group_1',
      DEFAULT_MOBILE_APP_GROUP_NAME: 'mobileapp_buybox_group_1',
      registrationMap: {
        CALLBACKS: 'callbacks',
        FEATURE_ATTRIBUTION: 'featureAttribution',
        IS_MULTI_SELECTION: 'isMultiSelection',
        UPDATE_QTY_AS_BASE_ITEM: 'updateQtyAsBaseItem',
        INCLUDE_SAVINGS_CALCULATION_IN_SUBTOTAL: 'includeSavingsCalculationInSubtotal',
        DISPLAY_SAVINGS_ROW_IN_BOTTOM_SHEET: 'displaySavingsRowInBottomSheet',
        BASE_ITEM_SAVINGS: 'baseItemSavings',
      },
      TWISTER_PLUS_VIEW_REGISTRATION: {
        viewAttribution: 'DetailPage',
        viewName: 'MobileTwisterPlusFramework',
      },
      ccManager: {
        FEATURE_NAME: 'ccManager',
        ACTIVE_CARDS: 'twisterPlusActiveCards',
        FEATURE_ATTRIBUTION: 'Website/ DetailPage/ TwisterPlus',
        UNSUPPORTED_BUYING_OPTION_LIST: ['ALM', 'SNS', 'UNKNOWN'],
      },
      itemAssociation: {
        KEY_BUYBACK: 'buyback',
        CUSTOM_NAME_STRING: 'custom-name',
        CUSTOM_VALUE_STRING: 'custom-value',
        CUSTOM_DATA_KEY: 'customData',
        INPUT_TYPE_HIDDEN: 'hidden',
        ENCODED_ITEM_ASSOC_VAL: 'encodedItemAssocVal',
        ITEM_ASSOCIATION_GROUP_KEY: 'ItemAssociationGroupKey',
        ITEM_ASSOCIATION_GROUP_VAL: 'itemAssociationGroup',
        ASIN_KEY: 'asin',
        QUANTITY_KEY: 'quantity',
        OFFERING_ID_KEY: 'offeringID',
        OFFER_LISTING_ID_KEY: 'offerListingId',
        FORM_DATA_ASIN_KEY: 'a',
        FORM_DATA_OID_KEY: 'oid',
        FIRST_INDEX: '.1',
        DEVICE_TYPE_MOBILE_WEB: 'mWeb',
        DEVICE_TYPE_MOBILE_APP: 'mApp',
        IS_BUYBACK_INPUT_FLAG: 'isBuyBack',
        IS_BUYBACK_INPUT_FLAG_VALUE: '1',
        PIPE_SEPARATOR: '|',
        FEATURE_NAME_KEY: 'featureName',
        BASE_ASIN_INDEX: 1,
        BASE_ASIN_INDEX_FOR_NATC: 0,
        BASE_ASIN_ITEM_TYPE: 'base',
        ITEMS_PREFIX: 'items',
        PARAM_NAMES: {
          ASIN: ['asin'],
          QUANTITY: ['quantity'],
          OFFER_LISTING_ID: ['offerListingId'],
          ITEM_ASSOCIATION: ['additionalParameters', 'itemAssociation'],
          ASSOCIATED_ITEM_ID: ['associatedItemId'],
          DELETE_CONSTRAINT: ['deleteConstraint', 'mutuallyInclusive'],
          PROGRAM_TYPE: ['programType'],
          RENDER_TYPE: ['renderType'],
          ACCESSORY_TYPE: ['properties', 'accessoryType'],
          CUSTOMER_APPOINTMENT_TYPE: ['properties', 'customerAppointmentType'],
          paymentOfferInfo: ['additionalParameters', 'paymentOfferInfo'],
          inHouseInstallments: ['additionalParameters', 'installments', 'programId'],
          buybackOfferSelectionKey: ['additionalParameters', 'buybackOfferSelectionKey'],
          wirelessPromotionId: ['additionalParameters', 'wirelessPromotionId'],
        },
        OPENING_SQUARE_BRACKET: '[',
        CLOSING_SQUARE_BRACKET: ']',
      },
      htmlTags: { INPUT: 'input', FIELDSET: 'fieldset' },
      selectors: {
        DECLARATIVE_CLASS: '.a-declarative',
        BUYBOX_ACCORDION: '#buybox .a-accordion',
        BUYBOX_ACCORDION_ACTIVE: '#buybox .a-accordion-active',
        BUYBOX: '#buybox',
        ACTIVE_ACCORDION: '.a-accordion-active',
        ACCORDION: '.a-accordion',
        TAB_PREFIX: '#tab_',
        BUYBOX_TAB_ACTIVE: '#buybox .a-tab-heading.a-active',
        NO_TABS_GROUP_DESKTOP: '#buybox div:first-child',
        NO_TABS_GROUP_MOBILE: '#buybox div:first-child div:first-child',
        TAB_GROUP_NAME: 'data-csa-c-content-id',
        OFFER_DISPLAY_GROUP: '#offerDisplayGroup',
        MOBILEAPP_TABS_ELEMENT_ID: '[id^\x3dtab_mobileapp_buybox_group]',
        MOBILEAPP_ACCORDION_OR_SINGLEOFFER_ELEMENT_ID:
          '.accordion-row, [id^\x3dgsod_singleOfferDisplay]',
        BUYNOW_ELEMENT_ID: 'form#buyNow, form#buyNowCheckout',
        BUYNOW_CHECKOUT_ELEMENT_ID: '#buyNowCheckout',
        BUYNOW_BUTTON_ID: '#buy-now-button',
        ADD_TO_CART_BUTTON_ID:
          '#add-to-cart-button, #installments-button, #add-to-cart-button-ubb-mobile, #pickup-add-to-cart-button',
        ADD_TO_CART_ELEMENT_ID: '#addToCart, #mobile-installments',
        ITEM_ASSOCIATION_INPUTS_CLASS: '.itemAssocInputs',
        ITEM_ASSOCIATION_INPUTS_CLASS_NAME: 'itemAssocInputs',
        DATA_ATTRIBUTE_ACTION: 'action',
        PPD_RIGHT_COL_ID: '#rightCol',
        BUYING_OPTIONS_PRICE_DATA_CLASS: '.twister-plus-buying-options-price-data',
        ACCORDION_ROW_CLASS: '.accordion-row',
      },
      ccFeatures: {
        PAYMENT_OPTIONS_FEATURE: 'paymentOptions',
        PAYMENT_OPTIONS_BUY_NOW_CART_TYPE: 'BUY_NOW',
        PAYMENT_OPTIONS_ATC_CART_TYPE: 'ADD_TO_CART',
        WIRELESS_PROMOTIONS_FEATURE: 'wirelessPromotions',
        CART_TYPE: 'cartType',
        IS_BUYBACK_KEY: 'isBuyBackKey',
        IS_BUYBACK_FEE: 'isBuyBackFee',
        BUY_NOW_DATA: 'buynowData',
        COUPONS_FEATURE: 'couponsCard',
        PAYMENT_OFFER_INPUT_NAME: 'paymentOfferInfo',
      },
      bottomSheet: {
        FEATURE_NAME: 'bottomSheet',
        EVENT_NAME: 'cc-selection-update',
        FEATURE_ATTRIBUTION: 'Website/ DetailPage/ TwisterPlus',
        BOTTOM_SHEET_NAME: 'twisterPlusBottomSheet',
        RESIZE_DURATION: 0.3,
        BOTTOM_SPACING: 21,
        ITEM_COUNT_SINGULAR_TEMPLATE: 'item-count-singular-template',
        ITEM_COUNT_PLURAL_TEMPLATE: 'item-count-plural-template',
        ITEM_COUNT_PLACEHOLDER: '###itemQuantity',
        DEFAULT_DISCOUNT_STRING: 'default-discount-string',
        MONTHLY_PAYMENTS_FOOTNOTE_TEMPLATE: 'monthly-payment-footnote-template',
      },
      unavailableMessage: {
        ACTIVE_ACCORDION: '.a-accordion-active',
        CLASS: '.',
        DISPLAYABLE_MESSAGE: 'tp-bbm-info-message-displayable',
        HIDDEN: 'aok-hidden',
        MESSAGE_ITEM: 'twister-plus-unavailable-message-item',
        MULTIPLE: '.tp-bbm-info-message-container',
        SINGLE: '.tp-bbm-info-message-with-card-name-container',
        TEMPLATE: 'twister-plus-unavailable-message-item-template',
        QUANTITY_RESTRICTION: '.tp-bbm-info-message-quantity-restriction-container',
        BUYBOX_ACCORDION_ROWS: '#buyBoxAccordion',
      },
      sideSheet: {
        FEATURE_NAME: 'sideSheet',
        EVENT_NAME: 'cc-selection-update',
        FEATURE_ATTRIBUTION: 'Website/ DetailPage/ TwisterPlus',
        RESIZE_DURATION: 300,
        SYMBOL_HASH: '#',
        DISPLAY: 'display',
        INLINE: 'inline',
        CAROUSEL_CONTAINER_CLASS: '.a-carousel-container',
        CAROUSEL_CONTAINER_CLASS_NAME: 'a-carousel-container',
        CAROUSEL_INITIALIZED_CLASS_NAME: 'a-carousel-initialized',
        CAROUSEL_NOT_INITIALIZED_CLASS_NAME: 'a-carousel-static',
        SIDE_SHEET_AJAX_SUCCESS: 'twister-plus:side-sheet:ajax:success',
      },
      ccCardsRefresh: {
        SINGLE_CARD_INVALID: 'single-card-invalid-message',
        SINGLE_SELECTION_INVALID: 'single-selection-invalid-message',
        SINGLE_DETAILS_UPDATE: 'single-details-update-message',
        MULTIPLE_DETAILS_UPDATE_OR_CARD_REFRESH: 'multiple-details-update-or-cards-refresh-message',
        MULTIPLE_CARD_INVALID_OR_SELECTION_INVALID:
          'multiple-card-invalid-or-selection-invalid-message',
        CARD_NAME_PLACEHOLDER: '###cardName',
      },
      metrics: {
        CC_CARD_COUNT: 'ccCardCount',
        TWISTER_PLUS_TTI: 'TTI',
        BOTTOM_SHEET_GV: 'priceBottomSheetGV',
        BOTTOM_SHEET_TIMER: 'priceBottomSheetTimer',
        CC_REMOVAL: 'ccRemoval',
        CC_SELECTION: 'ccSelection',
        PREFIX: 'twisterPlus.',
        FEATURE_NAME: 'twisterPlus',
        TWISTER_PLUS_TWISTER_REFRESH_GV: 'twisterPlusTwisterRefreshGV',
      },
      toolTip: {
        FEATURE_NAME: 'toolTip',
        EVENT_NAME: 'cc-selection-update',
        FEATURE_ATTRIBUTION: 'Website/ DetailPage/ TwisterPlus',
        TOOL_TIP_NAME: 'twisterPlusPopOver',
        ITEM_COUNT_SINGULAR_TEMPLATE: 'item-count-singular-template',
        ITEM_COUNT_PLURAL_TEMPLATE: 'item-count-plural-template',
        ITEM_COUNT_PLACEHOLDER: '###itemQuantity',
        MONTHLY_PAYMENTS_FOOTNOTE_TEMPLATE: 'monthly-payment-footnote-template',
      },
    }
  })
  ;('use strict')
  l.when('A').register('twister-plus-preconditions', function (g) {
    return {
      isTwisterPlusEligible: function () {
        return 'true' === g.$('#twister-plus-eligible').val()
      },
      isCcCardsRendered: function () {
        return 'true' === g.$('#ccCardsRendered').val()
      },
    }
  })
  ;('use strict')
  l.when('A', 'twister-plus-constants').register('utils', function (g, e) {
    var f = g.$,
      c = {},
      d = e.selectors
    c.isEmpty = function (a) {
      for (var b in a) if (a.hasOwnProperty(b)) return !1
      return !0
    }
    c.capitalizeFirstLetter = function (a) {
      return a.charAt(0).toUpperCase() + a.slice(1)
    }
    c.convertHTMLDataAttributesToKeys = function (a) {
      a = a.split('-')
      for (var b = a[0], k = 1; k < a.length; k++) b += c.capitalizeFirstLetter(a[k])
      return b
    }
    c.getBaseItemQuantity = function (a) {
      var b
      a = this.getDeviceType()
      var k,
        e = c.getActiveGroupName(),
        g = f(d.BUYBOX_TAB_ACTIVE)
      k =
        1 === g.length
          ? f(d.TAB_PREFIX + e + ' ' + d.ACTIVE_ACCORDION)
          : f(d.BUYBOX_ACCORDION_ACTIVE)
      var h
      if ('web' === a) {
        if (1 === k.length) return f('.a-accordion-active #quantity').val()
        h = 1 === g.length ? d.TAB_PREFIX + e + ' #quantity' : '#quantity'
      } else
        f('#mobileQuantityDropDown').length &&
          (1 === k.length
            ? (b = f('.a-accordion-active select.mobileQuantityDropDown').val())
            : (h =
                1 === g.length
                  ? d.TAB_PREFIX + e + ' #mobileQuantityDropDown'
                  : '#mobileQuantityDropDown'))
      f(h).length && (b = f(h).val())
      return b
    }
    c.getDeviceType = function () {
      var a = f('#twister-plus-device-type').val()
      return 'web' === a ? 'web' : 'mobile' === a ? 'mWeb' : 'mApp'
    }
    c.isMbbCheckboxChecked = function () {
      return 0 < f('input[id|\x3dmbb-checkbox-input]').filter(':checked').length
    }
    c.isFeatureSelectionPresent = function (a) {
      var b = !1,
        c
      for (c in a)
        if (0 < a[c].length) {
          b = !0
          break
        }
      return b
    }
    c.isValidNumber = function (a) {
      var b = !1
      null === a || isNaN(a) || (b = !0)
      return b
    }
    c.getBuyingOptionPosition = function (a) {
      var b = e.DEFAULT_BUYING_OPTION_POSITION
      1 === f(d.BUYBOX_TAB_ACTIVE).length
        ? (a === h && (a = c.getActiveGroupName()),
          (a = f(d.BUYBOX + ' ' + d.TAB_PREFIX + a + ' ' + d.ACTIVE_ACCORDION)))
        : (a = f(d.BUYBOX_ACCORDION_ACTIVE))
      a.length && (b = a.index())
      return b
    }
    c.getBuyingOptionPriceDataMap = function () {
      var a,
        b = f(d.BUYING_OPTIONS_PRICE_DATA_CLASS).html()
      if (b)
        try {
          a = JSON.parse(b)
        } catch (c) {
          l.log(
            'Error ( ' + c + ' ) while parsing twister plus price json: ' + b,
            'ERROR',
            e.TWISTER_PLUS_FRAMEWORK,
          )
        }
      return a
    }
    c.getActiveGroupName = function () {
      var a
      a = f(d.BUYBOX_TAB_ACTIVE)
      var b = this.getDeviceType()
      1 !== a.length && (a = 'web' === b ? f(d.NO_TABS_GROUP_DESKTOP) : f(d.NO_TABS_GROUP_MOBILE))
      a = a.attr(d.TAB_GROUP_NAME)
      ;(a && -1 !== a.indexOf('_buybox_group')) ||
        (b === e.DEVICE_TYPE_WEB
          ? (a = e.DEFAULT_WEB_GROUP_NAME)
          : b === e.itemAssociation.DEVICE_TYPE_MOBILE_WEB
            ? (a = e.DEFAULT_MOBILE_WEB_GROUP_NAME)
            : b === e.itemAssociation.DEVICE_TYPE_MOBILE_APP &&
              (a = e.DEFAULT_MOBILE_APP_GROUP_NAME))
      return a
    }
    c.getBuyingOptionType = function (a, b) {
      b === h && (b = c.getActiveGroupName())
      var k,
        d = c.getBuyingOptionPriceDataMap()
      d &&
        (Array.isArray(d)
          ? d && d[a] && (k = d[a].buyingOptionType)
          : ((b = d[b]),
            b === h && (b = d[Object.keys(d)[0]]),
            b !== h && b[a] !== h && (k = b[a].buyingOptionType)))
      return k
    }
    c.getAAPIBuyingOptionIndex = function (a, b) {
      b === h && (b = c.getActiveGroupName())
      var d,
        e = c.getBuyingOptionPriceDataMap()
      e &&
        ((b = e[b]),
        b === h && (b = e[Object.keys(e)[0]]),
        b !== h && b[a] !== h && (d = b[a].aapiBuyingOptionIndex))
      return d
    }
    c.getAccordionRowBuyingOptionType = function (a, b) {
      var d
      a.length && ((a = a.index()), (d = c.getBuyingOptionType(a, b)))
      return d
    }
    c.getActiveAccordionRow = function (a, b) {
      if (c.isValidNumber(a)) {
        var k,
          g = f(d.BUYBOX_TAB_ACTIVE)
        1 === g.length
          ? (b === h && (b = c.getActiveGroupName()),
            (k = f(d.TAB_PREFIX + b + ' ' + e.unavailableMessage.BUYBOX_ACCORDION_ROWS)))
          : (k = f(e.unavailableMessage.BUYBOX_ACCORDION_ROWS))
        if (1 === k.length) return k.children().eq(a)
        if (1 === g.length) return f(d.TAB_PREFIX + b)
      }
      return null
    }
    return c
  })
  l.when('twister-plus-constants').register('twister-plus-logger-service', function (g) {
    function e(c, d) {
      if (c !== h && '' !== c)
        (c = g.metrics.PREFIX + c),
          ue &&
            ue.count &&
            (d === h && (d = (ue.count(c) || 0) + 1),
            ue.count(c, d),
            'undefined' != typeof m.csa &&
              ((d = ue.count(c)),
              m.csa('Events', { producerId: 'dp-rpcx' })(
                'log',
                { schemaId: 'dpRpcx.CSALoggingSchema.5', eventName: c, valueToLog: d },
                { ent: 'all' },
              )))
      else throw Error('counterKey must be non empty string')
    }
    function f(c) {
      if (c !== h && '' !== c) (this._timerName = c), (this._startTime = 0)
      else throw Error('timerName must be non empty string')
    }
    f.prototype = {
      start: function () {
        this._startTime = Date.now()
      },
      stop: function () {
        this._startTime && e(this._timerName, Date.now() - this._startTime)
      },
    }
    return { Timer: f, logCounter: e }
  })
  ;('use strict')
  l.when('A', 'twister-plus-logger-service', 'ready').execute(
    'adaptive-experience-metrics-logger',
    function (g, e) {
      function f() {
        var a = c('#twister-plus-card .a-expander-container')
        return a && 0 < a.length && 'twister-plus-expander' === a.data('aExpanderName') ? !0 : !1
      }
      try {
        var c = g.$
        f() &&
          (e.logCounter('TwisterPlusCollapsed.GV'),
          g.on('a:expander:twister-plus-expander:toggle:expand', function (a) {
            e.logCounter('TwisterPlusExpanded.Action')
          }),
          g.on('a:expander:twister-plus-expander:toggle:collapse', function (a) {
            e.logCounter('TwisterPlusCollapsed.Action')
          }))
        var d = c('#short-title-rendered'),
          a = c('#title_feature_div'),
          b = 0 < a.length ? a.height() : 0
        0 < b &&
          (0 < d.length && 'true' === d.val()
            ? (e.logCounter('ShortTitle.height', b), e.logCounter('ShortTitle.GV'))
            : (e.logCounter('Title.height', b), e.logCounter('Title.GV')))
      } catch (k) {
        l.log(
          'Adaptive Experience metric logging failed with error: ( ' + k + ' )',
          'ERROR',
          'TwisterPlusAdaptiveExperience',
        )
      }
    },
  )
  ;('use strict')
  l.when(
    'A',
    'dp-time-to-interactive',
    'twister-plus-logger-service',
    'twister-plus-constants',
    'ready',
    'twister-plus-init',
  ).register('twister-plus-tti-logger', function (g, e, f, c) {
    function d() {
      var a = c.metrics,
        b = e.getTimeToInteractivity({ twisterPlus: { name: 'twisterPlus' } })
      if (b && b.interactiveTime) {
        var d = m.performance
        'object' === typeof d &&
          'object' === typeof d.timing &&
          f.logCounter(a.TWISTER_PLUS_TTI, b.interactiveTime - d.timing.navigationStart)
      }
    }
    d()
    return { logTTI: d }
  })
})
/* ******** */
;(function (h) {
  var C = window.AmazonUIPageJS || window.P,
    g = C._namespace || C.attributeErrors,
    c = g
      ? g('DetailPageTwisterPlusSubAssets@twisterPlusFramework', 'DetailPageTwisterPlusSubAssets')
      : C
  c.guardFatal
    ? c.guardFatal(h)(c, window)
    : c.execute(function () {
        h(c, window)
      })
})(function (h, C, g) {
  'use strict'
  h.when('A').register('turbo-checkout-handler', function (c) {
    var d = c.$,
      g
    return {
      updateInputCheckbox: function (c) {
        var p
        c = c.ccFeaturesState
        var q = !1
        for (p in c)
          if (0 < c[p].length) {
            q = !0
            break
          }
        p = q
        g = d('#twister-plus-checkbox')
        c = g.prop('checked')
        p && !c ? g.prop('checked', 'true').trigger('change') : !p && c && g.click()
      },
    }
  })
  ;('use strict')
  h.when('A', 'twister-plus-constants').register(
    'twister-plus-feature-registration',
    function (c, d) {
      var g = {},
        y = [d.TWISTER_REFRESH_EVENT, d.CC_SELECTION_UPDATE_EVENT]
      ;(function () {
        for (var d = 0; d < y.length; d++) g[y[d]] = []
      })()
      return {
        registerFeature: function (d, c, f) {
          var r
          r = !0
          ;(d.hasOwnProperty('featureName') && d.hasOwnProperty('featureAttribution')) ||
            ((r = !1),
            h.log(
              'Feature Registration does not contain valid featureName or featureAttribution',
              'ERROR',
              d.featureName + ': ' + d.featureAttribution,
            ))
          r &&
            ((r = !0),
            -1 === y.indexOf(c) &&
              (h.log(
                'Feature passed invalid event name while registering to Twister+: ' + c,
                'ERROR',
                d.featureName + ': ' + d.featureAttribution,
              ),
              (r = !1)))
          if (r) {
            r = d.featureName
            for (var a = !1, l = 0; l < g[c].length; l++)
              if (g[c][l].featureName === r) {
                a = !0
                break
              }
            a
              ? h.log('Feature already registered to TwisterPlus for the event: ' + c, 'ERROR', r)
              : ((a = {}),
                (a.featureName = r),
                (a.featureAttribution = d.featureAttribution),
                (a.callback = f),
                g[c].push(a))
          }
        },
        callRegisteredFeaturesCallback: function (d) {
          for (var c = 0; c < g[d].length; c++) g[d][c].callback.apply()
        },
      }
    },
  )
  ;('use strict')
  h.when(
    'A',
    'twister-plus-feature-state',
    'twister-plus-feature-registration',
    'twister-plus-constants',
    'priceUpdate',
    'itemAssociation',
    'buy-box-price-update',
    'twister-plus-unavailable-message',
    'turbo-checkout-handler',
    'utils',
  ).register('twister-plus-framework', function (c, d, x, y, p, q, f, r, a, l) {
    function u() {
      var b = l.getBuyingOptionPriceDataMap(),
        I = e
      if (b) {
        var a = w
        if (Array.isArray(b))
          return (
            b[a] === g &&
              h.log(
                'Buying option data missing for the selected offer at position: ' +
                  JSON.stringify(a),
                'FATAL',
                y.TWISTER_PLUS_FRAMEWORK,
              ),
            b[a]
          )
        var d = b[I]
        d === g && (d = b[Object.keys(b)[0]])
        if (d === g || d[a] === g)
          h.log(
            'Buying option data missing for the selected offer at position: ' +
              JSON.stringify(a) +
              ' and groupName: ' +
              JSON.stringify(I),
            'FATAL',
            y.TWISTER_PLUS_FRAMEWORK,
          )
        else return d[a]
      }
    }
    function v() {
      e = l.getActiveGroupName()
      w = l.getBuyingOptionPosition(e)
      D = H()
      A = K()
      var b = c.$('#twister-plus-asin')
      F = b ? b.val() : g
      d.initialize(k())
    }
    function t() {
      E(document).delegate('#quantity', 'change', function (b) {
        b = J()
        G = !0
        d.updateTwisterPlusFeatureStateForQuantity(b, z)
        m()
        G = !1
      })
    }
    function H() {
      var b = u()
      if (b) return { price: b.priceAmount, savings: 0, priceUnit: b.currencySymbol }
      var b = (b = c.$('#twister-plus-price-data-price')) ? b.val() : g,
        e = c.$('#twister-plus-price-data-savings'),
        e = e ? e.val() : g,
        a = c.$('#twister-plus-price-data-price-unit'),
        a = a ? a.val() : g
      return { price: parseFloat(b), savings: parseFloat(e), priceUnit: a }
    }
    function K() {
      var b = u()
      return b ? b.offerListingId : (b = c.$('#twister-plus-offer-listing-id')) ? b.val() : g
    }
    function k() {
      var b = B(),
        a = {}
      a[n.TOTAL_PRICE] = D.price
      a[n.YOU_SAVE] = D.savings
      return { twisterState: b, priceData: a, currentBuyingOptionPosition: w, currentGroupName: e }
    }
    function B() {
      var b = {}
      b[n.ASIN] = F
      b[n.PRICE] = D.price
      b[n.SAVINGS] = D.savings
      b[n.PRICE_UNIT] = D.priceUnit
      b[n.OFFER_LISTING_ID] = A
      b[n.QUANTITY] = J()
      return b
    }
    function J() {
      var b = l.getBaseItemQuantity()
      b === g && (b = 1)
      return b
    }
    function m() {
      D = H()
      A = K()
      d.setTwisterState(B())
      var b = d.getTwisterPlusFeaturesState(),
        I = p.getTotalPriceAndYouSave(b, z)
      d.updatePriceData(I)
      d.updateCurrentBuyingOptionPosition(w)
      d.updateGroupName(e)
      f.updatePriceSubtotalFeature(b)
      r.update(d)
      l.getBuyingOptionType(w, e) === y.UNKNOWN ||
        (G && !l.isFeatureSelectionPresent(d.getCCFeaturesState())) ||
        q.addItemAssociationBundleData(d.getTwisterPlusFeaturesState(), !0)
      x.callRegisteredFeaturesCallback(n.CC_SELECTION_UPDATE_EVENT)
      a.updateInputCheckbox(b)
    }
    var n = y,
      D,
      A,
      F,
      E = c.$,
      z,
      G = !1,
      w,
      e
    return {
      initializeTwisterPlus: function () {
        v()
        t()
      },
      refreshTwisterPlusData: function () {
        v()
        t()
        x.callRegisteredFeaturesCallback(n.TWISTER_REFRESH_EVENT)
      },
      ccSelectionFetch: function (b) {
        return d.getCCFeaturesState()[b]
      },
      ccRemovedSelectionFetch: function (b) {
        return d.getCCRemovedSelections()[b]
      },
      ccSelectionUpdate: function (b, e) {
        b = d.updateCCFeatureState(b, e, z)
        m()
        return b
      },
      ccRemovedSelectionUpdate: function (b, e) {
        b = d.updateCCRemovedSelections(b, e)
        m()
        return b
      },
      ccSelectionsClear: function (b) {
        b = d.clearCCFeatureSelections(b)
        m()
        return b
      },
      ccRemovedSelectionsClear: function (b) {
        b = d.clearCCRemovedSelections(b)
        m()
        return b
      },
      setFeatureRegistrationMap: function (b) {
        z = b
      },
      setCurrentBuyingOptionPosition: function (b) {
        w = b
        d.updateCurrentBuyingOptionPosition(b)
        q.reInitialiseItemCountVal()
      },
      setCurrentGroupName: function (b) {
        e = b
        d.updateGroupName(b)
        q.reInitialiseItemCountVal()
      },
      getCurrentBuyingOptionPosition: function () {
        return w
      },
      getCurrentGroupName: function () {
        return e
      },
      updateTwisterPlusComponents: function () {
        m()
      },
      getTwisterPlusState: function () {
        return c.copy(d.getTwisterPlusFeaturesState())
      },
      registerFeature: function (b, e, a) {
        try {
          'function' === typeof a
            ? x.registerFeature(b, e, a)
            : h.log(
                'Registering function should provide callback as a function',
                'ERROR',
                b.featureName,
              )
        } catch (d) {
          C.ueLogError &&
            C.ueLogError(d, {
              logLevel: 'ERROR',
              attribution: b.featureName,
              message:
                'TwisterPlus Framework: Error caused by the feature: ' +
                b.featureName +
                ' (C/T/I: ' +
                b.featureAttribution +
                ') while registering to TwisterPlus to listen to ' +
                e +
                ' event' +
                d,
            })
        }
      },
    }
  })
  h.when(
    'A',
    'twister-plus-framework',
    'twister-plus-constants',
    'twister-plus-logger-service',
    'utils',
  ).register('cc-manager', function (c, d, x, y, p) {
    function q(e) {
      return k[e].hasOwnProperty(m.IS_MULTI_SELECTION) && k[e][m.IS_MULTI_SELECTION]
    }
    function f(e) {
      var b = n.indexOf(e)
      if (-1 !== b && b !== n.length - 1 && ((b = r(b)), !(0 > b))) {
        var a = B('.cc-card-' + e)
        e = n[b]
        var d = k[e] && k[e].callbacks
        setTimeout(function () {
          a[0] && B('html, body').animate({ scrollTop: a.offset().top }, 500)
          d && d.hasOwnProperty('cardExpand') && d.cardExpand()
        }, 800)
      }
    }
    function r(e) {
      var b = p.getActiveGroupName(),
        a = p.getBuyingOptionPosition(b),
        d = p.getBuyingOptionType(a, b),
        c = B(x.selectors.BUYBOX_TAB_ACTIVE),
        l = p.getAAPIBuyingOptionIndex(a, b)
      for (e += 1; e < n.length; e++) {
        var f = n[e]
        if ((f = k[f] && k[f].callbacks) && f.hasOwnProperty('isBuyingOptionUnsupported')) {
          if (!f.isBuyingOptionUnsupported(a, d, 1 === c.length ? b : g, l !== g ? l : a)) return e
        } else return e
      }
      return -1
    }
    function a(e, b) {
      z = d.getTwisterPlusState()
      b = d.ccSelectionUpdate(e, b)
      d.ccRemovedSelectionsClear(e)
      return b
    }
    function l(e) {
      z = d.getTwisterPlusState()
      return d.ccSelectionsClear(e)
    }
    function u(e) {
      var b = !0,
        a = e
      n = v()
      k.hasOwnProperty(e)
        ? -1 === n.indexOf(e) &&
          ((b = !1),
          (a = k[e][m.FEATURE_ATTRIBUTION]),
          h.log('CC selection update called for non rendered feature', 'ERROR', a))
        : ((b = !1), h.log('CC selection update called for unregistered feature', 'ERROR', a))
      return b
    }
    function v() {
      var e = B('#twister-plus-active-cards'),
        e = e.length ? e.val() : ''
      return (e = e.trim()) ? e.split(',') : []
    }
    function t(e, b) {
      var a = {},
        d
      for (d in n) {
        var c = n[d]
        if (c !== b && k.hasOwnProperty(c)) {
          var l = k[c]
          l[m.CALLBACKS].hasOwnProperty('refreshCard') &&
            ((l = l[m.CALLBACKS].refreshCard(e, b)),
            'NO_CHANGE' !== l &&
              e.ccFeaturesState[c] !== g &&
              0 < e.ccFeaturesState[c].length &&
              (a[l] === g && (a[l] = []), a[l].push(c)))
        }
      }
      e = k[b][m.CALLBACKS]
      c = Object.keys(a).length
      if (e.hasOwnProperty('ccCardsRefreshNotification') && 0 < c) {
        var f
        b = B('#tp-cc-cards-refresh-strings')
        d = !0
        if (1 === c)
          if (((c = Object.keys(a)[0]), (a = a[c]), 1 === a.length)) {
            switch (c) {
              case 'CARD_INVALID':
                f = b.data(A.SINGLE_CARD_INVALID)
                break
              case 'SELECTION_INVALID':
                f = b.data(A.SINGLE_SELECTION_INVALID)
                break
              case 'DETAILS_UPDATE':
                ;(f = b.data(A.SINGLE_DETAILS_UPDATE)), (d = !1)
            }
            f = f.replace(A.CARD_NAME_PLACEHOLDER, a[0])
          } else
            switch (c) {
              case 'CARD_INVALID':
                f = b.data(A.MULTIPLE_CARD_INVALID_OR_SELECTION_INVALID)
                break
              case 'SELECTION_INVALID':
                f = b.data(A.MULTIPLE_CARD_INVALID_OR_SELECTION_INVALID)
                break
              case 'DETAILS_UPDATE':
                ;(f = b.data(A.MULTIPLE_DETAILS_UPDATE_OR_CARD_REFRESH)), (d = !1)
            }
        else 1 < c && (f = b.data(A.MULTIPLE_DETAILS_UPDATE_OR_CARD_REFRESH))
        a = d
          ? B('#tp-cc-cards-refresh-red-notification')
          : B('#tp-cc-cards-refresh-green-notification')
        a.find('.a-alert-content').text(f)
        f = a.html()
        e.ccCardsRefreshNotification(f)
      } else
        0 < c &&
          h.log(
            'Feature callback ccCardsRefreshNotification() missing for the feature',
            'ERROR',
            k[b][m.FEATURE_ATTRIBUTION],
          )
    }
    function H(e, b, a) {
      for (var d in n) {
        var c = n[d]
        if (c !== a && k.hasOwnProperty(c)) {
          var f = k[c]
          f[m.CALLBACKS].hasOwnProperty('restorePreviousSelection') &&
            f[m.CALLBACKS].restorePreviousSelection(e.ccFeaturesState[c], b.ccFeaturesState[c], a)
        }
      }
    }
    function C(e, b) {
      var a = !1
      if (E && E === e && z.ccFeaturesState !== g && z.ccFeaturesState[E] !== g)
        if ('SELECTION_CLEAR_ITEM_DATA' === b) a = 0 === z.ccFeaturesState[E].length ? !0 : !1
        else {
          e = z.ccFeaturesState[E]
          for (var d = b.itemType, c = 0; c < e.length; c++) {
            var f = e[c].itemType
            if (f === d && e[c][f] === b[d]) {
              a = !0
              break
            }
          }
        }
      return a
    }
    var k = {},
      B = c.$,
      J = x.ccManager,
      m = x.registrationMap,
      n,
      D = x.metrics,
      A = x.ccCardsRefresh,
      F,
      E,
      z,
      G = '',
      w
    return {
      registerFeature: function (e, b) {
        var a = !0
        ;(e.hasOwnProperty('featureName') && e.hasOwnProperty(m.FEATURE_ATTRIBUTION)) ||
          (h.log(
            'Properties missing in feature registration passed',
            'ERROR',
            e.featureAttribution || e.featureName,
          ),
          (a = !1))
        a &&
          ((a = !0),
          (b.hasOwnProperty('init') && b.hasOwnProperty('validateInputParams')) ||
            (h.log(
              'Functions missing in callbacks passed',
              'ERROR',
              e.featureAttribution || e.featureName,
            ),
            (a = !1)),
          a &&
            ((a = e.featureName),
            (k[a] = {}),
            (k[a][m.CALLBACKS] = b),
            (k[a][m.FEATURE_ATTRIBUTION] = e.featureAttribution),
            (k[a][m.IS_MULTI_SELECTION] = e.isMultiSelection),
            (k[a][m.UPDATE_QTY_AS_BASE_ITEM] = e.updateQtyAsBaseItem),
            (k[a][m.BASE_ITEM_SAVINGS] = e.baseItemSavings),
            (k[a][m.DISPLAY_SAVINGS_ROW_IN_BOTTOM_SHEET] = e.displaySavingsRowInBottomSheet),
            (k[a][m.INCLUDE_SAVINGS_CALCULATION_IN_SUBTOTAL] =
              e.includeSavingsCalculationInSubtotal),
            b.init()))
      },
      ccSelectionUpdate: function (e, b, c) {
        var l = !1
        if (u(e))
          if (k[e][m.CALLBACKS].validateInputParams(b)) {
            if ('T2' === w || 'T3' === w) if ((f(e), c)) return
            C(e, b)
              ? ((l = a(e, b)), H(d.getTwisterPlusState(), z, e))
              : ((E = e), (l = a(e, b)), t(d.getTwisterPlusState(), e))
            b = q(e)
            G === x.DEVICE_TYPE_WEB &&
              l &&
              !b &&
              ((b = k[e][m.CALLBACKS]),
              b.hasOwnProperty('cardCollapse')
                ? b.cardCollapse()
                : h.log(
                    'Feature callback cardCollapse() missing for the feature',
                    'ERROR',
                    k[e][m.FEATURE_ATTRIBUTION],
                  ))
          } else
            h.log('Validation failed for the passed itemData', 'ERROR', k[e][m.FEATURE_ATTRIBUTION])
        return l
      },
      ccRemovedSelectionUpdate: function (a, b) {
        var c = !1
        u(a) &&
          (k[a][m.CALLBACKS].validateInputParams(b)
            ? (c = d.ccRemovedSelectionUpdate(a, b))
            : h.log(
                'Validation failed for the passed itemData',
                'ERROR',
                k[a][m.FEATURE_ATTRIBUTION],
              ))
        return c
      },
      ccSelectionsClear: function (a, b) {
        var c = !1
        u(a) &&
          (!b || ('T2' !== w && 'T3' !== w) || f(a),
          C(a, 'SELECTION_CLEAR_ITEM_DATA')
            ? ((c = l(a)), H(d.getTwisterPlusState(), z, a))
            : ((E = a), (c = l(a)), t(d.getTwisterPlusState(), a)))
        return c
      },
      ccRemovedSelectionsClear: function (a) {
        var b = !1
        u(a) && (b = d.ccRemovedSelectionsClear(a))
        return b
      },
      getFeatureRegistrationDetails: function () {
        return k
      },
      init: function () {
        G = p.getDeviceType()
        n = v()
        d.setFeatureRegistrationMap(k)
        for (var a in n) {
          var b = n[a]
          k.hasOwnProperty(b) && k[b][m.CALLBACKS].init()
        }
        y.logCounter(D.CC_CARD_COUNT, n.length)
        if ((a = B('[data-wireless-multi-card]').data('wireless-multi-card')))
          w = a.enhancementTreatment
      },
      getRenderedFeaturesList: v,
      cardExpanded: function (a) {
        var b = u(a),
          d = F
        b &&
          (c.trigger('twisterPlus-removeCCCardNotification'),
          d && d !== a
            ? ((F = a),
              (a = k[d][m.CALLBACKS]),
              a.hasOwnProperty('cardCollapse')
                ? 'T3' !== w && a.cardCollapse()
                : h.log(
                    'Feature callback cardCollapse() missing for the feature',
                    'ERROR',
                    k[d][m.FEATURE_ATTRIBUTION],
                  ))
            : (F = a))
      },
      switchBuyingOption: function (a, b) {
        var c = p.getBuyingOptionType(a, b)
        d.setCurrentBuyingOptionPosition(a)
        d.setCurrentGroupName(b)
        var f = B(x.selectors.BUYBOX_TAB_ACTIVE),
          l = p.getAAPIBuyingOptionIndex(a, b),
          v
        for (v in n) {
          var h = n[v]
          if (k.hasOwnProperty(h)) {
            var t = k[h]
            t[m.CALLBACKS].hasOwnProperty('switchBuyingOption') &&
              t[m.CALLBACKS].switchBuyingOption(
                a,
                d.ccSelectionFetch(h),
                d.ccRemovedSelectionFetch(h),
                c,
                1 === f.length ? b : g,
                l !== g ? l : a,
                J.UNSUPPORTED_BUYING_OPTION_LIST.includes(c),
              )
          }
        }
        n && n.length && d.updateTwisterPlusComponents()
      },
      getFeatureCurrentlyExpanded: function () {
        return F
      },
      isMultiSelectionFeature: q,
    }
  })
  ;('use strict')
  h.when(
    'A',
    'twister-plus-constants',
    'twister-plus-logger-service',
    'twister-plus-preconditions',
    'buy-box-price-update',
    'cc-manager',
    'itemAssociation',
    'twister-plus-framework',
    'twister-plus-price-tool-tip',
    'twister-plus-side-sheet',
    'twister-plus-pinning',
  ).register('twister-plus-init', function (c, d, g, h, p, q, f, r, a, l, u) {
    function v() {
      f.init()
      a.init()
      l.init()
      p.init()
      q.init()
    }
    var t = d.metrics
    c.on('PageRefresh:Success', function () {
      h.isTwisterPlusEligible() &&
        (r.refreshTwisterPlusData(),
        v(),
        h.isCcCardsRendered() && g.logCounter(t.TWISTER_PLUS_TWISTER_REFRESH_GV))
    })
    h.isTwisterPlusEligible() &&
      (r.initializeTwisterPlus(),
      v(),
      'function' === typeof C.markFeatureInteractive &&
        C.markFeatureInteractive(t.FEATURE_NAME, {}))
  })
  ;('use strict')
  h.when('A', 'cc-manager', 'utils', 'twister-plus-constants').register(
    'twister-plus-mod',
    function (c, d, g, h) {
      function p() {
        a = q('#twister-plus-feature', a)
        l = q('#twister-plus-below-od-feature', l)
      }
      function q(a, d) {
        a = c.$(a)
        return !d && 0 < a.length && !a.is(':hidden')
          ? (c.on('a:accordion:buybox-accordion:select', r),
            c.on('a:tabs:offerDisplayGroup_tabs:select', f),
            !0)
          : d && (0 === a.length || a.is(':hidden'))
            ? (c.off('a:accordion:buybox-accordion:select', r),
              c.off('a:tabs:offerDisplayGroup_tabs:select', f),
              !1)
            : d
      }
      function f(a) {
        var f = a.selectedTab.$tab.attr(u.TAB_GROUP_NAME)
        a = c.$('#' + a.selectedTab.tabName + ' ' + u.ACTIVE_ACCORDION)
        a = a.length ? a.index() : 0
        d.switchBuyingOption(a, f)
      }
      function r(a) {
        a = a.selectedRow.$row.index()
        var c = g.getActiveGroupName()
        d.switchBuyingOption(a, c)
      }
      var a = !1,
        l = !1,
        u = h.selectors
      p()
      c.on('PageRefresh:ATF', function () {
        p()
      })
      c.on('twisterPlus:visibility:change', function () {
        p()
      })
    },
  )
  ;('use strict')
  h.when('A', 'twister-plus-logger-service', 'twister-plus-constants').register(
    'twister-plus-feature-state',
    function (c, d, x) {
      function y(a) {
        f.currentBuyingOptionPosition = a || 0
      }
      function p(a) {
        return f.ccFeaturesState[a]
      }
      function q(a) {
        return f.ccRemovedSelections[a]
      }
      var f = {},
        r = x.metrics
      return {
        initialize: function (a) {
          f.twisterState = a.twisterState || {}
          f.priceData = a.priceData || {}
          y(a.currentBuyingOptionPosition)
          f.currentGroupName = a.currentGroupName || ''
          f.ccFeaturesState = a.ccFeaturesState || {}
          f.ccRemovedSelections = a.ccRemovedSelections || {}
        },
        getTwisterPlusFeaturesState: function () {
          return f
        },
        getTwisterState: function () {
          return f.twisterState
        },
        setTwisterState: function (a) {
          f.twisterState = a || {}
        },
        getCCFeaturesState: function () {
          return f.ccFeaturesState
        },
        getCCRemovedSelections: function () {
          return f.ccRemovedSelections
        },
        getPriceData: function () {
          return f.priceData
        },
        getCurrentBuyingOptionPosition: function () {
          return f.currentBuyingOptionPosition
        },
        getCurrentGroupName: function () {
          return f.currentGroupName
        },
        updateCCFeatureState: function (a, c, u) {
          var v = !1
          if (a !== g && c !== g) {
            var v = f.ccFeaturesState,
              t
            t = p(a)
            if ('add' === c.selectionType)
              u[a].hasOwnProperty('updateQtyAsBaseItem') &&
                u[a].updateQtyAsBaseItem &&
                (c.quantity = f.twisterState.quantity),
                t !== g ? t.push(c) : ((f.ccFeaturesState[a] = []), f.ccFeaturesState[a].push(c)),
                d.logCounter(r.CC_SELECTION + '.' + a)
            else if ('delete' === c.selectionType && ((u = c.itemType), (c = c[u]), t !== g))
              for (var q = 0; q < t.length; q++)
                if (t[q][u] === c) {
                  t.splice(q, 1)
                  d.logCounter(r.CC_REMOVAL + '.' + a)
                  break
                }
            t = p(a)
            v[a] = t
            v = !0
          } else
            h.log('CC featureName or featureData passed to Twister+ is not defined.', 'FATAL', a)
          return v
        },
        updateTwisterPlusFeatureStateForQuantity: function (a, d) {
          f.twisterState.quantity = a
          c.each(f.ccFeaturesState, function (g, h) {
            d[h].hasOwnProperty('updateQtyAsBaseItem') &&
              d[h].updateQtyAsBaseItem &&
              c.each(g, function (c, d) {
                f.ccFeaturesState[h][d].quantity = a
              })
          })
        },
        updateCCRemovedSelections: function (a, d) {
          var c = !1
          a !== g && d !== g
            ? ((c = f.ccRemovedSelections),
              q(a) === g && (f.ccRemovedSelections[a] = []),
              q(a).push(d),
              (d = q(a)),
              (c[a] = d),
              (c = !0))
            : h.log('CC featureName or featureData passed to Twister+ is not defined.', 'FATAL', a)
          return c
        },
        clearCCFeatureSelections: function (a) {
          var c = !1
          a !== g
            ? (p(a) !== g &&
                ((c = f.ccFeaturesState[a].length),
                0 < c && d.logCounter(r.CC_REMOVAL + '.' + a, c),
                (f.ccFeaturesState[a] = [])),
              (c = !0))
            : h.log('CC featureName passed to Twister+ is not defined.', 'FATAL', a)
          return c
        },
        clearCCRemovedSelections: function (a) {
          var c = !1
          a !== g
            ? (q(a) !== g && delete f.ccRemovedSelections[a], (c = !0))
            : h.log('CC featureName passed to Twister+ is not defined.', 'FATAL', a)
          return c
        },
        updatePriceData: function (a) {
          f.priceData = a || {}
        },
        updateCurrentBuyingOptionPosition: function (a) {
          y(a)
        },
        updateGroupName: function (a) {
          f.currentGroupName = a || ''
        },
      }
    },
  )
})
/* ******** */
;(function (M) {
  var I = window.AmazonUIPageJS || window.P,
    t = I._namespace || I.attributeErrors,
    G = t
      ? t('DetailPageTwisterPlusSubAssets@itemAssociation', 'DetailPageTwisterPlusSubAssets')
      : I
  G.guardFatal
    ? G.guardFatal(M)(G, window)
    : G.execute(function () {
        M(G, window)
      })
})(function (M, I, t) {
  'use strict'
  M.when(
    'A',
    'utils',
    'twister-plus-constants',
    'twister-plus-feature-state',
    'item-association-utils',
  ).register('itemAssociation', function (G, l, y, E, z) {
    function B() {
      var a = l.getActiveAccordionRow(E.getCurrentBuyingOptionPosition(), E.getCurrentGroupName())
      return a && 1 === a.length ? a.find(m.ADD_TO_CART_ELEMENT_ID) : g(m.ADD_TO_CART_ELEMENT_ID)
    }
    function R() {
      var a = l.getActiveAccordionRow(E.getCurrentBuyingOptionPosition(), E.getCurrentGroupName())
      return a && 1 === a.length ? a.find(m.BUYNOW_ELEMENT_ID) : g(m.BUYNOW_ELEMENT_ID)
    }
    function aa(a) {
      return (
        0 <
        B()
          .clone()
          .find(m.ITEM_ASSOCIATION_INPUTS_CLASS)
          .remove()
          .end()
          .find('input[name\x3d"' + a + '"]').length
      )
    }
    function C(a, b, v) {
      var h = [],
        d = e.CUSTOM_NAME_STRING + '.' + a + '.' + b,
        d = g('\x3c' + J.INPUT + '\x3e', {
          type: e.INPUT_TYPE_HIDDEN,
          id: d,
          name: d,
          value: v[e.ITEM_ASSOCIATION_GROUP_KEY],
        })
      a = e.CUSTOM_VALUE_STRING + '.' + a + '.' + b
      v = g('\x3c' + J.INPUT + '\x3e', {
        type: e.INPUT_TYPE_HIDDEN,
        id: a,
        name: a,
        value: JSON.stringify(v[e.ENCODED_ITEM_ASSOC_VAL]),
      })
      h.push(d)
      h.push(v)
      return h
    }
    function U(a, b) {
      for (var v = [], h, d = 0; d < b.length; d++)
        (h =
          b[d].name === L.IS_BUYBACK_KEY
            ? g('\x3c' + J.INPUT + '\x3e', {
                type: e.INPUT_TYPE_HIDDEN,
                id: b[d].id,
                name: e.CUSTOM_NAME_STRING + '.' + a + '.1',
                value: b[d].value,
              })
            : b[d].name === L.IS_BUYBACK_FEE
              ? g('\x3c' + J.INPUT + '\x3e', {
                  type: e.INPUT_TYPE_HIDDEN,
                  id: b[d].id,
                  name: e.CUSTOM_VALUE_STRING + '.' + a + '.1',
                  value: b[d].value,
                })
              : g('\x3c' + J.INPUT + '\x3e', {
                  type: e.INPUT_TYPE_HIDDEN,
                  id: b[d].id,
                  name: b[d].name,
                  value: b[d].value,
                })),
          v.push(h)
      return v
    }
    function V(a) {
      return g('\x3c' + J.INPUT + '\x3e', {
        type: a.inputType,
        id: a.inputId,
        name: a.inputName,
        value: 'string' === typeof a.inputValue ? a.inputValue : JSON.stringify(a.inputValue),
      })
    }
    function F(a, b, v, h) {
      var d = a.featureName
      a = a.formData
      var c = []
      if (a !== t) {
        var g
        d === L.PAYMENT_OPTIONS_FEATURE &&
          a[0].inputName === L.PAYMENT_OFFER_INPUT_NAME &&
          (g = v ? L.PAYMENT_OPTIONS_BUY_NOW_CART_TYPE : L.PAYMENT_OPTIONS_ATC_CART_TYPE)
        for (v = 0; v < a.length; v++)
          g !== t && (a[v].inputValue[L.CART_TYPE] = g),
            (d = a[v]),
            'function' !== typeof b || (h && !e.PARAM_NAMES[d.inputName]) || ((d = b(d)), c.push(d))
      }
      return c
    }
    function w(a, b, v) {
      var e = v.quantity,
        d = v.offerListingId
      e !== t && d !== t
        ? (a.push(
            '\x3cinput type\x3d"hidden" id\x3d"asin.' +
              b +
              '" name\x3d"asin.' +
              b +
              '" value\x3d"' +
              v.asin +
              '"\x3e',
          ),
          (v = ba(b, e, !1)),
          a.push(v),
          (b = ca(b, d, !1)),
          a.push(b))
        : M.log(
            'offerListingId or quantity is not defined for the asin in the itemData',
            'Error',
            JSON.stringify(v),
          )
      return a
    }
    function H() {
      return g('\x3c' + J.INPUT + '\x3e', {
        type: e.INPUT_TYPE_HIDDEN,
        id: e.IS_BUYBACK_INPUT_FLAG,
        name: e.IS_BUYBACK_INPUT_FLAG,
        value: e.IS_BUYBACK_INPUT_FLAG_VALUE,
      })
    }
    function p(a) {
      var b = R(),
        v = b.find(m.ITEM_ASSOCIATION_INPUTS_CLASS)
      v.length ? g(v).replaceWith(a) : b.append(a)
    }
    function I(a, b) {
      var v = g('\x3c' + J.FIELDSET + '\x3e', { class: m.ITEM_ASSOCIATION_INPUTS_CLASS_NAME }),
        h = [],
        d = {},
        c = 2
      if (ga && l.isFeatureSelectionPresent(S.ccFeaturesState)) {
        c = {}
        c.quantity = g('#addToCart #atc-mbb-quantity').val()
        var u = g('input[id|\x3dmbb-checkbox-input]:checked'),
          r = u.closest(".a-declarative[data-action\x3d'mbb-mobile-checkbox-toggle']")
        c.asin = u.val()
        c.offerListingId = r.data('mbb-mobile-checkbox-toggle')
          ? r.data('mbb-mobile-checkbox-toggle').offeringId
          : ''
        h = w(h, 2, c)
        c = 3
      }
      for (u = 0; u < a.length; u++) {
        var r = a[u],
          n = r.featureName
        d[n] = d[n] !== t ? d[n] + 1 : 0
        if (W) {
          var q,
            f,
            k = 1
          a[u][e.FEATURE_NAME_KEY] === e.KEY_BUYBACK &&
            ((q = a[u].buynowData || []), (f = U(c, q)), g.merge(h, f), (k = 2))
          q = a[u].customData || []
          for (var x = 0; x < q.length; x++)
            (f = C(c, x + k, q[x])),
              g.merge(h, f),
              (f = z.createCustomInputFieldsForNATC(d[n], n, q[x])),
              g.merge(h, f)
        }
        r.asin !== t &&
          ((h = w(h, c, r)), c++, (h = z.addAsinItemsInputFieldsForNATC(d[n], n, h, r)))
        r = F(a[u], V, !1, !1)
        g.merge(h, r)
        r = F(a[u], z.createFormInputFieldForNATC, !1, !0)
        g.merge(h, r)
      }
      if (h.length)
        for (
          d = [],
            aa(e.ASIN_KEY + e.FIRST_INDEX) ||
              ((c = e.BASE_ASIN_INDEX),
              d.push(
                '\x3cinput type\x3d"hidden" id\x3d"asin.' +
                  c +
                  '" name\x3d"asin.' +
                  c +
                  '" value\x3d"' +
                  S.baseAsinState.asin +
                  '"\x3e',
              )),
            aa(e.QUANTITY_KEY + e.FIRST_INDEX) ||
              (ha
                ? ((c = l.getBaseItemQuantity()), c === t && (c = 1))
                : (c = B().find('input[id\x3d"quantity"]').val()),
              (c = ba(e.BASE_ASIN_INDEX, c)),
              d.push(c)),
            aa(e.OFFERING_ID_KEY + e.FIRST_INDEX) ||
              ((c = ca(e.BASE_ASIN_INDEX, S.baseAsinState.offerListingId)), d.push(c)),
            g.merge(h, d),
            b && ((d = H()), h.push(d)),
            d = 0;
          d < h.length;
          d++
        )
          g(v).append(h[d])
      h = g('\x3c' + J.FIELDSET + '\x3e', { class: m.ITEM_ASSOCIATION_INPUTS_CLASS_NAME })
      d = []
      c = 2
      u = 1
      for (r = 0; r < a.length; r++) {
        n = a[r]
        if (W)
          for (
            x = 1,
              a[r][e.FEATURE_NAME_KEY] === e.KEY_BUYBACK &&
                ((q = a[r].buynowData || []), (k = U(c, q)), g.merge(d, k), (x = 2)),
              q = a[r].customData || [],
              f = 0;
            f < q.length;
            f++
          )
            (k = C(c, f + x, q[f])), g.merge(d, k)
        n.asin !== t && ((d = w(d, u, n)), c++, u++)
        n = F(a[r], V, !0, !1)
        g.merge(d, n)
      }
      if (d.length) for (b && ((a = H()), d.push(a)), a = 0; a < d.length; a++) g(h).append(d[a])
      v.length &&
        ((a = B().find(m.ITEM_ASSOCIATION_INPUTS_CLASS)),
        a.length ? g(a).replaceWith(v) : B().append(v))
      h.length && p(h)
    }
    function X() {
      if (N === t || 0 === N.length)
        (N = B().find('input[name\x3d"itemCount"]')),
          (ia = 0 === N.length ? 0 : parseInt(N[0].value))
    }
    function b() {
      if (O === t || 0 === O.length)
        (O = R().find('input[name\x3d"itemCount"]')),
          (ja = 0 === O.length ? 0 : parseInt(O[0].value))
    }
    function c() {
      var a = g(m.OFFER_DISPLAY_GROUP)
      return a && 1 === a.length
        ? a.find(m.ADD_TO_CART_BUTTON_ID)
        : (a = g(m.BUYBOX_ACCORDION)) && 1 === a.length
          ? a.find(m.ADD_TO_CART_BUTTON_ID)
          : g(m.ADD_TO_CART_BUTTON_ID)
    }
    function f() {
      var a = g(m.OFFER_DISPLAY_GROUP)
      return a && 1 === a.length
        ? a.find(m.BUYNOW_BUTTON_ID)
        : (a = g(m.BUYBOX_ACCORDION)) && 1 === a.length
          ? a.find(m.BUYNOW_BUTTON_ID)
          : g(m.BUYNOW_BUTTON_ID)
    }
    function k(a, b, c) {
      var h = {}
      h[e.CUSTOM_NAME_STRING + '.' + a + '.' + b] = c[e.ITEM_ASSOCIATION_GROUP_KEY]
      h[e.CUSTOM_VALUE_STRING + '.' + a + '.' + b] = JSON.stringify(c[e.ENCODED_ITEM_ASSOC_VAL])
      return h
    }
    function D(a, b) {
      for (var c = {}, h = 0; h < b.length; h++) {
        var d = b[h].name,
          g = b[h].value
        b[h].name === L.IS_BUYBACK_KEY
          ? (c[e.CUSTOM_NAME_STRING + '.' + a + '.1'] = g)
          : b[h].name === L.IS_BUYBACK_FEE
            ? (c[e.CUSTOM_VALUE_STRING + '.' + a + '.1'] = g)
            : (c[d] = g)
      }
      return c
    }
    function ka(a) {
      var b = {},
        c = a.inputName
      a = 'string' === typeof a.inputValue ? a.inputValue : JSON.stringify(a.inputValue)
      b[c] = a
      return b
    }
    function na(a, b) {
      b = {}
      var c = {}
      K = {}
      da = {}
      for (
        var h = S.baseAsinState.asin,
          d = l.getBaseItemQuantity(),
          f = (d = d
            ? d
            : P.addToCartData[0] &&
                P.addToCartData[0].initialFormData &&
                P.addToCartData[0].initialFormData.inputs
              ? P.addToCartData[0].initialFormData.inputs.quantity
              : ''),
          u = S.baseAsinState.offerListingId,
          r = 2,
          n = 0;
        n < a.length;
        n++
      ) {
        var q = a[n],
          m = q.featureName
        c[m] = c[m] !== t ? c[m] + 1 : 0
        var p = q.asin,
          x = q.quantity,
          A = q.offerListingId
        p !== t &&
          x !== t &&
          A !== t &&
          ((h += e.PIPE_SEPARATOR + p),
          (d += e.PIPE_SEPARATOR + x),
          (u += e.PIPE_SEPARATOR + A),
          (da[p] = { quantity: x, offerListingId: A }),
          (p = z.addAsinItemKeyValuePairsForNATC(c[m], m, q)),
          (K = g.extend(K, p)))
        if (W) {
          var w,
            x = 1
          a[n][e.FEATURE_NAME_KEY] === e.KEY_BUYBACK &&
            ((p = a[n].buynowData || []), (w = D(r, p)), (b = g.extend(b, w)), (x = 2))
          p = a[n].customData || []
          for (A = 0; A < p.length; A++)
            (w = k(r, A + x, p[A])),
              (b = g.extend(b, w)),
              (w = z.createCustomKeyValuePairForNATC(c[m], m, p[A])),
              (K = g.extend(K, w))
        }
        q.asin !== t && r++
        m = F(a[n], ka, !1, !1)
        for (q = 0; q < m.length; q++) b = g.extend(b, m[q])
        K = g.extend(K, b)
        m = F(a[n], z.createFormInputKeyValuePairForNATC, !1, !0)
        for (q = 0; q < m.length; q++) K = g.extend(K, m[q])
      }
      b[e.FORM_DATA_ASIN_KEY] = h
      b[e.QUANTITY_KEY] = d
      u && (b[e.FORM_DATA_OID_KEY] = u)
      '' !== f &&
        f !== t &&
        (b[
          e.ITEMS_PREFIX +
            e.OPENING_SQUARE_BRACKET +
            e.BASE_ASIN_INDEX_FOR_NATC +
            '.' +
            e.BASE_ASIN_ITEM_TYPE +
            e.CLOSING_SQUARE_BRACKET +
            e.OPENING_SQUARE_BRACKET +
            e.QUANTITY_KEY +
            e.CLOSING_SQUARE_BRACKET
        ] = f)
      return b
    }
    function oa(a, b) {
      var c = {},
        h = l.getBaseItemQuantity()
      c[e.QUANTITY_KEY] = h
        ? h
        : Q.buyNowData[0] &&
            Q.buyNowData[0].initialFormData &&
            Q.buyNowData[0].initialFormData.inputs
          ? Q.buyNowData[0].initialFormData.inputs.quantity
          : ''
      for (h = 0; h < a.length; h++) {
        var d = a[h],
          f = h + 2,
          u = h + 1
        c[e.ASIN_KEY + '.' + u] = d.asin
        var r = ba(u, d.quantity, !0),
          c = g.extend(c, r),
          d = ca(u, d.offerListingId, !0),
          c = g.extend(c, d)
        if (W) {
          r = 1
          a[h][e.FEATURE_NAME_KEY] === e.KEY_BUYBACK &&
            ((d = a[h].buynowData || []), (u = D(f, d)), (c = g.extend(c, u)), (r = 2))
          for (var d = a[h].customData || [], n = 0; n < d.length; n++)
            (u = k(f, n + r, d[n])), (c = g.extend(c, u))
        }
        f = F(a[h], ka, !0, !1)
        for (d = 0; d < f.length; d++) c = g.extend(c, f[d])
      }
      !l.isEmpty(c) && b && (c[e.IS_BUYBACK_INPUT_FLAG] = e.IS_BUYBACK_INPUT_FLAG_VALUE)
      return c
    }
    function Y(a) {
      var b = []
      a.each(function () {
        var a = g(this).parents(m.MOBILEAPP_TABS_ELEMENT_ID).parent().attr(m.TAB_GROUP_NAME),
          a = a ? a : l.getActiveGroupName()
        if (
          l.getAccordionRowBuyingOptionType(
            g(this).parents(m.MOBILEAPP_ACCORDION_OR_SINGLEOFFER_ELEMENT_ID),
            a,
          ) !== y.UNKNOWN &&
          ((a = g(this).parents(m.DECLARATIVE_CLASS)), 0 < a.length)
        ) {
          var c = g(a).data(m.DATA_ATTRIBUTE_ACTION),
            c = l.convertHTMLDataAttributesToKeys(c),
            a = G.copy(g(a).data(c))
          b.push({ dataActionKey: c, initialFormData: a })
        }
      })
      return b
    }
    function pa(a, b, c) {
      var g = c.a.split(e.PIPE_SEPARATOR)
      c = b[e.FORM_DATA_ASIN_KEY].split(e.PIPE_SEPARATOR)
      b[e.QUANTITY_KEY].split(e.PIPE_SEPARATOR)
      var d = b[e.FORM_DATA_OID_KEY].split(e.PIPE_SEPARATOR)
      G.each(c, function (b, c) {
        g.includes(b) ||
          ea[b] !== t ||
          ((a[e.FORM_DATA_ASIN_KEY] = a[e.FORM_DATA_ASIN_KEY] + e.PIPE_SEPARATOR + b),
          (b = l.getBaseItemQuantity()),
          (a[e.QUANTITY_KEY] =
            a[e.QUANTITY_KEY] +
            e.PIPE_SEPARATOR +
            (b
              ? b
              : P.addToCartData[0] &&
                  P.addToCartData[0].initialFormData &&
                  P.addToCartData[0].initialFormData.inputs
                ? P.addToCartData[0].initialFormData.inputs.quantity
                : '')),
          (a[e.FORM_DATA_OID_KEY] = a[e.FORM_DATA_OID_KEY] + e.PIPE_SEPARATOR + d[c]))
      })
    }
    function la(a, b, c, e) {
      var d = 0
      a.each(function () {
        var a = g(this).parents(m.MOBILEAPP_TABS_ELEMENT_ID).parent().attr(m.TAB_GROUP_NAME),
          a = a ? a : l.getActiveGroupName()
        if (
          l.getAccordionRowBuyingOptionType(
            g(this).parents(m.MOBILEAPP_ACCORDION_OR_SINGLEOFFER_ELEMENT_ID),
            a,
          ) !== y.UNKNOWN &&
          ((a = g(this).parents(m.DECLARATIVE_CLASS)), 0 < a.length)
        ) {
          var f = b[d++]
          if (f !== t) {
            var n = g.extend({}, f.initialFormData.inputs, c),
              q = g.extend({}, f.initialFormData)
            e && pa(n, f.initialFormData.inputs, c)
            q.inputs = n
            a.data(f.dataActionKey, q)
          }
        }
      })
      if (e) {
        var d = 0,
          f = Y(a)
        a.each(function () {
          var a = g(this).parents(m.MOBILEAPP_TABS_ELEMENT_ID).parent().attr(m.TAB_GROUP_NAME),
            a = a ? a : l.getActiveGroupName()
          if (
            l.getAccordionRowBuyingOptionType(
              g(this).parents(m.MOBILEAPP_ACCORDION_OR_SINGLEOFFER_ELEMENT_ID),
              a,
            ) !== y.UNKNOWN &&
            ((a = g(this).parents(m.DECLARATIVE_CLASS)), 0 < a.length)
          ) {
            var b = f[d++]
            if (b !== t) {
              G.each(Object.keys(fa), function (a, c) {
                delete b.initialFormData.inputs[a]
              })
              var c = g.extend({}, b.initialFormData.inputs, K),
                e = g.extend({}, b.initialFormData)
              e.inputs = c
              a.data(b.dataActionKey, e)
            }
          }
        })
        fa = K
        ea = da
      }
    }
    function qa(a, b) {
      var e = na(a, b)
      G.delay(function () {
        Q.addToCartData = Y(c())
        la(c(), Q.addToCartData, e, !0)
      })
      a = oa(a, b)
      la(f(), Q.buyNowData, a, !1)
    }
    function ba(a, b, c) {
      return c
        ? ((c = {}), (c[e.QUANTITY_KEY + '.' + a] = b), c)
        : '\x3cinput type\x3d"hidden" id\x3d"quantity.' +
            a +
            '" name\x3d"quantity.' +
            a +
            '" value\x3d"' +
            b +
            '"\x3e'
    }
    function ca(a, b, c) {
      return c
        ? ((c = {}), (c[e.OFFERING_ID_KEY + '.' + a] = b), c)
        : '\x3cinput type\x3d"hidden" id\x3d"offeringID.' +
            a +
            '" name\x3d"offeringID.' +
            a +
            '" value\x3d"' +
            b +
            '"\x3e'
    }
    function ra(a, c) {
      if (T === e.DEVICE_TYPE_MOBILE_APP) qa(a, c), I(a, c)
      else if (T === e.DEVICE_TYPE_MOBILE_WEB) I(a, c)
      else {
        var f = g('\x3c' + J.FIELDSET + '\x3e', { class: m.ITEM_ASSOCIATION_INPUTS_CLASS_NAME })
        g(m.ITEM_ASSOCIATION_INPUTS_CLASS).remove()
        var h = [],
          d = {},
          k = B().find('input[name^\x3d"offeringID"]').length + 1,
          u = k + 1,
          r = a.length
        X()
        N.length
          ? (N[0].value = ia + r)
          : (B().append('\x3cinput type\x3d"hidden" name\x3d"itemCount" value\x3d"' + r + '"\x3e'),
            (N = B().find('input[name\x3d"itemCount"]')))
        for (r = 0; r < a.length; r++) {
          var n = a[r],
            q = n.featureName
          d[q] = d[q] !== t ? d[q] + 1 : 0
          if (W) {
            var l,
              D,
              x = 1
            a[r][e.FEATURE_NAME_KEY] === e.KEY_BUYBACK &&
              ((l = a[r].buynowData || []), (D = U(k, l)), g.merge(h, D), (x = 2))
            l = a[r].customData || []
            for (var A = 0; A < l.length; A++)
              (D = C(u, A + x, l[A])),
                g.merge(h, D),
                (D = z.createCustomInputFieldsForNATC(d[q], q, l[A])),
                g.merge(h, D)
          }
          n.asin !== t &&
            ((h = w(h, k, n)), k++, u++, (h = z.addAsinItemsInputFieldsForNATC(d[q], q, h, n)))
          n = F(a[r], V, !1, !1)
          g.merge(h, n)
          n = F(a[r], z.createFormInputFieldForNATC, !1, !0)
          g.merge(h, n)
        }
        if (h.length) for (c && ((d = H()), h.push(d)), d = 0; d < h.length; d++) g(f).append(h[d])
        h = g('\x3c' + J.FIELDSET + '\x3e', { class: m.ITEM_ASSOCIATION_INPUTS_CLASS_NAME })
        d = []
        k = {}
        u = R().find('input[name^\x3d"offeringID"]').length + 1
        r = u + 1
        n = a.length
        b()
        O.length
          ? (O[0].value = ja + n)
          : (R().append('\x3cinput type\x3d"hidden" name\x3d"itemCount" value\x3d"' + n + '"\x3e'),
            (O = R().find('input[name\x3d"itemCount"]')))
        for (n = 0; n < a.length; n++) {
          q = a[n]
          l = q.featureName
          k[l] = k[l] !== t ? k[l] + 1 : 0
          if (W) {
            var y,
              A = 1
            a[n][e.FEATURE_NAME_KEY] === e.KEY_BUYBACK &&
              ((x = a[n].buynowData || []), (y = U(u, x)), g.merge(d, y), (A = 2))
            x = a[n].customData || []
            for (D = 0; D < x.length; D++)
              (y = C(r, D + A, x[D])),
                g.merge(d, y),
                (y = z.createCustomInputFieldsForNATC(k[l], l, x[D])),
                g.merge(d, y)
          }
          q.asin !== t &&
            ((d = w(d, u, q)), u++, r++, (d = z.addAsinItemsInputFieldsForNATC(k[l], l, d, q)))
          q = F(a[n], V, !1, !1)
          g.merge(d, q)
          q = F(a[n], z.createFormInputFieldForNATC, !1, !0)
          g.merge(d, q)
        }
        if (d.length) for (c && ((a = H()), d.push(a)), a = 0; a < d.length; a++) g(h).append(d[a])
        f.length &&
          ((a = B().find(m.ITEM_ASSOCIATION_INPUTS_CLASS)),
          a.length ? g(a).replaceWith(f) : B().append(f))
        h.length && p(h)
      }
    }
    var g = G.$,
      Z = { name: 'itemAssociation' },
      T = '',
      ga,
      ha = !1,
      fa = {},
      K = {},
      da = {},
      ea = {},
      W,
      S = { ccFeaturesState: {}, baseAsinState: {} },
      Q = { addToCartData: [], buyNowData: [] },
      P = { addToCartData: [] },
      e = y.itemAssociation,
      J = y.htmlTags,
      m = y.selectors,
      L = y.ccFeatures,
      N,
      O,
      ia,
      ja
    Z.addItemAssociationBundleData = function (a, b, c, f) {
      ga = c
      W = b
      ha = f
      var d = !1,
        k = []
      S.ccFeaturesState = a.ccFeaturesState
      S.baseAsinState = a.twisterState
      g.each(S.ccFeaturesState, function (a, b) {
        g.each(b, function (b, c) {
          a === e.KEY_BUYBACK && c.isBuyBack && (d = !0)
          b = {}
          var f = []
          b[e.ASIN_KEY] = c.asin
          b[e.QUANTITY_KEY] = c.quantity
          b[e.OFFER_LISTING_ID_KEY] = c.offerListingId
          if (c.enableIA) {
            var g = {}
            g[e.ITEM_ASSOCIATION_GROUP_KEY] = e.ITEM_ASSOCIATION_GROUP_VAL
            g[e.ENCODED_ITEM_ASSOC_VAL] = c.IAData
            f.push(g)
            b[e.CUSTOM_DATA_KEY] = f
          }
          b[e.FEATURE_NAME_KEY] = a
          c.formData !== t && 0 < c.formData.length && (b.formData = c.formData)
          a === e.KEY_BUYBACK && (b[L.BUY_NOW_DATA] = c.buynowData)
          k.push(b)
        })
      })
      ra(k, d)
      T === e.DEVICE_TYPE_MOBILE_APP && G.trigger(y.TP_AFTER_BUYBOX_UPDATE_EVENT)
    }
    Z.init = function () {
      T = l.getDeviceType()
      fa = {}
      ea = {}
      T === e.DEVICE_TYPE_MOBILE_APP &&
        ((P.addToCartData = Y(c())), (Q.addToCartData = Y(c())), (Q.buyNowData = Y(f())))
      T === y.DEVICE_TYPE_WEB && (X(), b())
    }
    Z.reInitialiseItemCountVal = function () {
      O = N = t
      T = l.getDeviceType()
      T === y.DEVICE_TYPE_WEB && (X(), b())
    }
    return Z
  })
  ;('use strict')
  M.when('A', 'twister-plus-constants').register('item-association-utils', function (t, l) {
    function y(b, c) {
      var f = p.ITEMS_PREFIX
      return (f += p.OPENING_SQUARE_BRACKET + (b + '.' + c) + p.CLOSING_SQUARE_BRACKET)
    }
    function E(b, c) {
      var f = 'string' === typeof b ? b : ''
      'object' === typeof c && Array.isArray(c)
        ? t.each(c, function (b, c) {
            f += p.OPENING_SQUARE_BRACKET + b + p.CLOSING_SQUARE_BRACKET
          })
        : 'string' === typeof c && (f += p.OPENING_SQUARE_BRACKET + c + p.CLOSING_SQUARE_BRACKET)
      return f
    }
    function z(b, c, f) {
      return w('\x3c' + ma.INPUT + '\x3e', { type: f, id: b, name: b, value: c })
    }
    function B(b, c) {
      var f = {}
      f[b] = c
      return f
    }
    function R(b, c) {
      if ('number' === typeof b && 0 <= b && 'string' === typeof c)
        return (b = y(b, c)), (b = E(b, p.PARAM_NAMES.ITEM_ASSOCIATION))
      M.log(
        'Invalid data-type for itemIndex or itemType: itemIndex \x3d ' + b + ', itemType \x3d ' + c,
        'ERROR',
        X,
      )
    }
    function I(b, c, f) {
      return f ? B(b, c) : z(b, c, p.INPUT_TYPE_HIDDEN)
    }
    function C(b, c, f, k) {
      if ('string' === typeof f) return (b = E(b, c)), I(b, f, k)
    }
    function U(b, c, f) {
      if ('string' === typeof c || 'number' === typeof c)
        return (b = E(b, p.PARAM_NAMES.QUANTITY)), I(b, c, f)
    }
    function V(b, c, f) {
      if ('object' === typeof c && Array.isArray(c) && 'DELETE' === c[0].type)
        return (b = E(b, p.PARAM_NAMES.DELETE_CONSTRAINT)), I(b, c[0].mutuallyInclusive, f)
    }
    function F(b, c, f) {
      var k
      if (c) {
        if (c.AccessoryType) {
          var l = E(b, p.PARAM_NAMES.ACCESSORY_TYPE)
          f
            ? ((k = {}), (l = B(l, c.AccessoryType)), (k = w.extend(k, l)))
            : ((k = []), (l = z(l, c.AccessoryType, p.INPUT_TYPE_HIDDEN)), k.push(l))
        }
        c.CustomerAppointmentType &&
          ((b = E(b, p.PARAM_NAMES.CUSTOMER_APPOINTMENT_TYPE)),
          f
            ? ((c = B(b, c.CustomerAppointmentType)), (k = w.extend(k, c)))
            : ((c = z(b, c.CustomerAppointmentType, p.INPUT_TYPE_HIDDEN)), k.push(c)))
      }
      return k
    }
    var w = t.$,
      H = {},
      p = l.itemAssociation,
      ma = l.htmlTags,
      X = l.ATTRIBUTION
    H.createCustomInputFieldsForNATC = function (b, c, f) {
      var k = []
      b = R(b, c)
      f = f[p.ENCODED_ITEM_ASSOC_VAL]
      'string' === typeof b &&
        f &&
        ((c = C(b, p.PARAM_NAMES.ASSOCIATED_ITEM_ID, f.parentAsin, !1)),
        k.push(c),
        (c = C(b, p.PARAM_NAMES.PROGRAM_TYPE, f.type, !1)),
        k.push(c),
        (c = C(b, p.PARAM_NAMES.RENDER_TYPE, f.renderType, !1)),
        k.push(c),
        (c = V(b, f.constraintList, !1)),
        k.push(c),
        (b = F(b, f.properties, !1)),
        (k = k.concat(b)))
      return k
    }
    H.addAsinItemsInputFieldsForNATC = function (b, c, f, k) {
      var l = k.asin,
        t = k.quantity,
        w = k.offerListingId
      l && t && w
        ? ((b = y(b, c)),
          (l = C(b, p.PARAM_NAMES.ASIN, l, !1)),
          f.push(l),
          (t = U(b, t, !1)),
          f.push(t),
          (w = C(b, p.PARAM_NAMES.OFFER_LISTING_ID, w, !1)),
          f.push(w))
        : M.log(
            'Invalid data (asin/offerListingId/quantity) is present in itemData' +
              JSON.stringify(k),
            'ERROR',
            X,
          )
      return f
    }
    H.createFormInputFieldForNATC = function (b) {
      var c = y(p.BASE_ASIN_INDEX_FOR_NATC, p.BASE_ASIN_ITEM_TYPE),
        c = E(c, p.PARAM_NAMES[b.inputName]),
        f = 'string' === typeof b.inputValue ? b.inputValue : JSON.stringify(b.inputValue)
      return z(c, f, b.inputType)
    }
    H.createCustomKeyValuePairForNATC = function (b, c, f) {
      var k = {}
      b = R(b, c)
      f = f[p.ENCODED_ITEM_ASSOC_VAL]
      'string' === typeof b &&
        f &&
        ((c = C(b, p.PARAM_NAMES.ASSOCIATED_ITEM_ID, f.parentAsin, !0)),
        (k = w.extend(k, c)),
        (c = C(b, p.PARAM_NAMES.PROGRAM_TYPE, f.type, !0)),
        (k = w.extend(k, c)),
        (c = C(b, p.PARAM_NAMES.RENDER_TYPE, f.renderType, !0)),
        (k = w.extend(k, c)),
        (c = V(b, f.constraintList, !0)),
        (k = w.extend(k, c)),
        (b = F(b, f.properties, !0)),
        (k = w.extend(k, b)))
      return k
    }
    H.createFormInputKeyValuePairForNATC = function (b) {
      var c = y(p.BASE_ASIN_INDEX_FOR_NATC, p.BASE_ASIN_ITEM_TYPE),
        c = E(c, p.PARAM_NAMES[b.inputName])
      b = 'string' === typeof b.inputValue ? b.inputValue : JSON.stringify(b.inputValue)
      return B(c, b)
    }
    H.addAsinItemKeyValuePairsForNATC = function (b, c, f) {
      var k = {},
        l = f.asin,
        t = f.quantity,
        z = f.offerListingId
      l && t && z
        ? ((b = y(b, c)),
          (l = C(b, p.PARAM_NAMES.ASIN, l, !0)),
          (k = w.extend(k, l)),
          (t = U(b, t, !0)),
          (k = w.extend(k, t)),
          (z = C(b, p.PARAM_NAMES.OFFER_LISTING_ID, z, !0)),
          (k = w.extend(k, z)))
        : M.log(
            'Invalid data (asin/offerListingId/quantity) is present in itemData' +
              JSON.stringify(f),
            'ERROR',
            X,
          )
      return k
    }
    return H
  })
})
/* ******** */
;(function (h) {
  var F = window.AmazonUIPageJS || window.P,
    t = F._namespace || F.attributeErrors,
    c = t
      ? t('DetailPageTwisterPlusSubAssets@secondaryFeatures', 'DetailPageTwisterPlusSubAssets')
      : F
  c.guardFatal
    ? c.guardFatal(h)(c, window)
    : c.execute(function () {
        h(c, window)
      })
})(function (h, F, t) {
  h.when(
    'A',
    'twister-plus-feature-state',
    'twister-plus-constants',
    'cc-manager',
    'a-sheet',
    'twister-plus-framework',
    'twister-plus-logger-service',
  ).register('twister-plus-price-bottom-sheet', function (c, y, k, C, D, f, d) {
    function b() {
      E = !0
      n.html(L.html())
      I = n.find('#tp-bottom-sheet-price-section')
      M = y.getTwisterPlusFeaturesState()
    }
    function a(a, e, r, b) {
      var g = e[0]
      ;(e = e[1]) && '00' !== e
        ? a.find('.a-price-fraction').text(String(e))
        : r
          ? (a.find('.a-price-fraction').addClass('aok-hidden'),
            a.find('.a-price-decimal').addClass('aok-hidden'))
          : ((e = '00'), a.find('.a-price-fraction').text(String(e)))
      a.find('.a-price-whole')
        .contents()
        .filter(function () {
          return 3 === this.nodeType || '' === this.textContent.trim()
        })
        .first()
        .replaceWith(Number(g).toLocaleString(t))
      b
        ? a.find('.tp-price-minus').removeClass('aok-hidden')
        : a.find('.tp-price-minus').addClass('aok-hidden')
    }
    function e(a, e) {
      a.find('#display-string').text(e)
    }
    function u(e, r, b) {
      e.find('#tp-item-quantity').text(r)
      e = e.find('.tp-bottom-sheet-quantity-block')
      e.removeClass('aok-hidden')
      a(e, b.toFixed(2).split('.'), !0, !1)
    }
    function v(a) {
      a += B.data(1 < V ? A.ITEM_COUNT_PLURAL_TEMPLATE : A.ITEM_COUNT_SINGULAR_TEMPLATE)
      return (a = a.replace(A.ITEM_COUNT_PLACEHOLDER, V))
    }
    function l(a) {
      var e = m.clone()
      a !== t && e.attr('id', a)
      e.find('#tp-bottom-sheet-price').removeClass('twister-plus-price-template')
      return e
    }
    function p() {
      var a = n
        .find('.twister-plus-subtotal-price-template')
        .clone()
        .removeClass('twister-plus-subtotal-price-template')
      a.find('#tp-bottom-sheet-subtotal-price-value').removeAttr('id')
      return a
    }
    function r(a) {
      return G.hasOwnProperty(a) && 0 < G[a].length
    }
    var x = c.$,
      m = x('#tp-bottom-sheet-price-block'),
      M,
      W,
      J,
      E = !1,
      A = k.bottomSheet,
      w = k.registrationMap,
      I = x('#tp-bottom-sheet-price-section'),
      n = x('#twister-plus-bottom-sheet'),
      B = n.find('#tp-bottom-sheet-item-strings'),
      R = n.find('#tp-bottom-sheet-discount-string'),
      L = n.clone(),
      G,
      Q,
      N = [],
      H = 0,
      V,
      z = k.metrics,
      X = new d.Timer(z.BOTTOM_SHEET_TIMER),
      O = !1,
      g,
      S = !1
    c.on('a:sheet:beforeShow:twisterPlusBottomSheet', function () {
      X.start()
      if (E) {
        var b = 0
        G = M.ccFeaturesState
        var z = r('paymentOptions'),
          c = M.twisterState.quantity
        V = parseInt(c)
        Q = M.priceData.totalPrice.toFixed(2).split('.')
        for (var d in W) {
          var m = W[d]
          if ('paymentOptions' !== m && r(m)) {
            var f = G[m][0],
              x = !1
            J[m].hasOwnProperty(w.IS_MULTI_SELECTION) && J[m][w.IS_MULTI_SELECTION] && (x = !0)
            for (
              var y = l('tp-bottom-sheet-price-block-' + m),
                k = f.orderSummaryDisplayString,
                C = G[m].length,
                O = 0,
                h = 0,
                q = 0,
                S = J[m][w.DISPLAY_SAVINGS_ROW_IN_BOTTOM_SHEET],
                L = 0;
              L < C;
              L++
            ) {
              var U = G[m][L],
                F = U.quantity !== t ? U.quantity : 1,
                h = h + parseInt(F),
                O = O + U.price * F
              S && U.savings !== t && (q += U.savings * F)
            }
            S && J[m][w.BASE_ITEM_SAVINGS] && (q += J[m][w.BASE_ITEM_SAVINGS] * c)
            z && ((H += O), (C = b ? k.toLowerCase() : k), N.push(C), b++)
            x
              ? (k =
                  1 < h
                    ? k + B.data(A.ITEM_COUNT_PLURAL_TEMPLATE)
                    : k + B.data(A.ITEM_COUNT_SINGULAR_TEMPLATE))
              : f.hasOwnProperty('shortDisplayTitle') &&
                f.shortDisplayTitle !== t &&
                ((k = k + ' (' + f.shortDisplayTitle + ')'), 1 < h && u(y, h, G[m][0].price))
            V += h
            k = k.replace(A.ITEM_COUNT_PLACEHOLDER, h)
            a(y.find('#tp-bottom-sheet-price'), O.toFixed(2).split('.'), !1, !1)
            e(y, k)
            I.append(y)
            0 < Math.round(100 * q) &&
              ((f =
                f.hasOwnProperty('overrideOrderSummarySavingString') &&
                f.overrideOrderSummarySavingString !== t
                  ? f.overrideOrderSummarySavingString
                  : R.data(A.DEFAULT_DISCOUNT_STRING)),
              (m = l('tp-bottom-sheet-savings-price-block-' + m)),
              a(m.find('#tp-bottom-sheet-price'), q.toFixed(2).split('.'), !1, !0),
              e(m, f),
              I.append(m))
          }
        }
        z
          ? ((z = G.paymentOptions[0]),
            (b = n.find('#tp-bottom-sheet-footnote-section')),
            (q = l('tp-bottom-sheet-price-block-interest')),
            (d = z.interestAmount.toFixed(2).split('.')),
            a(q.find('#tp-bottom-sheet-price'), d, !1, !1),
            e(q, z.interestDisplayString),
            I.append(q),
            z.isOrderLevel || 0 === N.length
              ? (n
                  .find('#twister-plus-order-level-monthly-payments-section')
                  .removeClass('aok-hidden'),
                (q = n.find('#tp-bottom-sheet-order-level-monthly-payments-price-block')),
                e(q, z.orderSummaryDisplayString),
                (d = p()),
                q.find('#tp-order-level-monthly-payment-subtotal-price').append(d),
                (d = z.price.toFixed(2).split('.')),
                a(q, d, !1, !1),
                (z = z.bottomSheetFootnoteDisplayString))
              : (n
                  .find('#twister-plus-item-level-monthly-payments-section')
                  .removeClass('aok-hidden'),
                (q = l('tp-bottom-sheet-price-block-monthly-payment')),
                (d = z.price.toFixed(2).split('.')),
                a(q.find('#tp-bottom-sheet-price'), d, !1, !1),
                e(q, z.orderSummaryDisplayString),
                q.addClass('a-spacing-top-base'),
                (m = n.find('#tp-monthly-payments-breakdown-section')),
                m.append(q),
                (q = l('tp-bottom-sheet-price-block-all-selections')),
                (d = H.toFixed(2).split('.')),
                a(q.find('#tp-bottom-sheet-price'), d, !1, !1),
                e(q, N.join(', ')),
                m.append(q),
                (q = p()),
                n.find('#tp-item-level-monthly-payment-subtotal-price').append(q),
                (d = (z.price + H).toFixed(2).split('.')),
                a(q, d, !1, !1),
                (z = n
                  .find('#tp-bottom-sheet-footnote-string')
                  .data(A.MONTHLY_PAYMENTS_FOOTNOTE_TEMPLATE))),
            (d = n.find('#tp-bottom-sheet-monthly-payment-subtotal-price-block')),
            (q = d.find('#display-string').text()),
            (q = v(q)),
            e(d, q),
            (q = n
              .find('.twister-plus-price-template')
              .clone()
              .removeClass('twister-plus-price-template')
              .addClass('a-text-bold')),
            d.find('#tp-monthly-payment-subtotal-price').append(q),
            a(d, Q, !1, !1),
            n.find('#tp-bottom-sheet-subtotal-price-block').addClass('aok-hidden'),
            d.removeClass('aok-hidden'),
            (q = n
              .find('#tp-footnote-text')
              .clone()
              .attr('id', 'tp-monthly-payment-footnote-text')),
            q.text(z),
            b.append(q))
          : (a(n.find('#tp-bottom-sheet-subtotal-price-value'), Q, !1, !1),
            (b = n.find('#tp-bottom-sheet-subtotal-price-block')),
            (z = b.find('#display-string').text()),
            (z = v(z)),
            e(b, z))
        1 < c &&
          ((b = l()),
          (z = M.twisterState.price),
          u(b, c, z),
          (c *= z),
          a(b.find('#tp-bottom-sheet-price'), c.toFixed(2).split('.'), !1, !1),
          I.find('#tp-bottom-sheet-price-block').replaceWith(b))
        g = D.get(A.BOTTOM_SHEET_NAME).getContentContainer()
        g.html(n.html())
        g.addClass('twister-plus-bottom-sheet-padding')
      }
      E = !1
    })
    c.on('a:sheet:afterShow:twisterPlusBottomSheet', function () {
      var a = g[0].scrollHeight
      0 < a &&
        (D.get(A.BOTTOM_SHEET_NAME).changeHeight({ height: a, duration: A.RESIZE_DURATION }) ||
          h.log('Bottom sheet resize failed', 'ERROR', A.FEATURE_ATTRIBUTION))
      X.stop()
      O || (d.logCounter(z.BOTTOM_SHEET_GV), (O = !0))
    })
    return {
      init: function () {
        m = x('#tp-bottom-sheet-price-block')
        I = x('#tp-bottom-sheet-price-section')
        n = x('#twister-plus-bottom-sheet')
        L = n.clone()
        B = n.find('#tp-bottom-sheet-item-strings')
        R = n.find('#tp-bottom-sheet-discount-string')
        E = !1
        M = y.getTwisterPlusFeaturesState()
        W = C.getRenderedFeaturesList()
        O = !1
        if (!S) {
          var a = {}
          a.featureName = A.FEATURE_NAME
          a.featureAttribution = A.FEATURE_ATTRIBUTION
          f.registerFeature(a, A.EVENT_NAME, b)
          J = C.getFeatureRegistrationDetails()
          S = !0
        }
      },
    }
  })
  ;('use strict')
  h.when('A', 'utils').register('buy-box-price-update', function (c, y) {
    function k() {
      p.text('/' + a.termType)
      r.text(a.termCount.toString() + ' ' + a.termType)
      x.removeClass('aok-hidden')
    }
    function C() {
      p.text('')
      r.text('')
      x.addClass('aok-hidden')
    }
    function D() {
      2 === e.length
        ? u.find('.a-price-fraction').text(String(e[1].substring(0, 2)))
        : u.find('.a-price-fraction').text('00')
      u.find('.a-price-whole')
        .contents()
        .filter(function () {
          return 3 === this.nodeType || '' === this.textContent.trim()
        })
        .first()
        .replaceWith(Number(e[0]).toLocaleString(t))
    }
    var f = c.$
    c = {}
    var d, b, a, e, u, v, l, p, r, x
    c.init = function () {
      d = 0
      u = f('#tp_price_block_total_price_ww')
      v = f('#tp_options_detail')
      l = f('#tp_monthly_options_detail')
      p = f('#tp-price-update-payment-term')
      r = f('#tp-price-update-payment-term-length')
      x = f('#tp-price-update-payment-period')
    }
    c.updatePriceSubtotalFeature = function (r) {
      b = r.ccFeaturesState
      var c = r.priceData
      if (c && y.isValidNumber(c.totalPrice) && y.isValidNumber(c.youSave)) {
        var c = b.hasOwnProperty('paymentOptions') && 0 < b.paymentOptions.length,
          u = 0,
          p
        for (p in b)
          if ('paymentOptions' !== p && 0 < b[p].length) {
            u = 1
            break
          }
        c
          ? ((a = b.paymentOptions[0]),
            a.isOrderLevel
              ? ((e = a.price.toFixed(2).split('.')),
                D(),
                k(),
                1 === u ? v.removeClass('aok-hidden') : v.addClass('aok-hidden'),
                l.addClass('aok-hidden'))
              : 1 === u
                ? ((e = (r.priceData.totalPrice + a.price - r.twisterState.price)
                    .toFixed(2)
                    .split('.')),
                  D(),
                  C(),
                  v.addClass('aok-hidden'),
                  l.removeClass('aok-hidden'))
                : ((e = a.price.toFixed(2).split('.')),
                  D(),
                  k(),
                  v.addClass('aok-hidden'),
                  l.addClass('aok-hidden')))
          : ((e = r.priceData.totalPrice.toFixed(2).split('.')),
            D(),
            C(),
            v.removeClass('aok-hidden'),
            l.addClass('aok-hidden'))
        r = f('#tp_price_update_feature_ww')
        p = f('#tp_price_row_ww')
        1 === d && (p.css('display', 'none'), r.css('display', 'none'), (d = 0))
      }
    }
    return c
  })
  ;('use strict')
  h.when('A', 'twister-plus-constants').register('twister-plus-pinning', function (c, y) {
    var k = c.$,
      t = y.selectors
    return {
      init: function () {
        var c = k(t.PPD_RIGHT_COL_ID)
        c && c.addClass('twister-plus-pinning')
      },
    }
  })
  ;('use strict')
  h.when('A', 'twister-plus-constants').register('priceUpdate', function (c, y) {
    function k(a, e, c, v) {
      var l = a
      D.each(c, function (a, r) {
        var c = v && v[a] && v[a][b.INCLUDE_SAVINGS_CALCULATION_IN_SUBTOTAL]
        D.each(r, function (e, b) {
          a !== f.PAYMENT_OPTIONS_FEATURE &&
            b.price !== t &&
            (a === d.KEY_BUYBACK
              ? b.isBuyBack && (l = l - b.savings + b.price)
              : a === f.COUPONS_FEATURE
                ? (l -= b.savings)
                : ((e = b.quantity !== t ? b.quantity : 1),
                  (l += b.price * e),
                  c && b.savings !== t && (l -= b.savings * e)))
        })
        c && v[a][b.BASE_ITEM_SAVINGS] !== t && (l -= v[a][b.BASE_ITEM_SAVINGS] * e)
      })
      return l
    }
    function h(a, e, c, v, l) {
      var p = e
      D.each(v, function (a, e) {
        D.each(e, function (e, b) {
          a !== f.PAYMENT_OPTIONS_FEATURE &&
            b.savings !== t &&
            (a === d.KEY_BUYBACK
              ? b.isBuyBack && (p += b.savings)
              : (p += b.savings * (b.quantity !== t ? b.quantity : 1)))
        })
        l && l[a] && l[a][b.BASE_ITEM_SAVINGS] !== t && (p += l[a][b.BASE_ITEM_SAVINGS] * c)
      })
      return p
    }
    var D = c.$
    c = {}
    var f = y.ccFeatures,
      d = y.itemAssociation,
      b = y.registrationMap
    c.getTotalPrice = function (a, e) {
      var b = {},
        c = a.twisterState.quantity ? a.twisterState.quantity : 1
      b.totalPrice = k(a.twisterState.price * c, c, a.ccFeaturesState, e)
      return b
    }
    c.getTotalPriceAndYouSave = function (a, b) {
      var c = {},
        d = a.twisterState.quantity ? a.twisterState.quantity : 1,
        l = a.twisterState.price * d,
        f = a.twisterState.savings * d
      c.totalPrice = k(l, d, a.ccFeaturesState, b)
      c.youSave = h(l, f, d, a.ccFeaturesState, b)
      return c
    }
    return c
  })
  ;('use strict')
  h.when('A', 'twister-plus-constants').register('side-sheet', function (c, y) {
    function k() {
      d('#twister-plus-side-sheet-content').show(function () {
        h({ right: '0px' })
      })
    }
    function t() {
      d('#twister-plus-side-sheet-content').show(function () {
        h({ right: '-600px' })
      })
    }
    function h(b, a) {
      c.animate(d('#twister-plus-side-sheet-content'), b, f.RESIZE_DURATION, a)
    }
    var f = y.sideSheet,
      d = c.$
    c.declarative('side-sheet', 'click', function (b) {
      d('body').css('overflow', 'hidden')
      c.show('#twister-plus-dp-bg')
      k()
    })
    c.declarative('close-side-sheet', 'click', function (b) {
      t()
      c.hide('#twister-plus-dp-bg')
      d('body').css('overflow', 'scroll')
    })
    return {
      getContentContainer: function () {
        return d('#tp-side-sheet-main-section')
      },
    }
  })
  ;('use strict')
  h.when(
    'A',
    'twister-plus-constants',
    'cc-manager',
    'twister-plus-framework',
    'side-sheet',
    'a-carousel-framework',
  ).register('twister-plus-side-sheet', function (c, y, k, t, h, f) {
    function d() {
      var a = k.getFeatureCurrentlyExpanded()
      a && ((a = k.isMultiSelectionFeature(a)) || c.trigger('a:declarative:close-side-sheet:click'))
    }
    function b(a) {
      ;(a = a.hasClass(e.CAROUSEL_CONTAINER_CLASS_NAME) ? a : a.find(e.CAROUSEL_CONTAINER_CLASS)) &&
        0 < a.length &&
        !a.hasClass(e.CAROUSEL_INITIALIZED_CLASS_NAME) &&
        (a.addClass(e.CAROUSEL_NOT_INITIALIZED_CLASS_NAME), f.createAll(), f.initializeAll())
    }
    var a = c.$,
      e = y.sideSheet,
      u,
      v,
      l,
      p = !1
    c.on('a:declarative:side-sheet:click', function (d) {
      u.html(v.html())
      l = h.getContentContainer()
      var f = a(e.SYMBOL_HASH + d.data.contentId),
        m = a(e.SYMBOL_HASH + d.data.contentId).clone(),
        p = d.data.url
      p && !f.prop('data-urlLoaded')
        ? ((m = a(e.SYMBOL_HASH + d.data.preUrlLoadDomId).clone()),
          m.prop('id', d.data.contentId + '-sideSheet'),
          m.removeClass('aok-hidden'),
          l.html(m),
          l.removeClass('aok-hidden'),
          a('#twister-plus-side-sheet-content').removeClass('aok-hidden'),
          c.ajax(p, {
            method: 'get',
            success: function (b) {
              f.prop('data-urlLoaded', 'true')
              f.html(b)
              b = a(e.SYMBOL_HASH + d.data.contentId).clone()
              b.prop('id', d.data.contentId + '-sideSheet')
              l.html(b)
              d.data.postLoadEvent && c.trigger(d.data.postLoadEvent, d.data)
              c.trigger(e.SIDE_SHEET_AJAX_SUCCESS, d)
              b.css(e.DISPLAY, 'block')
              l.removeClass('aok-hidden')
              a('#twister-plus-side-sheet-content').removeClass('aok-hidden')
            },
            failure: function (b) {
              b = a(e.SYMBOL_HASH + d.data.failedUrlLoadDomId).clone()
              b.removeClass('aok-hidden')
              l.html(b)
              l.removeClass('aok-hidden')
              a('#twister-plus-side-sheet-content').removeClass('aok-hidden')
            },
          }))
        : (m.prop('id', d.data.contentId + '-sideSheet'),
          l.append(m),
          m.css(e.DISPLAY, 'block'),
          l.removeClass('aok-hidden'),
          a('#twister-plus-side-sheet-content').removeClass('aok-hidden'),
          b(m))
    })
    return {
      init: function () {
        u = a('#tp-side-sheet')
        v = u.clone()
        if (!p) {
          var b = {}
          b.featureName = e.FEATURE_NAME
          b.featureAttribution = e.FEATURE_ATTRIBUTION
          t.registerFeature(b, e.EVENT_NAME, d)
          p = !0
        }
      },
    }
  })
  h.when(
    'A',
    'twister-plus-feature-state',
    'twister-plus-constants',
    'cc-manager',
    'a-popover',
    'twister-plus-framework',
  ).register('twister-plus-price-tool-tip', function (c, y, k, h, D, f) {
    function d() {
      J = !0
      w.html(n.html())
      A = w.find('#tp-tool-tip-price-section')
      m = y.getTwisterPlusFeaturesState()
    }
    function b(a, b, e) {
      var d = b[0]
      ;(b = b[1]) && '00' !== b
        ? a.find('.a-price-fraction').text(String(b))
        : e
          ? (a.find('.a-price-fraction').addClass('aok-hidden'),
            a.find('.a-price-decimal').addClass('aok-hidden'))
          : ((b = '00'), a.find('.a-price-fraction').text(String(b)))
      a.find('.a-price-whole')
        .contents()
        .filter(function () {
          return 3 === this.nodeType || '' === this.textContent.trim()
        })
        .first()
        .replaceWith(Number(d).toLocaleString(t))
    }
    function a(a, b) {
      a.find('#display-string').text(b)
    }
    function e(a, e, d) {
      a.find('#tp-item-quantity').text(e)
      a = a.find('.tp-tool-tip-quantity-block')
      a.removeClass('aok-hidden')
      b(a, d.toFixed(2).split('.'), !0)
    }
    function u(a) {
      a += I.data(1 < N ? E.ITEM_COUNT_PLURAL_TEMPLATE : E.ITEM_COUNT_SINGULAR_TEMPLATE)
      return (a = a.replace(E.ITEM_COUNT_PLACEHOLDER, N))
    }
    function v(a) {
      var b = x.clone()
      a !== t && b.attr('id', a)
      b.find('#tp-tool-tip-price').removeClass('twister-plus-price-template')
      return b
    }
    function l() {
      var a = w
        .find('.twister-plus-subtotal-price-template')
        .clone()
        .removeClass('twister-plus-subtotal-price-template')
      a.find('#tp-tool-tip-subtotal-price-value').removeAttr('id')
      return a
    }
    function p(a) {
      return B.hasOwnProperty(a) && 0 < B[a].length
    }
    var r = c.$,
      x = r('#tp-tool-tip-price-block'),
      m,
      M,
      F,
      J = !1,
      E = k.toolTip,
      A = r('#tp-tool-tip-price-section'),
      w = r('#twister-plus-tool-tip'),
      I = w.find('#tp-tool-tip-item-strings'),
      n = w.clone(),
      B,
      R,
      L = [],
      G = 0,
      Q,
      N,
      H = !1
    c.on('a:popover:beforeShow:twisterPlusPopOver', function () {
      var d = r('.twister-plus-tool-tip-padding').parents('.a-popover'),
        c = r('#twister-plus-popover-inner').parents('.a-popover')
      d.addClass('twister-plus-popover-margin')
      c.addClass('twister-plus-popover-margin')
      if (J) {
        c = 0
        B = m.ccFeaturesState
        var f = p('paymentOptions'),
          d = m.twisterState.quantity
        N = parseInt(d)
        R = m.priceData.totalPrice.toFixed(2).split('.')
        for (var k in M) {
          var g = M[k]
          if ('paymentOptions' !== g && p(g)) {
            var h = B[g][0],
              y = !1
            F[g].hasOwnProperty('isMultiSelection') && F[g].isMultiSelection && (y = !0)
            var n = v('tp-tool-tip-price-block-' + g),
              x = h.orderSummaryDisplayString,
              C = B[g].length,
              H = 0,
              P = 0
            if ('couponsCard' === g) {
              for (var K = 0; K < C; K++)
                var T = B[g][K].quantity !== t ? B[g][K].quantity : 1,
                  P = P + parseInt(T),
                  H = H + B[g][K].savings * T
              n.find('#price-sign-string').text('-')
            } else
              for (K = 0; K < C; K++)
                (T = B[g][K].quantity !== t ? B[g][K].quantity : 1),
                  (P += parseInt(T)),
                  (H += B[g][K].price * T)
            f && ((G += H), (C = c ? x.toLowerCase() : x), L.push(C), c++)
            y
              ? (x =
                  1 < P
                    ? x + I.data(E.ITEM_COUNT_PLURAL_TEMPLATE)
                    : x + I.data(E.ITEM_COUNT_SINGULAR_TEMPLATE))
              : h.hasOwnProperty('shortDisplayTitle') &&
                h.shortDisplayTitle !== t &&
                ((x = x + ' (' + h.shortDisplayTitle + ')'), 1 < P && e(n, P, B[g][0].price))
            N += P
            x = x.replace(E.ITEM_COUNT_PLACEHOLDER, P)
            b(n.find('#tp-tool-tip-price'), H.toFixed(2).split('.'), !1)
            a(n, x)
            A.append(n)
          }
        }
        f
          ? ((c = B.paymentOptions[0]),
            (k = w.find('#tp-tool-tip-footnote-section')),
            (g = v('tp-tool-tip-price-block-interest')),
            (f = c.interestAmount.toFixed(2).split('.')),
            b(g.find('#tp-tool-tip-price'), f, !1),
            a(g, c.interestDisplayString),
            A.append(g),
            c.isOrderLevel || 0 === L.length
              ? (w
                  .find('#twister-plus-order-level-monthly-payments-section')
                  .removeClass('aok-hidden'),
                (g = w.find('#tp-tool-tip-order-level-monthly-payments-price-block')),
                a(g, c.orderSummaryDisplayString),
                (f = l()),
                g.find('#tp-order-level-monthly-payment-subtotal-price').append(f),
                (f = c.price.toFixed(2).split('.')),
                b(g, f, !1),
                (c = c.toolTipFootnoteDisplayString))
              : (w
                  .find('#twister-plus-item-level-monthly-payments-section')
                  .removeClass('aok-hidden'),
                (g = v('tp-tool-tip-price-block-monthly-payment')),
                (f = c.price.toFixed(2).split('.')),
                b(g.find('#tp-tool-tip-price'), f, !1),
                a(g, c.orderSummaryDisplayString),
                g.addClass('a-spacing-top-base'),
                (h = w.find('#tp-monthly-payments-breakdown-section')),
                h.append(g),
                (g = v('tp-tool-tip-price-block-all-selections')),
                (f = G.toFixed(2).split('.')),
                b(g.find('#tp-tool-tip-price'), f),
                a(g, L.join(', ')),
                h.append(g),
                (g = l()),
                w.find('#tp-item-level-monthly-payment-subtotal-price').append(g),
                (f = (c.price + G).toFixed(2).split('.')),
                b(g, f, !1),
                (c = w
                  .find('#tp-tool-tip-footnote-string')
                  .data(E.MONTHLY_PAYMENTS_FOOTNOTE_TEMPLATE))),
            (f = w.find('#tp-tool-tip-monthly-payment-subtotal-price-block')),
            (g = f.find('#display-string').text()),
            (g = u(g)),
            a(f, g),
            (g = w
              .find('.twister-plus-price-template')
              .clone()
              .removeClass('twister-plus-price-template')
              .addClass('a-text-bold')),
            f.find('#tp-monthly-payment-subtotal-price').append(g),
            b(f, R, !1),
            w.find('#tp-tool-tip-subtotal-price-block').addClass('aok-hidden'),
            f.removeClass('aok-hidden'),
            (g = w
              .find('#tp-footnote-text')
              .clone()
              .attr('id', 'tp-monthly-payment-footnote-text')),
            g.text(c),
            k.append(g))
          : (b(w.find('#tp-tool-tip-subtotal-price-value'), R, !1),
            (k = w.find('#tp-tool-tip-subtotal-price-block')),
            (c = k.find('#display-string').text()),
            (c = u(c)),
            a(k, c))
        1 < d &&
          ((k = v()),
          (c = m.twisterState.price),
          e(k, d, c),
          (d *= c),
          b(k.find('#tp-tool-tip-price'), d.toFixed(2).split('.'), !1),
          A.find('#tp-tool-tip-price-block').replaceWith(k))
        Q = D.get(E.TOOL_TIP_NAME).getContent()
        Q.html(w.html())
        Q.addClass('twister-plus-tool-tip-padding')
      }
      J = !1
    })
    return {
      init: function () {
        x = r('#tp-tool-tip-price-block')
        A = r('#tp-tool-tip-price-section')
        w = r('#twister-plus-tool-tip')
        n = w.clone()
        I = w.find('#tp-tool-tip-item-strings')
        J = !1
        m = y.getTwisterPlusFeaturesState()
        M = h.getRenderedFeaturesList()
        if (!H) {
          var a = {}
          a.featureName = E.FEATURE_NAME
          a.featureAttribution = E.FEATURE_ATTRIBUTION
          f.registerFeature(a, E.EVENT_NAME, d)
          F = h.getFeatureRegistrationDetails()
          H = !0
        }
      },
    }
  })
  h.when('A', 'twister-plus-constants', 'utils').register(
    'twister-plus-unavailable-message',
    function (c, h, k) {
      function C(b, a, c, u) {
        u = k.getActiveAccordionRow(c, u)
        c = b[0]
        a = a[c]
        var v = a[0].displayQuantityMessage
        v
          ? ((b = 1 === b.length ? d.QUANTITY_RESTRICTION : d.MULTIPLE),
            (u = 1 === f(b).length ? f(b) : u ? u.find(b) : f(d.ACTIVE_ACCORDION).find(b)))
          : ((b = 1 === b.length ? d.SINGLE : d.MULTIPLE),
            (u = u ? u.find(b) : f(d.ACTIVE_ACCORDION).find(b)))
        b = u.parent().first()
        var l = a[0] && a[0].maxQuantity,
          p = a[0] && a[0].orderSummaryDisplayString
        p
          ? (c = a[0].invalidSelectionTitle) &&
            (p = p + h.SPACE + h.OPENING_BRACKET + c + h.CLOSING_BRACKET)
          : (p = c)
        c = u.clone()
        c.removeClass(d.HIDDEN).addClass(d.DISPLAYABLE_MESSAGE)
        c.html(function (a, b) {
          return v
            ? b.replace('${cardName}', p).replace('${maxQuantity}', l)
            : b.replace('${cardName}', p)
        })
        f(b).append(c)
      }
      function D(b, a) {
        var c = f(d.CLASS + d.TEMPLATE),
          h = c.parent()
        f.each(b, function (b, f) {
          b = c && c.first() && c.first().clone()
          b.removeClass(d.HIDDEN).removeClass(d.TEMPLATE).addClass(d.MESSAGE_ITEM)
          var k = a[f],
            r = (k[0] && k[0].orderSummaryDisplayString) || f
          b.html(function (a, b) {
            return b.replace('%cardName%', r)
          })
          h.append(b)
        })
      }
      var f = c.$,
        d = h.unavailableMessage
      return {
        update: function (b) {
          f(d.CLASS + d.DISPLAYABLE_MESSAGE).remove()
          f(d.CLASS + d.MESSAGE_ITEM).remove()
          var a = b.getCCRemovedSelections(),
            c = b.getCurrentBuyingOptionPosition()
          b = b.getCurrentGroupName()
          var h = a ? Object.keys(a) : t
          h && 0 < h.length && (C(h, a, c, b), D(h, a))
        },
      }
    },
  )
})
/* ******** */
;(function (c) {
  var f = window.AmazonUIPageJS || window.P,
    k = f._namespace || f.attributeErrors,
    d = k ? k('DetailPageABSMultiSelectionIngressAssets', '') : f
  d.guardFatal
    ? d.guardFatal(c)(d, window)
    : d.execute(function () {
        c(d, window)
      })
})(function (c, f, k) {
  c.when(
    'A',
    'dp-latency-marker',
    'abs_msx_ingress_constants',
    'abs_msx_html_builder',
    'abs_msx_ingress_metrics',
    'abs_msx_ingress_utils',
  ).register('abs_msx_ingress', function (d, g, a, w, h, q) {
    function l(b) {
      b = JSON.parse(b.currentTarget.dataset.msxingressclick)
      var e = b.asin
      b = 'true' === String(b.isFlowEnabledForAjax).toLowerCase()
      var c = { asin: e }
      e = new URL(f.location)
      var h = { customizationToken: e.searchParams.get('customizationToken') },
        g = { showFeatures: 'msxPrimaryWidget' }
      b || (g.experienceId = 'absMultiSelection')
      c = d.extend({}, g, c, h)
      var l = new URL(e.origin)
      l.pathname = b ? a.FLOW_AJAX_ENDPOINT_PATH : a.GXA_AJAX_ENDPOINT_PATH
      Object.entries(c).forEach(function (a) {
        a[0] && a[1] && l.searchParams.append(a[0], a[1])
      })
      return l.href
    }
    function x(b) {
      document.body.style.overflow = 'hidden'
      d.ajax(b, {
        method: 'get',
        success: k,
        error: function (b) {
          m = !0
          h.registerCounter(a.msxMetrics.MSX_AJAX_CALL_TO_FETCH_MSX_CONTENT_FAILED)
          n()
        },
      })
    }
    function k(b) {
      p = !0
      b = b.trim()
      ;/^\s*$/.test(b)
        ? ((m = !0),
          h.registerCounter(a.msxMetrics.MSX_EMPTY_RESPONSE_AFTER_AJAX_CALL_SUCCESS),
          n())
        : (y(b),
          c.when('msx_slotDataLoader').execute(function (a) {
            a.initialLoad()
          }))
    }
    function y(b) {
      d.hide(document.getElementById(a.MSX_SPINNER_HTML_ID))
      var e = document.getElementById(a.MSX_SIDE_SHEET_TOP_CONTAINER_HTML_ID)
      e && e.insertAdjacentHTML('beforeend', b)
    }
    function z() {
      d.hide(document.getElementById(a.MSX_SPINNER_HTML_ID))
      var b = document.getElementById(r),
        e = document.getElementById(t)
      b.style.display = 'block'
      q.deviceTypeMobile()
        ? (null !== e && ((e.style.display = 'block'), (e.style.height = '100vh')),
          (b.style.height = '100vh'))
        : (d.show(document.getElementById(a.MSX_BACKGROUND_HTML_ID)),
          null !== e && (e.style.width = '605px'),
          (b.style.width = '605px'))
      document.body.style.overflow = 'hidden'
    }
    function u() {
      d.hide(document.getElementById(a.MSX_SPINNER_HTML_ID))
      var b = document.getElementById(r),
        e = document.getElementById(t)
      q.deviceTypeMobile()
        ? (e && (e.style.height = '0'), (b.style.height = '0'))
        : (d.hide(document.getElementById(a.MSX_BACKGROUND_HTML_ID)),
          e && (e.style.width = '0'),
          (b.style.width = '0'))
      document.body.style.overflow = 'scroll'
    }
    function n() {
      d.hide(document.getElementById(a.MSX_SPINNER_HTML_ID))
      document
        .getElementById(a.MSX_SIDE_SHEET_TOP_CONTAINER_HTML_ID)
        .appendChild(document.getElementById(a.MSX_ERROR_MSG_ID))
      document.getElementById(a.MSX_ERROR_MSG_ID).classList.remove(a.MSX_AOK_HIDDEN_CLASS)
    }
    var v = !1,
      p = !1
    g = a.viewEvents.CLICK
    var t = a.msxSideSheetSelectors.MSX_SIDE_SHEET,
      r = a.msxSideSheetSelectors.MSX_SIDE_SHEET_TOP_CONTAINER,
      m = !1
    d.declarative('msxIngressClick', g, function (b) {
      b = b.$event
      b.stopPropagation()
      ;(f.history.state && f.history.state.page === a.MSX_STATE) ||
        f.history.pushState({ page: a.MSX_STATE }, null)
      f.onpopstate = function () {
        u()
      }
      h.registerCounter(a.msxMetrics.MSX_INGRESS_LINK_CLICKED)
      p || v || (c.register('msxIngressClick'), (v = !0))
      w.createMsxContainer()
      b && b.currentTarget && b.currentTarget.dataset && b.currentTarget.dataset.msxingressclick
        ? ((b = l(b)), d.show(document.getElementById(a.MSX_SPINNER_HTML_ID)), p || m ? z() : x(b))
        : (h.registerCounter(a.msxMetrics.MSX_INGRESS_CLICK_EVENT_FAILED), n())
    })
    d.declarative('close-multi-selection-experience', g, function (a) {
      u()
    })
  })
  ;('use strict')
  c.when('dp-latency-marker').register('abs_msx_ingress_constants', function (d) {
    return {
      MSX_SIDE_SHEET_OPENED: 'msxSideSheetOpened',
      GXA_AJAX_ENDPOINT_PATH: '/gp/product/ajax',
      FLOW_AJAX_ENDPOINT_PATH: '/gp/product/ajax/absMultiSelection',
      viewEvents: { CLICK: 'click' },
      msxSideSheetSelectors: {
        MSX_SIDE_SHEET: 'multi-selection-experience',
        MSX_SIDE_SHEET_TOP_CONTAINER: 'msx-top-container',
      },
      msxSideSheetBackgroundSelectors: {
        MSX_BACKGROUND_DECLARATIVE_CONTENT:
          "\x3cspan class\x3d'a-declarative' data-action\x3d'close-multi-selection-experience' data-close-multi-selection-experience\x3d'{}'\x3e\x3c/span\x3e",
        MSX_BACKGROUND_CONTENT:
          "\x3cdiv id\x3d'msx-background' class\x3d'a-section msx-darken-background'\x3e\x3c/div\x3e",
        MSX_SPINNER_CONTAINER_CONTENT:
          "\x3cdiv id\x3d'multi-selection-experience-spinner' class\x3d'a-spinner-wrapper aok-hidden'\x3e\x3c/div\x3e",
        MSX_CONTAINER_CONTENT:
          "\x3cdiv id\x3d'msx-top-container' class\x3d'a-section'\x3e\x3c/div\x3e",
      },
      msxMetrics: {
        MSX_AJAX_CALL_TO_FETCH_MSX_CONTENT_FAILED: 'ABDpxMsx.ajaxCallToFetchMsxContentFailed',
        MSX_EMPTY_RESPONSE_AFTER_AJAX_CALL_SUCCESS: 'ABDpxMsx.emptyResponseAfterAjaxCallSuccess',
        MSX_INGRESS_CLICK_EVENT_FAILED: 'ABDpxMsx.ingressClickEventFailed',
        MSX_INGRESS_LINK_CLICKED: 'ABDpxMsx.ingressLinkClicked',
      },
      HTML_BODY_TAG: 'body',
      MSX_ANIMATION_CONTAINER: "\x3cspan class\x3d'msx-spinner-container'\x3e",
      MSX_ANIMATION_CONTAINER_INNER: "\x3cspan class\x3d'msx-spinner-container-inner'\x3e",
      MSX_PAGE_LOAD_ANIMATION_CUSTOM:
        "\x3cspan class\x3d'msx-animation msx-page-load'\x3e\x3c/span\x3e",
      HTML_SPAN_CLOSE_TAG: '\x3c/span\x3e',
      DIV_LOAD_TEXT: "\x3cdiv class\x3d'msx-load-text'\x3e",
      HTML_SIZE_BASE_COLOR_BASE: "\x3cspan class\x3d'a-size-base a-color-base'\x3e",
      MSX_FUN_STRING_SUSPENSEFUL_MUSIC: 'MSX_FUN_STRING_SUSPENSEFUL_MUSIC',
      HTML_DIV_CLOSE_TAG: '\x3c/div\x3e',
      MSX_BACKGROUND_HTML_ID: 'msx-background',
      MSX_SIDE_SHEET_TOP_CONTAINER_HTML_ID: 'msx-top-container',
      MSX_SPINNER_HTML_ID: 'multi-selection-experience-spinner',
      MSX_ERROR_MSG_ID: 'msx-error-msg-id',
      MSX_STATE: 'MSX',
      MSX_AOK_HIDDEN_CLASS: 'aok-hidden',
    }
  })
  ;('use strict')
  c.when(
    'jQuery',
    'dp-latency-marker',
    'abs_msx_ingress_constants',
    'abs_msx_spinner_builder',
  ).register('abs_msx_html_builder', function (d, c, a, f) {
    var h = !1
    return {
      createMsxContainer: function () {
        if (!h) {
          var c = d(a.msxSideSheetBackgroundSelectors.MSX_BACKGROUND_CONTENT),
            g = d(a.msxSideSheetBackgroundSelectors.MSX_BACKGROUND_DECLARATIVE_CONTENT)
          c.appendTo(g)
          g.prependTo(a.HTML_BODY_TAG)
          c = f.getSpinnerComponent()
          g = d(a.msxSideSheetBackgroundSelectors.MSX_SPINNER_CONTAINER_CONTENT)
          var k = d(a.msxSideSheetBackgroundSelectors.MSX_CONTAINER_CONTENT)
          c.appendTo(g)
          g.appendTo(k)
          k.prependTo(a.HTML_BODY_TAG)
          h = !0
        }
      },
    }
  })
  ;('use strict')
  c.when('jQuery', 'dp-latency-marker', 'abs_msx_ingress_constants', 'msx-spinner-string').register(
    'abs_msx_spinner_builder',
    function (d, c, a, f) {
      return {
        getSpinnerComponent: function () {
          var c =
            a.MSX_ANIMATION_CONTAINER +
            a.MSX_ANIMATION_CONTAINER_INNER +
            a.MSX_PAGE_LOAD_ANIMATION_CUSTOM +
            a.HTML_SPAN_CLOSE_TAG
          c +=
            a.DIV_LOAD_TEXT +
            a.HTML_SIZE_BASE_COLOR_BASE +
            f.getSpinnerString(a.MSX_FUN_STRING_SUSPENSEFUL_MUSIC) +
            a.HTML_SPAN_CLOSE_TAG +
            a.HTML_DIV_CLOSE_TAG
          c += a.HTML_SPAN_CLOSE_TAG
          return d(c)
        },
      }
    },
  )
  ;('use strict')
  c.when('dp-latency-marker').register('msx-spinner-string', function (d) {
    var c = { MSX_FUN_STRING_SUSPENSEFUL_MUSIC: '[Suspenseful music plays]' }
    return {
      getSpinnerString: function (a) {
        return c[a]
      },
    }
  })
  ;('use strict')
  c.when('dp-latency-marker').register('abs_msx_ingress_metrics', function (c) {
    return {
      registerCounter: function (c) {
        f.ue && f.ue.count && f.ue.count(c, (f.ue.count(c) || 0) + 1)
      },
    }
  })
  ;('use strict')
  c.when('dp-latency-marker').register('abs_msx_ingress_utils', function (c) {
    return {
      deviceTypeMobile: function () {
        return !1
      },
    }
  })
})
/* ******** */
;(function (c) {
  var e = window.AmazonUIPageJS || window.P,
    f = e._namespace || e.attributeErrors,
    a = f ? f('DetailPageDeepCheckPromiseAssets', '') : e
  a.guardFatal
    ? a.guardFatal(c)(a, window)
    : a.execute(function () {
        c(a, window)
      })
})(function (c, e, f) {
  c.when('A', 'deep-check-promise-container', 'deep-check-promise-loader').register(
    'deep-check-promise',
    function (a, k, d) {
      return {
        asyncRequestDeepCheckPromise: function (b) {
          var a = e.ue,
            c = e.uet,
            f = e.uex,
            l = b.url,
            g = {},
            h = k.getDcpContainer(b)
          h.length
            ? (h.hide(),
              (g.params = {
                asin: b.asin,
                buyingOptionIndex: b.buyingOptionIndex,
                customerId: b.customerId,
                device: b.device,
                marketplaceId: b.marketplaceId,
                merchantId: b.merchantId,
                requestId: b.requestId,
                sessionId: b.sessionId,
                slateToken: b.slateToken,
              }),
              (g.headers = { 'Accept-Language': b.language, 'csrf-token': b.csrfToken }),
              (g.success = function (b) {
                h.html(b.content)
                h.show()
                a && a.count && a.count('dcp_ajax_success', 1)
                'function' === typeof c && c('cf', 'DeepCheckPromise', { wb: 1 })
                'function' === typeof f && f('ld', 'DeepCheckPromise', { wb: 1 })
              }),
              (g.error = function (b) {
                h.hide()
                a && a.count && a.count('dcp_ajax_error', 1)
              }),
              'function' === typeof c && c('bb', 'DeepCheckPromise', { wb: 1 }),
              d.load(l, g))
            : a && a.count && a.count('dcp_container_not_found', 1)
        },
      }
    },
  )
  ;('use strict')
  c.when('A').register('deep-check-promise-container', function (a) {
    return {
      getDcpContainer: function (c) {
        var d = a.$
        c = c.buyingOptionIndex
        var b = d('[id\x3ddelivery-block-ags-dcp-container_' + c + ']')
        return b.length ? b : d('[id\x3dags-dcp-container_' + c + ']')
      },
    }
  })
  ;('use strict')
  c.when('A').register('deep-check-promise-loader', function (a) {
    return {
      load: function (c, d) {
        d = d || {}
        d.method = 'post'
        d.contentType = 'application/json'
        d.paramsFormat = 'json'
        d.withCredentials = !0
        a.ajax(c, d)
      },
    }
  })
})
/* ******** */
;(function (c) {
  var e = window.AmazonUIPageJS || window.P,
    h = e._namespace || e.attributeErrors,
    b = h ? h('DetailPageBuyBoxTabularLayoutDesktopAssets', '') : e
  b.guardFatal
    ? b.guardFatal(c)(b, window)
    : b.execute(function () {
        c(b, window)
      })
})(function (c, e, h) {
  c.when('A').execute('show-tabular-buybox-side-sheet', function (b) {
    function f(a) {
      g && g.count && g.count(a, (g.count(a) || 0) + 1)
    }
    function c() {
      d('.tabular-buybox').each(function (a, c) {
        a = d(c)
        var k = !1
        a.find('.tabular-buybox-text').each(function (a, b) {
          a = d(b)
          if (
            a.css('line-clamp') !== (3).toString() &&
            a.css('-webkit-line-clamp') !== (3).toString()
          ) {
            a = d(b).find('.tabular-buybox-text-message')
            var c = a.text()
            a.text('...')
            var e = b.offsetHeight
            a.text(c)
            for (c = !1; b.offsetHeight > 3 * e; )
              (c = !0), a.text(a.text().replace(/\W*\s(\S)*$/, '...'))
            k = c || b
          } else if ((k = b.scrollHeight > b.clientHeight)) return !1
        })
        a = a.find('.tabular-buybox-show-more')
        k
          ? (b.show(a), f('DesktopTabularBuyBoxContentTruncated'))
          : (b.hide(a), f('DesktopTabularBuyBoxContentExpanded'))
      })
    }
    var d = b.$,
      g = e.ue
    d('#tabular-buybox-side-sheet-content a').attr('target', '_blank')
    d('#tabular-buybox #sellerProfileTriggerId').click(function () {
      f('BuyBoxTabularLayoutDesktopLinkClicked')
    })
    b.declarative('close-tabular-buybox-side-sheet', 'click', function (a) {
      function c(a) {
        a.siblings('#tabular-buybox-side-sheet-content').show(function () {
          d(this).removeClass('tabular-buybox-side-sheet-content-display')
        })
      }
      ;(function (a) {
        c(a)
        b.hide(a.find('#tabular-buybox-background'))
      })(d(a && a.$currentTarget && a.$currentTarget[0]))
      f('DesktopTabularSideSheetClosed')
    })
    b.declarative('show-tabular-buybox-side-sheet', 'click', function (a) {
      function c(a) {
        a.siblings('#tabular-buybox-side-sheet-content').show(function () {
          d(this).addClass('tabular-buybox-side-sheet-content-display')
        })
      }
      ;(function (a) {
        var d = a
          .siblings('[data-action\x3d"close-tabular-buybox-side-sheet"]')
          .find('#tabular-buybox-background')
        b.show(d)
        c(a)
      })(d(a && a.$currentTarget && a.$currentTarget[0]).closest('#tabular-buybox'))
      f('DesktopTabularSideSheetOpened')
    })
    c()
    b.on('a:accordion:buybox-accordion:select', c)
    b.on('a:tabs:offerDisplayGroup_tabs:select', c)
    b.on('a:pageUpdate', c)
  })
})
/* ******** */
;(function (d) {
  var l = window.AmazonUIPageJS || window.P,
    g = l._namespace || l.attributeErrors,
    b = g ? g('DetailPageUpsellSelectionAwareAssets', '') : l
  b.guardFatal
    ? b.guardFatal(d)(b, window)
    : b.execute(function () {
        d(b, window)
      })
})(function (d, l, g) {
  'use strict'
  d.when('selection-aware-constants').register('selection-aware-utils', function (b) {
    var f = b.registerFeatures
    return {
      isFeatureAlreadyRegistered: function (a, d) {
        return a.hasOwnProperty(d)
      },
      validateFeature: function (a, b, e) {
        var c = !0
        ;(a.hasOwnProperty(f.FEATURE_NAME) && a.hasOwnProperty(f.FEATURE_ATTRIBUTION)) ||
          (d.log(
            'Properties missing in feature registration passed',
            'ERROR',
            a.featureAttribution || a.featureName,
          ),
          (c = !1))
        c &&
          ((c = !0),
          b.hasOwnProperty(e) ||
            (d.log(
              'Functions missing in callbacks passed',
              'ERROR',
              a.featureAttribution || a.featureName,
            ),
            (c = !1)))
        return c
      },
    }
  })
  ;('use strict')
  d.register('selection-aware-constants', function () {
    return {
      registerFeatures: {
        VALIDATE_FEATURE_DATA_CALLBACK: 'validateFeatureData',
        UPDATE_FEATURE_SELECTION_CALLBACK: 'updateFeatureSelection',
        CALLBACKS: 'callbacks',
        FEATURE_NAME: 'featureName',
        FEATURE_REGISTRATION: 'featureRegistration',
        FEATURE_ATTRIBUTION: 'featureAttribution',
        SELECTION_TYPE: 'selectionType',
      },
      metrics: {
        PREFIX: 'selectionAware.',
        TRIGGER_FEATURE: 'triggerFeatureRegistration.',
        LISTENER_FEATURE: 'listenerFeatureRegistration.',
        SUCCESSFUL: 'successful',
        FAILURE: 'failure',
        FEATURE_ATTRIBUTION: 'Website/Detail Page/Selection Aware Framework',
      },
    }
  })
  ;('use strict')
  d.when('selection-aware-constants').register('selection-aware-logger', function (b) {
    var f = b.metrics
    return {
      logCounter: function (a, b) {
        a !== g && '' !== a
          ? ((a = f.PREFIX + a),
            ue && ue.count && (b === g && (b = (ue.count(a) || 0) + 1), ue.count(a, b)))
          : d.log('counterKey must be non empty string', 'ERROR', f.FEATURE_ATTRIBUTION)
      },
    }
  })
  ;('use strict')
  d.when(
    'A',
    'selection-aware-utils',
    'selection-aware-constants',
    'selection-aware-logger',
  ).register('selection-aware-trigger-features', function (b, f, a, g) {
    var e = {},
      c = a.registerFeatures,
      h = a.metrics
    return {
      addFeature: function (k, a) {
        var b = k.featureName,
          n = h.FAILURE
        f.isFeatureAlreadyRegistered(e, b)
          ? d.log(
              'Feature is already registered to Selection Aware framework as trigger feature',
              'ERROR',
              e[b][c.FEATURE_REGISTRATION][c.FEATURE_ATTRIBUTION],
            )
          : f.validateFeature(k, a, c.VALIDATE_FEATURE_DATA_CALLBACK) &&
            ((e[b] = {}),
            (e[b][c.CALLBACKS] = a),
            (e[b][c.FEATURE_REGISTRATION] = k),
            (n = h.SUCCESSFUL))
        g.logCounter(h.TRIGGER_FEATURE + n)
      },
      getTriggerFeature: function (c) {
        return e[c]
      },
      getTriggerFeatures: function () {
        return e
      },
    }
  })
  ;('use strict')
  d.when(
    'A',
    'selection-aware-utils',
    'selection-aware-constants',
    'selection-aware-logger',
  ).register('selection-aware-listener-features', function (b, f, a, g) {
    var e = {},
      c = a.registerFeatures,
      h = a.metrics
    return {
      addFeature: function (b, a) {
        var m = b.featureName,
          n = h.FAILURE
        f.isFeatureAlreadyRegistered(e, m)
          ? d.log(
              'Feature is already registered to Selection Aware framework as listener feature',
              'ERROR',
              e[m][c.FEATURE_REGISTRATION][c.FEATURE_ATTRIBUTION],
            )
          : f.validateFeature(b, a, c.UPDATE_FEATURE_SELECTION_CALLBACK) &&
            ((e[m] = {}),
            (e[m][c.CALLBACKS] = a),
            (e[m][c.FEATURE_REGISTRATION] = b),
            (n = h.SUCCESSFUL))
        g.logCounter(h.LISTENER_FEATURE + n)
      },
      getListenerFeature: function (c) {
        return e[c]
      },
      getListenerFeatures: function () {
        return e
      },
    }
  })
  ;('use strict')
  d.when(
    'A',
    'selection-aware-constants',
    'selection-aware-trigger-features',
    'selection-aware-listener-features',
  ).register('selection-aware-handler', function (b, f, a, l) {
    var e = f.registerFeatures
    return {
      registerAsTriggerFeature: function (c, b) {
        a.addFeature(c, b)
      },
      registerAsListenerFeature: function (c, b) {
        l.addFeature(c, b)
      },
      updateFeatureSelection: function (c, h) {
        var k = a.getTriggerFeature(c)
        k !== g
          ? k[e.CALLBACKS].validateFeatureData(h)
            ? ((k = l.getListenerFeatures()),
              b.each(k, function (b, a) {
                b[e.CALLBACKS].updateFeatureSelection(c, h)
              }))
            : d.log(
                'Validation of featureData failed for the updated feature',
                'ERROR',
                k[e.FEATURE_REGISTRATION][e.FEATURE_ATTRIBUTION],
              )
          : d.log(
              'Updated feature is not registered to Selection Aware Framework as trigger feature',
              'ERROR',
              c,
            )
        return !1
      },
      getUpdatedState: function (c, a, d) {
        var f = b.copy(c)
        if ('twisterPlus' !== a)
          if ('add' === d[e.SELECTION_TYPE]) f.hasOwnProperty(a) || (f[a] = []), f[a].push(d)
          else {
            if (
              'delete' === d[e.SELECTION_TYPE] &&
              ((c = d.itemType), (d = d[c]), f.hasOwnProperty(a))
            )
              for (var g = 0; g < f[a].length; g++)
                if (f[a][g][c] === d) {
                  f[a].splice(g, 1)
                  break
                }
          }
        else
          b.each(d, function (a, b) {
            f[b] = a
          })
        return f
      },
    }
  })
})
/* ******** */
;(function (m) {
  var D = window.AmazonUIPageJS || window.P,
    z = D._namespace || D.attributeErrors,
    aa = z ? z('DetailPageMiraiAssets@discover', 'DetailPageMiraiAssets') : D
  aa.guardFatal
    ? aa.guardFatal(m)(aa, window)
    : aa.execute(function () {
        m(aa, window)
      })
})(function (m, D, z) {
  function aa(c) {
    if (Array.isArray(c)) {
      for (var a = 0, b = Array(c.length); a < c.length; a++) b[a] = c[a]
      return b
    }
    return Array.from(c)
  }
  m.when('A', 'ready').register('mirai-device-types', function () {
    return { IS_MOBILE: !1, IS_TABLET: !1 }
  })
  ;('use strict')
  m.when('A', 'ready').register('mirai-constants', function () {
    return {
      BOX_ID_PREFIX: 'shopbylook-btf-item-box-',
      GET_RECOMMENDATION_ADD_LIKE: 'getRecommendationsForLikeDPX',
      GET_RECOMMENDATION_ADD_DISLIKE: 'getRecommendationsForDislikeDPX',
      GET_RECOMMENDATION_QU2X: 'getRecommendationsForSearchQueryDPX',
      NUM_ITEMS_TO_FLIP_PER_DISLIKE: 1,
      MOBILE_NUM_ITEMS_PER_SHOW_MORE: 6,
      MOBILE_NUM_ITEMS_PER_SHOW_MORE_ON_SHADOW_PREV: 4,
      MOBILE_NUM_ITEMS_TO_FLIP: 2,
      MOBILE_MAX_SHOW_MORE: 2,
      RATINGS_HALF_STAR_THRESHOLD: 0.5,
      LIKE_PREFIX: 'L',
      DISLIKE_PREFIX: 'D',
      SBL_WEBSITE_ADDRESS_PREFIX: '/discover/',
      IS_PRIME_CLASS: 'shopbylook-prime',
      SBL_FLIP_BOX_CLASS: 'shopbylook-btf-item-box-flip',
      MAX_NUMBER_OF_ITEMS_MOBILE: 6,
      MIN_DESKTOP_WIDTH_NEEDED_FOR_ANCHOR: 800,
      MAX_DESKTOP_PAGE_SIZE: 10,
      REVIEW_KEYWORD_ITEM: '.sbl-keyword-item-review',
      END_OF_RECOMMENDATIONS_START_INDEX: -1,
      INTIAL_NUMBER_OF_ITEMS_DESKTOP: 12,
      LIKE_BUTTON_FOCUS: 'a-button-focus',
      SCROLL_HEIGHT_MULTIPLIER: 3.3,
      SCROLL_HEIGHT_MULTIPLIER_MOBILE: 2.1,
      SHOPBYLOOK_INIT: 'shopbylook-btf-items-section-p-1',
      TOP_FILTERS_PADDING: 200,
      FILTER_OPTIONS_WIDTH: 210,
      BROWSE_SOURCE: 'browse',
      MOBILE_REFINEMENT_BOTTOM_SHEET_NAMES: ['0', '1', '2', 'All'],
      DEFAULT_EXPECTED_FONT_SIZE: 13,
      REFINEMENT_SELECTOR_PREFIX: '.sbl-refinement-',
      NEW_ITEM_ANIMATION_TIME: 750,
      AUI_EMPTY_IMAGE_URL:
        'https://images-na.ssl-images-amazon.com/images/G/01/x-locale/common/grey-pixel.gif',
      DEFAULT_SHOW_TRANSITION_TIME: 300,
      CAROUSEL_SIZE: 12,
      SWATCH_MOBILE_NUMBER: 3,
      SWATCH_DESKTOP_NUMBER: 6,
      ALL_FILTERS_ID: '#sbl-all-filters',
      REFINEMENT_SHEET_OPTION_BUTTON: '.sbl-refinement-option-button',
      REFINEMENT_TOP_NAV_SEARCH_INPUT: '.sbl-refinements-search-input-container input',
      REFINEMENT_SEARCH_HIDDEN_CLASS: 'sbl-refinement-option-button-hidden',
      REFINEMENT_CATEGORY_HIDDEN_CLASS: 'sbl-category-button-hidden',
      REFINEMENT_UNAVAILABLE_HIDDEN_CLASS: 'sbl-refinement-value-button-hidden',
      TOP_REFINEMENT_SECTION_ID: '#sbl-top-refinement-section',
      BRAND_REFINEMENT_MAX: 15,
    }
  })
  ;('use strict')
  m.when(
    'A',
    'jQuery',
    'mirai-device-types',
    'mirai-constants',
    'a-truncate',
    'mirai-heart-button-helper',
    'ready',
  ).register('mirai-utils', function (c, a, b, d, e, k) {
    function p() {
      a(D).scroll()
      c.trigger('a:image:lazyLoad')
    }
    function f(n, g, c, h, v) {
      if (b.IS_MOBILE) {
        if (!g) return
      } else if (0 >= n.find('.shopbylook-btf-item-ratings-row').length && !g) return
      for (var ba = b.IS_MOBILE ? 'a-star-mini-' : 'a-star-', e = 0; 5 >= e; e++)
        g.removeClass(ba + e).removeClass(ba + e + '-5')
      !c || c < d.RATINGS_HALF_STAR_THRESHOLD || 1 > h
        ? (n.find('.sbl-item-rating').addClass('aok-hidden'),
          n.find('.sbl-review-count').first().text(''))
        : ((h = Math.floor(c)),
          g.addClass(ba + h + (c - h >= d.RATINGS_HALF_STAR_THRESHOLD ? '-5' : '')),
          n.find('.sbl-review-count').first().text(v),
          a(n.find('.sbl-item-rating').find('span')).first().text(c),
          n.find('.sbl-item-rating').removeClass('aok-hidden'))
    }
    function X(a, g, b) {
      if (!((c.objectIsEmpty(a) && c.objectIsEmpty(b)) || c.objectIsEmpty(g))) {
        c.objectIsEmpty(a) || a.addClass('aok-hidden')
        c.objectIsEmpty(b) || b.addClass('aok-hidden')
        var d = g.statusBadgeSource
        g = g.offerLevelWithDealBadge
        if (!c.objectIsEmpty(d) || !c.objectIsEmpty(g)) {
          if (b && !c.objectIsEmpty(g) && g.dealBadgeEnable) {
            var v = b.find('.sbl-deal-badge-label'),
              e = b.find('.sbl-deal-badge-message')
            e.addClass('aok-hidden')
            v.attr(
              'style',
              'color:' + g.badgeStringColor + '; background-color:' + g.badgeBackgroundColor + ';',
            )
            v.text(g.badgeString)
            ;(c.objectIsEmpty(g.supportString) && c.objectIsEmpty(g.supportShortString)) ||
              (e.attr(
                'style',
                'color:' +
                  g.supportStringColor +
                  '; background-color:' +
                  g.supportStringBackgroundColor +
                  ';',
              ),
              e.text(g.countdownTimerIncluded ? g.supportShortString : g.supportString),
              e.removeClass('aok-hidden'))
            b.removeClass('aok-hidden')
          }
          c.objectIsEmpty(d) ||
            c.objectIsEmpty(a) ||
            ((b = a.find('.sbl-status-badge')),
            b.removeClass(),
            b.addClass('sbl-status-badge'),
            b.addClass('sbl-' + d.badgeStyle),
            b.find('.sbl-badge-text').first().text(d.badgeString),
            a.removeClass('aok-hidden'))
        }
      }
    }
    function m(a, g) {
      if (!c.objectIsEmpty(a) && !c.objectIsEmpty(g)) {
        a.addClass('aok-hidden')
        var b = g.energyLabel
        if (
          !(
            c.objectIsEmpty(b) ||
            c.objectIsEmpty(b.ratingLetter) ||
            0 == b.ratingLetter.length ||
            c.objectIsEmpty(b.energyEfficiencyImageUrl) ||
            c.objectIsEmpty(b.productDataSheetImageUrl) ||
            0 == b.energyEfficiencyImageUrl.length ||
            0 == b.productDataSheetImageUrl.length
          )
        ) {
          var d = b.eu2021Standard,
            v = b.mobileDeviceType,
            e = d ? a.find('.sbl-eel-2021') : a.find('.sbl-eel-pre2021'),
            k = d ? a.find('.sbl-eel-pre2021') : a.find('.sbl-eel-2021'),
            f = e.find('span.a-declarative').first(),
            A = e.find('.a-popover-preload').first(),
            C = v ? JSON.parse(f.attr('data-a-secondary-view')) : JSON.parse(f.attr('data-a-modal'))
          C.name = 'energyEfficiencyImagePreload_' + g.asin
          A.prop('id', 'a-popover-energyEfficiencyImagePreload_' + g.asin)
          A.attr('id', 'a-popover-energyEfficiencyImagePreload_' + g.asin)
          v
            ? f.attr('data-a-secondary-view', JSON.stringify(C))
            : f.attr('data-a-modal', JSON.stringify(C))
          f = e.find('span.a-declarative').last()
          A = e.find('.a-popover-preload').last()
          C = v ? JSON.parse(f.attr('data-a-secondary-view')) : JSON.parse(f.attr('data-a-modal'))
          C.name = 'productDataSheetImagesPreload_' + g.asin
          A.prop('id', 'a-popover-productDataSheetImagesPreload_' + g.asin)
          A.attr('id', 'a-popover-productDataSheetImagesPreload_' + g.asin)
          v
            ? f.attr('data-a-secondary-view', JSON.stringify(C))
            : f.attr('data-a-modal', JSON.stringify(C))
          g = e.find('svg.badge-shape')
          g.find('path.badgeColor').attr('fill', b.hexColor)
          g.find('text.badgeLetter').text(b.ratingLetter)
          d || g.find('text.badgeSymbol').text(b.ratingSymbol)
          e.find('.eelImageUrl').attr('src', b.energyEfficiencyImageUrl)
          e.find('.eelImageUrl').attr('data-src', b.energyEfficiencyImageUrl)
          e.find('.eelImageUrl').data('src', b.energyEfficiencyImageUrl)
          e.find('.pdsImageUrl').attr('src', b.productDataSheetImageUrl)
          e.find('.pdsImageUrl').attr('data-src', b.productDataSheetImageUrl)
          e.find('.pdsImageUrl').data('src', b.productDataSheetImageUrl)
          k.addClass('aok-hidden')
          e.removeClass('aok-hidden')
          a.removeClass('aok-hidden')
        }
      }
    }
    function K(a, b) {
      a.attr('src', d.AUI_EMPTY_IMAGE_URL)
      a.attr('data-src', b.imageAddress)
      a.data('src', b.imageAddress)
      a.addClass('a-lazy-loaded')
      a.attr('alt', b.title)
      a.attr('title', b.title)
    }
    function U(a, b) {
      a.find('.a-price-whole').text(b.priceDetails.integerValue)
      a.find('.a-price-symbol').text(b.priceDetails.currencySymbol)
      a.find('.a-price-fraction').text(b.priceDetails.fractionalValue)
      a.find('.a-offscreen').text(b.price)
      a.find('.sbl-basis-price').text(c.objectIsEmpty(b.basisPrice) ? '' : b.basisPrice)
      a = a.find('.sbl-basis-price-label')
      c.objectIsEmpty(a) || a.text(c.objectIsEmpty(b.basisPrice) ? '' : b.priceLabel)
    }
    return {
      getElementData: function (a) {
        var b = a.data()
        b.asin && (b.asin = a.attr('data-asin'))
        b.mainAsin && (b.mainAsin = a.attr('data-main-asin'))
        b.refinementValue && (b.refinementValue = a.attr('data-refinement-value'))
        b.refinementType && (b.refinementType = a.attr('data-refinement-type'))
        return b
      },
      getCurrentItemBoxes: function (a) {
        return a.find('.shopbylook-btf-item-box')
      },
      getMaxNumberOfItems: function () {
        return b.IS_MOBILE ? d.MAX_NUMBER_OF_ITEMS_MOBILE : d.INTIAL_NUMBER_OF_ITEMS_DESKTOP
      },
      triggerLazyLoad: function () {
        c.delay(p, 500)
      },
      hideSelectedRefinementsBar: function (a) {
        b.IS_MOBILE
          ? a.removeClass('sbl-filter-keywords-activate')
          : c.slideUp(a.find('#sbl-selected-refinement-row'), 300, 'ease-out', function () {})
      },
      closeSelectedRefinementItem: function (a) {
        var b = 1 < arguments.length && arguments[1] !== z ? arguments[1] : !1,
          d = 2 < arguments.length && arguments[2] !== z ? arguments[2] : null
        c.animate(
          a,
          { width: '0', margin: '0', opacity: '0', 'border-radius': '0' },
          350,
          'ease-out',
          function () {
            a.remove()
            b && d && d()
          },
        )
      },
      startLoading: function (a) {
        a.find('#shopbylook-btf-loading-section').show()
      },
      stopLoading: function (a) {
        a.find('#shopbylook-btf-loading-section').hide()
        p()
      },
      updateReviewStars: f,
      updateTruncate: function (b) {
        b.find('.a-truncate').each(function () {
          e.get(a(this)).update()
        })
      },
      updateImageAttributes: K,
      updatePriceAttributes: U,
      updateEnergyLabel: m,
      replacingSrcImage: function (a, b, c) {
        var d = b
          .find('.shopbylook-btf-image-container')
          .get(0)
          .querySelector('.shopbylook-btf-image-elem')
        d && (d.src = a)
        a = b.find('.shopbylook-image-section-middle-dot')
        a.removeClass('selected')
        a.eq(c).addClass('selected')
      },
      getSearchQuery: function () {
        var a = 1 < D.location.search.length ? D.location.search.substring(1) : ''
        return c.contains(a, 'keywords\x3d') &&
          ((a = a.split('keywords\x3d')[1]),
          !c.objectIsEmpty(a) &&
            ((a = decodeURIComponent(a.split('\x26')[0]).replace(/\+/g, ' ')), 0 < a.length))
          ? a
          : ''
      },
      getRefinementsQueryParameter: function () {
        var a
        a = 1 < D.location.search.length ? D.location.search.substring(1) : ''
        if (0 === a.length) a = {}
        else {
          for (var b, c = /\+/g, d = {}, e = /([^&=]+)=?([^&]*)/g; (b = e.exec(a)); )
            d[decodeURIComponent(b[1]).replace(c, ' ')] = decodeURIComponent(b[2]).replace(c, ' ')
          a = d
        }
        return a.hasOwnProperty('refinements') ? a.refinements : ''
      },
      addNewRow: function (b, c, e, h, v, f, Q, T) {
        e = b.index() + e - (b.index() % e) - 1
        c = a(c.get(e))
        f = Math.min(f, Q.length)
        for (h = e = 0; h < f; h++)
          if (Q[h].asin) {
            k.updateNextHeartStrings(b)
            var A = b.clone()
            A.css({ height: 0, opacity: 0 })
            T(A, Q[h], !1) &&
              (e++,
              A.insertAfter(c),
              A.animate({ height: v, opacity: 1 }, d.NEW_ITEM_ANIMATION_TIME, function () {
                a(this).height('auto')
              }))
          }
        b.offset().top - D.pageYOffset > v &&
          0 < e &&
          a('html, body').animate({ scrollTop: D.pageYOffset + b.outerHeight() }, 350)
      },
      fillGap: function (a, b, c, d, e) {
        b = b.last()
        var f = 0,
          k = 0
        for (f; f < Math.min(c, d.length); f++)
          if (d[f].asin) {
            var T = a.clone()
            e(T, d[f], !1) && (T.insertAfter(b), k++)
          }
        return k
      },
      addRowsToEnd: function (b, c, e, f, v, k, Q, T) {
        f = Math.min(f, e.length)
        var A = f - (0 === f % 2 ? 2 : 1)
        T = T && 2 < f
        for (var C = !1, U = 0, p = 0; p < f; p++) {
          var m = b.clone()
          if ((C = k(m, e[p], !1)))
            U++,
              m.css({ height: 0, opacity: 0 }),
              c.append(m),
              T && p >= A
                ? (m.animate({ height: v, opacity: 1 }, d.NEW_ITEM_ANIMATION_TIME, function () {
                    a(this).css({ height: '50px' })
                  }),
                  (C = m.find('.sbl-shadow-preview-fading')),
                  C.removeClass('hit-sbl-shadow-preview-fading-override'),
                  C.removeClass('aok-hidden'),
                  (m = a(D).width()),
                  C.css('width', m / 2.3 + 'px'))
                : m.animate({ height: v, opacity: 1 }, d.NEW_ITEM_ANIMATION_TIME, function () {
                    a(this).height('auto')
                  })
        }
        0 < U &&
          ((c = a(D).scrollTop()),
          (b = b.offset().top + v * Q - (c + a(D).height())),
          0 < b && a('html, body').animate({ scrollTop: c + b }, 350))
      },
      getRefinementReadableName: function (b, c, e, f, v) {
        return 'review' === e
          ? c.refinementStarsAndUp.replace('${count}', f)
          : 'price' === e || 0 < b.find('.sbl-colorsprite').length
            ? b.closest(d.REFINEMENT_SELECTOR_PREFIX + v).text()
            : 'prime' !== e
              ? 0 === a('.sbl_refinement_' + e + '_title').length
                ? b
                    .closest('.a-expander-container')
                    .find('.sbl-refinement-expander-header-text span')
                    .text() +
                  ': ' +
                  b.closest(d.REFINEMENT_SELECTOR_PREFIX + v).text()
                : a('.sbl_refinement_' + e + '_title')
                    .first()
                    .text() +
                  ': ' +
                  b.closest(d.REFINEMENT_SELECTOR_PREFIX + v).text()
              : ''
      },
      redesignBoxSwap: function (n, g, q, h, v, ba, Q) {
        h && n.toggleClass(d.SBL_FLIP_BOX_CLASS)
        n.prop('id', d.BOX_ID_PREFIX + g.asin)
        n.attr('data-asin', g.asin)
        n.data('asin', g.asin)
        n.attr('data-physical-id', g.physicalId)
        n.data('physicalId', g.physicalId)
        n.attr('data-csa-c-item-id', g.itemId ? g.itemId : 'amzn1.asin.' + g.asin)
        ;(h = n.data('smlt-product-string-template')) &&
          n.find('input').attr('aria-label', h.replace('${product}', g.title))
        K(n.find('.shopbylook-btf-image-elem'), g)
        h = q(g.asin)
        n.find('.sbl-item-top').children('a').attr('href', h)
        q = n.find('.sbl-product-title-wrapper')
        n.hasClass('hit-sbl-softline-update') &&
          !c.objectIsEmpty(q) &&
          (c.objectIsEmpty(q) ||
            c.objectIsEmpty(g) ||
            0 === q.find('.a-truncate').size() ||
            (q.addClass('aok-hidden'),
            q.find('.sbl-product-title-url').closest('a').attr('href', h),
            (h = g.shortTitle),
            c.objectIsEmpty(h) ||
              (q.find('.sbl-product-title-hover').attr('title', h),
              q.find('.a-truncate').find('.a-truncate-full').first().text(h),
              e.get(q.find('.a-truncate')).update(),
              q.removeClass('aok-hidden'))))
        q = n.find('.sbl-item-brand')
        n.hasClass('hit-sbl-softline-update') &&
          !c.objectIsEmpty(q) &&
          (c.objectIsEmpty(q) ||
            c.objectIsEmpty(g) ||
            (q.addClass('aok-hidden'),
            (h = g.productBrandSource),
            c.objectIsEmpty(h) || (q.find('.a-text-bold').text(h), q.removeClass('aok-hidden'))))
        q = n.find('.lists-framework-action-button')
        k.updateHeartWishList(q, g)
        U(n.find('.sbl-item-price').first(), g)
        f(
          n,
          n.find('.shopbylook-btf-item-ratings').first(),
          g.rating,
          g.ratingCount,
          g.ratingCountStr,
        )
        X(n.find('.sbl-status-badge-wrapper'), g, null)
        X(null, g, n.find('.sbl-offer-level-badge-wrapper-with-dealBadge'))
        q = n.find('.sbl-delivery-message')
        c.objectIsEmpty(q) ||
          (q.addClass('aok-hidden'),
          (h = g.deliveryMessage),
          c.objectIsEmpty(h) || (q.html(h), q.removeClass('aok-hidden')))
        if (
          Q &&
          ((v = n.find('.shopbylook-image-gallery-override')),
          !c.objectIsEmpty(v) &&
            !c.objectIsEmpty(g) &&
            (v.find('.shopbylook-carousel-arrow-container').addClass('aok-hidden'),
            v.find('.shopbylook-image-section-middle-dot').removeClass('selected'),
            v
              .find(
                '.shopbylook-carousel-pagination span:first-child .shopbylook-image-section-middle-dot',
              )
              .addClass('selected'),
            (q = g.asinImageUrlsJson),
            (h = g.imageAddress),
            (Q = g.asin),
            !c.objectIsEmpty(h)))
        ) {
          v.find('.wb-image-url-container').attr('data-wb-image-url', h)
          v.find('.wb-image-url-container').attr('wbImageUrl', h)
          h = []
          c.objectIsEmpty(q) ||
            ((h = q.split(',').slice(0, 4)),
            v.find('.image-urls-container').attr('data-image-urls', h),
            v.find('.image-urls-container').attr('imageUrls', h))
          q = h.length + 1
          h = v.find('.shopbylook-carousel-pagination')
          v = v.find('.sbl-pagination-bullet-label').data('pagination-bullet-label')
          h.empty()
          h.attr('role', 'list')
          for (var p = 0; p < q; p++) {
            var A = v.replace('${order}', p + 1),
              C
            if (b.IS_MOBILE)
              (C = a('\x3cdiv\x3e')
                .addClass('shopbylook-image-section-middle-dot-container')
                .attr('role', 'listitem')),
                (A = a('\x3cbutton\x3e')
                  .addClass(
                    'shopbylook-image-section-middle-dot ' +
                      (0 === p ? 'selected' : '') +
                      ' ' +
                      (1 === q ? 'aok-hidden' : ''),
                  )
                  .attr('id', 'shopbylook-image-section-middle-dot-' + p + '-' + Q)
                  .attr('aria-label', A)),
                C.append(A)
            else {
              C = a('\x3cspan\x3e').attr('role', 'listitem')
              var z = a('\x3cspan\x3e')
                  .addClass('a-declarative')
                  .attr('data-action', 'sblThumbnailDetailPagination')
                  .attr('data-csa-c-type', 'widget')
                  .attr('data-csa-c-func-deps', 'aui-da-sblThumbnailDetailPagination')
                  .attr('data-sblthumbnaildetailpagination', JSON.stringify({ page: p })),
                z = C.append(z)
              C = a('\x3cdiv\x3e').addClass('shopbylook-image-section-middle-dot-container')
              A = a('\x3cbutton\x3e')
                .addClass(
                  'shopbylook-image-section-middle-dot ' +
                    (0 === p ? 'selected' : '') +
                    ' ' +
                    (1 === q ? 'aok-hidden' : ''),
                )
                .attr('id', 'shopbylook-image-section-middle-dot-' + p + '-' + Q)
                .attr('aria-label', A)
              C.append(A)
              z.append(C)
              C = z
            }
            h.append(C)
          }
        }
        ba && m(n.find('.sbl-energy-efficiency-wrapper'), g)
        g.prime
          ? n.find('.sbl-item-delivery').first().removeClass('aok-hidden')
          : n.find('.sbl-item-delivery').first().addClass('aok-hidden')
        n.removeClass('sbl-item-disliked')
        return !0
      },
      registerSelectedRefinementItem: function (a, b, c, d) {
        a.addClass('sbl-keyword-item-' + d)
        a.attr('data-parent-item', '.sbl-refinement-' + d)
        a.removeClass('sbl-filter-keyword-hidden').width('')
      },
      getReviewPosition: function () {
        return a(d.TOP_REFINEMENT_SECTION_ID).find(d.REVIEW_KEYWORD_ITEM).first()
      },
      createNewButton: function (a, b, c, d, e, f) {
        f = f.find('.sbl-filter-keyword-hidden').clone()
        var k = a.find('.sbl-softlines-colorsprite,.sbl-colorsprite')
        0 < k.length && k.clone().prependTo(f.find('.sbl-refinement-element-box'))
        f.find('.sbl-filter-keyword-text').text(this.getRefinementReadableName(a, e, b, c, d))
        f.data('refinementValue', c)
        return f
      },
      createTopRefinementButton: function (a, b, c, d, e, f) {
        a = this.createNewButton(a, b, c, d, e, f)
        a.addClass('sbl-inactive sbl-top-refinement-element')
        return a
      },
      getRefinementData: function (a) {
        var b = a.closest('.sbl-refinements-bn-list')
        if (!b || 0 === b.length) return null
        var c = this.getElementData(b),
          b = c.refinementType,
          e = '@' + b,
          f = this.getElementData(a.closest('.refinement-row'))
        a = f.refinementValue
        var k = f.refinementIndex,
          f = 'review' === b
        c.refinementSource === d.BROWSE_SOURCE
          ? (e = c = a)
          : ((c = e + (a ? ':' + a : '')), (e = b + (a ? '-' + (f ? a : k) : '')))
        return { refinementType: b, value: a, isReview: f, filter: c, filterSelectorSuffix: e }
      },
    }
  })
  ;('use strict')
  m.when('A', 'jQuery', 'ready').register('mirai-side-sheet-helper', function (c, a) {
    function b() {
      f.animate({ right: '0px' }, 500, function () {
        c.show(f.find('.sbl-side-sheet-close-icon'))
      })
    }
    function d() {
      c.hide(f.find('.sbl-side-sheet-close-icon'))
      f.animate({ right: -D + 'px' }, 500, function () {
        c.hide(f)
      })
    }
    function e(b) {
      K
        ? b.target.closest('.a-button') === a('#sbl-refinement-item-all')[0]
          ? (b.preventDefault(), (b = k()), b.focus())
          : b.target === a('#sbl_top_refinement_prime_switch_input')[0] &&
            (b.preventDefault(), f.find('.sbl-side-sheet-close-button').focus())
        : b.target === a('#sbl-refinement-item-all')[0]
          ? (b.preventDefault(), (b = k()), b.focus())
          : b.target === a('.sbl-image-link')[0] &&
            (b.preventDefault(), f.find('.sbl-side-sheet-close-button').focus())
    }
    function k() {
      var b = a('#sbl-all-filters .sbl-refinement-expander'),
        b = a(b[b.length - 1]),
        c = f.find('.sbl-refinements-show-results')
      f.find('#sbl-refinements-bottom-nav')[0].classList.contains('aok-hidden') &&
        ((c = a(b.find('.sbl-refinement-expander-content'))),
        (c =
          (c[0].hasAttribute('aria-expanded') && 'true' === c[0].getAttribute('aria-expanded')) ||
          (c[0].hasAttribute('data-expanded') && 'true' === c[0].getAttribute('data-expanded'))
            ? c.find(K ? 'input' : 'button')
            : a(b.find('.sbl-refinement-expander-header'))))
      return c
    }
    var p = a('body'),
      f = a('#sbl-side-sheet-section'),
      m = a('#sbl-side-sheet-background'),
      D = f.outerWidth() + f.find('.sbl-side-sheet-close-icon').outerWidth(!0),
      K = !1
    return {
      showSideSheet: function () {
        K = 0 < arguments.length && arguments[0] !== z ? arguments[0] : !1
        p.addClass('sbl-lock-background')
        c.show(m)
        c.show(f)
        b()
        a('#shopbylook-btf-loading-section').find('.a-spinner-wrapper').addClass('aok-hidden')
        document.addEventListener('focus', e, !0)
      },
      hideSideSheet: function () {
        d()
        c.hide(m)
        p.removeClass('sbl-lock-background')
        a('#shopbylook-btf-loading-section').find('.a-spinner-wrapper').removeClass('aok-hidden')
        document.removeEventListener('focus', e, !0)
      },
      refreshSideSheet: function (b) {
        b ||
          ((p = a('body')),
          (f = a('#sbl-side-sheet-section')),
          (m = a('#sbl-side-sheet-background')),
          (D = f.outerWidth() + f.find('.sbl-side-sheet-close-icon').outerWidth(!0)))
      },
    }
  })
  ;('use strict')
  m.when('A', 'jQuery', 'mirai-constants', 'mirai-utils', 'mirai-device-types', 'ready').register(
    'mirai-discover-search-bar-helper',
    function (c, a, b, d, e) {
      function k() {
        var c = a(b.ALL_FILTERS_ID)
        c.find('.sbl-refinement-see-more-btn-container').addClass('aok-hidden')
        c.find('.sbl-refinement-option-button').removeClass('aok-hidden')
      }
      function p() {
        var c = a(b.ALL_FILTERS_ID)
        c.find('.sbl-refinement-see-more-btn-container').removeClass('aok-hidden')
        c.find('.refinement-type-section').each(function () {
          0 < a(this).find('.sbl-refinement-see-more-btn-container').length &&
            a(this)
              .find('.sbl-refinement-option-button:gt(' + (b.BRAND_REFINEMENT_MAX - 1) + ')')
              .addClass('aok-hidden')
        })
      }
      function f(b, c) {
        a('#sbl-filters-results-text').text(c.replace('{count}', b))
      }
      function m(a) {
        return a.availableFilters
          .filter(function (a) {
            return 'keywords_static' === a.filterType
          })
          .map(function (a) {
            return a.filterId
          })
      }
      function D(a) {
        a = a.availableFilters
          .filter(function (a) {
            return 'keywords_dynamic' === a.filterType
          })
          .map(function (a) {
            return a.filterId
          })
          .filter(function (a) {
            return a.includes(':')
          })
          .map(function (a) {
            return a.substring(a.indexOf(':') + 1)
          })
        for (var b = 4; 0 < b; b--)
          if (-1 !== a.indexOf(b.toString())) {
            for (--b; 0 < b; b--) -1 === a.indexOf(b.toString()) && a.push(b.toString())
            break
          }
        return a
      }
      function K(a) {
        a.find(
          '.sbl-refinement-option-button:not(.sbl-refinement-value-button-hidden):not(.sbl-refinement-option-button-hidden):lt(' +
            b.BRAND_REFINEMENT_MAX +
            ')',
        ).removeClass('sbl-brand-refinement-option-button-hidden')
        a.find(
          '.sbl-refinement-option-button:not(.sbl-refinement-value-button-hidden):not(.sbl-refinement-option-button-hidden):gt(' +
            (b.BRAND_REFINEMENT_MAX - 1) +
            ')',
        ).addClass('sbl-brand-refinement-option-button-hidden')
        a.find(
          '.sbl-refinement-option-button.sbl-refinement-item-selected:not(.sbl-refinement-value-button-hidden):not(.sbl-refinement-option-button-hidden)',
        ).removeClass('sbl-brand-refinement-option-button-hidden')
      }
      function U(c, f) {
        var g = 2 < arguments.length && arguments[2] !== z ? arguments[2] : !1,
          k = arguments[3]
        a(b.TOP_REFINEMENT_SECTION_ID)
          .find(
            '.sbl-refinement-element-container:not(.sbl-filter-keyword-hidden):not(.sbl-smart-tag)',
          )
          .each(function () {
            var e = g
              ? d.getElementData(a(this).find('input')).refinementValue.toString()
              : d.getElementData(a(this)).refinementValue.toString()
            ;-1 === c.indexOf(e) &&
            -1 === f.indexOf(e) &&
            a(b.ALL_FILTERS_ID)
              .find(b.REFINEMENT_SELECTOR_PREFIX + e)
              .hasClass(b.REFINEMENT_UNAVAILABLE_HIDDEN_CLASS)
              ? a(this).addClass(b.REFINEMENT_UNAVAILABLE_HIDDEN_CLASS)
              : a(this).removeClass(b.REFINEMENT_UNAVAILABLE_HIDDEN_CLASS)
          })
        g && !e.IS_MOBILE && k && k()
      }
      function n(c, e, f) {
        a(b.ALL_FILTERS_ID)
          .find(b.REFINEMENT_SHEET_OPTION_BUTTON)
          .each(function () {
            var g = f
              ? d.getElementData(a(this).find('input')).refinementValue.toString()
              : d.getElementData(a(this)).refinementValue.toString()
            ;-1 === c.indexOf(g) && -1 === e.indexOf(g)
              ? a(this).addClass(b.REFINEMENT_UNAVAILABLE_HIDDEN_CLASS)
              : a(this).removeClass(b.REFINEMENT_UNAVAILABLE_HIDDEN_CLASS)
          })
        a(b.ALL_FILTERS_ID)
          .find(b.REFINEMENT_SHEET_OPTION_BUTTON + '.sbl-refinement-item-selected')
          .each(function () {
            a(this)
              .closest('.sbl-refinements-bn-list')
              .find(b.REFINEMENT_SHEET_OPTION_BUTTON)
              .removeClass(b.REFINEMENT_UNAVAILABLE_HIDDEN_CLASS)
          })
      }
      function g() {
        a(b.ALL_FILTERS_ID)
          .find('.refinement-type-section')
          .each(function () {
            0 <
            a(this).find(
              b.REFINEMENT_SHEET_OPTION_BUTTON +
                ':not(.' +
                b.REFINEMENT_SEARCH_HIDDEN_CLASS +
                '):not(.' +
                b.REFINEMENT_UNAVAILABLE_HIDDEN_CLASS +
                ')',
            ).length
              ? a(this).removeClass(b.REFINEMENT_CATEGORY_HIDDEN_CLASS)
              : a(this).addClass(b.REFINEMENT_CATEGORY_HIDDEN_CLASS)
          })
      }
      function q(c) {
        a(b.ALL_FILTERS_ID)
          .find(b.REFINEMENT_SHEET_OPTION_BUTTON)
          .each(function () {
            ;-1 !== a(this).text().toLowerCase().indexOf(c) ||
            a(this).hasClass('sbl-refinement-item-selected')
              ? a(this).removeClass(b.REFINEMENT_SEARCH_HIDDEN_CLASS)
              : a(this).addClass(b.REFINEMENT_SEARCH_HIDDEN_CLASS)
          })
      }
      function h(c) {
        a(b.ALL_FILTERS_ID)
          .find('.refinement-type-section')
          .each(function () {
            ;-1 !==
              a(this)
                .find('.sbl-refinement-expander-header-content')
                .text()
                .toLowerCase()
                .indexOf(c) &&
              (a(this).removeClass(b.REFINEMENT_CATEGORY_HIDDEN_CLASS),
              a(this)
                .find(b.REFINEMENT_SHEET_OPTION_BUTTON)
                .removeClass(b.REFINEMENT_SEARCH_HIDDEN_CLASS))
          })
      }
      return {
        startRefinementSheetLoading: function () {
          a('#shopbylook-refinement-loading-section').show()
        },
        stopRefinementSheetLoading: function () {
          a('#shopbylook-refinement-loading-section').hide()
        },
        showResultsNumber: f,
        updateSheetBottomSection: function (e) {
          e
            ? (c.show(a('#sbl-refinements-bottom-nav')), k())
            : (c.hide(a('#sbl-refinements-bottom-nav')), p())
          '' !== (a(b.REFINEMENT_TOP_NAV_SEARCH_INPUT).val().toLowerCase() || '').trim() && k()
        },
        updateFiltersAndAsinCount: function (c, e) {
          var d = 2 < arguments.length && arguments[2] !== z ? arguments[2] : !1,
            k = 3 < arguments.length && arguments[3] !== z ? arguments[3] : null,
            h = m(c),
            p = D(c)
          n(h, p, d)
          g()
          U(h, p, d, k)
          f(c.asinCount, e)
          K(a(b.ALL_FILTERS_ID).find('.sbl-refinement-brand'))
        },
        updateBrandRefinements: K,
        clearFilters: function () {
          var c = 0 < arguments.length && arguments[0] !== z ? arguments[0] : !1,
            e = 1 < arguments.length && arguments[1] !== z ? arguments[1] : null,
            d = 2 < arguments.length && arguments[2] !== z ? arguments[2] : null,
            f = 3 < arguments.length && arguments[3] !== z ? arguments[3] : null,
            k = a(b.ALL_FILTERS_ID),
            h = a(b.TOP_REFINEMENT_SECTION_ID)
          k.find(b.REFINEMENT_SHEET_OPTION_BUTTON).each(function () {
            c && a(this).hasClass('a-button-selected') && e
              ? e(a(this), !0)
              : a(this)[0].setAttribute('aria-pressed', 'false')
            a(this).removeClass(
              'sbl-refinement-item-selected ' + b.REFINEMENT_UNAVAILABLE_HIDDEN_CLASS,
            )
          })
          k.find('.refinement-button-selected-value').text('')
          g()
          c
            ? (h
                .find(
                  '.sbl-refinement-element-container:not(.sbl-keyword-item-review):not(.sbl-filter-keyword-hidden):not(.sbl-top-refinement-element)',
                )
                .closest('.a-declarative')
                .remove(),
              h.find('.sbl-top-refinement-element').each(function () {
                a(this).hasClass('a-button-selected') &&
                  (e && e(a(this), !0),
                  d &&
                    a(this)
                      .find('input')[0]
                      .getAttribute('data-refinement-value')
                      .includes('price') &&
                    d(a(this).closest('.a-declarative')))
                a(this).removeClass(b.REFINEMENT_UNAVAILABLE_HIDDEN_CLASS)
              }),
              a(h.find(b.REVIEW_KEYWORD_ITEM)).hasClass('a-button-selected') &&
                e(h.find(b.REVIEW_KEYWORD_ITEM), !0))
            : (h
                .find(
                  '.sbl-refinement-element-container:not(.sbl-keyword-item-review):not(.sbl-filter-keyword-hidden):not(.sbl-top-refinement-element)',
                )
                .remove(),
              h
                .find('.sbl-top-refinement-element')
                .removeClass(b.REFINEMENT_UNAVAILABLE_HIDDEN_CLASS)
                .addClass('sbl-inactive'),
              h.find(b.REVIEW_KEYWORD_ITEM).addClass('sbl-inactive'))
          0 === h.find('.sbl-prime-toggle').removeClass('sbl-prime-selected').length &&
            f &&
            f.isOn(!1)
          K(a(b.ALL_FILTERS_ID).find('.sbl-refinement-brand'))
          p()
        },
        searchBarFilterResults: function (e) {
          var d = a(b.REFINEMENT_TOP_NAV_SEARCH_INPUT).val().toLowerCase() || ''
          q(d)
          g()
          h(d)
          K(a(b.ALL_FILTERS_ID).find('.sbl-refinement-brand'))
          '' === d.trim()
            ? (c.hide(a('#sbl-refinement-search-clear-btn')), p())
            : (c.show(a('#sbl-refinement-search-clear-btn')), k())
          '' === d.trim() && e && k()
        },
        clearFilterSearchBar: function (e) {
          a(b.REFINEMENT_TOP_NAV_SEARCH_INPUT).val('')
          a(b.ALL_FILTERS_ID)
            .find(b.REFINEMENT_SHEET_OPTION_BUTTON)
            .each(function () {
              a(this).removeClass(b.REFINEMENT_SEARCH_HIDDEN_CLASS)
            })
          K(a(b.ALL_FILTERS_ID).find('.sbl-refinement-brand'))
          g()
          c.hide(a('#sbl-refinement-search-clear-btn'))
          e || p()
        },
      }
    },
  )
  ;('use strict')
  m.when('A', 'ready').register('mirai-action-type', function () {
    return {
      LIKE: 'LIKE',
      DISLIKE: 'DISLIKE',
      ADD_FILTER: 'ADD_FILTER',
      REMOVE_FILTER: 'REMOVE_FILTER',
      ADD_TOP_FILTER: 'ADD_TOP_FILTER',
      REMOVE_TOP_FILTER: 'REMOVE_TOP_FILTER',
      CLEAR_FILTERS: 'CLEAR_FILTERS',
      OPEN_FILTERS: 'OPEN_FILTERS',
      CLOSE_FILTERS: 'CLOSE_FILTERS',
      LOAD_MORE: 'LOAD_MORE',
      ADD_SUGGESTED_FILTER: 'ADD_SUGGESTED_FILTER',
      GO_TO_DETAIL_PAGE: 'GO_TO_DETAIL_PAGE',
      GO_TO_DETAIL_PAGE_VARIATIONS: 'GO_TO_DETAIL_PAGE_VARIATIONS',
      PLAY_VIDEO: 'PLAY_VIDEO',
      ADD_HEART: 'ADD_HEART',
      REMOVE_HEART: 'REMOVE_HEART',
      V31_DESKTOP_SCROLL: 'V31_DESKTOP_SCROLL',
    }
  })
  ;('use strict')
  m.when('A', 'mirai-device-types').register('mirai-video-ingress-helper', function (c, a) {
    function b() {
      var b = d
        .find('[data-asin]')
        .map(function () {
          return c.$(this).data('asin')
        })
        .get()
      0 < b.length &&
        (function () {
          var p = function (a) {
              '' !== a && ((e = !0), d.append(a))
            },
            f = {
              adaptiveWidgetContext: { asinList: b },
              clientPrefix: 'discover',
              page: 'Detail',
              placement: 'HITDiscover',
              device: a.IS_MOBILE ? 'Mobile' : 'Desktop',
              product: { contentID: b[0], contentIDType: 'ASIN' },
              requestId: D.ue ? D.ue.id : '',
            }
          m.when('dp-latency-marker').execute('mirai-video-ingress-execute-ajax', function () {
            c.post('/vap/ew/componentbuilder', {
              params: f,
              paramsFormat: 'json',
              contentType: 'application/json',
              success: p,
            })
          })
        })()
    }
    var d = void 0,
      e = !1
    return {
      initialize: function (a) {
        d = a
        b()
      },
      update: function () {
        e ? c.trigger('ive:discover:adaptiveWidget:update') : b()
      },
      updateHoverStatus: function (a) {
        a.hasClass('has-ive-video ive-is-hovering') &&
          (a.trigger('mouseleave'), a.removeClass('ive-is-hovering'))
      },
    }
  })
  ;('use strict')
  m.when('A', 'jQuery', 'mirai-constants', 'mirai-utils', 'ready').register(
    'mirai-discover-url-refinements-helper',
    function (c, a, b, d) {
      return {
        addOrReorderTopRefsWithUrlRef: function (c, k, p) {
          c = a(b.ALL_FILTERS_ID)
            .find('.sbl-refinement-' + c)
            .first()
          var f = d.getRefinementData(c)
          if (f)
            if (
              a(b.TOP_REFINEMENT_SECTION_ID)
                .find('.sbl-keyword-item-' + f.filterSelectorSuffix)
                .hasClass('sbl-top-refinement-element')
            )
              p.find('.sbl-keyword-item-' + f.filterSelectorSuffix).insertAfter(
                d.getReviewPosition(),
              )
            else {
              var m = f.refinementType,
                z = f.filterSelectorSuffix
              k = d.createTopRefinementButton(c, m, f.value, z, k, p)
              k.insertAfter(d.getReviewPosition())
              d.registerSelectedRefinementItem(k, c, m, z)
            }
        },
      }
    },
  )
  ;('use strict')
  m.when('A', 'ready').execute('mirai-list-registry', function (c) {
    m.now('lists-framework-ready').execute(function (a) {
      'undefined' === typeof a
        ? m.register('lists-framework-ready')
        : m.trigger('lists-framework-reinitialize')
    })
  })
  ;('use strict')
  m.when('A', 'jQuery', 'ready').register('mirai-heart-button-helper', function (c, a) {
    return {
      updateHeartWishList: function (a, d) {
        if (
          !c.objectIsEmpty(a) &&
          !c.objectIsEmpty(d) &&
          ((d = d.heartActionDetails), !c.objectIsEmpty(d))
        ) {
          var e = d.initialActions,
            k
          c.objectIsEmpty(e) ||
            '' === e ||
            ((k = e.replace(/&quot;/g, '"')), (k = k.replace(/&#34;/g, '"')))
          var e = d.hiddenActions,
            p
          c.objectIsEmpty(e) ||
            '' === e ||
            ((p = e.replace(/&quot;/g, '"')), (p = p.replace(/&#34;/g, '"')))
          d = d.serializedItemInfo
          var f
          c.objectIsEmpty(d) ||
            '' === d ||
            ((f = d.replace(/&quot;/g, '"')), (f = f.replace(/&#34;/g, '"')))
          c.objectIsEmpty(k) ||
            ((a = a.removeClass('lists-framework-replaced')),
            a.attr('data-lists-framework-initial-actions', k),
            a.data('listsFrameworkInitialActions', k))
          c.objectIsEmpty(p) ||
            (a.attr('data-lists-framework-hidden-actions', p),
            a.data('listsFrameworkHiddenActions', p))
          c.objectIsEmpty(f) ||
            (a.attr('data-lists-framework-item-info', f),
            a.data('listsFrameworkItemInfo', f),
            a.find('span').remove())
        }
      },
      updateNextHeartStrings: function (a) {
        a.find('.lists-framework-hearts-notifications-changeover').css('display', 'none')
      },
    }
  })
  ;('use strict')
  var $a =
    'function' === typeof Symbol && 'symbol' === typeof Symbol.iterator
      ? function (c) {
          return typeof c
        }
      : function (c) {
          return c &&
            'function' === typeof Symbol &&
            c.constructor === Symbol &&
            c !== Symbol.prototype
            ? 'symbol'
            : typeof c
        }
  m.when(
    'A',
    'jQuery',
    'mirai-device-types',
    'mirai-constants',
    'mirai-utils',
    'mirai-action-type',
    'mirai-side-sheet-helper',
    'mirai-discover-search-bar-helper',
    'mirai-video-ingress-helper',
    'mirai-discover-url-refinements-helper',
    'mirai-heart-button-helper',
    'ready',
  ).execute('mirai-core', function (c, a, b, d, e, k, p, f, X, Ia, K) {
    function U(a, b) {
      ;-1 === R.indexOf(d.LIKE_PREFIX + b.asin) &&
        (R.push(d.LIKE_PREFIX + b.asin), O.push({ asin: b.asin, iteration: S }))
    }
    function n(l, r, w) {
      var f = e.getCurrentItemBoxes(t).first().clone()
      f.removeClass(d.SBL_FLIP_BOX_CLASS)
      f.removeClass('sbl-item-liked')
      t.empty()
      r = l ? Math.min(r, l.length) : 0
      var g = r - (0 === r % 2 ? 2 : 1)
      w = w && 2 < r
      for (var k = 0; k < r; k++) {
        K.updateNextHeartStrings(f)
        var L = f.clone()
        if (w && k >= g) {
          L.each(function () {
            a(this).css({ height: '50px' })
          })
          var F = L.find('.sbl-shadow-preview-fading')
          F.removeClass('hit-sbl-shadow-preview-fading-override')
          F.removeClass('aok-hidden')
          F.css('width', xa / 2.3 + 'px')
        }
        var F = l[k],
          h = ea(L, F, !1)
        ;-1 < R.indexOf(d.LIKE_PREFIX + F.asin) && U(L, F)
        h ? t.append(L) : (r = Math.min(r + 1, l.length))
      }
      e.updateTruncate(t)
      b.IS_MOBILE || t.addClass(d.SHOPBYLOOK_INIT)
      Ma()
      X.update()
      ja()
      c.trigger('lists-framework-reinitialize')
      ka()
    }
    function g(l) {
      E && (E.abort(), (E = null))
      var b = O
      0 === O.length && 0 === V.length && (b = [{ asin: x.mainAsin, iteration: S }])
      e.startLoading(u)
      f.startRefinementSheetLoading()
      var c = u.find('#shopbylook-btf-items-section')
      fa = 0 < c.find('.hit-sbl-shadow-preview-loop').length
      var g = (la = 0 < c.find('.hit-sbl-shadow-preview').length) || fa,
        c = ma(B),
        La = e.getMaxNumberOfItems() + (g ? 2 : 0)
      c.positive = b
      c.count = La + 2
      c.currentViewAsins = []
      c.isFilterChange = !0
      c.actionType = l
      c.initialAsinList = x.initialAsinList.split(',')
      E = a
        .ajax({
          type: 'POST',
          url: d.SBL_WEBSITE_ADDRESS_PREFIX + 'getRecommendationsDPX',
          data: JSON.stringify(c),
          contentType: 'application/json',
          dataType: 'json',
          statusCode: {
            200: function (a) {
              u.find('#shopbylook-btf-no-results-section').hide()
              var l = a.dpxRecommendationItemList
              ca = a.nextStart
              n(l, La, g)
              f.updateFiltersAndAsinCount(a, x.refinementResultCountStr, y, Y)
              f.updateSheetBottomSection(0 < B.length)
            },
            204: function () {
              u.find('#shopbylook-btf-no-results-section').show()
              t.find('.shopbylook-btf-item-box').not(':first').remove()
              da.hide()
              t.animate({ height: qa }, d.NEW_ITEM_ANIMATION_TIME, function () {
                a(this).height('auto')
              })
              f.showResultsNumber(0, x.refinementResultCountStr)
              f.updateSheetBottomSection(0 < B.length)
            },
          },
        })
        .always(function () {
          e.stopLoading(u)
          f.stopRefinementSheetLoading()
          ya()
          a('#sbl-search-title').hide()
          a('#sbl-header-title').show()
          f.clearFilterSearchBar(0 < B.length)
        })
    }
    function q() {
      E && (E.abort(), (E = null))
      var l = e.getCurrentItemBoxes(t),
        l = l ? l.length : 0
      e.startLoading(u)
      var r,
        w = 0,
        f = t.find('.hit-sbl-shadow-preview'),
        g = t.find('.hit-sbl-shadow-preview-loop'),
        h
      h =
        0 < f.length && 0 === g.length
          ? d.MOBILE_NUM_ITEMS_PER_SHOW_MORE_ON_SHADOW_PREV
          : d.MOBILE_NUM_ITEMS_PER_SHOW_MORE
      r = b.IS_MOBILE ? h : 2 * ga
      w = Na(l)
      l = r + w + (b.IS_MOBILE ? 0 : 2)
      h = O
      0 === O.length && 0 === V.length && (h = [{ asin: x.mainAsin, iteration: S }])
      var L = ma(B)
      L.positive = h
      L.currentViewAsins = wa()
      L.start = ca
      L.count = l
      L.iteration = S
      L.actionType = k.LOAD_MORE
      L.initialAsinList = x.initialAsinList.split(',')
      E = a
        .ajax({
          type: 'POST',
          url: d.SBL_WEBSITE_ADDRESS_PREFIX + 'getRecommendationsDPX',
          data: JSON.stringify(L),
          contentType: 'application/json',
          dataType: 'json',
          statusCode: { 424: function () {} },
          success: function (l) {
            if (l && l.dpxRecommendationItemList) {
              var k = l.dpxRecommendationItemList
              ca = l.nextStart
              l = e.getCurrentItemBoxes(t).filter(':visible')
              l.each(function () {
                K.updateNextHeartStrings(a(this))
              })
              var h = l.first().clone()
              h.removeClass(d.SBL_FLIP_BOX_CLASS)
              h.removeClass('sbl-item-liked')
              h = l.last()
              l = e.fillGap(h, l, w, k, ea)
              k = k.slice(l)
              t = u.find('#shopbylook-btf-items-section')
              f = t.find('.hit-sbl-shadow-preview')
              g = t.find('.hit-sbl-shadow-preview-loop')
              fa = 0 < g.length
              if ((la = 0 < f.length) || fa)
                f.each(function () {
                  a(this).removeClass('hit-sbl-shadow-preview')
                  a(this).css({ height: 'auto', display: 'inline-block' })
                }),
                  la ||
                    g.each(function () {
                      a(this).css({ height: 'auto', display: 'inline-block' })
                    }),
                  t.find('.sbl-shadow-preview-fading').each(function () {
                    a(this).removeClass('hit-sbl-shadow-preview-fading-override')
                    a(this).addClass('aok-hidden')
                  }),
                  fa ||
                    a('.shopbylook-btf-items-section-row')
                      .find('.shopbylook-btf-mobile-expand-row')
                      .removeClass('sbl-show-more-shadow-preview')
              e.addRowsToEnd(
                h,
                t,
                k,
                r,
                qa,
                ea,
                b.IS_MOBILE ? d.SCROLL_HEIGHT_MULTIPLIER_MOBILE : d.SCROLL_HEIGHT_MULTIPLIER,
                fa,
              )
              t.removeClass(d.SHOPBYLOOK_INIT)
              X.update()
              ja()
              c.trigger('lists-framework-reinitialize')
              ka()
            } else ca = d.END_OF_RECOMMENDATIONS_START_INDEX
          },
        })
        .always(function () {
          Ma()
          e.updateTruncate(t)
          e.stopLoading(u)
        })
    }
    function h(l, r, w, f, g) {
      E && (E.abort(), (E = null))
      if (0 !== O.length || 0 !== V.length) {
        var k = wa(),
          h = e.getCurrentItemBoxes(t).filter(':visible'),
          F = h.length,
          p = t.find('#' + d.BOX_ID_PREFIX + l.asin),
          m = b.IS_MOBILE && p.hasClass('hit-sbl-smlt-update') ? (r ? ga + 2 : 1) : r ? ga : 1,
          n = b.IS_MOBILE ? 0 : Na(F),
          y = 0 < n && F + n - ga <= f,
          F = ma(B)
        F.asin = l.asin
        F.physicalId = l.physicalId
        F.positive = O
        F.currentViewAsins = k
        F.count = m + n + 2 + 0
        F.asinIndex = f
        F.actionType = g
        r || (F.initialAsinList = x.initialAsinList.split(','))
        E = a
          .ajax({
            type: 'POST',
            url: d.SBL_WEBSITE_ADDRESS_PREFIX + w,
            data: JSON.stringify(F),
            contentType: 'application/json',
            dataType: 'json',
            statusCode: {
              200: function (a) {
                a = a.dpxRecommendationItemList
                if (r) {
                  if (!b.IS_MOBILE && y) {
                    var w = e.fillGap(p, h, n, a, ea)
                    a = a.slice(w)
                    h = e.getCurrentItemBoxes(t).filter(':visible')
                  }
                  e.addNewRow(p, h, ga, t, qa, m, a, ea)
                  e.updateTruncate(t)
                  b.IS_MOBILE || t.removeClass(d.SHOPBYLOOK_INIT)
                } else {
                  for (
                    var w = t.find('#' + d.BOX_ID_PREFIX + l.asin), f = 0;
                    null !== a && !ea(w, a[f]) && f < a.length;

                  )
                    f++
                  e.updateTruncate(t)
                }
                e.updateTruncate(t)
                X.update()
                ja()
                c.trigger('lists-framework-reinitialize')
                ka()
              },
              204: function () {
                var a = u.find('#sbl-no-content-message')
                da.hide()
                if (!c.objectIsEmpty(a)) {
                  var b = t.find('#' + d.BOX_ID_PREFIX + l.asin),
                    r = t.offset()
                  a.css({
                    top: b.find('.sbl-item-details').offset().top - r.top,
                    left: b.offset().left - r.left,
                    width: b.outerWidth(),
                  })
                  a.stop(!0, !0).fadeIn(200).delay(4e3).fadeOut(200)
                }
              },
            },
          })
          .always(function () {
            e.triggerLazyLoad()
          })
      }
    }
    function v(l) {
      var c
      c = b.IS_MOBILE
        ? a('#refinement-all-sheet')
            .find('.sbl-refinement-' + l)
            .first()
        : a('.sbl-refinement-' + l).first()
      if (l.startsWith('@tag')) {
        c = l
          .slice(5)
          .split(' ')
          .map(function (a) {
            return a.charAt(0).toUpperCase() + a.slice(1)
          })
          .join(' ')
        l = void 0
        if (y) {
          var e = u.find('.sbl-filter-keyword-hidden').closest('.a-declarative').clone()
          l = e.find('.sbl-filter-keyword-hidden')
        } else l = u.find('.sbl-filter-keyword-hidden').clone()
        l.find('.sbl-filter-keyword-text').text(c)
        l.addClass('sbl-smart-tag')
        l.removeClass('sbl-filter-keyword-hidden').width('')
        y ? M(e, !0) : M(l, !0)
      } else
        (e = (e = na(c))
          ? a(d.TOP_REFINEMENT_SECTION_ID)
              .find('.sbl-keyword-item-' + e.filterSelectorSuffix)
              .hasClass('sbl-top-refinement-element')
          : !1),
          oa(c, !0, e, !1)
    }
    function ba(l) {
      E && (E.abort(), (E = null))
      var b = [{ asin: x.mainAsin, iteration: S }],
        w = ma(B)
      w.positive = b
      w.count = e.getMaxNumberOfItems()
      w.currentViewAsins = x.initialAsinList.split(',')
      w.isFilterChange = !1
      w.searchQuery = l
      w.refinementsQueryParameter = e.getRefinementsQueryParameter()
      w.topPickers = (function () {
        return Array.from(
          a('.sbl-top-refinement-element').map(function () {
            return '' + a(this).data('refinementValue')
          }),
        )
      })()
      var g = function (a) {
        var l = !0,
          b = !1,
          c = z
        try {
          for (
            var r = []
                .concat(aa(a.topPickers || []))
                .filter(function (a) {
                  return w.topPickers.includes(a)
                })
                .reverse()
                [Symbol.iterator](),
              e;
            !(l = (e = r.next()).done);
            l = !0
          )
            Ia.addOrReorderTopRefsWithUrlRef(e.value, x, u)
        } catch (d) {
          ;(b = !0), (c = d)
        } finally {
          try {
            !l && r.return && r.return()
          } finally {
            if (b) throw c
          }
        }
      }
      E = a.ajax({
        type: 'POST',
        url: d.SBL_WEBSITE_ADDRESS_PREFIX + 'getRecommendationsForSearchQueryDPX',
        data: JSON.stringify(w),
        contentType: 'application/json',
        dataType: 'json',
        statusCode: {
          200: function (b) {
            var r = b.refinements
            if (!c.objectIsEmpty(r)) {
              if (!0 === b.titleShown) {
                var d = a('#sbl-search-title'),
                  w
                w = d.hasClass('a-cardui-title')
                  ? d.find('.a-cardui-title-text').first()
                  : d.first()
                d.show()
                d =
                  null === b.searchQueryTitle || b.searchQueryTitle === z
                    ? x.searchInputTitle.replace(
                        '${query}',
                        '\x3cspan class\x3d"sbl-font-emphasis"\x3e' + l + '\x3c/span\x3e',
                      )
                    : b.searchQueryTitle
                w.html(d)
                a('#sbl-header-title').hide()
                G.find('#shopbylook-btf-no-results-section').hide()
              }
              ca = b.nextStart
              g(b)
              Ja(b)
              f.updateFiltersAndAsinCount(b, x.refinementResultCountStr, y)
              f.updateSheetBottomSection(0 < r.length)
              c.each(r, v)
              r = (b = b.dpxRecommendationItemList) ? b.length : 0
              r = Math.min(e.getMaxNumberOfItems(), r)
              n(b, r)
              ya()
              e.triggerLazyLoad()
              X.update()
              ja()
              c.trigger('lists-framework-reinitialize')
              ka()
            }
          },
          206: function (a) {
            g(a)
            Q(a)
          },
        },
      })
    }
    function Q(a) {
      Array.isArray(a.urlRefinements) &&
        0 < a.urlRefinements.length &&
        a.urlRefinements.some(function (a) {
          return '' !== a.trim()
        }) &&
        a.urlRefinements.forEach(function (a) {
          Ia.addOrReorderTopRefsWithUrlRef(a, x, u)
        })
    }
    function T() {
      var a = O
      0 === O.length && 0 === V.length && (a = [{ asin: x.mainAsin, iteration: S }])
      var b = ma(B)
      b.positive = a
      b.count = e.getMaxNumberOfItems()
      b.currentViewAsins = []
      b.isFilterChange = !1
      return b
    }
    function A(l, b, c) {
      if (x !== z && null !== x) {
        var e = T()
        e.actionType = l
        if (l === k.GO_TO_DETAIL_PAGE) {
          if (!b) return
          e.asin = b.asin
          e.physicalId = b.physicalId
          e.asinIndex = c
        }
        E = a.ajax({
          type: 'POST',
          url: d.SBL_WEBSITE_ADDRESS_PREFIX + 'recordActionDPX',
          data: JSON.stringify(e),
          contentType: 'application/json',
          dataType: 'json',
        })
      }
    }
    function C(a, b, c, e) {
      a = a.clone()
      var d = a.find('.refinement-row')
      a.find('.shopbylook-btf-clickable').text(c)
      d.removeClass()
      d.addClass('refinement-row sbl-refinement-option-button')
      d.addClass('sbl-refinement-' + b)
      y
        ? (d.find('input').attr('data-refinement-value', b),
          d.find('input').attr('data-refinement-index', e),
          d.addClass('a-button a-button-normal a-button-toggle v31-sheet-all-refinement'))
        : (d.attr('data-refinement-value', b), d.attr('data-refinement-index', e))
      Z.append(a)
    }
    function Ja(l) {
      if (!c.objectIsEmpty(l.fullRefinementItems)) {
        l = l.fullRefinementItems.find(function (a) {
          return a.type && 'brand' === a.type
        })
        Z = Oa.find('#sbl-refinements-bn-list-' + l.id)
        Z.addClass('sbl-refinement-brand')
        var b = Z.find('.a-declarative').length,
          d = []
        Z.find('.a-declarative .sbl-refinement-option-button').each(function () {
          y
            ? d.push(e.getElementData(a(this).find('input')).refinementValue.toString())
            : d.push(e.getElementData(a(this)).refinementValue.toString())
        })
        for (var g in l.childNodes)
          -1 === d.indexOf(g) &&
            (C(Z.find('.a-declarative').first(), g, l.childNodes[g], b), (b += 1))
        f.updateBrandRefinements(Z)
      }
    }
    function Ka() {
      if (x !== z && null !== x && !Z) {
        var l = T()
        E = a.ajax({
          type: 'POST',
          url: d.SBL_WEBSITE_ADDRESS_PREFIX + 'getFullRefinementsDPX',
          data: JSON.stringify(l),
          contentType: 'application/json',
          dataType: 'json',
          statusCode: {
            200: function (a) {
              Ja(a)
            },
          },
        })
      }
    }
    function wa() {
      var l = e
        .getCurrentItemBoxes(t)
        .map(function () {
          return e.getElementData(a(this)).asin
        })
        .get()
      b.IS_MOBILE || l.push(x.mainAsin)
      return l
    }
    function ea(a, r, w) {
      if (null === a || 0 === a.length || r === z || (pa && c.objectIsEmpty(r.basisPrice)))
        return !1
      if (w === z || w)
        a.toggleClass(d.SBL_FLIP_BOX_CLASS),
          a.removeClass('sbl-item-liked'),
          a.removeClass('sbl-item-disliked')
      if (!b.IS_MOBILE)
        return (
          e.redesignBoxSwap(a, r, za, w, !1, Aa, ra),
          r.prime ? a.addClass(d.IS_PRIME_CLASS) : a.removeClass(d.IS_PRIME_CLASS),
          X.updateHoverStatus(a),
          !0
        )
      e.redesignBoxSwap(a, r, za, w, !0, Aa, ra)
      a.removeClass('sbl-item-liked').removeClass('sbl-item-disliked')
      return !0
    }
    function Na(a) {
      var b = Pa()
      a %= b
      return 0 < a ? b - a : 0
    }
    function Pa() {
      return Math.floor(t.width() / t.children().eq(0).width())
    }
    function za(a, r) {
      r =
        'sbl_dpx_' +
        (b.IS_MOBILE ? 'm_' : '') +
        x.browseNode +
        '_' +
        x.mainAsin +
        '_' +
        (c.objectIsEmpty(r) ? '' : r + '_') +
        S
      var d = encodeURIComponent(e.getSearchQuery()),
        d = 0 < d.length ? '?keywords\x3d' + d : ''
      return '/dp/' + a + '/ref\x3d' + r.substring(0, 64) + d
    }
    function Qa() {
      var l = a('#desktop-dp-btf-shopbylook').width()
      a('#mirai-btf-shopbylook-row').width() < l
        ? a('.sbl-btf-suggestion-items-section').addClass('sbl-ads-override')
        : a('.sbl-btf-suggestion-items-section').removeClass('sbl-ads-override')
      ga = Pa()
      !b.IS_MOBILE && y && Y()
    }
    function Y() {
      var l = N[0].scrollLeft,
        b = N[0].scrollWidth - N[0].clientWidth - l
      2 < l
        ? a('#refinement_carousel_scroller_left').removeClass('aok-hidden')
        : a('#refinement_carousel_scroller_left').addClass('aok-hidden')
      2 < b
        ? a('#refinement_carousel_scroller_right').removeClass('aok-hidden')
        : a('#refinement_carousel_scroller_right').addClass('aok-hidden')
    }
    function ya(a) {
      var c = B.length
      0 === c && e.hideSelectedRefinementsBar(u)
      a || (a = u.find(b.IS_MOBILE ? '#sbl-btf-refinement-row' : '#sbl-refinement-row'))
      ;-1 < B.indexOf('@prime') && --c
      ;-1 < B.indexOf('@review:4') && --c
      a = a.find('#sbl-show-more-selected')
      0 < c
        ? (a.text('(' + c + ')'),
          y &&
            (a.removeClass('aok-hidden'),
            a.closest('.a-button-toggle').removeClass('a-button-normal'),
            a.closest('.a-button-toggle').addClass('a-button-selected')))
        : (a.text(''),
          y &&
            (a.addClass('aok-hidden'),
            a.closest('.a-button-toggle').addClass('a-button-normal'),
            a.closest('.a-button-toggle').removeClass('a-button-selected')))
    }
    function ab() {
      d.MOBILE_REFINEMENT_BOTTOM_SHEET_NAMES.forEach(function (b) {
        c.on('a:sheet:beforeShow:sbl' + b + 'Sheet', function (c) {
          A(k.OPEN_FILTERS)
          c = a('#refinement-' + b.toLowerCase() + '-sheet').closest('.a-sheet-web')
          c.height(D.innerHeight * ('All' === b ? 0.8 : 0.5))
          Ka()
          Ba(!1, c)
        })
        c.on('a:sheet:beforeHide:sbl' + b + 'Sheet', function (a) {
          A(k.CLOSE_FILTERS)
        })
      })
    }
    function Ra(a, b, c, d) {
      y
        ? ((b = a.find('input')),
          b.addClass('sbl-keyword-item-' + d),
          b.attr('data-parent-item', '.sbl-refinement-' + d),
          b.attr('data-refinement-value', d))
        : (a.addClass('sbl-keyword-item-' + d),
          a.attr('data-parent-item', '.sbl-refinement-' + d),
          a.attr('data-refinement-value', d))
      a.removeClass('sbl-filter-keyword-hidden').width('')
    }
    function na(a) {
      var b = a.closest('.sbl-refinements-bn-list')
      if (!b || 0 === b.length) return null
      var c = e.getElementData(b),
        b = c.refinementType,
        f = '@' + b,
        g = y ? e.getElementData(a.find('input')) : e.getElementData(a.closest('.refinement-row'))
      a = g.refinementValue
      var k = g.refinementIndex,
        g = 'review' === b
      c.refinementSource === d.BROWSE_SOURCE
        ? (f = c = a)
        : ((c = f + (a ? ':' + a : '')), (f = b + (a ? '-' + (g ? a : k) : '')))
      return { refinementType: b, value: a, isReview: g, filter: c, filterSelectorSuffix: f }
    }
    function Ca(a, b) {
      var c = B.indexOf(a)
      ;-1 < c
        ? (B.splice(c, 1), (P = b ? k.REMOVE_TOP_FILTER : k.REMOVE_FILTER))
        : (B.push(a), (P = b ? k.ADD_TOP_FILTER : k.ADD_FILTER))
    }
    function bb(b, c, d, e, f) {
      a('.sbl_refinement_' + c + '_selected').each(function () {
        var c = a(this)
        d
          ? c.text(0 < b ? x.refinementStarsAndUp.replace('${count}', e) : '')
          : c.text(0 < b ? '(' + b + ')' : '')
      })
    }
    function Da(a) {
      var b = u.find(d.REVIEW_KEYWORD_ITEM)
      if (y) {
        var c = b.find('input')
        c.attr('data-parent-item', '.sbl-refinement-review-' + a)
        c.attr('data-refinement-value', a)
      } else
        b.attr('data-parent-item', '.sbl-refinement-review-' + a),
          b.attr('data-refinement-value', a)
      b = b.find('.sbl-top-refinement-review')
      for (c = 0; 5 >= c; c++)
        b.removeClass('a-star-medium-' + c), b.removeClass('sbl-top-refinement-review-' + c)
      b.addClass('a-star-medium-' + a)
      b.addClass('sbl-top-refinement-review-' + a)
    }
    function Ea() {
      return y
        ? a(d.TOP_REFINEMENT_SECTION_ID)
            .find(d.REVIEW_KEYWORD_ITEM)
            .closest('.a-declarative')
            .first()
        : a(d.TOP_REFINEMENT_SECTION_ID).find(d.REVIEW_KEYWORD_ITEM).first()
    }
    function M(c, e) {
      var f = 2 < arguments.length && arguments[2] !== z ? arguments[2] : !1
      e
        ? (y
            ? (b.IS_MOBILE
                ? f
                  ? c.prependTo(c.closest('.sbl-two-row-refinements'))
                  : c.prependTo(u.find('#sbl-two-row-other-refinements'))
                : (c.prependTo(u.find('#sbl-top-refinement-section')), Y()),
              N.animate({ scrollLeft: 0 }, 600))
            : c.insertAfter(Ea()),
          y || c.removeClass('sbl-inactive'))
        : (y || c.addClass('sbl-inactive'),
          (f = y
            ? b.IS_MOBILE
              ? c
                  .closest('.sbl-two-row-refinements')
                  .find(
                    '.sbl-refinement-element-container:not(.a-button-normal):not(.sbl-filter-keyword-hidden)',
                  )
              : u
                  .find(d.TOP_REFINEMENT_SECTION_ID)
                  .find(
                    '.sbl-refinement-element-container:not(.a-button-normal):not(.sbl-filter-keyword-hidden):not(.sbl-filter-keyword-prime)',
                  )
            : a(d.TOP_REFINEMENT_SECTION_ID).find(
                '.sbl-refinement-element-container:not(.sbl-inactive):not(.sbl-filter-keyword-hidden):not(.sbl-filter-keyword-prime)',
              )) && 0 !== f.length
            ? y
              ? b.IS_MOBILE &&
                c.find('input')[0].getAttribute('data-refinement-value').includes('price')
                ? Fa(c, f.last().closest('.a-declarative'))
                : (c.insertAfter(f.last().closest('.a-declarative')), b.IS_MOBILE || Y())
              : c.insertAfter(f.last())
            : y
              ? b.IS_MOBILE
                ? c.find('input')[0].getAttribute('data-refinement-value').includes('price')
                  ? Fa(c)
                  : c.prependTo(c.closest('.sbl-two-row-refinements'))
                : (c.prependTo(a('#sbl-top-refinement-section')), Y())
              : c.insertAfter(Ea()))
    }
    function Ga(a) {
      return a
        .find('.a-button-input')[0]
        .getAttribute('data-refinement-value')
        .replace('price-', '')
    }
    function Fa(b) {
      for (
        var c = 1 < arguments.length && arguments[1] !== z ? arguments[1] : null,
          d = Ga(b),
          e = a('#sbl-two-row-review-price-refinements').find(
            '.sbl-refinement-element-container:not(.sbl-keyword-item-review)',
          ).length,
          f = a('#sbl-two-row-review-price-refinements')
            .find(
              '.sbl-refinement-element-container:not(.sbl-keyword-item-review):not(.a-button-selected)',
            )
            .not(b),
          g = 0;
        g < f.length;
        g++
      ) {
        var k = a(f[g].closest('.a-declarative')),
          h = Ga(k),
          p = g < f.length - 1 ? Ga(a(f[g + 1])) : e
        if (d < h) break
        if (d > h && d < p) {
          b.insertAfter(k)
          return
        }
      }
      c && 0 < a('#sbl-refinements-bn-list-review').find('.a-button-selected').length
        ? b.insertAfter(c)
        : b.insertAfter(Ea())
    }
    function W(a, b) {
      a.toggleClass('a-button-normal')
      a.toggleClass('a-button-selected')
      b
        ? a.find('input')[0].setAttribute('aria-pressed', 'false')
        : a.find('input')[0].setAttribute('aria-pressed', 'true')
      a.find('.close-icon').toggleClass('aok-hidden')
      a.find('.add-icon').toggleClass('aok-hidden')
      a.removeClass(d.LIKE_BUTTON_FOCUS)
    }
    function oa(c, f, w, k) {
      var h = c.hasClass('sbl-refinement-item-selected'),
        p = c.closest('.sbl-refinements-bn-list')
      if (p && 0 !== p.length) {
        var m = na(c),
          n = m.refinementType,
          t = m.value,
          q = m.isReview,
          v = m.filter,
          m = m.filterSelectorSuffix
        P = null
        y && W(a(d.REFINEMENT_SELECTOR_PREFIX + m), h)
        a(d.REFINEMENT_SELECTOR_PREFIX + m).toggleClass('sbl-refinement-item-selected')
        bb(p.find('.sbl-refinement-item-selected').length, n, q, t, v)
        Ca(v, k)
        k = y
          ? u
              .find('.sbl-keyword-item-' + (q ? n : m))
              .closest('.a-declarative')
              .find('.a-button-selected')
          : u.find('.sbl-keyword-item-' + (q ? n : m) + ':not(.sbl-inactive)')
        q
          ? ((m = u.find(d.REVIEW_KEYWORD_ITEM)),
            h
              ? (Da(4),
                y
                  ? (W(m, h),
                    (n = a('.sbl-refinement-review-4')[0].getAttribute('aria-label')),
                    m.find('input')[0].setAttribute('aria-label', n),
                    M(m.closest('.a-declarative'), !1))
                  : m.addClass('sbl-inactive'))
              : (Da(t),
                y &&
                  ((t = c.find('input')[0].getAttribute('aria-label')),
                  m.find('input')[0].setAttribute('aria-label', t),
                  M(m.closest('.a-declarative'), !0, !0)),
                k.length
                  ? (y
                      ? ((c = a('#sbl-refinements-bn-list-review')
                          .find('.a-button-selected')
                          .not(c)),
                        W(c, !0))
                      : ((c = a('#sbl-refinements-bn-list-review')
                          .find('.sbl-refinement-item-selected')
                          .not(c)),
                        c[0].setAttribute('aria-pressed', 'false')),
                    (h = na(c).filter),
                    Ca(h, !1, n),
                    c.removeClass('sbl-refinement-item-selected'))
                  : y
                    ? W(m, h)
                    : m.removeClass('sbl-inactive')))
          : ((q = B.indexOf(v)), h || (k.length && !(-1 >= q)))
            ? h &&
              k.length &&
              (w
                ? ((n = u.find('.sbl-keyword-item-' + m)),
                  y ? (W(n, h), M(n.closest('.a-declarative'), !1, !0)) : M(n, !1, !0))
                : y
                  ? e.closeSelectedRefinementItem(
                      k.first().closest('.a-declarative'),
                      !b.IS_MOBILE,
                      Y,
                    )
                  : e.closeSelectedRefinementItem(k.first()))
            : w
              ? ((n = u.find('.sbl-keyword-item-' + m)),
                y
                  ? (W(n, h), M(n.closest('.a-declarative'), !0, !0))
                  : (n.removeClass('sbl-inactive'), M(n, !0, !0)))
              : (y
                  ? ((h = u.find('.sbl-filter-keyword-hidden').closest('.a-declarative').clone()),
                    (w = h.find('.a-button')),
                    Ra(w, c, n, m))
                  : ((h = u.find('.sbl-filter-keyword-hidden').clone()), Ra(h, c, n, m)),
                (w = c.find('.sbl-softlines-colorsprite,.sbl-colorsprite')),
                0 < w.length && (sa(w), w.clone().prependTo(h.find('.sbl-refinement-element-box'))),
                h.find('.sbl-filter-keyword-text').text(e.getRefinementReadableName(c, x, n, t, m)),
                M(h, !0))
        f || g(P)
      }
    }
    function Sa(a) {
      var b = B.indexOf('@prime')
      0 > b
        ? (B.push('@prime'),
          a.find('.sbl-prime-toggle').addClass('sbl-prime-selected'),
          (P = k.ADD_FILTER))
        : (B.splice(b, 1),
          a.find('.sbl-prime-toggle').removeClass('sbl-prime-selected'),
          (P = k.REMOVE_FILTER))
      g(P)
    }
    function Ta() {
      var a = B.indexOf('@basisPrice'),
        b = u.find('.sbl-keyword-item-basisPrice')
      0 > a
        ? (B.push('@basisPrice'),
          (P = k.ADD_FILTER),
          y
            ? (W(b, !1), M(b.closest('.a-declarative'), !0, !0))
            : (b.removeClass('sbl-inactive'), M(b, !0, !0)))
        : (B.splice(a, 1),
          (P = k.REMOVE_FILTER),
          (pa = !1),
          y ? (W(b, !0), M(b.closest('.a-declarative'), !1, !0)) : M(b, !1, !0))
      g(P)
    }
    function Ma() {
      ca === d.END_OF_RECOMMENDATIONS_START_INDEX ? da.hide() : da.show()
    }
    function ta() {
      if (!Ua)
        if (c.objectIsEmpty(u)) c.off('scroll', ta)
        else if (c.onScreen(u, b.IS_MOBILE ? 100 : 50)) {
          c.off('scroll', ta)
          var a = e.getSearchQuery()
          c.objectIsEmpty(a) || ba(a)
        }
    }
    function cb() {
      var b = a(d.REFINEMENT_TOP_NAV_SEARCH_INPUT)
      b.val('')
      b.bind('input', function () {
        f.searchBarFilterResults(0 < B.length)
      })
    }
    function ha(a) {
      H = a.$currentTarget
        .closest('.shopbylook-btf-item-box-inner')
        .closest('.shopbylook-btf-item-box')
    }
    function ua(a) {
      var b = a.find('.image-urls-container').data('image-urls')
      a = a.find('.wb-image-url-container').data('wb-image-url')
      I = []
      I = [a].concat(b.split(','))
    }
    function Ba(a) {
      var d = 1 < arguments.length && arguments[1] !== z ? arguments[1] : null
      a
        ? y
          ? c.each(u.find('.sbl-top-refinement-scroller-v31').find('.sbl-color-span'), sa)
          : c.each(u.find('.sbl-top-refinement-scroller').find('.sbl-color-span'), sa)
        : c.each(
            b.IS_MOBILE && d
              ? d.find('.sbl-color-span')
              : u.find('.sbl-side-sheet-content').find('.sbl-color-span'),
            sa,
          )
    }
    function sa(b) {
      b = a(b)
      var c = b.attr('data-refinement-image-css')
      b.attr('style', c)
      b.removeClass('aok-hidden')
      b.removeClass('sbl-color-span')
    }
    function Va() {
      G = a(b.IS_MOBILE ? '#mobile-dp-btf-shopbylook' : '#desktop-dp-btf-shopbylook')
      y =
        0 < G.length
          ? a('#sbl-top-refinement-section').hasClass('sbl-top-refinement-scroller-v31')
          : !1
      u = a('#mirai-btf-shopbylook-row')
      if (0 < u.length) {
        c.state.parse()
        var d = c.state('shopbylookStateData')
        d || G.hide()
        Oa = b.IS_MOBILE ? a('.sbl-bottom-sheet') : u
        var f =
            0 < G.length &&
            0 < a('#miraiBTFShopByLook_feature_div').length &&
            a('#miraiBTFShopByLook_feature_div').hasClass('js-feature-refresh-overlay'),
          g = e.getElementData(u),
          h = g.mainAsin
        f || G.show()
        ;(x && x.mainAsin === h) || (x && !h) || !d
          ? f && G.hide()
          : (f &&
              (a('#miraiBTFShopByLook_feature_div').removeClass('js-feature-refresh-overlay'),
              a('#miraiBTFShopByLook_feature_div').css({ opacity: '' })),
            Ba(!0),
            (x = d),
            (d = x.mainAsin !== h),
            (x.mainAsin = h ? h : x.mainAsin),
            (x.browseNode = g.browseNode ? g.browseNode : x.browseNode),
            0 < G.length && G.find('h2'),
            b.IS_MOBILE || p.refreshSideSheet(b.IS_MOBILE),
            X.initialize(G),
            (O = []),
            (V = []),
            (R = []),
            (S = 0),
            (ca = null),
            (B = []),
            (Ua = G.hasClass('sbl-interactive-disabled')),
            (Aa = G.hasClass('sbl-eel-enabled')),
            (t = u.find('#shopbylook-btf-items-section')),
            (x.initialAsinList = d ? wa().join(',') : x.initialAsinList),
            (g = u.find('.shopbylook-btf-desktop-expand-row')),
            (g = 0 !== g.length ? g : u.find('#shopbylook-btf-desktop-show-more')),
            (da = b.IS_MOBILE ? u.find('#shopbylook-btf-mobile-show-more') : g),
            y &&
              (b.IS_MOBILE
                ? (N = a('#sbl-top-refinement-section'))
                : ((N = a('#sbl-top-refinement-section')),
                  N[0].addEventListener('scroll', function () {
                    Ha || (A(k.V31_DESKTOP_SCROLL), (Ha = !0))
                    Y()
                  }),
                  (Ha = !1))),
            Qa(),
            D.addEventListener('resize', Qa),
            cb(),
            (qa = e.getCurrentItemBoxes(t).first().outerHeight()),
            c.onScreen(u, 0) || (c.off('scroll', ta), c.on('scroll', ta)),
            b.IS_MOBILE ? b.IS_MOBILE && !Wa && (ab(), (Wa = !0)) : ya(),
            (la = 0 < t.find('.hit-sbl-shadow-preview').length),
            (xa = a(D).width()),
            la &&
              t
                .find('.sbl-shadow-preview-fading')
                .slice(-2)
                .each(function (b) {
                  0 === b && a(this).css('width', xa / 2.3 + 'px')
                }),
            (g = t.find('.shopbylook-btf-item-box')),
            (ra = G.hasClass('hit-sbl-swipeable-gallery-update')),
            g.each(function () {
              var b = a(this),
                c = e.getElementData(b),
                c = za(c.asin)
              b.find('a.sbl-image-link').attr('href', c)
              ra && b.find('.shopbylook-image-section-middle-dot').first().addClass('selected')
            }))
      } else x && (x.mainAsin = null)
    }
    function ja() {
      G.find('.play-icon-placeholder').unbind('click')
      G.find('.play-icon-placeholder').click(function () {
        A(k.PLAY_VIDEO)
      })
    }
    function ka() {
      G.find('.sbl-suggestion-box-hearts-container').unbind('click')
      G.find('.sbl-suggestion-box-hearts-container').click(function (b) {
        var c = a(this).find('.lists-framework-filled-heart')
        b = !a(this).find('.lists-framework-unfilled-heart').hasClass('aok-hidden')
        c = !c.hasClass('aok-hidden')
        b ? A(k.ADD_HEART) : c && A(k.REMOVE_HEART)
      })
    }
    function ma(a) {
      var b = {
          browseNode: x.browseNode,
          anchorAsin: x.mainAsin,
          anchorAsinPid: x.mainAsinPid,
          negative: V,
          iteration: S,
        },
        c = []
      a.forEach(function (a) {
        if (
          a &&
          'object' === ('undefined' === typeof a ? 'undefined' : $a(a)) &&
          'price' === a.type
        )
          a.min && (b.minPrice = a.min), a.max && (b.maxPrice = a.max)
        else if ('deal' == a) {
          a = new Date()
          var d = new Date(a.getTime() + 18e4),
            e = {
              year: 'numeric',
              month: '2-digit',
              day: '2-digit',
              hour: '2-digit',
              minute: '2-digit',
              second: '2-digit',
              hour12: !1,
            }
          b.startViewDealTime = a.toLocaleString('ja-JP', e).replaceAll('/', '-').replace(',', '')
          b.endViewDealTime = d.toLocaleString('ja-JP', e).replaceAll('/', '-').replace(',', '')
        } else
          a && 'string' == typeof a && -1 == a.indexOf('@')
            ? a.split('-').forEach(function (a) {
                c.push(a)
              })
            : c.push(a)
      })
      b.filters = c
      return b
    }
    var x,
      u,
      G,
      Oa,
      O = [],
      V = [],
      R = [],
      S = 0,
      ca = null,
      E = null,
      B = [],
      Wa = !1,
      P = null,
      Ua = !1,
      t = null,
      da = null,
      qa = null,
      ga = null,
      la = !1,
      fa = !1,
      xa = null,
      Z = null,
      Aa = !1,
      Xa = null,
      y = !1,
      N = null,
      Ha = !1,
      pa = !1,
      ra = !1,
      H = null,
      I = [],
      J = 0,
      ia = 0,
      Ya = 0,
      Za = 0,
      va = !1
    b.IS_MOBILE &&
      m.when('A', 'jQuery', 'a-sheet').register('mirai-discover-bottom-sheet', function (a, b, c) {
        a.declarative('mirai-discover-bottom-sheet:hide', 'click', function () {
          c.get('sblAllSheet').hide()
        })
      })
    c.on('a:pageUpdate', Va)
    c.declarative('sblTopRefinementScrollLeftV31', 'click', function () {
      N.animate({ scrollLeft: N[0].scrollLeft - Math.min(N[0].scrollLeft, 350) }, 400)
    })
    c.declarative('sblTopRefinementScrollRightV31', 'click', function () {
      N.animate(
        { scrollLeft: N[0].scrollLeft + Math.min(N[0].scrollWidth - N[0].clientWidth, 350) },
        400,
      )
    })
    c.declarative('sblImageMouseHover', 'mouseenter', function (a) {
      ha(a)
      1 < H.find('.shopbylook-carousel-pagination span').length &&
        H.find('.shopbylook-carousel-arrow-container').removeClass('aok-hidden')
    })
    c.declarative('sblImageMouseHover', 'mouseleave', function (a) {
      ha(a)
      H.find('.shopbylook-carousel-arrow-container').addClass('aok-hidden')
    })
    c.declarative('sblImageSwipe', 'touchstart', function (a) {
      Ya = a.$event.originalEvent.touches[0].pageX
      va = !1
    })
    c.declarative('sblImageSwipe', 'touchmove', function (a) {
      if (!va) {
        Za = a.$event.originalEvent.touches[0].pageX
        var b = Ya - Za
        ha(a)
        ua(H)
        a = H.find('.shopbylook-btf-image-container').width()
        var c = H.find('.shopbylook-btf-image-elem')
        a = Math.abs(b / a)
        c.css('transform', 'translateX(' + -1 * b + 'px)')
        0.05 < a &&
          ((va = !0),
          I &&
            I.length &&
            ((a = H.find('.shopbylook-image-section-middle-dot')),
            (J = a.index(a.filter('.selected'))),
            0 < b ? (J = (J + 1) % I.length) : 0 > b && (J = (J - 1 + I.length) % I.length),
            c.css('transform', 'translateX(0)'),
            c.css('opacity', '0'),
            setTimeout(function () {
              c.attr('src', I[J])
              c.css('opacity', '1')
            }, 300),
            (b = H.find('.shopbylook-image-section-middle-dot')),
            b.removeClass('selected'),
            b.eq(J).addClass('selected')),
          setTimeout(function () {
            va = !1
          }, 300))
      }
    })
    c.declarative('sblCarouselToPrevious', 'click', function (a) {
      ha(a)
      a = H.find('.shopbylook-image-section-middle-dot')
      ia = a.index(a.filter('.selected'))
      ua(H)
      I && ((J = 0 < ia ? ia - 1 : I.length - 1), e.replacingSrcImage(I[J], H, J))
    })
    c.declarative('sblCarouselToNext', 'click', function (a) {
      ha(a)
      a = H.find('.shopbylook-image-section-middle-dot')
      ia = a.index(a.filter('.selected'))
      ua(H)
      I && ((J = ia < I.length - 1 ? ia + 1 : 0), e.replacingSrcImage(I[J], H, J))
    })
    c.declarative('sblThumbnailDetailPagination', 'click', function (a) {
      ha(a)
      J = (a = a.$target
        .closest('.shopbylook-image-section-middle-dot')
        .attr('id')
        .match(/shopbylook-image-section-middle-dot-(\d+)-/))
        ? parseInt(a[1], 10)
        : 0
      ua(H)
      I && e.replacingSrcImage(I[J], H, J)
    })
    c.declarative('sblItemLike', 'click', function (a) {
      var c = a.$currentTarget.closest('.shopbylook-btf-item-like')
      a = c.closest('.shopbylook-btf-item-box')
      var f = a.index(),
        g = e.getElementData(a)
      S++
      b.IS_MOBILE && a.addClass('sbl-item-liked')
      c.find('.sbl-item-like-button').removeClass(d.LIKE_BUTTON_FOCUS)
      for (c = 0; c < V.length; c++)
        if (V[c].asin === g.asin) {
          V.splice(c, 1)
          break
        }
      for (c = 0; c < R.length; c++)
        if (R[c] === d.DISLIKE_PREFIX + g.asin) {
          R.splice(c, 1)
          break
        }
      U(a, g)
      h(g, !0, d.GET_RECOMMENDATION_ADD_LIKE, f, k.LIKE)
    })
    c.declarative('sblItemDislike', 'click', function (a) {
      a = a.$currentTarget
        .closest('.shopbylook-btf-item-dislike')
        .closest('.shopbylook-btf-item-box')
      var c = e.getElementData(a)
      b.IS_MOBILE || S++
      for (var f = 0; f < O.length; f++)
        if (O[f].asin === c.asin) {
          O.splice(f, 1)
          break
        }
      for (f = 0; f < R.length; f++)
        if (R[f] === d.LIKE_PREFIX + c.asin) {
          R.splice(f, 1)
          break
        }
      ;-1 === R.indexOf(d.DISLIKE_PREFIX + c.asin) &&
        (R.push(d.DISLIKE_PREFIX + c.asin), V.push({ asin: c.asin, iteration: S }))
      b.IS_MOBILE && a.addClass('sbl-item-disliked')
      h(c, !1, d.GET_RECOMMENDATION_ADD_DISLIKE, a.index(), k.DISLIKE)
    })
    c.declarative('sblRefinementChange', 'click', function (a) {
      a = a.$currentTarget.find('.sbl-refinement-option-button')
      a[0].setAttribute('aria-pressed', 'false' === a[0].getAttribute('aria-pressed'))
      var b = na(a),
        b = b
          ? u
              .find(d.TOP_REFINEMENT_SECTION_ID)
              .find('.sbl-keyword-item-' + b.filterSelectorSuffix)
              .hasClass('sbl-top-refinement-element')
          : !1
      oa(a, !1, b, !1)
    })
    c.declarative('sblRefinementChangeV31', 'click', function (a) {
      a = a.$currentTarget.find('.sbl-refinement-option-button')
      var b = na(a),
        b = b
          ? u
              .find(d.TOP_REFINEMENT_SECTION_ID)
              .find('.sbl-keyword-item-' + b.filterSelectorSuffix)
              .hasClass('sbl-top-refinement-element')
          : !1
      oa(a, !1, b, !1)
    })
    c.declarative('sblShowMore', 'click', function (a) {
      q()
      da.removeClass(d.LIKE_BUTTON_FOCUS)
    })
    c.declarative('sblShadowPreview', 'click', function (b) {
      var c = b.$currentTarget.closest('.shopbylook-btf-item-box'),
        e = a('.shopbylook-btf-item-box'),
        f = e.length
      b = c.hasClass('hit-sbl-shadow-preview') || c.hasClass('hit-sbl-shadow-preview-loop')
      c = c.is(e.eq(f - 1)) || c.is(e.eq(f - 2))
      b && c && (q(), da.removeClass(d.LIKE_BUTTON_FOCUS))
    })
    c.declarative('sblTopRefinementChange', 'click', function (b) {
      var c = a(b.$currentTarget.closest('.sbl-refinement-element-container')).hasClass(
        'sbl-top-refinement-element',
      )
      if ((pa = b.$declarativeParent.parent().hasClass('sbl-keyword-item-basisPrice'))) Ta()
      else {
        var d = a(b.$declarativeParent.parent().attr('data-parent-item')).first()
        d[0].setAttribute('aria-pressed', 'false' === d[0].getAttribute('aria-pressed'))
        b.$declarativeParent.parent().hasClass('sbl-smart-tag')
          ? ((b = a(b.$declarativeParent.parent()).filter('.sbl-smart-tag')),
            e.closeSelectedRefinementItem(b.first()),
            g(k.CLEAR_FILTERS))
          : oa(d, !1, c, !0)
      }
    })
    c.declarative('sblTopRefinementChangeV31', 'click', function (c) {
      var d = a(c.$currentTarget.find('.sbl-refinement-element-container').first()).hasClass(
        'sbl-top-refinement-element',
      )
      if (
        (pa =
          '.sbl-refinement-basisPrice' === c.$currentTarget.find('input').attr('data-parent-item'))
      )
        Ta()
      else {
        var f = a(c.$currentTarget.find('input').attr('data-parent-item')).first()
        0 === f.length
          ? c.$currentTarget.find('.sbl-keyword-item-review')
            ? ((d = c.$currentTarget.find('.sbl-keyword-item-review')),
              (f = d.hasClass('a-button-selected')),
              Ca('@review:4', !0),
              y && W(d, f),
              g(P),
              M(c.$currentTarget, !f, !0))
            : c.$currentTarget.find('.sbl-smart-tag') &&
              (e.closeSelectedRefinementItem(c.$currentTarget, !b.IS_MOBILE, Y), g(k.CLEAR_FILTERS))
          : oa(f, !1, d, !0, !1)
        c.$currentTarget.find('input').focus()
      }
    })
    c.declarative('sblPrimeRefinementChange', 'click', function (a) {
      Sa(a.$currentTarget.find('#sbl-refinement-item-prime'))
    })
    c.declarative('sblPrimeRefinementChangeMobile', 'touchend', function (a) {
      Sa(a.$currentTarget.find('#sbl-refinement-item-prime'))
    })
    m.when('a-switch', 'jQuery').execute(function (a, b) {
      Xa = a.getSwitch(b('#sbl_top_refinement_prime_switch'))
    })
    c.declarative('sblViewRefinements', 'click', function () {
      Ba(!1)
      p.showSideSheet(y)
      A(k.OPEN_FILTERS)
      Ka()
    })
    c.declarative('mirai-discover-side-sheet:hide', 'click', function () {
      p.hideSideSheet()
      A(k.CLOSE_FILTERS)
      f.clearFilterSearchBar(0 < B.length)
    })
    c.declarative('sbl-filter-search-clear', 'click', function () {
      f.clearFilterSearchBar(0 < B.length)
    })
    c.declarative('mirai-discover-clear-filters', 'click', function () {
      f.clearFilters(y, W, Fa, Xa)
      Da(4)
      B = []
      P = k.REMOVE_FILTER
      pa = !1
      g(P)
    })
    c.declarative('sbl-refinement-see-more', 'click', function (a) {
      a.$currentTarget
        .closest('.sbl-refinements-bn-list')
        .find('.sbl-refinement-option-button')
        .removeClass('aok-hidden')
      a.$currentTarget.closest('.sbl-refinement-see-more-btn-container').remove()
    })
    c.declarative('sblGoToDetailPage', 'click', function (a) {
      E && (E.abort(), (E = null))
      a = a.$currentTarget
        .closest('.shopbylook-btf-image-container')
        .closest('.shopbylook-btf-item-box')
      var b = e.getElementData(a)
      A(k.GO_TO_DETAIL_PAGE, b, a.index())
    })
    c.declarative('sblGoToDetailPageVariations', 'click', function () {
      E && (E.abort(), (E = null))
      A(k.GO_TO_DETAIL_PAGE_VARIATIONS)
    })
    Va()
    ja()
    ka()
  })
})
/* ******** */
;(function (l) {
  var x = window.AmazonUIPageJS || window.P,
    t = x._namespace || x.attributeErrors,
    m = t ? t('DetailPageMiraiAssets@shoppableScenes', 'DetailPageMiraiAssets') : x
  m.guardFatal
    ? m.guardFatal(l)(m, window)
    : m.execute(function () {
        l(m, window)
      })
})(function (l, x, t) {
  function m(a) {
    if (Array.isArray(a)) {
      for (var b = 0, c = Array(a.length); b < a.length; b++) c[b] = a[b]
      return c
    }
    return Array.from(a)
  }
  function m(a) {
    if (Array.isArray(a)) {
      for (var b = 0, c = Array(a.length); b < a.length; b++) c[b] = a[b]
      return c
    }
    return Array.from(a)
  }
  function m(a) {
    if (Array.isArray(a)) {
      for (var b = 0, c = Array(a.length); b < a.length; b++) c[b] = a[b]
      return c
    }
    return Array.from(a)
  }
  function m(a) {
    if (Array.isArray(a)) {
      for (var b = 0, c = Array(a.length); b < a.length; b++) c[b] = a[b]
      return c
    }
    return Array.from(a)
  }
  function m(a) {
    if (Array.isArray(a)) {
      for (var b = 0, c = Array(a.length); b < a.length; b++) c[b] = a[b]
      return c
    }
    return Array.from(a)
  }
  function m(a) {
    if (Array.isArray(a)) {
      for (var b = 0, c = Array(a.length); b < a.length; b++) c[b] = a[b]
      return c
    }
    return Array.from(a)
  }
  function m(a) {
    if (Array.isArray(a)) {
      for (var b = 0, c = Array(a.length); b < a.length; b++) c[b] = a[b]
      return c
    }
    return Array.from(a)
  }
  function m(a) {
    if (Array.isArray(a)) {
      for (var b = 0, c = Array(a.length); b < a.length; b++) c[b] = a[b]
      return c
    }
    return Array.from(a)
  }
  function m(a) {
    if (Array.isArray(a)) {
      for (var b = 0, c = Array(a.length); b < a.length; b++) c[b] = a[b]
      return c
    }
    return Array.from(a)
  }
  l.when('jQuery', 'mirai-scene-polyfill', 'mirai-scene-utils', 'atf').register(
    'mirai-scenes-action-recorder',
    function (a, b, c) {
      function d(d, c, f) {
        a.ajax({
          type: 'POST',
          url: '/discover/rooms/dpx/recordAction',
          data: JSON.stringify(b.object.assign({ actionType: d, actionSource: c }, f)),
          contentType: 'application/json; charset\x3dUTF-8',
        })
      }
      return {
        recordTagClick: function (a, b, f, e, g) {
          a = c.parseTagId(a)
          'SOFTLINES' === g
            ? d('GET_SIMILAR_ITEMS', 'IMAGE_BLOCK_SOFTLINES_SCENE_PRODUCT_TAG', {
                tagId: a,
                scenePhysicalId: b,
                anchorAsin: f,
                position: e,
              })
            : 'IMAGE_GALLERY' === g
              ? d('GET_SIMILAR_ITEMS', 'IMAGE_GALLERY_SCENE_PRODUCT_TAG', {
                  tagId: a,
                  scenePhysicalId: b,
                  anchorAsin: f,
                  position: e,
                })
              : d('GET_SIMILAR_ITEMS', 'IMAGE_BLOCK_SCENE_PRODUCT_TAG', {
                  tagId: a,
                  scenePhysicalId: b,
                  anchorAsin: f,
                  position: e,
                })
        },
        recordTagClickSideSheet: function (a, b, f) {
          b = c.parseTagId(b)
          d('GET_SIMILAR_ITEMS', 'IMAGE_BLOCK_SHEET_SCENE_PRODUCT_TAG', {
            anchorAsin: a,
            tagId: b,
            scenePhysicalId: f,
          })
        },
        recordTabClick: function (a, b, f) {
          a = c.parseTagId(a)
          f
            ? d('GET_SIMILAR_ITEMS', 'IMAGE_GALLERY_SCENE_PRODUCT_TAB', {
                tagId: a,
                scenePhysicalId: b,
              })
            : d('GET_SIMILAR_ITEMS', 'IMAGE_BLOCK_SCENE_PRODUCT_TAB', {
                tagId: a,
                scenePhysicalId: b,
              })
        },
        recordViewProductsButtonClick: function (a, b, f, e, g) {
          a = c.parseTagId(a)
          'SOFTLINES' === g
            ? d('GET_SIMILAR_ITEMS', 'IMAGE_BLOCK_SOFTLINES_VIEW_PRODUCTS_BUTTON', {
                tagId: a,
                scenePhysicalId: b,
                anchorAsin: f,
                position: e,
              })
            : 'IMAGE_GALLERY' === g
              ? d('GET_SIMILAR_ITEMS', 'IMAGE_GALLERY_VIEW_PRODUCTS_BUTTON', {
                  tagId: a,
                  scenePhysicalId: b,
                  anchorAsin: f,
                  position: e,
                })
              : d('GET_SIMILAR_ITEMS', 'IMAGE_BLOCK_VIEW_PRODUCTS_BUTTON', {
                  tagId: a,
                  scenePhysicalId: b,
                  anchorAsin: f,
                  position: e,
                })
        },
        recordSheetOpen: function (a, b, f, e) {
          var g = g !== t ? c.parseTagId(b) : ''
          'SOFTLINES' === e
            ? d('SHEET_OPEN', 'IMAGE_BLOCK_SOFTLINES_SHEET', {
                anchorAsin: a,
                tagId: g,
                scenePhysicalId: f,
              })
            : 'IMAGE_GALLERY' === e
              ? d('SHEET_OPEN', 'IMAGE_GALLERY_SHEET', {
                  anchorAsin: a,
                  tagId: g,
                  scenePhysicalId: f,
                })
              : d('SHEET_OPEN', 'IMAGE_BLOCK_SHEET', {
                  anchorAsin: a,
                  tagId: g,
                  scenePhysicalId: f,
                })
        },
        recordSheetClose: function (a, b, c, e, g, n) {
          'SOFTLINES' === n
            ? d('SHEET_CLOSE', 'IMAGE_BLOCK_SOFTLINES_SHEET', {
                anchorAsin: a,
                tagId: b,
                scenePhysicalId: c,
                currentViewAsins: [].concat(m(e)),
                browseNodeList: [].concat(m(g)),
              })
            : 'IMAGE_GALLERY' === n
              ? d('SHEET_CLOSE', 'IMAGE_GALLERY_SHEET', {
                  anchorAsin: a,
                  tagId: b,
                  scenePhysicalId: c,
                  currentViewAsins: [].concat(m(e)),
                  browseNodeList: [].concat(m(g)),
                })
              : d('SHEET_CLOSE', 'IMAGE_BLOCK_SHEET', {
                  anchorAsin: a,
                  tagId: b,
                  scenePhysicalId: c,
                  currentViewAsins: [].concat(m(e)),
                  browseNodeList: [].concat(m(g)),
                })
        },
        recordCollectionBrowseNextButton: function (a, b, c, e, g, n) {
          'SOFTLINES' === n
            ? d(
                'GET_COLLECTION_RIGHT',
                'IMAGE_BLOCK_SOFTLINES_COLLECTIONS_CAROUSEL_NEXT_PAGE_BUTTON',
                { anchorAsin: a, asin: b, tagId: c, scenePhysicalId: e, browseNode: g },
              )
            : 'IMAGE_GALLERY' === n
              ? d('GET_COLLECTION_RIGHT', 'IMAGE_GALLERY_COLLECTIONS_CAROUSEL_NEXT_PAGE_BUTTON', {
                  anchorAsin: a,
                  asin: b,
                  tagId: c,
                  scenePhysicalId: e,
                  browseNode: g,
                })
              : d('GET_COLLECTION_RIGHT', 'IMAGE_BLOCK_COLLECTIONS_CAROUSEL_NEXT_PAGE_BUTTON', {
                  anchorAsin: a,
                  asin: b,
                  tagId: c,
                  scenePhysicalId: e,
                  browseNode: g,
                })
        },
        recordCollectionBrowsePreviousButton: function (a, b, c, e, g, n) {
          'SOFTLINES' === n
            ? d(
                'GET_COLLECTION_LEFT',
                'IMAGE_BLOCK_SOFTLINES_COLLECTIONS_CAROUSEL_PREVIOUS_PAGE_BUTTON',
                { anchorAsin: a, asin: b, tagId: c, scenePhysicalId: e, browseNode: g },
              )
            : 'IMAGE_GALLERY' === n
              ? d(
                  'GET_COLLECTION_LEFT',
                  'IMAGE_GALLERY_COLLECTIONS_CAROUSEL_PREVIOUS_PAGE_BUTTON',
                  { anchorAsin: a, asin: b, tagId: c, scenePhysicalId: e, browseNode: g },
                )
              : d('GET_COLLECTION_LEFT', 'IMAGE_BLOCK_COLLECTIONS_CAROUSEL_PREVIOUS_PAGE_BUTTON', {
                  anchorAsin: a,
                  asin: b,
                  tagId: c,
                  scenePhysicalId: e,
                  browseNode: g,
                })
        },
        recordCollectionAddToCartButton: function (a, b, c, e, g, n) {
          'SOFTLINES' === n
            ? d('ADD_TO_CART', 'IMAGE_BLOCK_SOFTLINES_COLLECTIONS_ADD_TO_CART_BUTTON', {
                anchorAsin: a,
                tagId: b,
                scenePhysicalId: c,
                browseNode: e,
                asin: g,
              })
            : 'IMAGE_GALLERY' === n
              ? d('ADD_TO_CART', 'IMAGE_GALLERY_COLLECTIONS_ADD_TO_CART_BUTTON', {
                  anchorAsin: a,
                  tagId: b,
                  scenePhysicalId: c,
                  browseNode: e,
                  asin: g,
                })
              : d('ADD_TO_CART', 'IMAGE_BLOCK_COLLECTIONS_ADD_TO_CART_BUTTON', {
                  anchorAsin: a,
                  tagId: b,
                  scenePhysicalId: c,
                  browseNode: e,
                  asin: g,
                })
        },
        recordCollectionV2BrowseNextButton: function (a, b, c, e, g, n) {
          'SOFTLINES' === n
            ? d(
                'GET_COLLECTION_RIGHT',
                'IMAGE_BLOCK_SOFTLINES_COLLECTIONS_CAROUSEL_NEXT_PAGE_BUTTON',
                { anchorAsin: a, asin: b, tagId: c, scenePhysicalId: e, browseNode: g },
              )
            : d('GET_COLLECTION_V2_RIGHT', 'IMAGE_BLOCK_COLLECTIONS_V2_CAROUSEL_NEXT_PAGE_BUTTON', {
                anchorAsin: a,
                asin: b,
                tagId: c,
                scenePhysicalId: e,
                browseNode: g,
              })
        },
        recordCollectionV2BrowsePreviousButton: function (a, b, c, e, g, n) {
          'SOFTLINES' === n
            ? d(
                'GET_COLLECTION_LEFT',
                'IMAGE_BLOCK_SOFTLINES_COLLECTIONS_CAROUSEL_PREVIOUS_PAGE_BUTTON',
                { anchorAsin: a, asin: b, tagId: c, scenePhysicalId: e, browseNode: g },
              )
            : d(
                'GET_COLLECTION_V2_LEFT',
                'IMAGE_BLOCK_COLLECTIONS_V2_CAROUSEL_PREVIOUS_PAGE_BUTTON',
                { anchorAsin: a, asin: b, tagId: c, scenePhysicalId: e, browseNode: g },
              )
        },
        recordCollectionV2AddToCartButton: function (a, b, c, e, g, n) {
          'SOFTLINES' === n
            ? d('ADD_TO_CART', 'IMAGE_BLOCK_SOFTLINES_COLLECTIONS_ADD_TO_CART_BUTTON', {
                anchorAsin: a,
                tagId: b,
                scenePhysicalId: c,
                browseNode: e,
                asin: g,
              })
            : d('ADD_TO_CART_COLLECTION_V2', 'IMAGE_BLOCK_COLLECTIONS_V2_ADD_TO_CART_BUTTON', {
                anchorAsin: a,
                tagId: b,
                scenePhysicalId: c,
                browseNode: e,
                asin: g,
              })
        },
      }
    },
  )
  ;('use strict')
  l.when('jQuery', 'mirai-scene-utils', 'atf').register(
    'mirai-scenes-add-to-cart-dp',
    function (a, b) {
      var c = function (a) {
        ;-1 !== a &&
          (l.when('nav.setCartCount').execute(function (b) {
            b(a)
          }),
          l.when('mash').execute(function (b) {
            b.cart && b.cart.didUpdate && b.cart.didUpdate({ newCartQuantity: a })
          }))
      }
      return {
        addToCart: function (b, h) {
          b = b.data
          return a.ajax({
            type: 'POST',
            url: '/discover/rooms/addToCart?ref\x3d' + h,
            data: JSON.stringify({
              asin: b.asin,
              offerId: b.offerListingId,
              quantity: 1,
              price: b.price,
              currencyCode: b.currencyCode,
            }),
            contentType: 'application/json',
            dataType: 'html',
            success: function (b) {
              c(parseInt(b))
            },
          })
        },
        showSpinnerThenMessage: function (a, c) {
          var k = a.$declarativeParent.closest('.add-to-cart-button-container'),
            f = k.find('.add-to-cart-spinner')
          k.find('.add-to-cart-button').addClass(b.HIDDEN_CLASS)
          f.removeClass(b.HIDDEN_CLASS)
          c.always(function () {
            f.addClass(b.HIDDEN_CLASS)
          })
            .done(function () {
              k.find('.add-success-message').addClass('add-to-cart-success')
            })
            .fail(function () {
              k.find('.add-to-cart-button').removeClass(b.HIDDEN_CLASS)
            })
        },
      }
    },
  )
  ;('use strict')
  l.when('atf').register('mirai-event-bus', function () {
    function a(b) {
      var a = []
      return {
        add: function (b) {
          b && a.push(b)
          return {
            remove: function () {
              var c = a.indexOf(b)
              if (0 <= c) return a.splice(c, 1)
            },
          }
        },
        notify: function (h) {
          a.forEach(function (a) {
            try {
              a(h)
            } catch (d) {
              l.log('Handler for ' + b + ' failed: ' + d, 'FATAL', 'mirai-event-bus')
            }
          })
        },
      }
    }
    function b() {
      for (var b = {}, d = arguments.length, h = Array(d), k = 0; k < d; k++) h[k] = arguments[k]
      h.forEach(function (d) {
        return (b[d] = a(d))
      })
      return {
        on: function (a, d) {
          if (!b[a])
            throw Error(
              'Cannot assign handler to nonexistent event ' +
                a +
                '. Please make sure the event name is spelled correctly and registered by the calling instance.',
            )
          if (!d) throw Error('Cannot assign empty handler to event ' + a)
          return b[a].add(d)
        },
        trigger: function (a, d) {
          if (!b[a])
            throw Error(
              'Cannot trigger nonexistent event ' +
                a +
                '. Please make sure the event name is spelled correctly and registered by the calling instance.',
            )
          b[a].notify(d)
        },
      }
    }
    return function d() {
      if (!(this instanceof d)) throw new TypeError('Cannot call a class as a function')
      var a = b.apply(t, arguments)
      this.on = a.on
      this.trigger = a.trigger
    }
  })
  ;('use strict')
  l.when('atf').register('mirai-scene-polyfill', function () {
    return {
      object: {
        assign: function (a) {
          for (var b = arguments.length, c = Array(1 < b ? b - 1 : 0), d = 1; d < b; d++)
            c[d - 1] = arguments[d]
          var b = Object(a),
            d = !0,
            h = !1,
            k = t
          try {
            for (var f = c[Symbol.iterator](), e; !(d = (e = f.next()).done); d = !0) {
              var g = e.value
              if (g !== t && null !== g) for (var n in g) g.hasOwnProperty(n) && (b[n] = g[n])
            }
          } catch (v) {
            ;(h = !0), (k = v)
          } finally {
            try {
              !d && f.return && f.return()
            } finally {
              if (h) throw k
            }
          }
          return b
        },
        entries: function (a) {
          return Object.keys(a).map(function (b) {
            return [b, a[b]]
          })
        },
        values: function (a) {
          return Object.keys(a).map(function (b) {
            return a[b]
          })
        },
      },
      array: {
        includes: function (a, b, c) {
          return c !== t && null !== c
            ? c >= a.length
              ? !1
              : 0 > c && 0 > a.length + c
                ? -1 !== a.indexOf(b, 0)
                : -1 !== a.indexOf(b, c)
            : -1 !== a.indexOf(b)
        },
      },
    }
  })
  ;('use strict')
  l.when('atf').register('mirai-scene-scroll-listener', function () {
    function a(a) {
      return Array.from(a.values(), function (a) {
        return a.getBoundingClientRect()
      })
    }
    return function (b, c) {
      var d = this
      this.handler = b
      this.options = c
      var h = function () {
          a(d.columns).some(function (a) {
            return x.innerHeight + d.options.scrollOffset >= a.bottom
          }) && d.handler()
        },
        k = function () {
          clearTimeout(d.resizeTimeout)
          d.resizeTimeout = setTimeout(function () {
            h()
          }, 100)
        }
      this.start = function () {
        var a = this.handler,
          b = this.options,
          c = []
        a || c.push('handler required: ' + a)
        b || c.push('options required: ' + b)
        b.columnSelector || c.push('columnSelector option required: ' + b.columnSelector)
        b.scrollOffset || c.push('scrollOffset option required: ' + b.scrollOffset)
        if (c.length) throw Error('[scroll listener error] ' + c.join('. '))
        d.columns = document.querySelectorAll(d.options.columnSelector)
        d.scrollableViewport = d.options.scrollableViewportSelector
          ? document.querySelector(d.options.scrollableViewportSelector)
          : x
        d.scrollableViewport.addEventListener('scroll', k)
      }
      this.stop = function () {
        d.scrollableViewport.removeEventListener('scroll', k)
      }
      this.start()
    }
  })
  ;('use strict')
  var C = (function () {
    return function (a, b) {
      if (Array.isArray(a)) return a
      if (Symbol.iterator in Object(a)) {
        var c = [],
          d = !0,
          h = !1,
          k = t
        try {
          for (
            var f = a[Symbol.iterator](), e;
            !(d = (e = f.next()).done) && (c.push(e.value), !b || c.length !== b);
            d = !0
          );
        } catch (g) {
          ;(h = !0), (k = g)
        } finally {
          try {
            if (!d && f['return']) f['return']()
          } finally {
            if (h) throw k
          }
        }
        return c
      }
      throw new TypeError('Invalid attempt to destructure non-iterable instance')
    }
  })()
  l.when('mirai-scene-weblab-context', 'atf').register('mirai-scene-utils', function (a) {
    return {
      steppedIndex: function (a, c) {
        return Math.ceil((a + 1) / c) * c - 1
      },
      indicesOfMatches: function (a, c) {
        return a
          .map(function (a, b) {
            return a === c ? b : ''
          })
          .filter(String)
      },
      urlResolver: function (a) {
        var c = function (a) {
          return Object.entries(a)
            .map(function (a) {
              a = C(a, 2)
              var b = a[1]
              return encodeURIComponent(a[0]) + '\x3d' + encodeURIComponent(b)
            })
            .join('\x26')
        }
        return function (d, h) {
          return a + '/' + d + (h ? '?' + c(h) : '')
        }
      },
      replacePlus: function (a) {
        return a.replace(/\+/g, '\\+')
      },
      parseTagId: function (a) {
        return a.split('/').pop()
      },
      parseScenePhysicalIdFromTagId: function (a) {
        return a.split('_').shift()
      },
      isScenesEnabledDp: function (a) {
        return (
          0 !== a('#image-block-row .scenes-view-products-background-ib').length ||
          0 !== a('#image-block-row .scenes-view-products-background').length
        )
      },
      isDotsExperiment: function (a) {
        return -1 !== a('.scenes-product-tag')[0].src.indexOf('dot')
      },
      isSeeSimilarExperiment: function () {
        return a.isT1('MIRAI_SCENES_DP_IMAGE_BLOCK_MOBILE_V2_SEE_SIMILAR_EXPERIMENT_393991')
      },
      getHeartIcon: function (a) {
        return (
          a('#image-block-row').find('#heart-background') ||
          a('#image-block-row').find('.list-heart-sprite')
        )
      },
      getAnchorAsin: function (a) {
        return a('#imageBlock_feature_div').length
          ? a('#imageBlock_feature_div')[0].dataset.csaCAsin
          : null
      },
      isShoppableImageLoaded: function (a) {
        return (
          0 <
          a('#image-block .scenes-tag-container').filter(function () {
            return 0 !== a(this).closest('.image-wrapper').find('img.carousel-alt-img').length
          }).length
        )
      },
      isImageDotsOnViewProductButtonCXEnabled: function (a) {
        return (
          0 < a('#image-block-row .scenes-view-products-background-ib').length &&
          0 < a('.scenes-view-products-background-ib.with-number').length
        )
      },
      getCurrentSelectedShoppableSceneImage: function (a) {
        return a('#image-block-pagination-dots .a-dots li.a-selected').index() + 1
      },
      isCarouselLoaderDivExist: function (a) {
        return 0 < a('#image-block .image-wrapper .carousel-loader').length
      },
      SCENES_VIEW_PRODUCTS_BUTTON: '#image-block-row .scenes-view-products-background',
      SCENES_VIEW_PRODUCTS_BUTTON_IB: '#image-block-row .scenes-view-products-background-ib',
      HIDDEN_CLASS: 'aok-hidden',
    }
  })
  ;('use strict')
  l.when('atf').register('mirai-scene-url-parser', function () {
    return {
      getPageAsin: function () {
        var a = x.location.href.match(/\/dp\/[0-9]{9}[0-9X]|[A-Z][A-Z0-9]{9}/)
        return a ? a[0] : null
      },
    }
  })
  ;('use strict')
  var E =
    'function' === typeof Symbol && 'symbol' === typeof Symbol.iterator
      ? function (a) {
          return typeof a
        }
      : function (a) {
          return a &&
            'function' === typeof Symbol &&
            a.constructor === Symbol &&
            a !== Symbol.prototype
            ? 'symbol'
            : typeof a
        }
  l.when('mirai-scene-polyfill', 'atf').register('mirai-scene-weblab-context', function (a) {
    var b = {}
    return {
      setWeblabsFromMap: function (c) {
        c && 'object' === ('undefined' === typeof c ? 'undefined' : E(c)) && a.object.assign(b, c)
      },
      isT1: function (a) {
        return 'T1' === b[a]
      },
    }
  })
  ;('use strict')
  l.when(
    'A',
    'jQuery',
    'mirai-multi-scene-view',
    'mirai-side-sheet-view',
    'mirai-shoppable-scene-immersive-view',
    'atf',
  ).execute('MiraiShoppableScenes', function (a, b, c, d, h) {
    0 < b('.mirai-scene-image-block-template').length &&
      (new d({ $sideSheetElement: b('#mirai-side-sheet') }),
      new c({ $root: b('#scene-details-content') }))
    0 < b('#ivShoppableSceneHeading').length && new h()
  })
  ;('use strict')
  l.when(
    'A',
    'jQuery',
    'mirai-scene-feed-select-view-model',
    'mirai-scenes-action-recorder',
    'mirai-scene-context-model',
    'mirai-scene-utils',
    'atf',
  ).register('mirai-scene-tag-view', function (a, b, c, d, h, k) {
    function f(b, c) {
      a.hide(c)
      a.show(b)
    }
    var e = h.createImageBlockContext(),
      g = k.getAnchorAsin(b)
    return function (b) {
      var h = b.$tagElements,
        p = b.scenePhysicalId,
        k = new c({ tagIds: b.tagIds }),
        z = h.not('.highlighted'),
        r = h.filter('.highlighted')
      k.eventBus.on(k.events.INDEX_CHANGE, function (b) {
        var c = b.selectedIndices
        b.selectedPhysicalId === p &&
          (f(z, r),
          c.length
            ? (c.forEach(function (b) {
                var c = z.eq(b)
                b = r.eq(b)
                a.hide(c)
                a.show(b)
                b.removeClass('mirai-scene-dot-pulsate')
                b.width()
                b.addClass('mirai-scene-dot-pulsate')
              }),
              a.trigger('mirai:index:change', { selectedIndices: c, scenePhysicalId: p }))
            : a.trigger('mirai:no-products-active', { scenePhysicalId: p }))
      })
      a.on('scenes-show-details-tags-ib-' + p, function (a) {
        a = a.data
        d.recordTagClick(a.tagId, p, g, null, e.requestSource)
        k.selectCommand(p, a.tagId)
      })
      a.on('scenes-show-details-view-products-ib-' + p, function (a) {
        d.recordViewProductsButtonClick(a.data.tagId, p, g, null, e.requestSource)
        k.selectCommand(p, null)
      })
      a.on('scenes-show-details-tags-ss-' + p, function (a) {
        a = a.data
        d.recordTagClickSideSheet(g, a.tagId, p)
        k.selectCommand(p, a.tagId)
      })
      a.on('scenes-scroll-to-carousel-ss-' + p, function (a) {
        d.recordTagClickSideSheet(g, a.data.tagId, p)
      })
    }
  })
  ;('use strict')
  ;('use strict')
  l.when('A', 'jQuery', 'atf').register('mirai-scene-feed-container-view', function (a, b) {
    var c = null,
      d = null
    return function (h) {
      function k() {
        a.on('mirai:multi-scene-view:physical-id:change', function (a) {
          d = a.physicalId
        })
      }
      function f() {
        a.declarative('like-feed-item', 'click', function (b) {
          a.trigger('like-feed-item-' + d, b)
        })
        a.declarative('dislike-feed-item', 'click', function (b) {
          a.trigger('dislike-feed-item-' + d, b)
        })
        a.declarative('show-discover-feed', 'click', function (b) {
          a.trigger('show-discover-feed-' + d, b)
        })
        a.declarative('scenes-show-details', 'click', function (b) {
          a.trigger('scenes-show-details-' + d, b)
        })
        a.declarative('scenes-show-details-tags-ib', 'click', function (b) {
          a.trigger('scenes-show-details-tags-ib-' + d, b)
        })
        a.declarative('scenes-show-details-view-products-ib', 'click', function (b) {
          a.trigger('scenes-show-details-view-products-ib-' + d, b)
        })
        a.declarative('scenes-show-details-tags-ss', 'click', function (b) {
          a.trigger('scenes-show-details-tags-ss-' + d, b)
        })
        a.declarative('product-feed-to-detail-page-navigation', 'click', function (b) {
          a.trigger('product-feed-to-detail-page-navigation-' + d, b)
        })
        a.declarative('see-more-items', 'click', function (b) {
          a.trigger('see-more-items-' + d, b)
        })
        a.declarative('mirai:scenes:carousel-product-card:add-to-cart', 'click', function (b) {
          a.trigger('mirai:scenes:carousel-product-card:add-to-cart-' + d, b)
        })
        e.scroll(
          (function () {
            var a = b('.back-to-top-icon')
            return function () {
              150 <= e.scrollTop() ? a.addClass('visible') : a.removeClass('visible')
            }
          })(),
        )
        a.declarative('go-back-to-top', 'click', function () {
          e.animate({ scrollTop: 0 }, '300')
        })
      }
      var e = h.$scrollableViewport
      c || (f(), k(), (c = this))
    }
  })
  ;('use strict')
  E =
    'function' === typeof Symbol && 'symbol' === typeof Symbol.iterator
      ? function (a) {
          return typeof a
        }
      : function (a) {
          return a &&
            'function' === typeof Symbol &&
            a.constructor === Symbol &&
            a !== Symbol.prototype
            ? 'symbol'
            : typeof a
        }
  l.when(
    'A',
    'jQuery',
    'a-carousel-constants',
    'a-carousel-framework',
    'mirai-scene-utils',
    'mirai-scenes-action-recorder',
    'mirai-scene-context-model',
    'mirai-scene-scroll-listener',
    'mirai-scene-flush-feed-display-strategy',
    'mirai-scene-collection-view-model',
    'a-carousel-ajax-standard',
    'mirai-scenes-add-to-cart-dp',
    'atf',
  ).register('mirai-scene-collection-view', function (a, b, c, d, h, k, f, e, g, n, v, p) {
    function u(d) {
      var e = d.scenePhysicalId,
        q = d.$feedRootElement,
        w = d.$scrollableViewport,
        A = d.$loadingSpinnerElement,
        B = d.$errorElement,
        I = d.$belowFeedElement,
        y = new n({ scenePhysicalId: e, tagIds: d.tagIds }),
        F = f.createImageBlockContext(),
        m = h.getAnchorAsin(b),
        G = {}
      y.eventBus.on(y.events.COLLECTIONS_PREFETCH, function () {
        a.hide(q)
        a.hide(B)
        a.hide(I)
        a.show(A)
      })
      y.eventBus.on(y.events.COLLECTIONS_CHANGE, function (c) {
        var d = c.scenePhysicalId,
          e = c.tagId,
          f = c.isActiveCollection
        g.replaceAll(q, b(c.res.html))
        a.show(A)
        a.hide(B)
        a.show(q)
        a.hide(A)
        b('.room-products-scroller-wrapper').empty()
        H(d)
        x()
        J(d, e, f)
      })
      y.eventBus.on(y.events.COLLECTIONS_ERROR, function () {
        a.hide(q)
        a.hide(A)
        a.show(B)
      })
      a.on('product-feed-to-detail-page-navigation-' + e, function (a) {
        a = a.data
        y.navigateToDetailPageCommand(a.asin, a.browseNode)
      })
      var J = function (a, c, d) {
          d
            ? (function () {
                c = h.parseTagId(c)
                var a = b('.room-collection-' + h.replacePlus(c))
                w.animate({ scrollTop: a.position().top }, 500, function () {
                  t(a)
                })
              })()
            : w.scrollTop(0)
        },
        t = function (c) {
          var d = c.closest('.room-feed-and-refinements')
          b('.mirai-scene-carousel-color-flicker').removeClass('mirai-scene-carousel-color-flicker')
          d.addClass('mirai-scene-carousel-color-flicker')
          a.delay(function () {
            d.removeClass('mirai-scene-carousel-color-flicker')
          }, 3250)
        },
        H = function (a) {
          l.when('a-carousel-framework').execute(function (a) {
            l.when('cf').execute(function () {
              a.createAll()
              a.initializeAll()
              var c = b('.collections-carousel-container')
              c.find('.a-carousel-card').css('height', '190px')
              c.each(function () {
                var b = a.getCarousel(this),
                  c = b.getAttr('name'),
                  d = b.dom.$carousel.closest('.room-feed-and-refinements').data('tagId'),
                  e = h.parseScenePhysicalIdFromTagId(d)
                K(b, c, d, e, a)
              })
            })
          })
        },
        x = function () {
          w.scroll(function () {
            l.when('a-carousel-framework').execute(function (a) {
              l.when('cf').execute(function () {
                a.createAll()
                a.initializeAll()
              })
            })
          })
        },
        K = function (b, c, d, e, A) {
          var g = 'a:carousel:' + c + ':change:pageNumber',
            f = 'a:carousel:' + c + ':repaint',
            r = b.dom.$carousel
              .closest('.room-feed-items-container-collection')
              .find('.pagination-slider')
          A.onInit(c, function (b) {
            v.want(b, 1, 5)
            D(b)
            a.on(g, function (a) {
              D(a.carousel)
            })
          })
          a.on(g, function (a) {
            if (a.carousel.__id === b.__id) {
              var c = (function () {
                D(a.carousel)
                var c = a.newValue,
                  A = a.oldValue,
                  g = b.dom.$carousel.closest('.room-feed-and-refinements').data().tagId
                if (G[g] === c) return { v: void 0 }
                var f = b.dom.$carousel.children(),
                  p = []
                f.each(function () {
                  this.childNodes[0] && p.push(this.childNodes[0].dataset.asin)
                })
                if (c !== A) {
                  C(c, r)
                  var f = f[0].childNodes[0].dataset.browseNode,
                    B = p[c - 1].split()[0]
                  G[g] = c
                  c > A
                    ? (y.storeCurrentViewAsins([B]),
                      k.recordCollectionBrowseNextButton(m, B, d, e, f, F.requestSource))
                    : k.recordCollectionBrowsePreviousButton(m, B, d, e, f, F.requestSource)
                }
              })()
              if ('object' === ('undefined' === typeof c ? 'undefined' : E(c))) return c.v
            }
          })
          a.on(f, function (a) {
            a.carousel.__id === b.__id && D(a.carousel)
          })
        },
        D = function (a) {
          var b = a.getAttr(c.PAGE_NUMBER),
            d = a.getAttr(c.TOTAL_PAGES),
            e = a.dom.$container.find('.a-carousel-goto-prevpage')
          a = a.dom.$container.find('.a-carousel-goto-nextpage')
          e.css('visibility', 1 === b ? 'hidden' : 'visible')
          a.css('visibility', b >= d ? 'hidden' : 'visible')
        },
        C = function (a, b) {
          var c = b.width()
          b.css('left', c * (a - 1))
        }
      a.on('mirai:scenes:carousel-product-card:add-to-cart-' + e, function (a) {
        var b = a.$declarativeParent.closest('.room-feed-and-refinements').data().tagId,
          c = h.parseScenePhysicalIdFromTagId(b),
          d = a.$declarativeParent.closest('.mirai-side-sheet-content').length,
          e = a.$declarativeParent.closest('.mirai-scene-details-iv-' + c).length
        d &&
          y.scenePhysicalId === c &&
          ((d = p.addToCart(a, 'sbl_dr_dp_ib_col_atc')),
          p.showSpinnerThenMessage(a, d),
          k.recordCollectionAddToCartButton(
            m,
            b,
            c,
            a.data.browseNode,
            a.data.asin,
            F.requestSource,
          ))
        e && ((b = p.addToCart(a, 'sbl_dr_dp_iv_col_atc')), p.showSpinnerThenMessage(a, b))
      })
      new MutationObserver(function (a, b) {
        '' !== q.html() && y.saveViewCommand(q.html())
      }).observe(q[0], {
        subtree: !0,
        childList: !0,
        attributes: !0,
        attributeFilter: ['style', 'class'],
      })
      u.initializeCarousels = H
    }
    return u
  })
  ;('use strict')
  l.when(
    'jQuery',
    'A',
    'mirai-scene-side-sheet-view-model',
    'mirai-scenes-action-recorder',
    'atf',
  ).register('mirai-side-sheet-view', function (a, b, c, d) {
    return function (d) {
      var k = this,
        f = d.$sideSheetElement,
        e = a('body'),
        g = a('#mirai-side-sheet-background'),
        n = f.css('right'),
        v = new c()
      e.append(f)
      this.animateSideSheetOpen = function () {
        f.animate({ right: 0 }, 500)
      }
      this.animateSideSheetClosed = function () {
        f.animate({ right: n }, 500)
      }
      v.eventBus.on(v.events.SIDE_SHEET_SHOW, function () {
        e.addClass('lock-background')
        b.show(g)
        k.animateSideSheetOpen()
      })
      b.declarative('mirai-side-sheet:hide', 'click', function () {
        k.animateSideSheetClosed()
        b.hide(g)
        e.removeClass('lock-background')
        v.setSideSheetVisible(!1)
        v.recordSideSheetClose()
      })
    }
  })
  ;('use strict')
  l.when(
    'A',
    'jQuery',
    'mirai-scene-utils',
    'mirai-scene-tag-view',
    'mirai-scene-collection-view',
    'mirai-multi-scene-view-model',
    'mirai-scene-feed-container-view',
    'atf',
  ).register('mirai-multi-scene-view', function (a, b, c, d, h, k, f) {
    var e = function (a) {
        return c.replacePlus('.mirai-scene-details-' + a)
      },
      g = b('#room-detail-page-container'),
      n = b('#scene-details-content'),
      v = function (a, b, c) {
        return new d({ $tagElements: a, scenePhysicalId: b, tagIds: c })
      },
      p = function (a, b, c) {
        return new h({
          scenePhysicalId: b,
          tagIds: c,
          $feedRootElement: a.find('.room-feed-section'),
          $scrollableViewport: n,
          $loadingSpinnerElement: a.find('.room-load-more-section'),
          $errorElement: a.find('.room-feed-no-results-container'),
          $belowFeedElement: a.find('.room-below-feed-section'),
        })
      },
      u = function (a) {
        return b('.' + a)
          .clone()
          .removeClass(a + ' aok-hidden')
      },
      z = function (a) {
        return u('mirai-scene-image-template').attr('src', a)
      },
      r = function (c) {
        return c
          .map(function (b) {
            var c = u('mirai-scene-tag-template')
            c.css({ top: 100 * b.top + '%', left: 100 * b.left + '%' })
            a.declarative.create(c, 'scenes-show-details-tags-ss', { tagId: b.link })
            return c
          })
          .reduce(b.merge)
      },
      q = function (a) {
        b('.room-detail-section').addClass('aok-hidden')
        b(e(a)).removeClass('aok-hidden')
      },
      w = function (c) {
        var d = (function (b) {
          return a.debounce(function () {
            c.css({ 'max-height': x.innerHeight * b })
          }, 100)
        })(0.35)
        b(x).bind('resize.sceneImage', d)
        d()
        return c
      },
      A = function (a) {
        if (a.find('.scenes-product-carousel-placeholder').length) {
          var c = b('\x3cdiv\x3e').addClass('a-section').addClass('room-below-image-section'),
            d = b('\x3cdiv\x3e').addClass('a-section').addClass('room-feed-and-refinements'),
            e = b('\x3cdiv\x3e')
              .attr('id', 'room-feed-section')
              .addClass('a-section')
              .addClass('room-feed-section')
          d.append(e)
          c.append(d)
          a.find('.scenes-product-carousel-placeholder').replaceWith(c)
        }
        return a
      }
    return function () {
      var c = new k()
      new f({ $scrollableViewport: n })
      a.on('mirai:scene-side-sheet-init', function (a) {
        var d = a.icons
        a = a.strings
        c.isSideSheetInitialized() ||
          (b('img[mirai-scene-icon-source]').each(function () {
            var a = b(this)
            a.attr('src', d[a.attr('mirai-scene-icon-source')])
          }),
          b('img[data-mirai-scene-icon-source]').each(function () {
            var a = b(this)
            a.attr('src', d[a.attr('data-mirai-scene-icon-source')])
          }),
          b('.mirai-scene-no-results-string-slot').replaceWith(a.shoppableSceneNoSuggestions),
          b('.mirai-scene-tabs-title-string-slot').replaceWith(a.shoppableSceneTabsTitle),
          b('.mirai-scene-see-more-string-slot').replaceWith(a.shoppableSceneSeeMoreString))
      })
      a.on('mirai:scene-details-init', function (d) {
        var f = d.scene,
          k = d.imageSource
        if (f && f.physicalId && ((d = e(f.physicalId)), !(0 < b(d).length))) {
          d = 'mirai-scene-details-' + f.physicalId
          d = u('mirai-scene-details-template').addClass(d)
          d = A(d)
          var h = w(z(k)),
            k = r(f.tags)
          d.find('.mirai-scene-image-slot').replaceWith(h)
          d.find('.mirai-scene-tags-slot').replaceWith(k)
          g.append(d)
          h = f.tags.map(function (a) {
            return a.link
          })
          d = {
            tagView: v(k.find('.item-tag'), f.physicalId, h),
            collectionView: p(d, f.physicalId, h),
          }
          c.initializeSceneAction(f.physicalId, f.tags, d)
          q(f.physicalId)
          a.trigger('mirai:multi-scene-view:physical-id:change', { physicalId: f.physicalId })
        }
      })
      a.on('mirai:scene-details-change', function (d) {
        d = d.physicalId
        c.doesSceneExist(d) &&
          b(e(d)).hasClass('aok-hidden') &&
          (q(d), a.trigger('mirai:multi-scene-view:physical-id:change', { physicalId: d }))
      })
    }
  })
  ;('use strict')
  l.when(
    'A',
    'jQuery',
    'mirai-scene-utils',
    'mirai-scene-immersive-recommendation-column-view',
  ).register('mirai-shoppable-scene-immersive-view', function (a, b, c, d) {
    var h = b('#shoppable-scene-details-content-iv').find('.room-detail-page-container'),
      k = {}
    return function () {
      a.on('mirai:scene-immersive-recommendation-col-init', function (f) {
        if ((f = f.scene) && f.physicalId) {
          if (!k[f.physicalId]) {
            var e = c.replacePlus('.mirai-scene-details-iv-' + f.physicalId)
            if (0 < b(e).length) return
            e = 'mirai-scene-details-iv-' + f.physicalId
            e = b('.mirai-scene-details-template-iv')
              .clone()
              .removeClass('mirai-scene-details-template-iv aok-hidden')
              .addClass(e)
            if (0 < e.find('.scenes-product-carousel-placeholder-iv').length) {
              var g = b('\x3cdiv\x3e').addClass('a-section').addClass('room-below-image-section'),
                n = b('\x3cdiv\x3e').addClass('a-section').addClass('room-feed-and-refinements'),
                v = b('\x3cdiv\x3e')
                  .attr('id', 'room-feed-section')
                  .addClass('a-section')
                  .addClass('room-feed-section')
              n.append(v)
              g.append(n)
              e.find('.scenes-product-carousel-placeholder-iv').replaceWith(g)
            }
            h.append(e)
            new d({
              scenePhysicalId: f.physicalId,
              $container: e,
              $feedRootElement: e.find('.room-feed-section'),
            })
          }
          k[f.physicalId] = !0
          a.trigger('mirai:multi-scene-view:immersive-view:open', f)
        }
      })
      a.on('mirai:scene-immersive-publish-metric', function (a) {})
    }
  })
  ;('use strict')
  l.when(
    'A',
    'jQuery',
    'mirai-scene-immersive-recommendation-column-view-model',
    'mirai-scene-collection-view',
    'mirai-scene-flush-feed-display-strategy',
    'atf',
  ).register('mirai-scene-immersive-recommendation-column-view', function (a, b, c, d, h) {
    return function (k) {
      var f = k.$container,
        e = k.$feedRootElement,
        g = new c(k.scenePhysicalId)
      a.on('mirai:multi-scene-view:immersive-view:open', function (a) {
        var b = a.tags.map(function (a) {
          return a.link
        })
        g.selectCommand(a.physicalId, null, b)
      })
      a.on('mirai:scene-immersive-recommendation-col-update', function (a) {})
      g.eventBus.on(g.events.IMMERSIVE_VIEW_PREFETCH, function () {
        a.hide(f)
      })
      g.eventBus.on(g.events.IMMERSIVE_RECOMMENDATION_COL_SHOW, function (c) {
        var g = c.scenePhysicalId
        c = c.res
        var k = b('#shoppable-scene-iv-recommendation-waiting-spinner')
        0 < k.length && k.remove()
        k = b('.shoppable-scene-recommendation-iv')
        0 < k.length && k.show()
        h.replaceAll(e, b(c.html))
        a.show(f)
        d.initializeCarousels(g)
      })
      new MutationObserver(function (a, b) {
        '' !== e.html() && g.saveViewCommand(e.html())
      }).observe(e[0], {
        subtree: !0,
        childList: !0,
        attributes: !0,
        attributeFilter: ['style', 'class'],
      })
    }
  })
  ;('use strict')
  l.when('mirai-scene-utils', 'atf').register(
    'mirai-scene-flush-feed-display-strategy',
    function (a) {
      return {
        append: function (a, c, d) {
          a.last().after(d)
          c.animate({ scrollTop: [d.position().top - 100, 'swing'] }, { duration: 700 })
        },
        insert: function (b, c, d, h) {
          var k = b.eq(h)
          c.animate({ scrollTop: [k.position().top - 100, 'swing'] }, { duration: 700 })
          b.eq(a.steppedIndex(h, d.length)).after(d)
          d.hide().css('opacity', 0).slideDown(700).animate({ queue: !1, opacity: 1 }, 700)
        },
        replaceOne: function (a, c, d) {
          var h = a.eq(d)
          c.hide()
          h.fadeOut(200, function () {
            h.replaceWith(c)
            c.fadeIn(200)
          })
        },
        replaceAll: function (a, c) {
          a.empty()
          a.append(c)
        },
      }
    },
  )
  ;('use strict')
  l.when(
    'mirai-scene-utils',
    'mirai-scene-polyfill',
    'mirai-event-bus',
    'mirai-scene-details-model',
    'mirai-scene-context-model',
    'atf',
  ).register('mirai-scene-feed-select-view-model', function (a, b, c, d, h) {
    return function (k) {
      var f = this
      k = k.tagIds
      this.events = { INDEX_CHANGE: 'index:change' }
      this.eventBus = new (Function.prototype.bind.apply(
        c,
        [null].concat(m(b.object.values(this.events))),
      ))()
      this.selectableTagIds = k
      d.eventBus.on(d.events.COLLECTIONS_PREFETCH, function (c) {
        var d = c.scenePhysicalId
        c = c.tagId
        b.array.includes(f.selectableTagIds, c)
          ? ((c = a.indicesOfMatches(f.selectableTagIds, c)),
            0 === c.length && (c = [0]),
            f.eventBus.trigger(f.events.INDEX_CHANGE, {
              selectedPhysicalId: d,
              selectedIndices: c,
            }))
          : f.eventBus.trigger(f.events.INDEX_CHANGE, {
              selectedPhysicalId: d,
              selectedIndices: {},
            })
      })
      this.selectCommand = function (a, b) {
        d.getCollections(a, b, this.selectableTagIds, h.createImageBlockContext())
      }
    }
  })
  ;('use strict')
  l.when(
    'mirai-scene-utils',
    'mirai-event-bus',
    'mirai-scene-polyfill',
    'mirai-scene-details-model',
    'mirai-scene-context-model',
    'atf',
  ).register('mirai-scene-collection-view-model', function (a, b, c, d, h) {
    var k = h.createImageBlockContext()
    return function (a) {
      var e = this
      a = a.scenePhysicalId
      var g = !1,
        h = [],
        l = []
      this.targetTagId = null
      this.scenePhysicalId = a
      this.tagIdsWithNoMoreProducts = []
      this.asinsWithNoMoreRecommendations = []
      this.tagIdsWithRequestedRecommendations = []
      this.events = {
        COLLECTIONS_PREFETCH: 'scene:collections:prefetch',
        COLLECTIONS_CHANGE: 'scene:collections:change',
        COLLECTIONS_ERROR: 'scene:collections:error',
        SIMILAR_PRODUCTS_CHANGE: 'scene:similar-products:change',
        SIMILAR_PRODUCTS_ERROR: 'scene:similar-products:error',
        MORE_PRODUCTS_PREFETCH: 'scene:more-products:prefetch',
        MORE_PRODUCTS_CHANGE: 'scene:more-products:change',
        MORE_PRODUCTS_ERROR: 'scene:more-products:error',
        SHOW_LOAD_MORE_BUTTON: 'scene:load-more-button:show',
      }
      this.eventBus = new (Function.prototype.bind.apply(
        b,
        [null].concat(m(c.object.values(this.events))),
      ))()
      d.eventBus.on(d.events.COLLECTIONS_PREFETCH, function () {
        e.eventBus.trigger(e.events.COLLECTIONS_PREFETCH)
      })
      d.eventBus.on(d.events.COLLECTIONS_CHANGE, function (a) {
        var b = a.scenePhysicalId,
          c = a.tagId
        a = a.res
        b === e.scenePhysicalId &&
          ((g = null !== c),
          (h = a.firstAsinPerTagIdList),
          (l = a.browseNodeList),
          e.eventBus.trigger(e.events.COLLECTIONS_CHANGE, {
            scenePhysicalId: b,
            tagId: c,
            res: a,
            isActiveCollection: g,
          }))
      })
      d.eventBus.on(d.events.COLLECTIONS_CHANGE_IG, function (a) {
        var b = a.scenePhysicalId,
          c = a.tagId
        a = a.res
        b === e.scenePhysicalId &&
          ((g = null !== c),
          (h = a.firstAsinPerTagIdList),
          (l = a.browseNodeList),
          e.eventBus.trigger(e.events.COLLECTIONS_CHANGE_IG, {
            scenePhysicalId: b,
            tagId: c,
            res: a,
            isActiveCollection: g,
          }))
      })
      d.eventBus.on(d.events.COLLECTIONS_ERROR, function (a) {
        a = a.scenePhysicalId
        a === e.scenePhysicalId &&
          e.eventBus.trigger(e.events.COLLECTIONS_ERROR, { scenePhysicalId: a })
      })
      this.saveViewCommand = function (a) {
        d.cacheView(
          this.scenePhysicalId,
          { firstAsinPerTagIdList: h, browseNodeList: l, html: a },
          k,
        )
      }
      this.storeCurrentViewAsins = function (a) {
        d.updateCurrentViewAsins(this.scenePhysicalId, a, k)
      }
      this.navigateToDetailPageCommand = function (a, b) {
        x.open('/dp/' + a + '?ref\x3dsbl_dr_dp_col_' + b, '_blank')
      }
    }
  })
  ;('use strict')
  l.when(
    'jQuery',
    'mirai-event-bus',
    'mirai-scene-polyfill',
    'mirai-scene-utils',
    'mirai-scene-details-model',
    'mirai-scenes-action-recorder',
    'mirai-scene-context-model',
    'atf',
  ).register('mirai-scene-side-sheet-view-model', function (a, b, c, d, h, k, f) {
    return function () {
      var e = this,
        g = !1,
        l = f.createImageBlockContext(),
        v = d.getAnchorAsin(a)
      this.events = { SIDE_SHEET_SHOW: 'mirai:side-sheet:show' }
      this.scenePhysicalId
      this.tagId
      this.eventBus = new (Function.prototype.bind.apply(
        b,
        [null].concat(m(c.object.values(this.events))),
      ))()
      h.eventBus.on(h.events.COLLECTIONS_PREFETCH, function (a) {
        var b = a.scenePhysicalId
        a = a.tagId
        g || (e.eventBus.trigger(e.events.SIDE_SHEET_SHOW), (g = !0), e.recordSideSheetOpen(a, b))
      })
      this.recordSideSheetOpen = function (a, b) {
        this.tagId = null !== a ? d.parseTagId(a) : ''
        this.scenePhysicalId = b
        k.recordSheetOpen(v, this.tagId, this.scenePhysicalId, l.requestSource)
      }
      this.recordSideSheetClose = function () {
        var a = h.getCurrentViewAsins(this.scenePhysicalId, l),
          b = h.getBrowseNodeList(this.scenePhysicalId)
        k.recordSheetClose(v, this.tagId, this.scenePhysicalId, a, b, l.requestSource)
      }
      this.setSideSheetVisible = function (a) {
        g = a
      }
    }
  })
  ;('use strict')
  l.when('atf').register('mirai-multi-scene-view-model', function () {
    return function () {
      var a = {},
        b = !1
      this.initializeSceneAction = function (c, d, h) {
        a[c] = { tags: d, subViews: h }
        b = !0
      }
      this.doesSceneExist = function (b) {
        return !!a[b]
      }
      this.isSideSheetInitialized = function () {
        return b
      }
    }
  })
  ;('use strict')
  l.when(
    'jQuery',
    'mirai-event-bus',
    'mirai-scene-polyfill',
    'mirai-scene-details-model',
    'mirai-scene-context-model',
    'atf',
  ).register('mirai-scene-immersive-recommendation-column-view-model', function (a, b, c, d, h) {
    var k = h.createImageBlockImmersiveViewContext()
    return function (a) {
      var e = this,
        g = [],
        h = []
      this.scenePhysicalId = a
      this.events = {
        IMMERSIVE_VIEW_PREFETCH: 'scene:immersive-view:prefetch',
        IMMERSIVE_RECOMMENDATION_COL_SHOW: 'mirai:immersive-view-recommendation-col:show',
      }
      this.eventBus = new (Function.prototype.bind.apply(
        b,
        [null].concat(m(c.object.values(this.events))),
      ))()
      d.eventBus.on(d.events.COLLECTIONS_PREFETCH_IV, function () {
        e.eventBus.trigger(e.events.IMMERSIVE_VIEW_PREFETCH)
      })
      d.eventBus.on(d.events.COLLECTIONS_CHANGE_IV, function (a) {
        var b = a.scenePhysicalId,
          c = a.tagId
        a = a.res
        b === e.scenePhysicalId &&
          ((g = a.firstAsinPerTagIdList),
          (h = a.browseNodeList),
          e.eventBus.trigger(e.events.IMMERSIVE_RECOMMENDATION_COL_SHOW, {
            scenePhysicalId: b,
            tagId: c,
            res: a,
          }))
      })
      this.selectCommand = function (a, b, c) {
        a === this.scenePhysicalId && d.getCollections(a, b, c, k)
      }
      this.saveViewCommand = function (a) {
        d.cacheView(
          this.scenePhysicalId,
          { firstAsinPerTagIdList: g, browseNodeList: h, html: a },
          k,
        )
      }
    }
  })
  ;('use strict')
  l.when('mirai-scene-url-parser', 'atf').register('mirai-scene-context-model', function (a) {
    var b = function (a, b) {
      var h = 2 < arguments.length && arguments[2] !== t ? arguments[2] : t,
        k = { requestSource: a, refMarker: b }
      return h ? Object.assign(k, { pageAsin: h }) : k
    }
    return {
      createImageBlockContext: function () {
        return b('IMAGE_BLOCK', 'sbl_dr_dp_col_sm_m')
      },
      createSoftlinesContext: function () {
        return b('SOFTLINES', 'sbl_dr_dp_soft_sm_m', a.getPageAsin())
      },
      createImageGalleryContext: function () {
        return b('IMAGE_GALLERY', 'sbl_dr_dp_ig_col_sm_m')
      },
      createImageBlockImmersiveViewContext: function () {
        return b('IMMERSIVE_VIEW', 'sbl_dr_ibiv_sm')
      },
    }
  })
  ;('use strict')
  l.when(
    'mirai-scene-utils',
    'mirai-scene-polyfill',
    'mirai-event-bus',
    'mirai-scene-details-model-adapter',
    'atf',
  ).register('mirai-scene-details-model', function (a, b, c, d) {
    function h(a, b, c) {
      var d = e(a, c).currentViewAsins
      b.forEach(function (a) {
        return d.add(a)
      })
    }
    function k(a, b, c) {
      a = g(a)
      a.numberOfRecommendationsMade += 1
      a[c ? 'likedAsins' : 'dislikedAsins'].push({
        asin: b,
        iteration: a.numberOfRecommendationsMade,
      })
    }
    function f(a, b, c, d, e) {
      var f
      a = g(a)
      ;(f = a.similarAsins).splice.apply(f, [e ? b : b + 1, e ? 1 : 0].concat(m(c)))
      d && (a.nextStartIndex = d)
    }
    function e(a, b) {
      a = b.requestSource + '-' + a
      if (a in z) return z[a]
      z[a] = { currentViewAsins: new Set() }
      return z[a]
    }
    function g(a) {
      if (!u || !u[a]) throw Error('There is no data available for the tag ID ' + a)
      return u[a]
    }
    function l(a) {
      if (!r || !r[a]) throw Error('There is no response cached for the cacheKey ' + a)
      return r[a]
    }
    function v(a) {
      if (
        Object.values(a).some(function (a) {
          return a === t
        })
      )
        throw Error('Invalid response from server')
    }
    function p(a) {
      return (
        Object.values(a).some(function (a) {
          return a === t
        }) && a.html
      )
    }
    var u = {},
      z = {},
      r = {},
      q = {
        FEED_PREFETCH: 'scene-details-model:feed:prefetch',
        FEED_CHANGE: 'scene-details-model:feed:change',
        FEED_ERROR: 'scene-details-model:feed:error',
        SIMILAR_PRODUCTS_CHANGE: 'scene-details-model:similar-products:change',
        SIMILAR_PRODUCTS_ERROR: 'scene-details-model:similar-products:error',
        MORE_PRODUCTS_PREFETCH: 'scene-details-model:more-products:prefetch',
        MORE_PRODUCTS_CHANGE: 'scene-details-model:more-products:change',
        MORE_PRODUCTS_ERROR: 'scene-details-model:more-products:error',
        MORE_PRODUCTS_ABORTED_ERROR: 'scene-details-model:more-products:aborted',
        COLLECTIONS_PREFETCH: 'scene-details-model:collections:prefetch',
        COLLECTIONS_PREFETCH_IV: 'scene-details-model:collections:prefetch:iv',
        COLLECTIONS_CHANGE: 'scene-details-model:collections:change',
        COLLECTIONS_CHANGE_IG: 'scene-details-model:collections:change:ig',
        COLLECTIONS_CHANGE_IV: 'scene-details-model:collections:change:iv',
        COLLECTIONS_ERROR: 'scene-details-model:collections:error',
      },
      w = new (Function.prototype.bind.apply(c, [null].concat(m(b.object.values(q)))))()
    return {
      events: q,
      eventBus: w,
      getProducts: function (a, c, e) {
        w.trigger(q.MORE_PRODUCTS_PREFETCH)
        var k = g(a)
        d.getProducts(b.object.assign({ count: e, tagId: a }, k), c)
          .then(function (b) {
            v(b)
            var c = b.html
            f(a, k.similarAsins.length, b.similarAsins, b.nextIndex, !1)
            w.trigger(q.MORE_PRODUCTS_CHANGE, { tagId: a, html: c })
          })
          .catch(function (b) {
            'abort' !== b.statusText
              ? w.trigger(q.MORE_PRODUCTS_ERROR, { tagId: a })
              : w.trigger(q.MORE_PRODUCTS_ABORTED_ERROR, { tagId: a })
          })
      },
      getProductRecommendation: function (a, c, e, h, r, z, l) {
        var u = g(a),
          m = u.similarAsins.indexOf(c)
        0 != u.dislikedAsins.length || r || k(a, u.tagAsin, !0)
        k(a, c, r)
        d.getProductRecommendation(
          b.object.assign(
            { productAsin: c, productPhysicalId: e, count: h, asinIndexInFeed: m },
            u,
          ),
          r,
          z,
        )
          .then(function (b) {
            v(b)
            var c = b.similarAsins,
              d = b.nextIndex
            b = b.html
            var e = l(m)
            f(a, e, c, d, !r)
            w.trigger(q.SIMILAR_PRODUCTS_CHANGE, { targetIndex: e, tagId: a, isLike: r, html: b })
          })
          .catch(function (b) {
            'abort' !== b.statusText &&
              w.trigger(q.SIMILAR_PRODUCTS_ERROR, { targetIndex: m, tagId: a })
          })
      },
      getSimilarProductsForTagId: function (a) {
        w.trigger(q.FEED_PREFETCH, { tagId: a })
        r && r[a]
          ? w.trigger(q.FEED_CHANGE, { tagId: a, html: l(a), nextIndex: g(a).nextStartIndex })
          : d
              .getSimilarProductsForTagId(a)
              .then(function (b) {
                if (p(b)) w.trigger(q.FEED_CHANGE, { tagId: a, html: b.html })
                else {
                  v(b)
                  var c = b.similarAsins,
                    d = b.nextIndex,
                    e = b.html
                  u[a] = {
                    browseNode: b.browseNode,
                    tagAsin: c[0],
                    numberOfRecommendationsMade: 0,
                    nextStartIndex: 0,
                    similarAsins: [],
                    likedAsins: [],
                    dislikedAsins: [],
                  }
                  f(a, 0, c, d, !1)
                  w.trigger(q.FEED_CHANGE, { tagId: a, html: e, nextIndex: d })
                }
              })
              .catch(function (b) {
                'abort' !== b.statusText && w.trigger(q.FEED_ERROR, { tagId: a })
              })
      },
      cacheView: function (a, b, c) {
        r[c.requestSource + '-' + a] = b
      },
      getModel: function (a) {
        return JSON.parse(JSON.stringify(u[a]))
      },
      getCollections: function (a, b, c, e) {
        var f = void 0,
          g = q.COLLECTIONS_PREFETCH
        e.requestSource.includes('IMAGE_GALLERY')
          ? (f = q.COLLECTIONS_CHANGE_IG)
          : e.requestSource.includes('IMMERSIVE_VIEW')
            ? ((g = q.COLLECTIONS_PREFETCH_IV), (f = q.COLLECTIONS_CHANGE_IV))
            : (f = q.COLLECTIONS_CHANGE)
        w.trigger(g, { scenePhysicalId: a, tagId: b })
        g = e.requestSource + '-' + a
        r && r[g]
          ? ((c = l(g)),
            h(a, c.firstAsinPerTagIdList, e),
            w.trigger(f, { scenePhysicalId: a, tagId: b, res: c }))
          : d
              .getCollections(c, e)
              .then(function (c) {
                v(c)
                h(a, c.firstAsinPerTagIdList, e)
                w.trigger(f, { scenePhysicalId: a, tagId: b, res: c })
              })
              .catch(function (b) {
                'abort' !== b.statusText && w.trigger(q.COLLECTIONS_ERROR, { scenePhysicalId: a })
              })
      },
      updateCurrentViewAsins: h,
      getCurrentViewAsins: function (a, b) {
        return e(a, b).currentViewAsins
      },
      getBrowseNodeList: function (a) {
        return r[a] ? r[a].browseNodeList : []
      },
    }
  })
  ;('use strict')
  C = (function () {
    return function (a, b) {
      if (Array.isArray(a)) return a
      if (Symbol.iterator in Object(a)) {
        var c = [],
          d = !0,
          h = !1,
          k = t
        try {
          for (
            var f = a[Symbol.iterator](), e;
            !(d = (e = f.next()).done) && (c.push(e.value), !b || c.length !== b);
            d = !0
          );
        } catch (g) {
          ;(h = !0), (k = g)
        } finally {
          try {
            if (!d && f['return']) f['return']()
          } finally {
            if (h) throw k
          }
        }
        return c
      }
      throw new TypeError('Invalid attempt to destructure non-iterable instance')
    }
  })()
  l.when('jQuery', 'mirai-scene-utils', 'mirai-scene-weblab-context', 'atf').register(
    'mirai-scene-details-model-adapter',
    function (a, b, c) {
      var d = b.urlResolver('/discover/rooms/dpx'),
        h = (function () {
          var b = null
          return function (c) {
            b && (b.abort(), (b = null))
            return (b = a.ajax(c).done(function () {
              b = null
            }))
          }
        })(),
        k = function (a) {
          return 'string' === typeof a ? a.split(',') : []
        },
        f = function (a) {
          return a
        },
        e = function (a) {
          return a.trim()
        },
        g = function (b, c) {
          var d = a(b)
          return Object.entries(c).reduce(function (a, b) {
            var c = C(b, 2)
            b = c[0]
            c = c[1]
            if ('function' === typeof c) {
              var e = d.data(b)
              a[b] = c(e)
              return a
            }
          }, {})
        },
        l = function (b) {
          return a(b)
            .find('.discover-feed-item')
            .map(function () {
              return this.outerHTML
            })
            .get()
            .join('')
        },
        v = function (a) {
          return function (b) {
            return Object.assign({ html: l(b) }, g(b, a))
          }
        },
        p = (function () {
          var a = v({ nextIndex: f, similarAsins: k })
          return function (b, c, f) {
            c = c ? 'getProductRecommendationsForLike' : 'getProductRecommendationsForDislike'
            b = {
              browseNode: b.browseNode,
              asin: b.productAsin,
              physicalId: b.productPhysicalId,
              currentViewAsins: [].concat(m(b.similarAsins)),
              positive: [].concat(m(b.likedAsins)),
              negative: [].concat(m(b.dislikedAsins)),
              count: b.count,
              asinIndex: b.asinIndexInFeed,
              iteration: b.numberOfRecommendationsMade,
            }
            return Promise.resolve(
              h({
                type: 'POST',
                url: d(c, { roomPhysicalId: f }),
                data: JSON.stringify(b),
                contentType: 'application/json; charset\x3dUTF-8',
              }),
            )
              .then(e)
              .then(a)
          }
        })()
      return {
        getProducts: (function () {
          var a = v({ nextIndex: f, similarAsins: k })
          return function (b, c) {
            b = {
              browseNode: b.browseNode,
              currentAsins: [].concat(m(b.similarAsins)),
              keywords: [],
              positive: [].concat(m(b.likedAsins)),
              negative: [].concat(m(b.dislikedAsins)),
              start: b.nextStartIndex,
              iteration: b.numberOfRecommendationsMade,
              count: b.count,
              currentCount: b.similarAsins.length,
              minPrice: 0,
              maxPrice: null,
              isPrime: null,
              tagId: b.tagId.split('/').pop(),
            }
            return Promise.resolve(
              h({
                type: 'POST',
                url: d('loadMoreProducts', { roomPhysicalId: c }),
                data: JSON.stringify(b),
                contentType: 'application/json; charset\x3dUTF-8',
              }),
            )
              .then(e)
              .then(a)
          }
        })(),
        getProductRecommendation: p,
        getSimilarProductsForTagId: function (a) {
          return Promise.resolve(h({ type: 'GET', url: a }))
            .then(e)
            .then(function (a) {
              var b = g(a, {
                browseNode: f,
                tagAsin: f,
                similarAsins: k,
                weblabTreatments: f,
                nextIndex: f,
              })
              c.setWeblabsFromMap(b.weblabTreatments)
              return {
                html: a,
                browseNode: b.browseNode,
                tagAsin: b.tagAsin,
                similarAsins: b.similarAsins,
                nextIndex: b.nextIndex,
              }
            })
        },
        getCollections: function (a, c) {
          a = a.map(b.parseTagId)
          a = Object.assign({ tagIds: a }, c)
          return Promise.resolve(h({ type: 'GET', url: d('tags', a) }))
            .then(e)
            .then(function (a) {
              var b = g(a, { model: f })
              return {
                html: a,
                firstAsinPerTagIdList: b.model.firstAsinPerTagIdList,
                browseNodeList: b.model.browseNodeList,
              }
            })
        },
      }
    },
  )
  ;('use strict')
  l.register('mirai-scene-bottom-sheet', function () {
    return {}
  })
  ;('use strict')
  ;('use strict')
  ;('use strict')
  l.when(
    'A',
    'jQuery',
    'a-carousel-constants',
    'mirai-scene-utils',
    'mirai-scene-details-model',
    'mirai-scenes-action-recorder',
    'a-carousel-ajax-standard',
    'mirai-event-bus',
    'mirai-scene-polyfill',
    'atf',
  ).register('mirai-scenes-collections-carousels', function (a, b, c, d, h, k, f, e, g) {
    return function () {
      function b(c, e, g, l) {
        var m = 'a:carousel:' + e + ':change:pageNumber',
          n = 'a:carousel:' + e + ':repaint',
          u = c.dom.$carousel.closest('.room-feed-and-refinements').data('tagId'),
          y = d.parseScenePhysicalIdFromTagId(u),
          t = c.dom.$carousel
            .closest('.room-feed-items-container-collection')
            .find('.pagination-slider')
        g.onInit(e, function (b) {
          f.want(b, 1, 5)
          k(b)
          a.on(m, function (a) {
            k(a.carousel)
          })
        })
        a.on(m, function (a) {
          a.carousel.__id === c.__id &&
            (function () {
              k(a.carousel)
              var b = a.newValue,
                d = a.oldValue,
                e = c.dom.$carousel.children(),
                f = []
              e.each(function () {
                this.childNodes[0] && f.push(this.childNodes[0].dataset.asin)
              })
              if (b !== d) {
                h(b, t)
                var g = e[0].childNodes[0].dataset.browseNode,
                  r = f[b - 1].split()[0]
                b > d
                  ? (l.eventBus.trigger(l.events.NEXT_BUTTON_CLICKED, {
                      asin: r,
                      tagId: u,
                      scenePhysicalId: y,
                      browseNode: g,
                      $items: e,
                    }),
                    l.eventBus.trigger(l.events.ASIN_SEEN, { asin: r, scenePhysicalId: y }))
                  : l.eventBus.trigger(l.events.PREV_BUTTON_CLICKED, {
                      asin: r,
                      tagId: u,
                      scenePhysicalId: y,
                      browseNode: g,
                    })
              }
            })()
        })
        a.on(n, function (a) {
          a.carousel.__id === c.__id && k(a.carousel)
        })
      }
      function k(a) {
        var b = a.getAttr(c.PAGE_NUMBER),
          d = a.getAttr(c.TOTAL_PAGES),
          e = a.dom.$container.find('.a-carousel-goto-prevpage')
        a = a.dom.$container.find('.a-carousel-goto-nextpage')
        e.css('visibility', 1 === b ? 'hidden' : 'visible')
        a.css('visibility', b >= d ? 'hidden' : 'visible')
      }
      function h(a, b) {
        var c = b.width()
        b.css('left', c * (a - 1))
      }
      this.events = {
        NEXT_BUTTON_CLICKED: 'scene:collections:carousel:next',
        PREV_BUTTON_CLICKED: 'scene:collections:carousel:prev',
        ASIN_SEEN: 'scene:collections:asinSeen',
      }
      this.eventBus = new (Function.prototype.bind.apply(
        e,
        [null].concat(m(g.object.values(this.events))),
      ))()
      var u = this
      this.bindEventListenersToCarousels = function (a) {
        l.when('a-carousel-framework').execute(function (c) {
          l.when('cf').execute(function () {
            c.createAll()
            c.initializeAll()
            var d = a.find('.collections-carousel-container'),
              e = a.find('.collections-partial-carousel-container')
            d.add(e).each(function () {
              var a = c.getCarousel(this),
                d = a.getAttr('name')
              b(a, d, c, u)
            })
          })
        })
      }
      this.initializeCarousels = function (a) {
        l.when('a-carousel-framework').execute(function (a) {
          l.when('cf').execute(function () {
            a.createAll()
            a.initializeAll()
          })
        })
        a.scroll(function () {
          l.when('a-carousel-framework').execute(function (a) {
            l.when('cf').execute(function () {
              a.createAll()
              a.initializeAll()
            })
          })
        })
      }
    }
  })
  ;('use strict')
  l.when(
    'A',
    'jQuery',
    'a-carousel-constants',
    'mirai-scene-utils',
    'mirai-scene-details-model',
    'mirai-scenes-action-recorder',
    'a-carousel-ajax-standard',
    'mirai-event-bus',
    'mirai-scene-polyfill',
    'atf',
  ).register('mirai-scenes-collections-v2-carousels', function (a, b, c, d, h, k, f, e, g) {
    return function () {
      function k(b, c, e, g) {
        var l = 'a:carousel:' + c + ':change:pageNumber',
          m = 'a:carousel:' + c + ':repaint',
          n = b.dom.$carousel.closest('.room-feed-and-refinements').data('tagId'),
          t = d.parseScenePhysicalIdFromTagId(n),
          x = b.dom.$carousel
            .closest('.room-feed-items-container-collection')
            .find('.pagination-slider')
        e.onInit(c, function (b) {
          f.want(b, 1, 5)
          b.onChange('fetchedItems', function () {
            u(b)
            b.strategies.display.repaint(b)
            g.initializeTruncation()
          })
          h(b)
          a.on(l, function (a) {
            h(a.carousel)
          })
        })
        a.on(l, function (a) {
          a.carousel.__id === b.__id &&
            (function () {
              h(a.carousel)
              var c = a.newValue,
                d = a.oldValue,
                e = b.dom.$carousel.children(),
                f = []
              e.each(function () {
                this.childNodes[0] && f.push(this.childNodes[0].dataset.asin)
              })
              if (c !== d) {
                p(c, x)
                var k = e[0].childNodes[0].dataset.browseNode,
                  l = f[c - 1].split()[0]
                c > d
                  ? (g.eventBus.trigger(g.events.NEXT_BUTTON_CLICKED, {
                      asin: l,
                      tagId: n,
                      scenePhysicalId: t,
                      browseNode: k,
                      $items: e,
                    }),
                    g.eventBus.trigger(g.events.ASIN_SEEN, { asin: l, scenePhysicalId: t }))
                  : g.eventBus.trigger(g.events.PREV_BUTTON_CLICKED, {
                      asin: l,
                      tagId: n,
                      scenePhysicalId: t,
                      browseNode: k,
                    })
              }
            })()
        })
        a.on(m, function (a) {
          a.carousel.__id === b.__id && h(a.carousel)
        })
      }
      function h(a) {
        var b = a.getAttr(c.PAGE_NUMBER),
          d = a.getAttr(c.TOTAL_PAGES),
          e = a.dom.$container.find('.a-carousel-goto-prevpage')
        a = a.dom.$container.find('.a-carousel-goto-nextpage')
        e.css('visibility', 1 === b ? 'hidden' : 'visible')
        a.css('visibility', b >= d ? 'hidden' : 'visible')
      }
      function p(a, b) {
        var c = b.width()
        b.css('left', c * (a - 1))
      }
      function u(a) {
        var c = 0
        a.dom.$carousel.find('.collection-item').each(function () {
          var a = b(this).outerHeight()
          c = Math.max(c, a)
        })
        a.dom.$carousel.find('.collection-item').css('min-height', c + 'px')
        a.strategies.display.repaint(a)
        a.dom.$carousel.find('.a-carousel-card').css('height', c + 'px')
        a.dom.$viewport.css('height', '100%')
        a.strategies.display.repaint(a)
      }
      this.events = {
        NEXT_BUTTON_CLICKED: 'scene:collections:carousel:next',
        PREV_BUTTON_CLICKED: 'scene:collections:carousel:prev',
        ASIN_SEEN: 'scene:collections:asinSeen',
      }
      this.eventBus = new (Function.prototype.bind.apply(
        e,
        [null].concat(m(g.object.values(this.events))),
      ))()
      var t = this
      this.bindEventListenersToCarousels = function (a) {
        l.when('a-carousel-framework').execute(function (b) {
          l.when('cf').execute(function () {
            b.createAll()
            b.initializeAll()
            var c = a.find('.collections-carousel-container'),
              d = a.find('.collections-partial-carousel-container')
            c.add(d).each(function () {
              var a = b.getCarousel(this),
                c = a.getAttr('name')
              k(a, c, b, t)
            })
          })
        })
      }
      this.initializeCarousels = function (a) {
        function b() {
          l.when('a-carousel-framework').execute(function (a) {
            l.when('cf').execute(function () {
              a.createAll()
              a.initializeAll()
              t.initializeTruncation()
            })
          })
        }
        setTimeout(b, 100)
        a.scroll(b)
      }
      this.initializeTruncation = function () {
        l.when('A', 'a-truncate').execute(function (a, b) {
          b.refreshAutoTruncate()
        })
      }
    }
  })
  ;('use strict')
  ;('use strict')
  ;('use strict')
  l.when('A', 'jQuery', 'mirai-scene-utils', 'atf').register(
    'mirai-scene-image-block-view-products-button',
    function (a, b, c) {
      function d(d) {
        c.getHeartIcon(b)[0] ? d.css({ left: '' }) : d.css({ left: '0px' })
        a.trigger('mirai:scenes-view-products-button-moved')
      }
      var h = function () {
        return 0 < b(c.SCENES_VIEW_PRODUCTS_BUTTON_IB).length
          ? b(c.SCENES_VIEW_PRODUCTS_BUTTON_IB)
          : b(c.SCENES_VIEW_PRODUCTS_BUTTON)
      }
      a.on('a:pageUpdate', function () {
        return d(h())
      })
      return {
        show: function () {
          var a = h()
          a.css('visibility', 'visible')
          d(a)
        },
        hide: function () {
          h().css('visibility', 'hidden')
        },
      }
    },
  )
  ;('use strict')
})
/* ******** */
;(function (c) {
  var b = window.AmazonUIPageJS || window.P,
    d = b._namespace || b.attributeErrors,
    a = d ? d('DetailPageMiraiAssets@theia', 'DetailPageMiraiAssets') : b
  a.guardFatal
    ? a.guardFatal(c)(a, window)
    : a.execute(function () {
        c(a, window)
      })
})(function (c, b, d) {})
/* ******** */
;(function (d) {
  var q = window.AmazonUIPageJS || window.P,
    n = q._namespace || q.attributeErrors,
    a = n ? n('AmazonUIFormControlsJS', 'AmazonUI') : q
  a.guardFatal
    ? a.guardFatal(d)(a, window)
    : a.execute(function () {
        d(a, window)
      })
})(function (d, q, n) {
  d.register('prv:a-form-states', function () {
    function a(a) {
      return function (b) {
        b.removeClass(a)
      }
    }
    function c(a) {
      return function (b) {
        b.addClass(a)
      }
    }
    function b(a) {
      return function (b) {
        return b.hasClass(a)
      }
    }
    return {
      disabled: {
        cssClass: 'a-form-disabled',
        disabled: !0,
        enterState: function (a) {
          a.addClass(this.cssClass)
          a.prop('disabled', this.disabled)
        },
        exitState: function (a) {
          a.removeClass(this.cssClass)
          a.prop('disabled', !this.disabled)
        },
        match: function (a) {
          return a.hasClass(this.cssClass) && a.prop('disabled')
        },
      },
      error: {
        enterState: c('a-form-error'),
        exitState: a('a-form-error'),
        match: b('a-form-error'),
      },
      inactive: {
        enterState: c('a-form-inactive'),
        exitState: a('a-form-inactive'),
        match: b('a-form-inactive'),
      },
      selected: {
        enterState: c('a-form-selected'),
        exitState: a('a-form-selected'),
        match: b('a-form-selected'),
      },
      normal: {
        enterState: c('a-form-normal'),
        exitState: a('a-form-normal'),
        match: b('a-form-normal'),
      },
    }
  })
  ;('use strict')
  d.when('A').register('prv:a-base-form-control-specs', function (a) {
    var c = a.$
    return a.createClass({
      matchTag: function (a) {
        return this.tag ? a.is(this.tag) : !0
      },
      matchType: function (b) {
        if (!this.attrs || !this.attrs.type) return !0
        var c = this.attrs.type
        return 0 <= a.indexOfArray(a.isArray(c) ? c : [c], b.attr('type'))
      },
      matchCssClass: function (a) {
        return this.attrs && this.attrs.cssClass ? a.hasClass(this.attrs.cssClass) : !0
      },
      isCoreElement: function (a) {
        return this.matchTag(a) && this.matchType(a) && this.matchCssClass(a)
      },
      getCoreElement: function (a) {
        var b = this
        return this.isCoreElement(a)
          ? a
          : a
              .find(this.tag)
              .filter(function () {
                return b.isCoreElement(c(this))
              })
              .first()
      },
      isVisualElement: function (a) {
        return this.visualElementSelector ? a.is(this.visualElementSelector) : this.isCoreElement(a)
      },
      getVisualElement: function (a) {
        return this.isVisualElement(a)
          ? a
          : this.visualElementSelector
            ? a.closest(this.visualElementSelector)
            : a
      },
      getWrapperElement: function (a) {
        if (this.wrapperElementSelector) {
          var b = a.closest(this.wrapperElementSelector)
          return 0 < b.length ? b : a
        }
        return a
      },
    })
  })
  ;('use strict')
  d.when('A').register('prv:a-form-util', function (a) {
    var c = 0
    return {
      setElementId: function (a) {
        if (!a.attr('id')) {
          var b = 'a-form-control-auto-id-' + c++
          a.attr('id', b)
        }
      },
    }
  })
  ;('use strict')
  d.when('A', 'a-component', 'prv:a-form-util', 'prv:a-form-control-interfaces').register(
    'a-form-control',
    function (a, c, b, k) {
      var e = c.create({
        init: function (a, c) {
          this._super(a, c)
          a = this.specs
          this._$coreElement = a.getCoreElement(this._$element)
          b.setElementId(this._$coreElement)
          this._$visualElement = a.getVisualElement(this._$coreElement)
          this.isInstanceOf('stateTransitionableControl') && this._resolveFormState()
          this._$wrapperElement = a.getWrapperElement(this._$visualElement)
        },
        getNativeElement: function () {
          return this._$coreElement[0]
        },
        isInstanceOf: function (b) {
          return 0 <= a.indexOfArray(this.specs.interfaces || [], b)
        },
      })
      return {
        create: function (b) {
          ;(b && b.specs) ||
            d.error('Form control specs required', 'AmazonUIFormControlsJS', 'createFormControl')
          a.extend(b, k.resolveControlImplementation(b))
          return e.extend(b)
        },
      }
    },
  )
  ;('use strict')
  d.when('A', 'prv:a-form-states', 'a-tooltip', 'a-dropdown-select-apis').register(
    'prv:a-form-control-interfaces',
    function (a, c, b, d) {
      function e(h, b) {
        var w = a.$.extend({}, c, b || {})
        return a.reduce(
          h || [],
          function (a, h) {
            w.hasOwnProperty(h) && (a[h] = w[h])
            return a
          },
          {},
        )
      }
      function g(h) {
        return a.reduce(
          h || [],
          function (h, b) {
            x.hasOwnProperty(b) && a.extend(h, x[b])
            return h
          },
          {},
        )
      }
      var l = a.$,
        k = function () {
          var h = {}
          a.each([].slice.call(arguments), function (b) {
            a.mixin(h, b)
          })
          return h
        },
        m = {
          hasClass: function () {
            return l.fn.hasClass.apply(this._$visualElement, arguments)
          },
          addClass: function () {
            l.fn.addClass.apply(this._$visualElement, arguments)
          },
          removeClass: function () {
            l.fn.removeClass.apply(this._$visualElement, arguments)
          },
          prop: function () {
            var a = l.fn.prop.apply(this._$coreElement, arguments)
            return a && a.jquery ? n : a
          },
          attr: function () {
            var a = l.fn.attr.apply(this._$coreElement, arguments)
            return a && a.jquery ? n : a
          },
          removeAttr: function () {
            l.fn.removeAttr.apply(this._$coreElement, arguments)
          },
          removeData: function (a) {
            this._$wrapperElement.removeAttr('data-' + a)
          },
          data: function (a, b) {
            return (a = this._$wrapperElement.attr('data-' + a, b)) && a.jquery ? n : a
          },
        },
        t = {
          trigger: function (a) {
            this._$coreElement.trigger(a)
          },
          on: function () {
            l.fn.bind.apply(this._$coreElement, arguments)
          },
          off: function () {
            l.fn.unbind.apply(this._$coreElement, arguments)
          },
        },
        y = k(m, t, {
          check: function (a) {
            this.isChecked() ||
              (this._$coreElement.prop('checked', !0), a || this.trigger('change'))
          },
          uncheck: function (a) {
            this.isChecked() && (this.prop('checked', !1), a || this.trigger('change'))
          },
          isChecked: function () {
            return this._$coreElement.is(':checked')
          },
        }),
        u = k(m, {
          setPlaceholder: function (a) {
            this.attr('placeholder', a)
          },
        }),
        p = k(t, {
          focus: function () {
            this.trigger('focus')
          },
        }),
        v = k(m, {
          setTooltip: function (h, c, f) {
            this.removeTooltip()
            b.create(this._$coreElement, { position: c, activate: f, content: a.escapeHtml(h) })
            this.attr('title', a.escapeHtml(h))
          },
          removeTooltip: function () {
            b.remove(this._$coreElement)
            this.removeAttr('title')
          },
        })
      k = k(m, {
        getState: function () {
          return this._state
        },
        setState: function (a) {
          if (this._applicableStateConfigs.hasOwnProperty(a) && this.getState() !== a) {
            var b = this._getApplicableStateConfig(this.getState())
            b && b.exitState(this)
            this._getApplicableStateConfig(a).enterState(this)
            this._state = a
          }
        },
        isDisabled: function () {
          return 'disabled' === this._state
        },
        isError: function () {
          return 'error' === this._state
        },
        _resolveFormState: function () {
          var b = this.specs
          b = e(b.applicableStates, b.formStates)
          for (var c = a.keys(b), f = 'normal', g = 0; g < c.length; g++)
            if (b[c[g]].match(this)) {
              f = c[g]
              break
            }
          this._state = f
          this._applicableStateConfigs = b
        },
        _getApplicableStateConfig: function (a) {
          return this._applicableStateConfigs[a]
        },
      })
      var f = {}
      a.mixin(
        f,
        d,
        'getOptions getOption addOptions addOption removeOptions removeOption'.split(' '),
      )
      var z = {
          show: function () {
            this._$wrapperElement.show()
          },
          hide: function () {
            this._$wrapperElement.hide()
          },
          isHidden: function () {
            return !this._$wrapperElement.is(':visible')
          },
          val: function (a, b) {
            if ('undefined' !== typeof a && a !== this._$coreElement.val())
              this._$coreElement.val(a),
                b || 'function' !== typeof this.trigger || this.trigger('change')
            else return this._$coreElement.val()
          },
        },
        x = {
          domEventTriggerableControl: t,
          domManipulableControl: m,
          checkableControl: y,
          typeableControl: u,
          focusableControl: p,
          declarativeActionControl: {
            setDeclarativeAction: function (b, c) {
              a.declarative.create(this._$coreElement, b, c)
            },
            removeDeclarativeAction: function (b) {
              a.declarative.remove(this._$coreElement, b)
            },
          },
          tooltipableControl: v,
          stateTransitionableControl: k,
          selectableControl: f,
        }
      return {
        resolveControlImplementation: function (b) {
          var c = b.specs || {},
            f = c.mixins || []
          c = g(c.interfaces || [])
          var e = {}
          f && f.length && a.mixin(c, z, f)
          f = a.filter(a.keys(c), function (a) {
            return !b.hasOwnProperty(a)
          })
          a.mixin(e, c, f)
          return e
        },
      }
    },
  )
  ;('use strict')
  d.when('A').register('prv:a-form-control-proxy', function (a) {
    function c(a, b) {
      if ('function' === typeof a[b])
        return function () {
          return a[b].apply(a, arguments)
        }
    }
    function b(b, g) {
      var e = a.reduce(
        b,
        function (a, b) {
          ;(b = c(b, g)) && a.push(b)
          return a
        },
        [],
      )
      return function () {
        var b = a.copy([].slice.call(arguments))
        return a.each(e, function (a) {
          return a.apply(null, b)
        })
      }
    }
    function d(a) {
      var b = [],
        c
      for (c in a) 'function' === typeof a[c] && 0 !== c.indexOf('_') && b.push(c)
      return b
    }
    function e(b) {
      return a.reduce(
        d(b),
        function (a, g) {
          var e = c(b, g)
          e && (a[g] = e)
          return a
        },
        {},
      )
    }
    function g(c) {
      var g = {}
      g.length = c.length
      var e = a.map(c, function (a) {
        return l(a)
      })
      g.get = function (a) {
        if (e && e.length >= a + 1) return e[a]
      }
      a.each(r, function (b) {
        'function' === typeof a[b] &&
          (g[b] = function () {
            var c = [].slice.call(arguments)
            c.unshift(e)
            return a[b].apply(g, c)
          })
      })
      var k = d(c[0])
      return a.reduce(
        k,
        function (g, f) {
          if (0 > a.indexOfArray(m, f)) {
            var e = b(c, f)
            e && (g[f] = e)
          }
          return g
        },
        g,
      )
    }
    function l(b) {
      return a.isArray(b) && 1 < b.length ? g(b) : e(a.isArray(b) ? b[0] : b)
    }
    var r = ['each', 'map', 'reduce', 'filter'],
      m = ['getState', 'isDisabled', 'isError', 'isHidden', 'getNativeElement']
    return { create: l }
  })
  ;('use strict')
  d.when(
    'A',
    'prv:a-form-control-proxy',
    'a-text-input',
    'a-form-radio-button',
    'a-form-textarea',
    'a-form-checkbox',
    'a-form-multiselect',
  ).register('a-form', function (a, c, b, k, e, g, l) {
    function r(a, b) {
      a.is('input,select,textarea') || (a = a.find('input,select,textarea').first())
      return b && 'function' === typeof b ? b(a) : null
    }
    function m(a) {
      return function (b, c) {
        return u(this, b, c, a)
      }
    }
    function n(b, c) {
      for (var g = a.keys(c || {}), e = 0; e < g.length; e++) {
        var f = g[e],
          d = c[f]
        f = b.$el.find('[name\x3d"' + a.escapeJquerySelector(f) + '"]')
        f.length &&
          (f.is('select[multiple]') ||
          (1 < f.length && f.is('[type\x3dcheckbox]')) ||
          (1 < f.length && f.is('[type\x3dradio]'))
            ? f.val([].concat(d))
            : a.isArray(d) && f.length === d.length
              ? f.val(function (a) {
                  return d[a]
                })
              : f.val(d))
      }
    }
    function q(b) {
      b = b.$el.serializeArray()
      return a.reduce(
        b,
        function (b, c) {
          b.hasOwnProperty(c.name)
            ? (a.isArray(b[c.name]) || (b[c.name] = [b[c.name]]), b[c.name].push(c.value))
            : (b[c.name] = c.value)
          return b
        },
        {},
      )
    }
    function u(b, g, e, d) {
      var f = b.$el
      b = p(g, f)
      if (!b || !b.length) return null
      e
        ? ((e = a.reduce(
            b,
            function (b, c) {
              if ((c = r(p(c), d)) && !c.jquery) {
                var g = c.getNativeElement().name,
                  e = c.specs.tag
                b.hasOwnProperty(g) ||
                  ((e = p(e + ('[name\x3d"' + a.escapeJquerySelector(g) + '"]'), f)),
                  (b[g] = 1 < e.length ? r(e, d) : c))
              }
              return b
            },
            {},
          )),
          (e = a.values(e)))
        : (e = a.map(b, function (a) {
            return r(p(a), d)
          }))
      return c.create(e)
    }
    var p = a.$,
      v = a.createClass({
        init: function (b) {
          b = p(b)
          b.is('form') ? a.constProp(this, '$el', b) : a.constProp(this, '$el', b.closest('form'))
          ;(this.$el && this.$el.length) ||
            d.error(
              'The selector does not resolve back to a form',
              'AmazonUIFormControlsJS',
              'Form',
            )
        },
        getTextInput: m(b),
        getRadioButton: m(k),
        getTextArea: m(e),
        getCheckbox: m(g),
        getMultiSelect: m(l),
        val: function (a) {
          if (p.isPlainObject(a)) n(this, a)
          else return q(this)
        },
        reset: function () {
          this.$el[0].reset()
        },
      })
    return function (a) {
      return new v(a)
    }
  })
  ;('use strict')
  d.when('A', 'prv:a-base-form-control-specs', 'prv:a-text-input-specs-overrides').register(
    'prv:a-text-input-specs',
    function (a, c, b) {
      return new (c.extend(
        a.extend(
          {
            tag: 'input',
            attrs: {
              type: 'text color date datetime datetime-local email month number password search tel time url week'.split(
                ' ',
              ),
            },
            wrapperElementSelector: '.a-input-text-addon-group-wrapper',
            applicableStates: ['normal', 'disabled', 'error', 'inactive', 'selected'],
            interfaces: [
              'stateTransitionableControl',
              'typeableControl',
              'focusableControl',
              'tooltipableControl',
            ],
            mixins: ['show', 'hide', 'isHidden', 'val'],
          },
          b,
        ),
      ))()
    },
  )
  ;('use strict')
  d.declare('prv:a-text-input-specs-overrides', { attrs: { cssClass: 'a-input-text' } })
  ;('use strict')
  d.when('A', 'a-form-control', 'prv:a-text-input-specs').register(
    'a-text-input',
    function (a, c, b) {
      var d = c.create({
        _componentName: 'form_TextInput',
        specs: b,
        init: function (a, b) {
          this._super(a, b)
        },
      })
      return function (a, b) {
        return new d(a, b)
      }
    },
  )
  ;('use strict')
  d.when('A', 'prv:a-base-form-control-specs', 'prv:a-form-textarea-specs-overrides').register(
    'prv:a-form-textarea-specs',
    function (a, c, b) {
      return new (c.extend(
        a.extend(
          {
            tag: 'textarea',
            applicableStates: ['normal', 'disabled', 'error', 'inactive', 'selected'],
            interfaces: ['stateTransitionableControl', 'typeableControl', 'focusableControl'],
            wrapperElementSelector: '.a-input-text-wrapper',
            mixins: ['show', 'hide', 'isHidden', 'val'],
          },
          b,
        ),
      ))()
    },
  )
  ;('use strict')
  d.declare('prv:a-form-textarea-specs-overrides', {})
  ;('use strict')
  d.when('A', 'a-form-control', 'prv:a-form-textarea-specs').register(
    'a-form-textarea',
    function (a, c, b) {
      var d = c.create({
        _componentName: 'form_TextArea',
        specs: b,
        init: function (a, b) {
          this._super(a, b)
        },
      })
      return function (a, b) {
        return new d(a, b)
      }
    },
  )
  ;('use strict')
  d.when('A', 'prv:a-base-form-control-specs', 'prv:a-form-radio-button-specs-overrides').register(
    'prv:a-form-radio-button-specs',
    function (a, c, b) {
      return new (c.extend(
        a.extend(
          {
            tag: 'input',
            attrs: { type: 'radio' },
            visualElementSelector: '.a-radio',
            applicableStates: ['normal', 'disabled', 'error', 'inactive', 'selected'],
            mixins: ['show', 'hide', 'isHidden'],
            interfaces: [
              'checkableControl',
              'focusableControl',
              'tooltipableControl',
              'stateTransitionableControl',
            ],
          },
          b,
        ),
      ))()
    },
  )
  ;('use strict')
  d.declare('prv:a-form-radio-button-specs-overrides', {
    formStates: {
      disabled: {
        enterState: function (a) {
          a.prop('disabled', !0)
        },
        exitState: function (a) {
          a.prop('disabled', !1)
        },
        match: function (a) {
          return a.prop('disabled')
        },
      },
    },
  })
  ;('use strict')
  d.when('A', 'a-form-control', 'prv:a-form-radio-button-specs').register(
    'a-form-radio-button',
    function (a, c, b) {
      var d = c.create({
        _componentName: 'form_RadioButton',
        specs: b,
        init: function (a, b) {
          this._super(a, b)
        },
        val: function (a, b) {
          if (a)
            this._$coreElement.val(1 < this._$coreElement.length ? [a] : a),
              b || this.trigger('change')
          else
            return 1 < this._$coreElement.length
              ? this._$coreElement.filter(':checked').val()
              : this._$coreElement.val()
        },
      })
      return function (a, b) {
        return new d(a, b)
      }
    },
  )
  ;('use strict')
  d.when('A', 'prv:a-base-form-control-specs', 'prv:a-form-checkbox-specs-overrides').register(
    'prv:a-form-checkbox-specs',
    function (a, c, b) {
      return new (c.extend(
        a.extend(
          {
            tag: 'input',
            attrs: { type: 'checkbox' },
            visualElementSelector: '.a-checkbox',
            applicableStates: ['normal', 'disabled', 'error', 'inactive'],
            mixins: ['show', 'hide', 'isHidden', 'val'],
            interfaces: [
              'checkableControl',
              'focusableControl',
              'tooltipableControl',
              'stateTransitionableControl',
            ],
          },
          b,
        ),
      ))()
    },
  )
  ;('use strict')
  d.declare('prv:a-form-checkbox-specs-overrides', {
    formStates: {
      disabled: {
        enterState: function (a) {
          a.prop('disabled', !0)
        },
        exitState: function (a) {
          a.prop('disabled', !1)
        },
        match: function (a) {
          return a.prop('disabled')
        },
      },
    },
  })
  ;('use strict')
  d.when('A', 'a-form-control', 'prv:a-form-checkbox-specs').register(
    'a-form-checkbox',
    function (a, c, b) {
      var d = c.create({
        _componentName: 'form_Checkbox',
        specs: b,
        init: function (a, b) {
          this._super(a, b)
        },
      })
      return function (a, b) {
        return new d(a, b)
      }
    },
  )
  ;('use strict')
  d.when('A', 'prv:a-base-form-control-specs').register(
    'prv:a-form-multiselect-specs',
    function (a, c) {
      return new (c.extend({
        tag: 'select',
        attrs: { cssClass: 'a-select-multiple' },
        formStates: {
          disabled: {
            enterState: function (a) {
              a.prop('disabled', !0)
            },
            exitState: function (a) {
              a.prop('disabled', !1)
            },
            match: function (a) {
              return a.prop('disabled')
            },
          },
        },
        applicableStates: ['normal', 'disabled'],
        interfaces: ['focusableControl', 'selectableControl', 'stateTransitionableControl'],
        mixins: ['show', 'hide', 'isHidden'],
      }))()
    },
  )
  ;('use strict')
  d.when('A', 'a-form-control', 'prv:a-form-multiselect-specs').register(
    'a-form-multiselect',
    function (a, c, b) {
      var d = a.constants.NOOP,
        e = c.create({
          _componentName: 'form_MultiSelect',
          specs: b,
          init: function (b, c) {
            this._super(b, c)
            this.options = { $select: this._$coreElement, $button: a.$([]) }
          },
          val: function (b, c) {
            var d = this._$coreElement,
              e = d.val()
            if (b)
              (b = a.isArray(b) ? b : [b]),
                a.equals(e, b) || (d.val(b), c || this.trigger('change'))
            else return e
          },
          hidePopover: d,
          refreshPopover: d,
        })
      return function (a, b) {
        return new e(a, b)
      }
    },
  )
})
/* ******** */
;(function (e) {
  var f = window.AmazonUIPageJS || window.P,
    g = f._namespace || f.attributeErrors,
    d = g ? g('DetailPageVSXOffersAssets', '') : f
  d.guardFatal
    ? d.guardFatal(e)(d, window)
    : d.execute(function () {
        e(d, window)
      })
})(function (e, f, g) {
  e.when('A', 'atf').register('vsx-offers-constants', function (d) {
    return {
      ACTIVE_CLASS: 'a-active',
      A_DECLARATIVE_SELECTOR: '.a-declarative',
      ASIN: 'asin',
      CATEGORY_CARDS_SELECTOR: '.category_cards',
      CTI_CEPC: 'Amazon.in/Category Expansion/CE-PC',
      CC_CARD_VSX_OFFERS_SELECTOR: '.cc-card-vsxoffers',
      VSX_NLP_DIV_SELECTOR: '.vsx_offers_nlp',
      DISPLAY_PROPERTY: 'display',
      EMI_CREDIT_NCE_NOT_AVAILABLE: '.inemi-credit-nce-not-available',
      EMI_CREDIT_STANDARD_PLANS_TABLE_TITLE: '.inemi-credit-standard-plans-table-title',
      EMI_CREDIT_TOGGLE_SWITCH: '#credit-toggle-switch',
      EMI_DEBIT_NCE_NOT_AVAILABLE: '.inemi-debit-nce-not-available',
      EMI_DEBIT_STANDARD_PLANS_TABLE_TITLE: '.inemi-debit-standard-plans-table-title',
      EMI_DEBIT_TOGGLE_SWITCH: '#debit-toggle-switch',
      INPUT: ' input',
      EMI_LIST_VIEW_ITEMS: '.emi-list-view-items',
      EMI_NCE_NOT_AVAILABLE_NOTE_CREDIT_EMI: '.inemi-nce-not-available-note-credit-emi',
      EMI_NCE_NOT_AVAILABLE_NOTE_DEBIT_EMI: '.inemi-nce-not-available-note-debit-emi',
      EMI_POPOVER_PRELOAD: '#a-popover-preLoad',
      EMI_STANDARD_PLANS_CREDIT: '.inemi-standard-plans-credit',
      EMI_STANDARD_PLANS_DEBIT: '.inemi-standard-plans-debit',
      EMI_TAB: '-emi-tab',
      EMI_TAB_AMAZON: 'amazon-pay',
      EMI_TAB_CREDIT: 'credit',
      EMI_TAB_DEBIT: 'debit',
      EMI_TYPE: 'emitype',
      EMI_TYPE_AMAZON_CREDIT: 'AmazonCredit',
      EMI_TYPE_CREDIT_CARD: 'CreditCard',
      EMI_TYPE_DEBIT_CARD: 'DebitCard',
      ERROR_LOG_LEVEL: 'ERROR',
      EVENT_CLICK: 'click',
      EVENT_POPOVER_AfTER_SHOW: 'a:popover:afterShow:',
      EVENT_POPOVER_AJAX_CONTENT_LOADED: 'a:popover:ajaxContentLoaded:',
      EVENT_POPOVER_AJAX_FAILED: 'a:popover:ajaxFail:',
      EXPANDER_AJAX_ERROR: 'EXPANDER_AJAX_ERROR',
      EXPANDER_FETCH_ERROR: 'Error fetching the details. Try again later',
      EXPANDER_STATUS_CODE_ERROR: 'EXPANDER_STATUS_CODE_ERROR',
      HERES_HOW_EXAPANDER: 'heres_how_expander',
      HERES_HOW_EXAPANDER_BODY: '.heres-how-expander-body',
      HERES_HOW_EXAPANDER_HEAD: '.heres-how-expander-head',
      ICART_OFFER_BOX: '#itembox-iCart',
      IN_EMI: '#inemi-',
      INHERIT_DISPLAY_PROPERTY: 'inherit',
      NCEMI_TYPE_SELECTOR: '#vsx__ncemi-type',
      NCEMI_ERROR_CONTAINER_SELECTOR: '#vsx__ncemi-error-container',
      NCEMI_ERROR_CONTENT_SELECTOR: '#vsx__ncemi-error-content',
      NCEMI_FETCH_ERROR: 'NCEMI_FETCH_ERROR ',
      NCEMI_ID_NOT_FOUND: 'NCEMI_ID_NOT_FOUND',
      NCEMI_STATUS_CODE_ERROR: 'NCEMI_STATUS_CODE_ERROR',
      NCEMI_TREATMENT_T1: '#ncemi-treatment-t1',
      NOCOST_EMI_FEATURES_PARAM: 'inPriceBlockEmi-secondaryviews,inemi',
      NOCOST_EMI_REQUEST_ENDPOINT: '/gp/product/ajax',
      NOCOST_EMI_EXPERIENCE_ID: 'emiMenueSVAjaxExperience',
      NOCOST_EMI_SECONDARY_VIEW: '#vsxoffers-emi-secondary-view',
      OFFER_URL: 'url',
      REFTAG_OFFER_SUFFIX: '_click',
      REFTAG_PREFIX: 'tp_cc_vsx_offers_',
      REFTAG_URL: '/hctp/log/refMarker?ref_\x3d',
      REFTAG_PREFIX_DESKTOP: 'tp_desktop_cc_vsx_offers_',
      REQUEST_ACCEPT_TEXT_HTML: 'text/html, charset:utf-8',
      REQUEST_METHOD_GET: 'get',
      VSX_OFFERS_FEATURE_NAME: 'vsxoffers',
      VSX_OFFERS_ITEMS_CONTENT: '.offers-items-content',
      VSX_OFFERS_ITEMS_CONTENT_LINK: 'vsx__offers-items-content-a',
      VSX_OFFER_SIMPLE_CARD_CLICKED_ACTION: 'vsxOfferSimpleCardClickedAction',
      OFFERS_CARD_ICON: '.vsx__offers-holder .headings-icon .a-image-wrapper',
      VSX_OFFERS_MAINVIEW_ITEMS_CONTENT: '.vsx__offers-mainview-item-content',
      ATTRIBUTE_ONCLICK: 'onclick',
      REFTAG_VSX_PSP_PREFIX: 'vsx_psp_',
      VSX_ICART_PSP_REDIRECT: 'icart-psp-redirect',
      OFFER_ID: 'offerid',
      TWISTER_PLUS_SIDE_SHEET_CONTENT_SELECTOR: '#twister-plus-side-sheet-content',
      VSX_OFFERS_CAROUSEL: 'vsx-offers-carousel',
      OFFER_CATEGORY_SELECTOR: '.offer_category',
      OFFERS_MOD_CARD_DECK: '.cc-card-vsxoffers .offersConsistencyEnabled',
      OFFERS_MOD_CARD_DECK_DESKTOP: '.vsxoffers_desktop_feature .offersConsistencyEnabled',
      OFFER_TYPE_NOCOSTEMI: 'NoCostEmi',
      OFFER_TYPE_PARTNER: 'Partner',
      OFFER_TYPE_CASHBACK: 'GCCashback',
      OFFER_TYPE_ICART: 'iCart',
      OFFER_TYPE_BANK: 'InstantBankDiscount',
      OFFER_TYPE_CARD_VIEW: 'cardView',
      AUI_HIDE_CLASS: 'aok-hidden',
      AUI_EXPANDER: 'a:expander:',
      AUI_EXPANDER_EXPAND: ':toggle:expand',
      AUI_EXPANDER_COLLAPSE: ':toggle:collapse',
      OFFERS_EXPANDER: 'vsx-offers-expander-header',
      OFFERS_CONTENT_SELECTOR: '.vsx__commons .a-expander-container .offers-expander-content',
      OFFERS_EXPANDER_ICON_SELECTOR: '.vsx__commons .a-expander-container .offers-header .a-icon',
      DATA_EXPANDED: 'data-expanded',
      EXPANDER_CONTENT_EXPANDED_CLASS: 'a-expander-content-expanded',
      EXPANDER_CONTENT_COLLAPSED_STYLE: 'overflow: hidden; display: none;',
      EXPANDER_ICON_COLLAPSE_CLASS: 'a-icon-section-collapse',
      EXPANDER_ICON_EXPAND_CLASS: 'a-icon-section-expand',
      FALSE: 'false',
      STYLE: 'style',
      OFFERS_EXPANDED: 'offers-expanded',
      csmCountMetrics: {
        METRIC_PREFIX: 'VSXOffers:',
        METRIC_TYPE_ERROR: 'Error:',
        METRIC_TYPE_SUCCESS: 'Success:',
        AJAX_FAILURE: 'AjaxFailure',
        SECONDARY_SIDE_SHEET: 'SecSideSheet:',
        PRIMARY_SIDE_SHEET: 'PrimarySideSheet',
        PRIMARY_POPOVER_VIEW: 'PrimaryPopOverView',
        SECONDARY_POPOVER_VIEW: 'SecondaryPopOverView',
        COLON: ':',
        OFFERS_CARD_COLLAPSE: 'CardCollapse',
        OFFERS_CARD_EXPAND: 'CardExpand',
        NLP_DETAIL_CLICK: 'NLPDetailClick',
        NLP_REFRESH: 'NLPRefresh',
        NLP_SELECT: 'NLPCardSelect',
        NLP_SEE_ALL_EMI: 'NLPSeeAllEmi',
        NLP_SEE_ALL_OFFERS: 'NLPSeeAllOffers',
        NLP_FETCH_GXA_DATA: 'FetchNlpGxaData',
        NLP_COMBO_CARD: 'combocard',
      },
      AJAX_VSX_DATA_SELECTOR: '#vsx__offer-data',
      DESKTOP_DEVICE_TYPE: 'web',
      MOBILE_DEVICE_TYPE: 'mobile',
      VSX_OFFERS_GXA_ENDPOINT: '/gp/product/ajax',
      GXA_EXPERIENCE_ID: 'vsxOffersSecondaryView',
      GXA_FEATURES: 'vsxoffers',
      AJAX_DEFAULT_FALLBACK_MESSAGE: 'Sorry, content is not available.',
      AJAX_ERROR_MESSAGE_SELECTOR: 'ajaxerrormessage',
      BUYING_OPTION_INDEX: 'buyingoptionindex',
      SMID: 'smid',
      ENCRYPTED_MERCHANT_ID: 'encryptedmerchantid',
      SR: 'sr',
      QUERY_ARGS: 'query-args',
      NONE: 'none',
      POUND: '#',
      NORMAL: 'normal',
      TRUE: 'true',
      NOCOSTEMI: 'NoCostEmi',
      _MAIN_CONTAINER: '_main_container',
      AUI_SPACING_NONE: 'a-spacing-none',
      SECONDARY_PAGE: 'secondaryPage',
      EMI_TABLE_CLASS: '.emi_table_card_deck',
      AUI_PADDING_NONE: 'a-padding-none',
      AUI_PADDING_BASE: 'a-padding-base',
      SPACE: ' ',
      SEE_MORE_LINK_CLASS: '.see_more_link',
      AUI_BTN_FOCUS_CLASS: 'a-button-focus',
      AUI_TAB_BTN_CLASS: '.vsx_tab_btn',
      VSX_TAB_LI_PREFIX: '#vsx_tab_offer_li_',
      NEAREST: 'nearest',
      SCROLL: 'scroll',
      OFFER_CATEGORY_TOGGLE_GROUP_ID: '#tab_btn_group',
      EMI_CREDIT_TAB_ID: '#inemi-credit-emi-tab',
      EMI_DEBIT_TAB_ID: '#inemi-debit-emi-tab',
      EMI_APAY_TAB_ID: '#inemi-amazon-pay-emi-tab',
      SECONDARY_VIEW: 'secondaryView',
      TNC_MESSAGE_SELECTOR: '.offer_messages .message a',
      EMI_SECONDARY_VIEW_NAME: 'emiSecondaryView',
      SEE_ALL_EMI_LINK_SELECTOR: '.see_all_emi_offers .see_all_link a',
      COMMON_OFFER_BOTTOMSHEET_ACTION: 'common-offer-bottomsheet-item-clicked-action',
      BANK_OFFER_BOTTOMSHEET_ACTION: 'bank-offer-bottomsheet-item-clicked-action',
      SIMPLE_CARD_CLICKED_ACTION: 'vsx-offer-simple-card-clicked-action',
      LOGO_CARD_CLICKED_ACTION: 'vsx-offer-logo-card-clicked-action',
      SHOW_LIST_VIEW_ACTION: 'show-list-view-action',
      OFFER_CARD_SCROLLER_ID: '#offer_cards_scroller',
      LAST_OFFER_CARD_SELECTOR: '.offer_card:last',
      SEE_ALL_LINKS_SECTION_ID: '#see_all_links',
      TAB_BTN_TOGGLE_EVENT: 'a:button-group:tab_btn_group:toggle',
      REUSABLE_SPINNER_ID: '#offersv2-reusable-spinner',
      EMI_PLAN_SECONDARY_VIEW_ID: '#emiPlansSecondaryView',
      AUI_PAGE_UPDATE_EVENT: 'a:pageUpdate',
      LOGO_CARD_PREFIX: 'logo_card_',
      SIMPLE_CARD_PREFIX: 'simple_card_',
      CLICK_METRIC_PREFIX: 'tp_cc_vsx_offersv2_',
      CLICK_METRIC_SUFFIX: '_click',
      METRIC_BANK_OFFER: 'bankoffer_',
      BOTTOMSHEET_PREFIX: 'bs',
      SEE_ALL_INGRESS_PREFIX: '_see_all',
      SEE_MORE_INGRESS_PREFIX: '_see_more',
      UNDERSCORE: '_',
      IBD: 'InstantBankDiscount',
      BANK_OFFER_TNC: 'bankoffer_tnc',
      INLINE: 'inline',
      BOTTOMSHEET_AFTER_SHOW_EVENT: 'a:sheet:afterShow:',
      SHOW_COMBINED_LIST_VIEW_ACTION: 'show-combined-list-view-action',
      METRIC_COMBINED_LABEL: 'combined',
      AUI_POPOVER_PREFIX: '#a-popover-',
      PADDING_BASE: 'base',
      COMBINED_LIST_VIEW_EXPANDER_EVENT_EXPAND:
        'a:expander:combined_listview_expander:toggle:expand',
      COMBINED_LIST_VIEW_SEE_ALL_CLASS: '.combined_see_all',
      EXPANDER_REFMARKER: 'expander',
      OFFERS_V2_ID: '#vsx_offers_v2',
      OFFER_CATEGORY_CLASS: '#vsx_offers_v2 .offer_category',
      VSX_OFFERS_CATEGORY_CARDS: '.cc-card-vsxoffers',
      VSX_DESKTOP_OFFER_ITEMS: '.vsxoffers_desktop_feature .offers-items',
      VSX_DESKTOP_FEATURE: '.vsxoffers_desktop_feature',
      VSX_OFFER_GLANCE_VIEW_METRIC_PREFIX: 'vsxoffer_gv_',
      VSX_GLANCE_VIEW_METRIC_SUFFIX: '_gv',
      VSX_SESSION_METRIC_SUFFIX: '_session',
      VSX_DESKTOP_OFFER_EXPANDER_CONTENT_SELECTOR: '#vsx-desktop-offer-expander-content-',
      NLP_CARD_SCROLLER: '.nlp_cards_scroller',
      ccManagerInputParams: {
        couponItemType: 'coupons',
        offerItemType: 'offers',
        selectionType: { ADD: 'add', DELETE: 'delete' },
        price: 0,
      },
    }
  })
  ;('use strict')
  e.when('A', 'vsx-offers-constants', 'postMetric', 'atf').register(
    'vsx-offers-utils',
    function (d, a, e) {
      function h(k, b) {
        b ? c(b + ' ' + a.IN_EMI + k + a.EMI_TAB).click() : c(a.IN_EMI + k + a.EMI_TAB).click()
      }
      function g(c) {
        f.ueLogError &&
          f.ueLogError(
            { message: c },
            { logLevel: a.ERROR_LOG_LEVEL, attribution: a.VSX_OFFERS_FEATURE_NAME },
          )
      }
      var c = d.$
      return {
        logError: g,
        registerRefTag: function (d) {
          c.get(a.REFTAG_URL + d)
        },
        onEmiAjaxSuccess: function (d, b) {
          b = b ? b + ' ' : ''
          switch (d) {
            case a.EMI_TYPE_CREDIT_CARD:
              h(a.EMI_TAB_CREDIT, b)
              break
            case a.EMI_TYPE_DEBIT_CARD:
              h(a.EMI_TAB_DEBIT, b)
              break
            case a.EMI_TYPE_AMAZON_CREDIT:
              h(a.EMI_TAB_AMAZON, b)
              break
            default:
              h(a.EMI_TAB_CREDIT, b)
          }
          c(b + ' ' + a.EMI_POPOVER_PRELOAD) &&
          c(b + ' ' + a.EMI_DEBIT_TOGGLE_SWITCH) &&
          c(b + ' ' + a.EMI_CREDIT_TOGGLE_SWITCH)
            ? (c(b + ' ' + a.EMI_POPOVER_PRELOAD).show(),
              c(b + ' ' + a.EMI_DEBIT_TOGGLE_SWITCH).addClass(a.ACTIVE_CLASS),
              c(b + ' ' + a.EMI_DEBIT_NCE_NOT_AVAILABLE).hide(),
              c(b + ' ' + a.EMI_STANDARD_PLANS_DEBIT).hide(),
              c(b + ' ' + a.EMI_DEBIT_STANDARD_PLANS_TABLE_TITLE).hide(),
              c(b + ' ' + a.EMI_NCE_NOT_AVAILABLE_NOTE_DEBIT_EMI) &&
                c(b + ' ' + a.EMI_NCE_NOT_AVAILABLE_NOTE_DEBIT_EMI).css(
                  a.DISPLAY_PROPERTY,
                  a.INHERIT_DISPLAY_PROPERTY,
                ),
              c(b + ' ' + a.EMI_CREDIT_TOGGLE_SWITCH).addClass(a.ACTIVE_CLASS),
              c(b + ' ' + a.EMI_CREDIT_NCE_NOT_AVAILABLE).hide(),
              c(b + ' ' + a.EMI_STANDARD_PLANS_CREDIT).hide(),
              c(b + ' ' + a.EMI_CREDIT_STANDARD_PLANS_TABLE_TITLE).hide(),
              c(b + ' ' + a.EMI_NCE_NOT_AVAILABLE_NOTE_CREDIT_EMI) &&
                c(b + ' ' + a.EMI_NCE_NOT_AVAILABLE_NOTE_CREDIT_EMI).css(
                  a.DISPLAY_PROPERTY,
                  a.INHERIT_DISPLAY_PROPERTY,
                ),
              c(b + ' ' + a.NCEMI_TREATMENT_T1).show())
            : (g(a.NCEMI_ID_NOT_FOUND), c(b + ' ' + a.NOCOST_EMI_SECONDARY_VIEW).show())
        },
        logCountMetric: function (c, b) {
          e.postCountMetric(a.csmCountMetrics.METRIC_PREFIX + b + c)
        },
      }
    },
  )
})
/* ******** */
;(function (c) {
  var b = window.AmazonUIPageJS || window.P,
    d = b._namespace || b.attributeErrors,
    a = d ? d('DetailPageFreebiesAssets', '') : b
  a.guardFatal
    ? a.guardFatal(c)(a, window)
    : a.execute(function () {
        c(a, window)
      })
})(function (c, b, d) {})
/* ******** */
;(function (m) {
  var n = window.AmazonUIPageJS || window.P,
    q = n._namespace || n.attributeErrors,
    a = q ? q('DetailPageOfferDisplayFeatureCommonAssets', '') : n
  a.guardFatal
    ? a.guardFatal(m)(a, window)
    : a.execute(function () {
        m(a, window)
      })
})(function (m, n, q) {
  m.when('A', 'odf-metric-utils').register('progressive-display-utils', function (a, d) {
    function f(b, e) {
      h('.offer-display-features-expander').each(function (c, a) {
        c = h(a)
        a = c.find('.a-expander-header.odf-expander-heading')
        if (a.is(':visible')) {
          var g = c.attr('data-a-expander-collapsed-height')
          if ('undefined' === typeof g || !1 === g || !0 === e) {
            var f = c.find('.offer-display-features-container').attr('displayable-row-count'),
              r = a.height() + 4 + 6
            c.find('.offer-display-feature-label').each(function (b, c) {
              if (b >= parseInt(f)) return !1
              r += h(c).outerHeight(!0)
            })
            c.attr('data-a-expander-collapsed-height', r)
            0 < c.find('div[data-expanded\x3d"false"]').length &&
              (c.height(r), c.find('.a-expander-content-fade').remove())
            d.publishCountMetrics(b + 'ProgressiveDisplayHeightSet')
          }
          d.publishCountMetrics(b + 'ProgressiveDisplayAvailable')
        } else d.publishCountMetrics(b + 'ProgressiveDisplayNotAvailable')
      })
    }
    function l(b) {
      h('.offer-display-features-expander').each(function (e, c) {
        e = h(c)
        c = e.find('.offer-display-features-container').attr('displayable-row-count')
        var a = e
          .find('.offer-display-feature-label')
          .not('.show-more .offer-display-feature-label').length
        'undefined' !== typeof c && a <= c
          ? ((c = e.find('.offer-display-features-show-more')),
            c.length && c[0].classList.remove('a-spacing-small'),
            (c = e.find('.a-expander-header.odf-expander-heading')),
            c.length && c[0].classList.add('aok-hidden'),
            (e = e.find('.show-more')),
            0 < e.length && e.find('.offer-display-feature-label')[0].classList.add('aok-hidden'),
            d.publishCountMetrics(b + 'ProgressiveDisplayHidden'))
          : 'undefined' !== typeof c && g(e)
      })
    }
    function k(b) {
      var e = 0
      h('.offer-display-dynamic-features').each(function (b, a) {
        a.classList.remove('aok-hidden')
        e += 1
      })
      d.publishCountMetrics(b + 'UnHidingDynamicFeatures', e)
    }
    function p(b) {
      h('.collapsed-offer-display-features').each(function (e, c) {
        e = h(c)
        var a = e.find('.offer-display-features-container').attr('displayable-row-count')
        c = e.find('.offer-display-feature-label').length
        'undefined' !== typeof a &&
          c > a &&
          (e.find('.offer-display-feature-label').each(function (b, c) {
            b >= a && h(c).parent()[0].classList.add('aok-hidden')
          }),
          d.publishCountMetrics(b + 'FeaturesHiddenInCollapsedAccordion', c - a))
      })
    }
    function g(b) {
      var a = b.find('.offer-display-features-container').attr('displayable-row-count')
      'undefined' !== typeof a &&
        b.find('.offer-display-feature-label').each(function (b, e) {
          b >= a && h(e).parent()[0].classList.add('aok-hidden')
        })
    }
    function t(b, a) {
      b = d.buildMetricPrefix(b, a)
      k(b)
      l(b)
      f(b, !1)
      p(b)
    }
    var h = a.$
    return {
      initializeAndSetEventListeners: function (b) {
        t(b, 'pageLoad')
        a.on('a:pageUpdate', function () {
          t(b, 'pageUpdate')
        })
        a.on('a:accordion:buybox-accordion:select', function () {
          f(d.buildMetricPrefix(b, 'accordionSelect'), !1)
        })
        a.on('a:tabs:offerDisplayGroup_tabs:select', function () {
          f(d.buildMetricPrefix(b, 'tabSelect'), !1)
        })
        a.on('a:odf:resetHeightForProgressiveFaceOut', function () {
          f(d.buildMetricPrefix(b, 'resetHeightForProgressiveFaceOut'), !0)
        })
      },
      alignOverlappingElements: function (b, a) {
        var c = b.find('.a-expander-header.odf-expander-heading a')[0].getBoundingClientRect(),
          e = b.find('.offer-display-features-show-more a')[0].getBoundingClientRect()
        c = c.right - e.left
        ;-10 <= c &&
          (b.find('.offer-display-features-show-more a').css('paddingLeft', c + 10),
          (b = d.buildMetricPrefix(a)),
          d.publishCountMetrics(b + 'AlignedOverlappingElements'))
      },
      showFeaturesUnderProgressiveDisplay: function (b) {
        var a = b.find('.offer-display-features-container').attr('displayable-row-count')
        'undefined' !== typeof a &&
          b.find('.offer-display-feature-label').each(function (b, e) {
            b >= a && h(e).parent()[0].classList.remove('aok-hidden')
          })
      },
      hideFeaturesUnderProgressiveDisplay: g,
    }
  })
  ;('use strict')
  m.when('A', 'odf-metric-utils').register('truncation-utils', function (a, d) {
    function f(f, p) {
      l('.offer-display-features').each(function (g, k) {
        g = l(k)
        var h = !1
        g.find('.offer-display-feature-text-message').each(function (b, a) {
          b = l(a)
          if (
            b.css('line-clamp') !== (3).toString() &&
            b.css('-webkit-line-clamp') !== (3).toString()
          ) {
            b = l(a)
            var c = b.text()
            b.text('...')
            var e = a.offsetHeight
            b.text(c)
            for (c = !1; a.offsetHeight > 3 * e; )
              (c = !0), b.text(b.text().replace(/\W*\s(\S)*$/, '...'))
            c && (h = !0)
          } else if ((h = a.scrollHeight > a.clientHeight)) return !1
        })
        g = g.find('.offer-display-features-show-more')
        k = d.buildMetricPrefix(f, p)
        h
          ? (a.show(g), d.publishCountMetrics(k + 'ContentTruncated'))
          : (a.hide(g), d.publishCountMetrics(k + 'ContentNotTruncated'))
      })
    }
    var l = a.$
    return {
      setEventsToUpdateTextAndDetailsLinkVisibility: function (d) {
        f(d, 'pageLoad')
        if ('Mobile' === d)
          a.on(a.constants.BROWSER_EVENTS.RESIZE, function () {
            f(d, 'pageResize')
          })
        a.on('a:accordion:buybox-accordion:select', function () {
          f(d, 'accordionSelect')
        })
        a.on('a:tabs:offerDisplayGroup_tabs:select', function () {
          f(d, 'tabSelect')
        })
        a.on('a:pageUpdate', function () {
          f(d, 'pageUpdate')
        })
      },
    }
  })
  ;('use strict')
  m.when('A').register('copy-odf-content-utils', function (a) {
    var d = a.$
    return {
      copyOfferDisplayFeatureContent: function (a, l) {
        a.siblings('#offer-display-features')
          .find(d(l))
          .each(function (f, p) {
            a.append(d(p).children())
          })
      },
    }
  })
  ;('use strict')
  m.when('A').register('odf-metric-utils', function (a) {
    function d(a, d) {
      a = 'ODF.' + a + '.'
      d && (a += d + '.')
      return a
    }
    function f(a, d) {
      k && k.count && k.count(a, d ? d : 1)
    }
    var l = a.$,
      k = n.ue
    return {
      buildMetricPrefix: d,
      publishCountMetrics: f,
      publishFeatureLevelMetrics: function (a) {
        l('.offer-display-features')
          .find('.offer-display-feature-label')
          .not('.show-more .offer-display-feature-label')
          .each(function (g, k) {
            g = l(k).attr('offer-display-feature-name')
            g = d(a) + g + '.Display'
            f(g)
          })
      },
    }
  })
})
/* ******** */
;(function (c) {
  var e = window.AmazonUIPageJS || window.P,
    g = e._namespace || e.attributeErrors,
    b = g ? g('DetailPageOfferDisplayFeatureDesktopAssets', '') : e
  b.guardFatal
    ? b.guardFatal(c)(b, window)
    : b.execute(function () {
        c(b, window)
      })
})(function (c, e, g) {
  c.when('A', 'truncation-utils', 'copy-odf-content-utils', 'odf-metric-utils').execute(
    'show-offer-display-features-side-sheet',
    function (b, h, c, a) {
      var f = b.$
      f('#offer-display-features-side-sheet-content a').attr('target', '_blank')
      f('#offer-display-features #sellerProfileTriggerId').click(function () {
        a.publishCountMetrics(a.buildMetricPrefix('Desktop') + 'SellerProfileTriggerIdClicked')
      })
      b.declarative('close-offer-display-features-side-sheet', 'click', function (d) {
        function c(a) {
          a.siblings('#offer-display-features-side-sheet-content').show(function () {
            f(this).removeClass('offer-display-features-side-sheet-content-display')
          })
        }
        ;(function (a) {
          c(a)
          b.hide(a.find('#offer-display-features-background'))
        })(f(d && d.$currentTarget && d.$currentTarget[0]))
        a.publishCountMetrics(a.buildMetricPrefix('Desktop') + 'SideSheetClosed')
      })
      b.declarative('show-offer-display-features-side-sheet', 'click', function (d) {
        function h(a) {
          a.siblings('#offer-display-features-side-sheet-content').show(function () {
            f(this).addClass('offer-display-features-side-sheet-content-display')
          })
        }
        d = f(d && d.$currentTarget && d.$currentTarget[0]).closest('#offer-display-features')
        ;(function (a) {
          a = a.siblings('#offer-display-features-side-sheet-content')
          0 === a[0].children.length &&
            c.copyOfferDisplayFeatureContent(a, '.offer-display-feature-side-sheet')
        })(d)
        ;(function (a) {
          var f = a
            .siblings('[data-action\x3d"close-offer-display-features-side-sheet"]')
            .find('#offer-display-features-background')
          b.show(f)
          h(a)
        })(d)
        a.publishCountMetrics(a.buildMetricPrefix('Desktop') + 'SideSheetOpened')
      })
      h.setEventsToUpdateTextAndDetailsLinkVisibility('Desktop')
    },
  )
  ;('use strict')
  c.when('A', 'progressive-display-utils', 'odf-metric-utils').execute(
    'offer-display-features-expander',
    function (b, c, e) {
      c.initializeAndSetEventListeners('Desktop')
      b.on('a:expander:offer-display-features-expander:toggle:expand', function (a) {
        a = a.expander.$expander
        var b = a.find('.a-expander-header.odf-expander-heading').height()
        a.find('.offer-display-features-show-more').is(':visible')
          ? a.children('.a-row').css('paddingTop', b)
          : a.children('.a-row').css('paddingTop', b + 4)
        c.showFeaturesUnderProgressiveDisplay(a)
        e.publishCountMetrics(e.buildMetricPrefix('Desktop') + 'ProgressiveDisplayExpand')
      })
      b.on('a:expander:offer-display-features-expander:toggle:collapse', function (a) {
        a = a.expander.$expander
        var b = a.attr('data-a-expander-collapsed-height')
        a.children('.a-row').css('paddingTop', '0px')
        a.height(b)
        c.hideFeaturesUnderProgressiveDisplay(a)
        e.publishCountMetrics(e.buildMetricPrefix('Desktop') + 'ProgressiveDisplayCollapse')
      })
    },
  )
  ;('use strict')
  c.when('A', 'odf-metric-utils').execute('publish-feature-metrics', function (b, c) {
    c.publishFeatureLevelMetrics('Desktop')
  })
})
/* ******** */
;(function (b) {
  var c = window.AmazonUIPageJS || window.P,
    d = c._namespace || c.attributeErrors,
    a = d ? d('TurboCheckoutBaseAssets@accessibility_switch', '') : c
  a.guardFatal
    ? a.guardFatal(b)(a, window)
    : a.execute(function () {
        b(a, window)
      })
})(function (b, c, d) {
  b.when('turbo-initiate-migration-switch').register(
    'turbo-checkout-accessibility-switch',
    function (a) {
      return {
        isEnabled: function () {
          return a.isEnabled()
        },
      }
    },
  )
})
/* ******** */
;(function (a) {
  var b = window.AmazonUIPageJS || window.P,
    d = b._namespace || b.attributeErrors,
    c = d ? d('TurboCheckoutBaseAssets@buy_now_to_tango_switch', '') : b
  c.guardFatal
    ? c.guardFatal(a)(c, window)
    : c.execute(function () {
        a(c, window)
      })
})(function (a, b, d) {
  a.when(
    'turbo-configuration',
    'buy-now-to-tango-switch-mobile',
    'buy-now-to-tango-switch-desktop',
    'buy-now-to-tango-switch-beta',
  ).register('buy-now-to-tango-switch', function (c, a, b, d) {
    return {
      isEnabled: function () {
        return (
          c.get(c.KEYS.IS_BUY_NOW_TO_TANGO_ENABLED) &&
          (a.isGatingWeblabEnabled() || b.isGatingWeblabEnabled() || d.isGatingWeblabEnabled())
        )
      },
    }
  })
  ;('use strict')
  a.when('turbo-checkout-page-ready').register('buy-now-to-tango-switch-mobile', function () {
    return {
      isGatingWeblabEnabled: function () {
        return !1
      },
    }
  })
  ;('use strict')
  a.when(
    'buy-now-to-tango-switch-desktop-prime',
    'buy-now-to-tango-switch-desktop-non-prime',
  ).register('buy-now-to-tango-switch-desktop', function (a, b) {
    return {
      isGatingWeblabEnabled: function () {
        return a.isGatingWeblabEnabled() || b.isGatingWeblabEnabled()
      },
    }
  })
  ;('use strict')
  a.when('turbo-checkout-page-ready').register(
    'buy-now-to-tango-switch-desktop-prime',
    function () {
      return {
        isGatingWeblabEnabled: function () {
          return !1
        },
      }
    },
  )
  ;('use strict')
  a.when('turbo-checkout-page-ready').register(
    'buy-now-to-tango-switch-desktop-non-prime',
    function () {
      return {
        isGatingWeblabEnabled: function () {
          return !1
        },
      }
    },
  )
  ;('use strict')
  a.when('turbo-checkout-page-ready').register('buy-now-to-tango-switch-beta', function () {
    return {
      isGatingWeblabEnabled: function () {
        return !1
      },
    }
  })
})
/* ******** */
;(function (a) {
  var c = window.AmazonUIPageJS || window.P,
    d = c._namespace || c.attributeErrors,
    b = d ? d('TurboCheckoutBaseAssets@chewbacca_migration_switch', '') : c
  b.guardFatal
    ? b.guardFatal(a)(b, window)
    : b.execute(function () {
        a(b, window)
      })
})(function (a, c, d) {
  a.when('turbo-checkout-state-handler').register(
    'turbo-chewbacca-migration-switch-non-prime-desktop',
    function (b) {
      return {
        isGatingWeblabEnabled: function () {
          return !1
        },
        isShadowModeEnabled: function () {
          return !1
        },
      }
    },
  )
  ;('use strict')
  a.when('turbo-checkout-state-handler').register(
    'turbo-chewbacca-migration-switch-prime-desktop',
    function (b) {
      return {
        isGatingWeblabEnabled: function () {
          !1
        },
        isShadowModeEnabled: function () {
          return !1
        },
      }
    },
  )
  ;('use strict')
  a.when('turbo-checkout-state-handler').register(
    'turbo-chewbacca-migration-switch-non-prime-mobile',
    function (b) {
      return {
        isGatingWeblabEnabled: function () {
          return !1
        },
        isShadowModeEnabled: function () {
          return !1
        },
      }
    },
  )
  ;('use strict')
  a.when('turbo-checkout-state-handler').register(
    'turbo-chewbacca-migration-switch-prime-mobile',
    function (b) {
      return {
        isGatingWeblabEnabled: function () {
          return !1
        },
        isShadowModeEnabled: function () {
          return !1
        },
      }
    },
  )
  ;('use strict')
  a.when(
    'turbo-checkout-state-handler',
    'turbo-chewbacca-migration-switch-prime-mobile',
    'turbo-chewbacca-migration-switch-non-prime-mobile',
    'turbo-chewbacca-migration-switch-prime-desktop',
    'turbo-chewbacca-migration-switch-non-prime-desktop',
  ).register('turbo-chewbacca-migration-switch', function (b, a, c, d, e) {
    return {
      isGatingWeblabEnabled: function () {
        return (
          a.isGatingWeblabEnabled() ||
          c.isGatingWeblabEnabled() ||
          d.isGatingWeblabEnabled() ||
          e.isGatingWeblabEnabled()
        )
      },
      isShadowModeEnabled: function () {
        return a.isShadowModeEnabled()
      },
    }
  })
})
/* ******** */
;(function (c) {
  var a = window.AmazonUIPageJS || window.P,
    d = a._namespace || a.attributeErrors,
    b = d ? d('TurboCheckoutBaseAssets@chewbacca_migration_switch_beta', '') : a
  b.guardFatal
    ? b.guardFatal(c)(b, window)
    : b.execute(function () {
        c(b, window)
      })
})(function (c, a, d) {
  c.when('turbo-checkout-state-handler', 'turbo-checkout-device-filter').register(
    'turbo-chewbacca-migration-switch-beta',
    function (b, c) {
      return {
        isGatingWeblabEnabled: function () {
          var a = b.getClientId()
          return !('primewardrobe' === a || 'primestylist' === a) && c.isMashBeta()
        },
        isShadowModeEnabled: function () {
          return !1
        },
      }
    },
  )
})
/* ******** */
;(function (a) {
  var c = window.AmazonUIPageJS || window.P,
    f = c._namespace || c.attributeErrors,
    b = f ? f('TurboCheckoutBaseAssets@initiate_migration_switch', '') : c
  b.guardFatal
    ? b.guardFatal(a)(b, window)
    : b.execute(function () {
        a(b, window)
      })
})(function (a, c, f) {
  a.when(
    'turbo-initiate-migration-switch-mobile',
    'turbo-initiate-migration-switch-desktop',
  ).register('turbo-initiate-migration-switch', function (b, a) {
    return {
      isEnabled: function () {
        return b.isEnabled() || a.isEnabled()
      },
    }
  })
  ;('use strict')
  a.when('turbo-chewbacca-migration-switch', 'turbo-checkout-weblab-allocation').register(
    'turbo-initiate-migration-switch-mobile',
    function (b, a) {
      return {
        isEnabled: function () {
          return !1
        },
      }
    },
  )
  ;('use strict')
  a.when('turbo-chewbacca-migration-switch', 'turbo-checkout-weblab-allocation').register(
    'turbo-initiate-migration-switch-desktop',
    function (b, a) {
      var c = [
        'PAX_TURBO_INITIATE_MIGRATION_DESKTOP_868123',
        'PAX_TURBO_INITIATE_MIGRATION_DESKTOP_NON_PRIME_986684',
      ]
      return {
        isEnabled: function () {
          var d
          if ((d = b.isGatingWeblabEnabled()))
            a: {
              d = a.getTurboRedesignWeblabs()
              for (var e = 0; e < c.length; e++)
                if (d.hasOwnProperty(c[e]) && ('T1' === d[c[e]] || 'T3' === d[c[e]])) {
                  d = !0
                  break a
                }
              d = !1
            }
          return d
        },
      }
    },
  )
})
/* ******** */
;(function (a) {
  var c = window.AmazonUIPageJS || window.P,
    d = c._namespace || c.attributeErrors,
    b = d ? d('TurboCheckoutBaseAssets@shopping_portal_switch', '') : c
  b.guardFatal
    ? b.guardFatal(a)(b, window)
    : b.execute(function () {
        a(b, window)
      })
})(function (a, c, d) {
  a.when('turbo-checkout-state-handler', 'turbo-checkout-page-ready').register(
    'turbo-shopping-portal-switch',
    function (b) {
      return {
        isShoppingPortalEnabled: function () {
          var a = b.getClientId()
          return !('primewardrobe' === a || 'primestylist' === a)
        },
      }
    },
  )
})
/* ******** */
;(function (b) {
  var c = window.AmazonUIPageJS || window.P,
    d = c._namespace || c.attributeErrors,
    a = d ? d('TurboCheckoutBaseAssets@tbyb_shopping_portal_switch', '') : c
  a.guardFatal
    ? a.guardFatal(b)(a, window)
    : a.execute(function () {
        b(a, window)
      })
})(function (b, c, d) {
  b.when('turbo-checkout-page-ready').register('turbo-tbyb-shopping-portal-switch', function () {
    return {
      isTBYBShoppingPortalEnabled: function () {
        return !0
      },
    }
  })
})
/* ******** */
;(function (g) {
  var n = window.AmazonUIPageJS || window.P,
    y = n._namespace || n.attributeErrors,
    c = y ? y('TurboCheckoutBaseAssets@confirm_initiate_removal', '') : n
  c.guardFatal
    ? c.guardFatal(g)(c, window)
    : c.execute(function () {
        g(c, window)
      })
})(function (g, n, y) {
  g.when(
    'A',
    'turbo-view-adapter',
    'turbo-checkout-view-state',
    'turbo-checkout-eligible-state',
    'turbo-checkout-content-loader',
    'turbo-checkout-utils',
    'turbo-checkout-weblab-allocation',
    'turbo-checkout-weblab-trigger',
    'turbo-checkout-csm',
    'turbo-checkout-state-handler',
    'turbo-checkout-device-filter',
    'turbo-checkout-ajax-wrapper',
    'turbo-checkout-page-visibility-manager',
    'turbo-checkout-counter',
    'turbo-checkout-prefetcher',
    'turbo-checkout-prefetch-timer',
    'turbo-checkout-buy-now-button',
    'turbo-checkout-signin-controller',
    'buy-now-to-tango-weblab-trigger',
    'turbo-checkout-auto-open',
    'turbo-checkout-urls',
    'turbo-checkout-ref-tagger',
    'turbo-configuration',
    'turbo-checkout-event-verification',
    'buy-now-to-tango-eligibility-call-ignore-turbo-device-filters',
    'turbo-checkout-page-ready',
  ).register(
    'turbo-checkout-controller',
    function (c, d, g, k, C, u, l, n, e, h, D, z, y, A, v, B, p, J, F, K, G, Y, q, a, b) {
      function f() {
        p.bindTurboClickEvent()
        c.off('turbo:checkout:dimmer:clicked')
        c.on('turbo:checkout:dimmer:clicked', function (r) {
          r()
        })
      }
      function w(r, a) {
        u.logDebug('turbo-checkout-controller', r, a)
      }
      function Q(r, a) {
        H()
        r ||
          (a === Y.TAGS.ROTATION && e.logCount('turboCheckoutDeviceRotated'),
          d.close({ reason: a }))
      }
      function Z() {
        w('Handling signin success')
        R()
      }
      function S() {
        w('Handling buy now button click')
        R()
        return !0
      }
      function R() {
        O = setTimeout(X, 2e4)
        t = e.createScope()
        t.markClick()
        x = 'loading'
        L = !1
        B.checkTimeout()
        A.incrementSheetOpenedCounter()
        d.show()
      }
      function X() {
        e.logCount('turboCheckoutContenLoadTimeout')
      }
      function I() {
        H()
        d.removeContent()
      }
      function E() {
        H()
        a.logBuyNowButtonClickHandlerMetrics()
      }
      function H() {
        k.canShow() && !l.isDisableTurboWeblabInTreatment()
          ? (w('Registering with buy now button'),
            c.trigger('turbo:checkout:buyNowEnabled'),
            p.registerOnClickCallback(S))
          : (w('Unregistering from buy now button'),
            c.trigger('turbo:checkout:buyNowDisabled'),
            p.deregisterOnClickCallback(S))
      }
      function aa(a, N) {
        e.logCount('turboCheckoutPrefetchSuccess')
        a &&
          (l.isControl() || l.isBuyNowOnly()) &&
          (w('Received content in control: ' + a.substring(0, 255)),
          e.logCount('turboCheckoutControlContentReceived'))
        P = N
        C.isTurboOptimisticFlushingEnabled() ? d.finalizeIFrameContent() : d.setContent(a)
        H()
        C.shadowCallChewbaccaInitiate()
      }
      function ba() {
        H()
        g.isOpeningOrOpen() &&
          (e.logCount('turboCheckoutYieldNewPurchase'), d.closeImmediatelyThenExecute(T))
      }
      function ca() {
        clearTimeout(O)
        x = 'unknown'
        U()
        V()
      }
      function U() {
        !m ||
          m.isResolved() ||
          m.isRejected() ||
          (w(
            'Initiate confirm called for ' +
              P.currentPurchaseId +
              ' with existing confirm still executing. Aborting',
          ),
          e.logCount('turboCheckoutConfirmPending'),
          (m._supersedByNewPurchase = !0),
          m.abort())
      }
      function da() {
        var a = h
          .getLineItems()
          .filter(function (a) {
            return a && a.isDiscoveredAsin
          })
          .map(function (a, r) {
            return a.asin
          })
        e.logCount('turboCheckoutDiscoveredAsins', a.length)
        return a
      }
      function V() {
        e.logCount('turboCheckoutConfirm')
        var a = P.currentPurchaseId,
          b = G.buildConfirmPathWith(
            h.getRefTag(),
            l.getExperimentName(),
            h.getClientId(),
            h.getRequestId(),
            h.getSessionId(),
            da(),
          )
        m = z.loadWithJQXHR(b, {
          type: 'POST',
          data: { pid: a },
          headers: ea(),
          success: function (a, r, b) {
            e.logCount('turboCheckoutConfirmSuccess')
          },
          error: function (r, b, N) {
            'abort' === b
              ? e.logCount('turboCheckoutConfirmAborted')
              : ('timeout' === b && e.logCount('turboCheckoutConfirmTimeOut'),
                e.logCount('turboCheckoutConfirmFailed'))
            r._supersedByNewPurchase ||
              (u.logError(
                'Issue confirming turbo initiate prefetch for pid ' + a + ': ' + N + ', ' + b,
              ),
              e.logCount('turboCheckoutYieldNewPurchase'),
              d.closeImmediatelyThenExecute(T))
          },
        })
      }
      function ea() {
        var a = {},
          b = h.getCSRFToken()
        b && 0 < b.length && (a['x-amz-checkout-csrf-token'] = b)
        return a
      }
      function fa() {
        t.markFirstByte()
      }
      function ha() {
        clearTimeout(O)
        x = 'unknown'
      }
      function ia() {
        U()
        V()
      }
      function ja() {
        t.markFirstByte()
      }
      function M() {
        return q.get(q.KEYS.HOST_PAGE_TYPE_IDENTIFIER)
      }
      function T() {
        p.executeOriginalBuyNowAction(h.getActiveId())
      }
      function ka(a) {
        c.trigger('turbo:checkout:embedded:page:showSpinner')
        m.done(a)
      }
      function la(a, b, c) {
        x = c
        L = !1
      }
      function ma() {
        L = !0
      }
      function na(a) {
        c.off('turbo:checkout:dimmer:clicked')
        c.on('turbo:checkout:dimmer:clicked', function (a) {
          a()
        })
        ;(a && a.doNotLog) || (a && !a.doNotLog ? W(x, a.reason) : W(x, !1))
        x = 'closed'
      }
      function W(a, b) {
        var c = G.buildLogPageHitPathWith(L ? a + '2' : a, b, h.getClientId())
        w('Logging page hit from ' + a + ' to ' + M() + ' reason ' + b)
        z.load(c, { method: 'POST', params: { pageType: M(), referrer: a }, timeout: 4e3 })
      }
      function oa() {
        g.isOpeningOrOpen() && e.logCount('turboCheckoutProductChangedWhileOpening')
      }
      var t,
        x,
        P,
        L,
        pa = q.get(q.KEYS.AJAX_PAGE_UPDATE_EVENT),
        O,
        m
      c.on(pa, f)
      f()
      return {
        pageLoaded: function () {
          var a = l.getExperimentName()
          if (a) {
            var f = l.getAllocation()
            e.addCounterExtraSuffix('wl:' + f)
            e.addCounterExtraSuffix(a + ':' + f)
          }
          if (D.isDeviceTurboEligible() || b.shouldForceEligibilityCall())
            k.setup(),
              k.registerStateChangeCallback(Q),
              y.setup(),
              C.registerCallback({ onStart: I, onTurboEligible: E, onFinish: aa, onError: ba }),
              n.setup(),
              J.setup(),
              J.registerCallback(Z),
              F.registerBuyNowToTangoTriggerOnButton(),
              (t = e.createScope()),
              d.registerCallbacks({
                beforeFramePopulated: ca,
                afterFramePopulated: fa,
                beforeOptimisticFlushing: ha,
                afterOptimisticFlushing: ia,
                csmMarkFirstByte: ja,
              }),
              h.registerCallback(oa),
              c.on('turbo:checkout:sheet:beforeClose', na),
              c.on('turbo:checkout:embedded:page:beforeReload', la),
              c.on('turbo:checkout:embedded:page:animation:start', ma),
              K.setup(p.executeTurboBuyNowAction, E),
              v.setup(),
              c.trigger('turbo:checkout:controller:onPageLoaded')
        },
        loadFullscreen: function (a, b) {
          function c() {
            a = u.createFQDN(a)
            'thankyou' === b
              ? (e.logCount('turboCheckoutYieldTYP'),
                'primewardrobe' === h.getClientId() && e.logCount('turboCheckoutYieldTYP:pw'),
                d.closeAndNavigate(a))
              : 'thirdPartyPaymentInterstitial' === b
                ? d.closeAndNavigate(a)
                : 'verifyMfaPage' === b
                  ? ('primewardrobe' === h.getClientId() && e.logCount('turboCheckoutYieldTYP:pw'),
                    d.closeAndNavigate(a))
                  : (e.logCount('turboCheckoutYield'), d.closeToFullscreen(a))
          }
          !m || m.isResolved() || m.isRejected()
            ? c()
            : (e.logCount('turboCheckoutWaitYield'), ka(c))
        },
        frameContentReady: function (a, b, f) {
          c.trigger('turbo:checkout:embedded:page:ready', a, b)
          ;(function () {
            var a = function () {
              t.markCriticalFeature()
              f.confirmHit(M(), h.getRefTag())
              t.whenDataSet(f.recordClientSideMetrics)
              b.off('checkout:afterReload', a)
            }
            b.on('checkout:afterReload', a)
          })()
          ;(function () {
            b.on('checkout:beforeReload', function (f) {
              c.trigger('turbo:checkout:embedded:page:beforeReload', a, b, f)
            })
            b.on('checkout:reload', function (f) {
              c.trigger('turbo:checkout:embedded:page:reload', a, b, f)
            })
            b.on('checkout:afterReload', function (f) {
              c.trigger('turbo:checkout:embedded:page:afterReload', a, b, f)
            })
            b.on('turbo:checkout:animation:start', function () {
              c.trigger('turbo:checkout:embedded:page:animation:start')
            })
            b.state('turbo-secondary-panels-weblab-state', l.getHoldbackSecondaryPanelsWeblab())
            c.on('turbo:checkout:embedded:page:showSpinner', function () {
              f.showSpinner()
            })
            c.off('turbo:checkout:dimmer:clicked')
            c.on('turbo:checkout:dimmer:clicked', function (a) {
              b.trigger('turbo:checkout:dimmer:clicked:iFrame', a)
            })
            b.on('turbo:checkout:update:dimmer', function (a) {
              c.trigger('turbo:checkout:update:dimmer:afterReload', a)
            })
            b.on('turbo:checkout:update:modal:header', function (a) {
              c.trigger('turbo:checkout:update:modal:header:afterReload', a)
            })
            b.on('turbo:checkout:update:dimmer:block', function () {
              c.trigger('turbo:checkout:update:dimmer:block:iFrame')
            })
            b.on('turbo:checkout:update:dimmer:unblock', function () {
              c.trigger('turbo:checkout:update:dimmer:unblock:iFrame')
            })
            b.on('turbo:checkout:order:success', function () {
              c.trigger('turbo:checkout:order:success:iFrame')
            })
          })()
        },
        frameHtmlRendered: function () {
          t.markAboveTheFold()
        },
        updateBounds: function (a, b) {
          d.updateBounds(a, b)
        },
        getHeight: function () {
          return d.getHeight()
        },
        updateMinHeight: function (a) {
          return d.updateMinHeight(a)
        },
        updateScrollHeight: function (a, b) {
          return d.updateScrollHeight(a, b)
        },
        updateDimmer: function (a) {
          c.trigger('turbo:checkout:update:dimmer:typReload', a)
        },
        getHostPageType: M,
        closeBottomSheet: function (a) {
          c.trigger('turbo:checkout:sheet:doClose', a)
        },
      }
    },
  )
  ;('use strict')
  g.register('turbo-discovered-asins-filter', function () {
    return {
      apply: function (c) {
        return c
          .filter(function (c) {
            return c && c.isDiscoveredAsin
          })
          .map(function (c, g) {
            return c.asin
          })
      },
    }
  })
  ;('use strict')
  g.when(
    'A',
    'turbo-configuration',
    'turbo-checkout-ref-tagger',
    'turbo-checkout-utils',
    'turbo-initiate-migration-switch',
    'turbo-shopping-portal-switch',
    'turbo-tbyb-shopping-portal-switch',
    'turbo-checkout-state-handler',
    'buy-now-to-tango-switch',
    'turbo-checkout-eligibility-aggregator',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-urls', function (c, d, g, k, n, u, l, I, e, h) {
    function D(a, b) {
      if ((a && n.isEnabled()) || b) {
        try {
          var f = c.$('#debug-purchase-id')[0].textContent
          var d = f === y ? '' : '/' + f
        } catch (Q) {
          d = ''
        }
        a = '/checkout/entry/buynow' + d
      } else
        a =
          l.isTBYBShoppingPortalEnabled() && z()
            ? '/checkout/trybeforeyoubuy/turbo-initiate'
            : u.isShoppingPortalEnabled()
              ? '/checkout/turbo/initiate'
              : '/checkout/turbo-initiate'
      return a
    }
    function z() {
      return 'primewardrobe' === I.getClientId()
    }
    function E(a, b) {
      return ['\x26', a, '\x3d', b].join('')
    }
    function A(a, b, c) {
      a = '\x26pipelineType\x3dturbo\x26clientId\x3d' + a
      var f = d.get(d.KEYS.DEVICE_OVERRIDE)
      return a + (f ? '\x26devicestring-override\x3d' + f : '') + F(b, c)
    }
    function v(a) {
      var b = d.get(d.KEYS.HOST_PAGE_TYPE_IDENTIFIER)
      return 'ref_\x3d' + a + '\x26referrer\x3d' + b
    }
    function B(a) {
      return k.isNonEmptyString(a) ? '\x26weblab\x3d' + a : ''
    }
    function p() {
      return d.get(d.KEYS.IS_ADD_TO_CART_ENABLED) ? '\x26temporaryAddToCart\x3d1' : ''
    }
    function J(a) {
      if (!a || !a.length) return ''
      d.get(d.KEYS.IS_ADD_TO_CART_ENABLED) ||
        k.logError(
          'Discovered asins present but add to cart is disabled? This will generate a "clickstream_ignore" hit on the server side and cause the hit to be ignored by clickstream and the attribution lost!',
          'turbo-checkout-urls',
        )
      var b = ''
      a.forEach(function (a, c) {
        b += '\x26discoveredAsins.' + c + '\x3d' + a
      })
      return b
    }
    function F(a, b) {
      var c = ''
      k.isNonEmptyString(a) && (c += '\x26pageRequestId\x3d' + a)
      k.isNonEmptyString(b) && (c += '\x26pageSessionId\x3d' + b)
      return c
    }
    function K() {
      return l.isTBYBShoppingPortalEnabled() && z()
        ? '/checkout/trybeforeyoubuy/triggerWeblab'
        : u.isShoppingPortalEnabled()
          ? '/checkout/turbo/triggerWeblab'
          : '/checkout/triggerWeblab'
    }
    function G() {
      return (
        q('auiDebug', 'auiDebug') +
        q('ds_user', 'ds_user') +
        q('ds_turbo_workspace', 'ds_workspace') +
        q('stringDebug', 'stringDebug')
      )
    }
    function C(a) {
      a = a ? a : []
      var b = ''
      a.forEach(function (a, c) {
        b += '\x26asin.' + (c + 1) + '\x3d' + a.asin
      })
      return b
    }
    function q(a, b) {
      var c = ''
      a = k.getUrlQueryParam(a)
      k.isNonEmptyString(a) && (c = '\x26' + b + '\x3d' + a)
      return c
    }
    return {
      buildInitiatePathWith: function (a, b, c, d, e, h, g) {
        var f = D(!0, g)
        a = f + '?' + v(a) + A(c, d, e) + B(b) + p() + G() + C(h)
        b = ''
        k.isNonEmptyString(f) &&
          -1 !== f.indexOf('/checkout/entry/buynow') &&
          (b = '\x26turboCheckoutMigrationFlag\x3d1')
        g && (b += '\x26isShadowMode\x3d1')
        return a + b
      },
      buildEligibilityPathWith: function (a, b, c, d, g) {
        a = D() + '?' + v(a) + A(c, d, g) + B(b) + '\x26checkEligibilityOnly\x3dtrue' + p() + G()
        b = h.shouldAttemptTurboPrefetch() && h.isTurboEligible()
        c = []
        c.push(E('runTurboEligibility', b))
        e.isEnabled() && c.push(E('runTangoEligibility', I.isProductTangoEligible()))
        b = c.join('')
        return a + b
      },
      buildConfirmPathWith: function (a, b, c, d, e, g) {
        return D() + '/confirm?' + v(a) + A(c, d, e) + B(b) + p() + J(g)
      },
      buildLogPageHitPathWith: function (a, b, c) {
        a =
          (l.isTBYBShoppingPortalEnabled() && z()
            ? '/checkout/trybeforeyoubuy/log-page-hit'
            : u.isShoppingPortalEnabled()
              ? '/checkout/turbo/log-page-hit'
              : '/checkout/log-page-hit') +
          '?' +
          g.generateRefTag(a, g.ACTIONS.CLOSE, b) +
          A(c)
        b = n.isEnabled() ? '' : '\x26isLegacyCheetah\x3d1'
        return a + b
      },
      buildTriggerWeblabPathWith: function (a, b, c, d, e) {
        return K() + '?' + v(a) + B(b) + '\x26weblabAllocation\x3d' + c + F(d, e)
      },
      buildTriggerWeblabPathWithoutWeblab: function (a, b, c) {
        return K() + '?' + v(a) + F(b, c)
      },
    }
  })
})
/* ******** */
;(function (c) {
  var a = window.AmazonUIPageJS || window.P,
    d = a._namespace || a.attributeErrors,
    b = d ? d('TurboCheckoutBaseAssets@navigation_window', '') : a
  b.guardFatal
    ? b.guardFatal(c)(b, window)
    : b.execute(function () {
        c(b, window)
      })
})(function (c, a, d) {
  c.when('turbo-checkout-page-ready').register('turbo-checkout-navigation-window', function () {
    return {
      getWindow: function () {
        return a.self
      },
    }
  })
})
/* ******** */
;(function (b) {
  var c = window.AmazonUIPageJS || window.P,
    d = c._namespace || c.attributeErrors,
    a = d ? d('TurboCheckoutBaseAssets@chewbacca_migration_optimistic_flushing', '') : c
  a.guardFatal
    ? a.guardFatal(b)(a, window)
    : a.execute(function () {
        b(a, window)
      })
})(function (b, c, d) {
  b.when().register('turbo-chewbacca-migration-optimistic-flushing', function () {
    return {
      isEnabled: function () {
        return !1
      },
    }
  })
})
/* ******** */
;(function (k) {
  var v = window.AmazonUIPageJS || window.P,
    B = v._namespace || v.attributeErrors,
    e = B ? B('TurboCheckoutBaseAssets@base', '') : v
  e.guardFatal
    ? e.guardFatal(k)(e, window)
    : e.execute(function () {
        k(e, window)
      })
})(function (k, v, B) {
  'use strict'
  k.register('turbo-function-adapter', function () {
    return {
      adapt: function (e) {
        return function () {
          if ('function' !== typeof e)
            throw Error("Parameter 'property' is invalid. Expected a function but got " + typeof e)
          return e.apply(e, arguments)
        }
      },
    }
  })
  ;('use strict')
  k.when('turbo-configuration', 'turbo-function-adapter').execute(
    'turbo-signin-adapter-factory',
    function (e, a) {
      k.when(e.get(e.KEYS.SHOW_SIGN_IN_INTERFACE)).register('turbo-signin-adapter', function (b) {
        return { show: a.adapt(b.show) }
      })
    },
  )
  ;('use strict')
  k.when('turbo-configuration', 'turbo-function-adapter').execute(
    'turbo-view-adapter-factory',
    function (e, a) {
      k.when(e.get(e.KEYS.VIEW_ADAPTER)).register('turbo-view-adapter', function (b) {
        return {
          registerCallbacks: a.adapt(b.registerCallbacks),
          close: a.adapt(b.close),
          show: a.adapt(b.show),
          removeContent: a.adapt(b.removeContent),
          setContent: a.adapt(b.setContent),
          closeImmediatelyThenExecute: a.adapt(b.closeImmediatelyThenExecute),
          closeAndNavigate: a.adapt(b.closeAndNavigate),
          closeToFullscreen: a.adapt(b.closeToFullscreen),
          updateBounds: a.adapt(b.updateBounds),
          getHeight: a.adapt(b.getHeight),
          updateMinHeight: a.adapt(b.updateMinHeight),
          updateScrollHeight: a.adapt(b.updateScrollHeight),
          updateBottomSheetAttributes: a.adapt(b.updateBottomSheetAttributes),
          initiateIFrameContent: a.adapt(b.initiateIFrameContent),
          appendToIFrameContent: a.adapt(b.appendToIFrameContent),
          finalizeIFrameContent: a.adapt(b.finalizeIFrameContent),
        }
      })
    },
  )
  ;('use strict')
  k.when(
    'A',
    'turbo-checkout-utils',
    'turbo-checkout-csm',
    'turbo-callback-list',
    'turbo-checkout-form',
    'turbo-configuration',
    'turbo-checkout-weblab-allocation',
    'turbo-checkout-load-events',
    'buy-now-to-tango-parameter-eligibility-list-switch',
    'buy-now-to-tango-parameter-list-retriever',
    'turbo-checkout-page-ready',
  ).register(
    'buy-now-to-tango-parameter-eligibility-listener',
    function (e, a, b, d, f, c, g, h, l, p) {
      function m(a) {
        var c = z,
          d = f.getForms(F(t))
        d === B || 0 === d.length
          ? b.logCount('buyNowToTangoCheckoutInvalidBuyNowForm')
          : (a(d),
            c !== z &&
              (q('Buy Now to Tango parameter eligibility state has changed'),
              !0 === z
                ? q(
                    'Form corresponding to the Buy Now button is Buy Now to Tango parameter eligible',
                    d,
                  )
                : q(
                    'Form corresponding to the Buy Now button is NOT Buy Now to Tango parameter eligible',
                    d,
                  ),
              E.callAll('buyNowToTangoFormParameterEligibility')))
      }
      function r(c) {
        q('Observing child node mutation events on:', c)
        try {
          var f = c[0]
          new MutationObserver(function () {
            m(n)
          }).observe(f, { childList: !0, subtree: !0 })
        } catch (I) {
          b.logCount('buyNowToTangoCheckoutObserveBuyNowFormException'),
            a.logWarning(
              'buy-now-to-tango-parameter-eligibility-listener',
              'Exception while attempting to observe the Buy Now Button Form \x3d ' +
                I +
                '. Buy Now Button Form: ',
              c,
            )
        }
      }
      function n(a) {
        x = D = 0
        a = !0
        for (
          var c = y(),
            f = p.getBuyNowToTangoParameterAllowList(),
            d = p.getBuyNowToTangoParameterExclusionList(),
            e = l.shouldSwitchToExclusionList(),
            n = g.getBuyNowToTangoWeblabs(),
            m = 0;
          m < c.length;
          m++
        ) {
          var r = c[m]
          if (e) {
            var h = r
            var t = d,
              F = n
            h && t.hasOwnProperty(h)
              ? (t = t[h])
                ? 'T1' !== F[t]
                  ? (x++, (h = !1))
                  : (h = w(h) ? !1 : !0)
                : (h = !1)
              : (h = !0)
            h = !h
          } else h = !u(r, f, n)
          h &&
            (D++,
            (a = !1),
            b.logCountSimple('buyNowToTangoCheckoutParameterExcluded:onDetailPageStateChange:' + r))
        }
        z = 0 < c.length ? a : !1
      }
      function y() {
        var a = f.getForms(F(t))
        if (a === B || 0 === a.length) b.logCountSimple('buyNowToTangoCheckoutInvalidBuyNowForm')
        else {
          a = a.find('input[type\x3dhidden]')
          for (var c = [], d = 0; d < a.length; d++) c.push(a[d].getAttribute('name'))
          return c
        }
      }
      function u(a, c, b) {
        if (!a) return !0
        if (!c.hasOwnProperty(a)) return !1
        c = c[a]
        return c ? ('T1' !== b[c] ? (x++, !1) : w(a) ? !1 : !0) : !0
      }
      function w(a) {
        if (k.hasOwnProperty(a)) {
          a: {
            var c = f.getForms(F(t))
            if (c !== B && 0 !== c.length)
              if (((c = c.find('input[type\x3dhidden][name\x3d"' + a + '"]')), 1 !== c.length))
                b.logCountSimple('buyNowToTangoCheckoutParameterMultiInputs:' + a)
              else if ((c = c[0])) {
                c = c.getAttribute('value')
                break a
              }
            c = void 0
          }
          if (c !== B && !new RegExp(k[a]).test(c ? c : ''))
            return (
              b.logCountSimple('buyNowToTangoCheckoutParameterIneligibleValue:' + a),
              q('Buy Now To Tango Ineligible Parameter value observed: ' + a + '\x3d' + c),
              !0
            )
        }
        return !1
      }
      function A(a, c) {
        return a.every(function (a) {
          return 0 <= c.indexOf(a)
        })
      }
      function q(c, b) {
        a.logDebug('buy-now-to-tango-parameter-eligibility-listener', c, b)
      }
      var t = c.get(c.KEYS.BUY_NOW_BUTTON_SELECTOR),
        C = new RegExp(/^$/),
        k = {
          registryID: C,
          registryItemID: C,
          rebateId: C,
          'custom-name.1.1': new RegExp(/^incentivizedCart$/),
        },
        F = e.$,
        E = d.create(),
        z = !1,
        D = 0,
        x = 0
      h.bind(function () {
        c.get(c.KEYS.IS_BUY_NOW_TO_TANGO_ENABLED) &&
          m(function (a) {
            n(a)
            r(a)
          })
      })
      return {
        onStateChange: function (a) {
          E.push(a)
        },
        isBuyNowToTangoParameterEligible: function () {
          return z
        },
        logBuyNowFormParameterExclusionsAndFeatures: function () {
          for (
            var a = y(),
              f = c.get(c.KEYS.BUY_NOW_TO_TANGO_PARAMETER_TO_FEATURE_MAPPING),
              d = {},
              e = 0;
            e < a.length;
            e++
          ) {
            var n = a[e],
              m = n,
              u = p.getBuyNowToTangoParameterAllowList(),
              g = p.getBuyNowToTangoParameterExclusionList()
            if (l.shouldSwitchToExclusionList() ? g.hasOwnProperty(m) : !u.hasOwnProperty(m))
              b.logCountSimple('buyNowToTangoCheckoutParameterExcluded:onBuyNowButtonClick:' + n),
                f.hasOwnProperty(n) ||
                  (b.logCountSimple(
                    'buyNowToTangoCheckoutParameterExcluded:onBuyNowButtonClick:Unknown',
                  ),
                  q('Buy Now To Tango Unknown Parameter Observed: ' + n)),
                (m = 'Unknown'),
                f.hasOwnProperty(n) && '' !== f[n] && (m = f[n]),
                (d[m] = !0)
          }
          for (var r in d)
            d.hasOwnProperty(r) &&
              b.logCountSimple('buyNowToTangoCheckoutParameterExcluded:Feature:' + r)
          f = c.get(c.KEYS.BUY_NOW_TO_TANGO_FEATURE_PARAMETER_GROUP_MAPPING)
          d = !1
          for (var h in f)
            f.hasOwnProperty(h) &&
              A(f[h], a) &&
              (b.logCountSimple('buyNowToTangoCheckoutParameterExcluded:FeatureByGrouping:' + h),
              (d = !0))
          d || b.logCountSimple('buyNowToTangoCheckoutParameterExcluded:FeatureByGrouping:Unknown')
        },
        isBuyNowToTangoParameterIneligibleOnlyDueToNonT1WeblabAllocation: function () {
          return 0 !== D && D === x
        },
      }
    },
  )
  ;('use strict')
  k.when(
    'A',
    'turbo-checkout-form',
    'turbo-checkout-utils',
    'turbo-checkout-content-loader',
    'turbo-configuration',
    'turbo-checkout-load-events',
    'turbo-checkout-eligible-state',
    'turbo-checkout-buy-now-button',
    'buy-now-to-tango-parameter-eligibility-listener',
    'buy-now-to-tango-switch',
    'turbo-checkout-page-ready',
  ).register('buy-now-to-tango-url-handler', function (e, a, b, d, f, c, g, h, l, p) {
    function m() {
      E = !0
      l.isBuyNowToTangoParameterEligible() && u()
    }
    function r() {
      E = !1
    }
    function n() {
      E &&
        (l.isBuyNowToTangoParameterEligible() && !z
          ? ((z = !0), u())
          : ((z = !1),
            t('handle tango ineligible and update form action url to the fallback url'),
            (D = !1),
            h.deregisterOnClickCallback(w),
            (x = !1)))
    }
    function y() {
      D && !g.canShow()
        ? (h.registerOnClickCallback(w), (x = !0))
        : (h.deregisterOnClickCallback(w), (x = !1))
    }
    function u() {
      D = !0
      g.canShow()
        ? t('Tango eligible but Turbo being eligible takes precedence when handling URL')
        : (h.registerOnClickCallback(w), (x = !0))
    }
    function w() {
      var c = a.getForms(C(k))
      c.append(A(a.getRefTag(C(k))))
      c.attr('action', '/checkout/entry/buynow')
      c.submit()
      return !1
    }
    function A(a) {
      var c = document.createDocumentFragment()
      c.appendChild(q('pipelineType', 'Chewbacca'))
      c.appendChild(q('referrer', F))
      c.appendChild(q('isBuyNow', '1'))
      c.appendChild(q('ref_', (a || 'unknown_buy_now') + '_chw'))
      return c
    }
    function q(a, c) {
      var b = document.createElement('input')
      b.type = 'hidden'
      b.className = 'buy-now-to-tango-migration-request-param'
      b.name = a
      b.value = c
      return b
    }
    function t(a, c) {
      b.logDebug('buy-now-to-tango-url-handler', a, c)
    }
    var C = e.$,
      k = f.get(f.KEYS.BUY_NOW_BUTTON_SELECTOR),
      F = f.get(f.KEYS.HOST_PAGE_TYPE_IDENTIFIER),
      E = !1,
      z = !1,
      D = !1,
      x = !1
    c.bind(function () {
      p.isEnabled() &&
        (d.registerCallback({ onTangoEligible: m, onTangoIneligible: r }),
        l.onStateChange(n),
        g.registerStateChangeCallback(y))
    })
    return {
      _forTestOnly: {
        _setTangoAsinCustomerEligibleAndCheckBuyNowToTangoParameterEligibility: m,
        _onBuyNowToTangoParameterEligibilityChange: n,
        _onTurboEligibilityChange: y,
        _overrideBuyNowButtonFormAttributesAndSubmit: w,
      },
      isBuyNowToTangoEligible: function () {
        return D
      },
      isTangoCustomerAndAsinEligible: function () {
        return E
      },
      isBuyNowClickPointingToTango: function () {
        return x
      },
    }
  })
  ;('use strict')
  k.when(
    'A',
    'turbo-checkout-utils',
    'turbo-configuration',
    'turbo-checkout-form',
    'buy-now-to-tango-switch',
    'buy-now-to-tango-switch-beta',
    'turbo-checkout-buy-now-button',
    'turbo-checkout-eligible-state',
    'turbo-checkout-weblab-allocation',
    'turbo-checkout-state-handler',
    'buy-now-to-tango-url-handler',
    'turbo-checkout-urls',
    'turbo-checkout-weblab-trigger',
    'buy-now-to-tango-parameter-eligibility-listener',
    'turbo-checkout-csm',
    'buy-now-to-tango-parameter-eligibility-list-switch',
    'buy-now-to-tango-parameter-list-retriever',
    'turbo-checkout-page-ready',
  ).register(
    'buy-now-to-tango-weblab-trigger',
    function (e, a, b, d, f, c, g, h, l, p, m, r, n, y, u, w, A) {
      function q() {
        !h.canShow() && m.isBuyNowClickPointingToTango()
          ? u.logCountSimple('BUY_NOW_TO_TANGO_HIT')
          : h.canShow() ||
            !f.isEnabled() ||
            c.isGatingWeblabEnabled() ||
            (u.logCountSimple('BUY_NOW_TO_TANGO_EXCLUDED'),
            y.isBuyNowToTangoParameterEligible() ||
              (u.logCountSimple('BUY_NOW_TO_TANGO_EXCLUSION_REASON:Parameter'),
              y.logBuyNowFormParameterExclusionsAndFeatures()),
            p.isProductTangoEligible() ||
              u.logCountSimple('BUY_NOW_TO_TANGO_EXCLUSION_REASON:ASIN'),
            p.isProductTangoEligible() &&
              !m.isTangoCustomerAndAsinEligible() &&
              u.logCountSimple('BUY_NOW_TO_TANGO_EXCLUSION_REASON:Customer'))
        var a = t(C)
        a = d.getForms(a)
        if (a === B || 0 === a.length) return !1
        var b = !h.canShow(),
          e = m.isTangoCustomerAndAsinEligible()
        if (b && e && f.isEnabled() && !c.isGatingWeblabEnabled()) {
          a: {
            a = a.find('input[type\x3dhidden]')
            b = A.getBuyNowToTangoParameterAllowList()
            e = A.getBuyNowToTangoParameterExclusionList()
            if (w.shouldSwitchToExclusionList())
              b: {
                b = []
                for (var g = 0; g < a.length; g++) {
                  var q = a[g].getAttribute('name')
                  if (q && e.hasOwnProperty(q)) {
                    q = e[q]
                    if (!q) {
                      a = []
                      break b
                    }
                    0 > b.indexOf(q) && b.push(q)
                  }
                }
                a = b
              }
            else
              b: {
                e = []
                for (g = 0; g < a.length; g++)
                  if ((q = a[g].getAttribute('name'))) {
                    q = b[q]
                    if (!q) {
                      a = []
                      break b
                    }
                    0 > e.indexOf(q) && e.push(q)
                  }
                a = e
              }
            if (0 === a.length) u.logCountSimple('NO_BUY_NOW_TO_TANGO_PARAMETER_WEBLABS'), (a = [])
            else {
              b = l.getBuyNowToTangoWeblabs()
              e = 0
              g = ''
              for (q = 0; q < a.length; q++) {
                var k = a[q]
                if (!b.hasOwnProperty(k) || '' === b[k] || null === b[k]) {
                  u.logCountSimple(
                    'BUY_NOW_TO_TANGO_WEBLAB_TRIGGER:' + k + b.hasOwnProperty(k)
                      ? 'HAS_NO_ALLOCATION'
                      : 'DOES_NOT_EXIST',
                  )
                  a = []
                  break a
                }
                'C' === b[k] && (e++, (g = k))
              }
              q = []
              if (0 === e) {
                for (e = 0; e < a.length; e++)
                  (g = a[e]),
                    q.push({ weblabName: g, weblabAllocation: b[g] }),
                    u.logCountSimple('BUY_NOW_TO_TANGO_WEBLAB_TRIGGER:' + g + ':T1')
                m.isBuyNowClickPointingToTango() ||
                  u.logCountSimple('BUY_NOW_TO_TANGO_WEBLAB_TRIGGERED_T1_BUT_URL_DID_NOT_FLIP')
              } else
                1 === e &&
                  (q.push({ weblabName: g, weblabAllocation: 'C' }),
                  u.logCountSimple('BUY_NOW_TO_TANGO_WEBLAB_TRIGGER:' + g + ':C'),
                  m.isBuyNowClickPointingToTango() &&
                    u.logCountSimple('BUY_NOW_TO_TANGO_TRIGGERED_C_BUT_URL_FLIPPED'))
              a = q
            }
          }
          0 < a.length &&
            ((b = r.buildTriggerWeblabPathWithoutWeblab(
              p.getRefTag(),
              p.getRequestId(),
              p.getSessionId(),
            )),
            n.sendTurboWeblabRequest(b, a))
        }
        return !1
      }
      var t = e.$,
        C = b.get(b.KEYS.BUY_NOW_BUTTON_SELECTOR)
      return {
        registerBuyNowToTangoTriggerOnButton: function () {
          g.registerOnClickCallback(q)
        },
        _forTestOnly: { _triggerBuyNowToTangoExperimentWeblabs: q },
      }
    },
  )
  ;('use strict')
  k.when('turbo-checkout-page-ready').register(
    'buy-now-to-tango-parameter-eligibility-list-switch',
    function () {
      return {
        shouldSwitchToExclusionList: function () {
          return !1
        },
      }
    },
  )
  ;('use strict')
  k.when('turbo-checkout-page-ready').execute(function () {
    k.declare('turbo-eligibility-override', !1)
  })
  ;('use strict')
  k.when('turbo-checkout-page-ready').register(
    'buy-now-to-tango-eligibility-call-ignore-turbo-device-filters',
    function () {
      return {
        shouldForceEligibilityCall: function () {
          return !1
        },
      }
    },
  )
  ;('use strict')
  k.when(
    'turbo-checkout-page-state',
    'turbo-configuration',
    'turbo-checkout-utils',
    'turbo-checkout-csm',
    'turbo-checkout-page-ready',
  ).register('buy-now-to-tango-parameter-list-retriever', function (e, a, b, d) {
    return {
      getBuyNowToTangoParameterAllowList: function () {
        if (!1 === a.get(a.KEYS.IS_BUY_NOW_TO_TANGO_PRIME_SPLIT))
          return a.get(a.KEYS.BUY_NOW_TO_TANGO_PARAMETER_ALLOW_LIST)
        var b = e.get().isPrimeCustomer
        if (!0 === b) return a.get(a.KEYS.BUY_NOW_TO_TANGO_PARAMETER_ALLOW_LIST_PRIME)
        if (!1 === b) return a.get(a.KEYS.BUY_NOW_TO_TANGO_PARAMETER_ALLOW_LIST_NON_PRIME)
        d.logCountSimple(
          'buyNowToTangoCheckoutTurboStateIsPrimeCustomerUndefined:getBuyNowToTangoParameterAllowList',
        )
        throw Error(
          "getBuyNowToTangoParameterAllowList(): Unable to determine if prime customer or not as Turbo page state's isPrimeCustomer attribute is not true or false, but: " +
            b,
        )
      },
      getBuyNowToTangoParameterExclusionList: function () {
        if (!1 === a.get(a.KEYS.IS_BUY_NOW_TO_TANGO_PRIME_SPLIT))
          return a.get(a.KEYS.BUY_NOW_TO_TANGO_PARAMETER_EXCLUSION_LIST)
        var b = e.get().isPrimeCustomer
        if (!0 === b) return a.get(a.KEYS.BUY_NOW_TO_TANGO_PARAMETER_EXCLUSION_LIST_PRIME)
        if (!1 === b) return a.get(a.KEYS.BUY_NOW_TO_TANGO_PARAMETER_EXCLUSION_LIST_NON_PRIME)
        d.logCountSimple(
          'buyNowToTangoCheckoutTurboStateIsPrimeCustomerUndefined:getBuyNowToTangoParameterExclusionList',
        )
        throw Error(
          "getBuyNowToTangoParameterExclusionList(): Unable to determine if prime customer or not as Turbo page state's isPrimeCustomer attribute is not true or false, but: " +
            b,
        )
      },
    }
  })
  ;('use strict')
  k.when('A', 'turbo-checkout-csm', 'turbo-configuration', 'turbo-checkout-page-ready').register(
    'turbo-checkout-address-id',
    function (e, a, b) {
      function d(c) {
        for (var b = 0; b < c.length; b++) {
          var d = f(c[b])
          if (0 < d.length) return a.logCount('turboCheckoutAddressSelectorIndex' + b), d
        }
        a.logCount('turboCheckoutAddressSelectorMissing')
        return f()
      }
      var f = e.$
      return {
        getAddressId: function () {
          return d(b.get(b.KEYS.ADDRESS_INPUT_SELECTORS)).val() || ''
        },
        set: function (a) {
          d(b.get(b.KEYS.ADDRESS_INPUT_SELECTORS)).val() !== a &&
            d(b.get(b.KEYS.ADDRESS_INPUT_SELECTORS)).val(a).trigger('change', [a])
        },
      }
    },
  )
  ;('use strict')
  k.when(
    'A',
    'turbo-checkout-utils',
    'turbo-callback-list',
    'turbo-configuration',
    'turbo-checkout-load-events',
    'turbo-checkout-page-ready',
  ).register('turbo-checkbox-exclusion-listener', function (e, a, b, d, f) {
    function c(a) {
      var b = n
      n = !1
      for (var c = 0; c < p.length; c++) {
        var f = m(p[c]).find('input[type\x3dcheckbox]')
        a(f)
      }
      b !== n && (h('Exclusion checkbox state changed'), r.callAll('exclusionCheckbox'))
    }
    function g(a) {
      var c
      if (!(c = n)) {
        c = !1
        for (var b = 0; b < a.length && !c; b++) {
          var f = m(a[b])
          ;(c = f.prop('checked')) && h('Exclusion checkbox is checked', f)
        }
      }
      n = c
    }
    function h(c, b) {
      a.logDebug('turbo-checkbox-exclusion-listener', c, b)
    }
    function l() {
      c(g)
    }
    var p = d.get(d.KEYS.CHECKBOX_EXCLUSION_ROOT_NODES),
      m = e.$,
      r = b.create(),
      n = !1
    f.bind(function () {
      c(function (a) {
        h('Listening for change events on:', a)
        a.unbind('change', l).bind('change', l)
        g(a)
      })
    })
    return {
      onStateChange: function (a) {
        r.push(a)
      },
      isAnyCheckboxChecked: function () {
        return n
      },
    }
  })
  ;('use strict')
  k.when(
    'A',
    'turbo-callback-list',
    'turbo-checkout-load-events',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-custom-price-input', function (e, a, b) {
    function d() {
      var a = f()
      h !== a && ((h = a), g.callAll())
    }
    function f() {
      return c('#gcPriceOverride').val() || ''
    }
    var c = e.$,
      g = a.create(),
      h
    b.bind(function () {
      h = f()
      c('#gcPriceOverride').unbind('change', d).bind('change', d)
    })
    return {
      getCustomPrice: f,
      onChange: function (a) {
        g.push(a)
      },
    }
  })
  ;('use strict')
  k.when(
    'A',
    'turbo-checkout-csm',
    'turbo-checkout-utils',
    'turbo-configuration',
    'turbo-callback-list',
    'turbo-checkout-load-events',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-quantity-input', function (e, a, b, d, f, c) {
    function g(a) {
      var c = a
        ? a.value
          ? parseInt(a.value, 10)
          : a.target && a.target.value
            ? parseInt(a.target.value, 10)
            : void 0
        : void 0
      n === c
        ? b.logDebug(
            'turbo-checkout-quantity-input',
            'Quantity change event does NOT have new quantity. Suppressing callbacks',
            void 0,
          )
        : ((n = c),
          b.logDebug('turbo-checkout-quantity-input', 'Quantity change event', a),
          p.callAll())
    }
    function h(c) {
      c = c.val()
      ;(c = parseInt(c, 10)) || a.logCount('turboCheckoutNoQuantityFromPage')
      return c
    }
    var l = e.$,
      p = f.create(),
      m = d.get(d.KEYS.QUANTITY_SELECT_SELECTOR),
      r =
        'Multiple quantity nodes present on the page. This may lead to an incorrect quantity being used in Turbo! Selector \x3d ' +
        m,
      n
    c.bind(function () {
      var c = l(m)
      n = h(c)
      c.unbind('change', g).bind('change', g)
      1 < c.length &&
        (b.logError(r, 'turbo-checkout-quantity-input'),
        b.logDebug('turbo-checkout-quantity-input', r, c))
      a.logCount('turboCheckoutQuantityNodes', c.length)
    })
    return {
      getQuantity: function () {
        return h(l(m))
      },
      setQuantity: function (a) {
        var c = l(m),
          b = h(c)
        a = parseInt(a, 10)
        b !== a && c.val(a).change()
      },
      onChange: function (a) {
        p.push(a)
      },
    }
  })
  ;('use strict')
  k.when(
    'A',
    'turbo-checkout-csm',
    'turbo-checkout-utils',
    'turbo-callback-list',
    'turbo-configuration',
    'turbo-checkout-quantity-input',
    'turbo-checkout-load-events',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-warranty-input', function (e, a, b, d, f, c, g) {
    var h = e.$,
      l = d.create(),
      p = f.get(f.KEYS.WARRANTY_CHECKBOX_INPUT_SELECTOR),
      m = f.get(f.KEYS.WARRANTY_CHECKBOX_RELATIVE_PARENT_SELECTOR),
      r = f.get(f.KEYS.WARRANTY_ASIN_INPUT_NAME),
      n = f.get(f.KEYS.WARRANTY_OFFER_INPUT_SELECTOR)
    g.bind(function () {
      h(p).unbind('click', l.callAll).bind('click', l.callAll)
    })
    return {
      select: function (a) {
        a &&
          h(m + ' input[name^\x3d' + r + '][value\x3d' + a + ']')
            .parents(m)
            .find(p)
            .click()
      },
      onChange: function (a) {
        l.push(a)
      },
      getLineItem: function (f) {
        if (h(p + ':checked').length) {
          var d =
              h(p + ':checked')
                .first()
                .parents(m)
                .find('input[name^\x3d' + r + ']')
                .val() || '',
            e = h(n).val() || ''
          f = parseInt(f, 10) || c.getQuantity() || 1
          if (d && e) return { asin: d, offerListingId: e, quantity: f, isDiscoveredAsin: !0 }
          a.logCount('turboCheckoutIncompleteWarrantyInputs')
          b.logError(
            'Incomplete input data for the selected warranty checkbox - asin:' +
              d +
              ', offerId:' +
              e +
              ', quantity:' +
              f,
          )
        } else
          b.logDebug('turbo-checkout-warranty-input', 'No warranty checkbox is selected', void 0)
      },
    }
  })
  ;('use strict')
  k.when(
    'A',
    'turbo-checkout-csm',
    'turbo-callback-list',
    'turbo-configuration',
    'turbo-checkout-load-events',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-vas-input', function (e, a, b, d, f) {
    function c() {
      return p(h).prop('checked') || !1
    }
    function g() {
      var a = r
      r = c()
      a !== r && m.callAll(r)
    }
    var h = d.get(d.KEYS.VAS_CHECKBOX_SELCTOR),
      l = d.get(d.KEYS.VAS_CHANGE_EVENTS),
      p = e.$,
      m = b.create(),
      r
    f.bind(function () {
      r = c()
      l.forEach(function (a) {
        e.off(a, g)
        e.on(a, g)
      })
    })
    return {
      isSelected: c,
      onChange: function (a) {
        m.push(a)
      },
    }
  })
  ;('use strict')
  k.when(
    'A',
    'turbo-checkout-utils',
    'turbo-callback-list',
    'turbo-checkout-load-events',
    'turbo-checkout-csm',
    'turbo-checkout-aui-page-state-parser',
    'turbo-configuration',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-accessories-input', function (e, a, b, d, f, c, g) {
    function h() {
      var a = k
      k = y()
      k !== a && w.callAll()
    }
    function l() {
      if (q === B && u(t).length) {
        var a = c.parse('simpleBundleParameterMap', '.simpleBundleFeatureContainer')
        0 === a.length ? (f.logCount('Turbo:Accessories:No:State'), (q = {})) : p(a)
      }
    }
    function p(a) {
      q = {}
      a[0].items.forEach(function (a) {
        q[a.asin] = { asin: a.asin, offerListingId: a.offerListingId, isDiscoveredAsin: !0 }
      })
    }
    function m() {
      return u(t).find('input[type\x3dcheckbox]')
    }
    function r() {
      m().unbind('change', h).bind('change', h)
    }
    function n() {
      return u(t).length ? 1 >= k : 0 === k
    }
    function y() {
      var c = 0
      m().each(function () {
        u(this).prop('checked') && c++
      })
      a.logDebug('turbo-checkout-accessories-input', 'Accessories selected ' + c)
      return c
    }
    var u = e.$,
      w = b.create(),
      k = 0,
      q,
      t = g.get(g.KEYS.ENABLED_ACCESSORIES_SELECTOR)
    l()
    r()
    d.bind(function () {
      l()
      r()
      y()
    })
    return {
      isEligible: n,
      registerCallback: function (a) {
        w.push(a)
      },
      getLineItem: function () {
        if (n()) {
          var a = m().filter(':checked').val()
          a = q ? q[a] : void 0
          return a || B
        }
        return B
      },
      select: function (a) {
        a && u(t + ' input[type\x3dcheckbox][value\x3d' + a + ']').click()
      },
    }
  })
  ;('use strict')
  k.when(
    'A',
    'turbo-checkout-utils',
    'turbo-callback-list',
    'turbo-checkout-load-events',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-devices-accessories-input', function (e, a, b, d) {
    function f() {
      var b = c('#accessory-upsell-container').find('input[type\x3dcheckbox]')
      for (var f = !1, d = 0; d < b.length && !f; d++) {
        var e = c(b[d])
        ;(f = e.prop('checked')) &&
          a.logDebug(
            'turbo-checkbox-exclusion-listener',
            'Devices accessory checkbox is checked',
            e,
          )
      }
      b = f
      h !== b && ((h = b), g.callAll())
    }
    var c = e.$,
      g = b.create(),
      h = !1
    d.bind(function () {
      h = !1
      f()
      c('#accessory-upsell-container').unbind('change', f).bind('change', f)
    })
    return {
      isEligible: function () {
        return !h
      },
      registerCallback: function (a) {
        g.push(a)
      },
    }
  })
  ;('use strict')
  k.when(
    'A',
    'turbo-checkout-utils',
    'turbo-callback-list',
    'turbo-checkout-load-events',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-devices-account-linking-input', function (e, a, b, d) {
    function f() {
      return g('#account-linking')
    }
    function c() {
      var c
      if ((c = f().prop('checked'))) {
        var b = f()
        a.logDebug(
          'turbo-checkbox-exclusion-listener',
          'Devices account linking checkbox is checked',
          b,
        )
      }
      l !== c && ((l = c), h.callAll())
    }
    var g = e.$,
      h = b.create(),
      l = !0
    d.bind(function () {
      l = !0
      c()
      f().unbind('change', c).bind('change', c)
    })
    return {
      isEligible: function () {
        return 0 < f().length ? l : !0
      },
      registerCallback: function (a) {
        h.push(a)
      },
    }
  })
  ;('use strict')
  k.when('A', 'turbo-checkout-csm', 'turbo-configuration', 'turbo-checkout-page-ready').register(
    'turbo-checkout-session-id-input',
    function (e, a, b) {
      var d = e.$
      return {
        getSessionId: function () {
          var f = d(b.get(b.KEYS.SESSION_ID_SELECTOR))
          ;(f && 0 < f.length) || (a.logCount('turboCheckoutSessionIdSelectorMissing'), (f = d()))
          return f.val() || ''
        },
      }
    },
  )
  ;('use strict')
  k.when(
    'A',
    'turbo-checkout-csm',
    'turbo-checkout-utils',
    'turbo-configuration',
    'turbo-checkout-aui-page-state-parser',
    'turbo-checkout-page-ready',
  ).register('java-checkout-url-page-state', function (e, a, b, d, f) {
    function c(a, c) {
      this.javaCheckoutUrl = a
      this.javaCheckoutQueryParams = c
    }
    function g(a, c) {
      b.logDebug('java-checkout-url-page-state', a, c)
    }
    var h = d.get(d.KEYS.JAVA_CHECKOUT_URL_PAGE_STATE_KEY),
      l = d.get(d.KEYS.JAVA_CHECKOUT_URL_PAGE_STATE_PARSING_ROOT_NODE_SELECTOR),
      p = new c('', {})
    return {
      get: function (b, d) {
        b = b || h
        d = d || l
        d = f.parse(b, d)
        a.logCount('javaCheckoutUrlPageStates', d.length)
        0 === d.length
          ? (g('Java checkout url page state [' + b + '] is NOT present'), (b = void 0))
          : (b = d[0])
        b
          ? (b = new c(b.javaCheckoutUrl, b.javaCheckoutQueryParams))
          : (a.logCount('javaCheckoutUrlPageStateNotDefined'), (b = p))
        g('Java Checkout Url PageState', b)
        return b
      },
    }
  })
  ;('use strict')
  k.when(
    'A',
    'turbo-checkout-csm',
    'turbo-checkout-utils',
    'turbo-checkout-form',
    'turbo-checkout-ref-tagger',
    'turbo-checkout-page-state',
    'turbo-checkout-product-state',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-joined-state', function (e, a, b, d, f, c, g) {
    function h(a, c, b) {
      c && (b && (c.quantity = b), a.push(c))
    }
    function l(c, g) {
      function l() {
        var b = c.turboWeblab
        b || a.logCount('turboCheckoutWeblabNameNotDefinedInState')
        return b
      }
      function n() {
        return c.turboWeblabTreatment
      }
      this.pageState = c
      this.productStates = g
      this.getLineItems = function () {
        return h.lineItemInputs
      }
      this.getActiveId = function () {
        return h.id
      }
      this.getHeaderText = function () {
        return h ? h.turboHeaderText || c.turboHeaderText : c.turboHeaderText
      }
      this.getLoadingText = function () {
        return c.turboLoadingText
      }
      this.getCloseText = function () {
        return c.turboCloseText
      }
      this.getAddressId = function () {
        return c.addressId
      }
      this.getRequestId = function () {
        return c.requestId
      }
      this.getSessionId = function () {
        return c.sessionId
      }
      this.getAdditionalWeblabs = function () {
        return c.additionalWeblabs
      }
      this.getInitiateSelector = function () {
        return c.initiateSelector
      }
      this.getWeblab = l
      this.getWeblabTreatment = n
      this.isTurboLaunched = function () {
        return !l() && 'C' !== n()
      }
      this.isProductStateEligible = function () {
        return g.isTurboEligible
      }
      this.getRefTag = function () {
        if (!h) throw Error('Turbo checkout product state is NOT resolved. Cannot generate ref tag')
        var a = e.$('#' + h.id)
        a = d.getRefTag(a)
        return f.generateJoinedValue(a)
      }
      this.getCSRFToken = function () {
        return c.csrfToken
      }
      this.getClientId = function () {
        return h && h.checkoutClientId ? h.checkoutClientId : 'retailwebsite'
      }
      this.resolve = function (c) {
        c &&
          ((h = g.states[c])
            ? (b.logDebug('turbo-checkout-joined-state', 'Resolved new product state', h),
              e.trigger('turbo:checkout:state:product:resolved'))
            : (b.logWarning('Resolved turbo checkout product state is undefined. Id \x3d ' + c),
              a.logCount('turboCheckoutProductStateNotFound')))
      }
      this.getHoldbackSecondaryPanelsWeblab = function () {
        return c.holdbackSecondaryPanelsWeblab
      }
      this.isPrimeCustomer = function () {
        return c.isPrimeCustomer
      }
      var h = 1 !== g.states.length ? B : g.states[0]
    }
    return {
      createTurboState: function (b, f, d, e, y, u) {
        if (e && d) throw Error('Custom item price is NOT supported with warranty')
        var n = c.get()
        f && (n.addressId = f)
        f = g.get()
        if (b || e || d || u)
          (b = parseInt(b, 10)),
            f.states.forEach(function (c) {
              c.lineItemInputs.forEach(function (c) {
                b && (c.quantity = b)
                e
                  ? ((c.customItemPrice = e), a.logCount('turboCheckoutItemPriceOverrided'))
                  : c.customItemPrice &&
                    a.logCount('turboCheckoutItemPriceSelectorFallBackToTurboState')
              })
              h(c.lineItemInputs, u, b)
              h(c.lineItemInputs, d, b)
            })
        n = new l(n, f)
        n.resolve(y)
        return n
      },
    }
  })
  ;('use strict')
  k.when(
    'A',
    'turbo-checkout-csm',
    'turbo-checkout-utils',
    'turbo-configuration',
    'turbo-checkout-aui-page-state-parser',
    'turbo-constants',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-page-state', function (e, a, b, d, f, c) {
    function g(a, b, f, d, e, g, l, h, p, m, r, k, D, x, K, v) {
      this.version = a
      this.turboWeblab = b
      this.turboWeblabTreatment = f
      this.initiateSelector = d
      this.turboLoadingText = e
      this.turboHeaderText = g
      this.turboCloseText = l
      this.addressId = h
      this.requestId = p
      this.sessionId = m
      this.csrfToken = r
      this.turboAssetsMode = k
      this.isJavaPipelineEligible =
        '0' !== this.version && this.turboAssetsMode !== c.ASSET_MODE_TURBO_ONLY
      this.additionalWeblabs = D
      this.holdbackSecondaryPanelsWeblab = x
      this.isTangoCheckoutEligible = K
      this.isPrimeCustomer = v
    }
    function h(a, c) {
      b.logDebug('turbo-checkout-page-state', a, c)
    }
    var l = d.get(d.KEYS.TURBO_PAGE_STATE_KEY),
      p = d.get(d.KEYS.PAGE_STATE_PARSING_ROOT_NODE_SELECTOR),
      m = d.get(d.KEYS.LEGACY_SESSION_ID_IDENTIFIER),
      r = new g(
        '0',
        '',
        'C',
        '#buy-now-button',
        '',
        '',
        '',
        '',
        '',
        '',
        '',
        c.ASSET_MODE_TURBO_ONLY,
        '',
        '',
        !1,
        !1,
      )
    return {
      get: function (d, e) {
        b: {
          d = d || l
          e = e || p
          e = f.parse(d, e)
          a.logCount('turboCheckoutPageStates', e.length)
          if (1 < e.length)
            b.logError(
              'Multiple turbo checkout page states found! Turbo will NOT show',
              'turbo-checkout-page-state',
              void 0,
            ),
              h('PageStates', e)
          else if (0 === e.length) h('Turbo checkout page state [' + d + '] is NOT present')
          else {
            d = e[0]
            break b
          }
          d = void 0
        }
        if (d)
          if (d.version)
            d = new g(
              d.version,
              d.turboWeblab || '',
              d.turboWeblabTreatment || 'C',
              d.initiateSelector || '.buy-now-button',
              d.turboLoadingText || '',
              d.turboHeaderText || '',
              d.turboCloseText || '',
              d.addressId || '',
              d.requestId || '',
              d.sessionId || '',
              d.csrfToken || '',
              d.turboAssetsMode || c.ASSET_MODE_TURBO_ONLY,
              d.additionalWeblabs || '{}',
              d.holdbackSecondaryPanelsWeblab || '{}',
              d.isTangoCheckoutEligible || !1,
              d.isPrimeCustomer || !1,
            )
          else {
            e = d.inputs || {}
            var u = d.strings || {}
            d = new g(
              '1',
              d.turboWeblab || '',
              d.turboWeblabTreatment || 'C',
              (d.configurations || {}).initiateSelector || '#buy-now-button',
              u.TURBO_LOADING_TEXT || '',
              u.TURBO_CHECKOUT_HEADER || '',
              u.TURBO_CLOSE_TEXT || '',
              e.addressId || '',
              e.requestId || '',
              e.sessionId || e[m] || '',
              d.csrfToken || '',
              d.turboAssetsMode || c.ASSET_MODE_TURBO_ONLY,
              d.additionalWeblabs || '{}',
              d.holdbackSecondaryPanelsWeblab || '{}',
              d.isTangoCheckoutEligible || !1,
              d.isPrimeCustomer || !1,
            )
          }
        else a.logCount('turboCheckoutStateNotDefined'), (d = r)
        h('Turbo Checkout PageState', d)
        return d
      },
    }
  })
  ;('use strict')
  k.when(
    'A',
    'turbo-checkout-csm',
    'turbo-checkout-utils',
    'turbo-configuration',
    'turbo-checkout-aui-page-state-parser',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-product-state', function (e, a, b, d, f) {
    function c(a, c) {
      this.isTurboEligible = a
      this.states = c
    }
    function g(a, c, b, d, f) {
      this.id = a
      this.isTurboEligible = c
      this.lineItemInputs = b
      this.turboHeaderText = d || ''
      this.checkoutClientId = f
    }
    function h(a, c, b, d, f, e, g, l, h, p, m) {
      this.asin = c || ''
      this.offerListingId = b || ''
      this.quantity = parseInt(d, 10) || 1
      this.isTurboEligible = !!this.asin && !!this.offerListingId && a
      this.productTitle = f || ''
      this.incentivizedCart = e || ''
      this.customItemPrice = g || ''
      this.addToCartTimeAsUnixEpochMilliseconds = l || ''
      this.addToCartSessionId = h || ''
      this.isDiscoveredAsin = !!p
      this.concealmentEligibilityType = m || ''
    }
    function l(a, c) {
      b.logDebug('turbo-checkout-product-state', a, c)
    }
    function p(a) {
      if (!a.lineItemInputs || !a.lineItemInputs.length || !a.id)
        return (
          l(
            'Versioned product state is invalid. Expected non empty "id" and "lineItemInputs". Turbo may NOT show',
            a,
          ),
          n
        )
      var c = !0,
        b = e.map(a.lineItemInputs, function (a) {
          a = new h(
            a.isTurboEligible,
            a.asin,
            a.offerListingId,
            a.quantity,
            a.productTitle,
            a.incentivizedCart,
            a.customItemPrice,
            a.addToCartTimeAsUnixEpochMilliseconds,
            a.addToCartSessionId,
            a.isDiscoveredAsin,
            a.concealmentEligibilityType,
          )
          c = c && a.isTurboEligible
          return a
        })
      return new g(a.id, c, b, a.turboHeaderText, a.checkoutClientId)
    }
    var m = d.get(d.KEYS.TURBO_PRODUCT_STATE_KEY),
      r = d.get(d.KEYS.PRODUCT_STATE_PARSING_ROOT_NODE_SELECTOR),
      n = new g('buy-now-button', !1, [], '', 'retailwebsite'),
      k = new c(!1, [n])
    return {
      get: function (d, e) {
        d = d || m
        e = e || r
        e = f.parse(d, e)
        a.logCount('turboCheckoutProductStates', e.length)
        1 < e.length && 'turbo-checkout-page-state' === d
          ? (b.logError(
              'turbo-checkout-page-state only supports the single item use case! Turbo will NOT show',
              'turbo-checkout-product-state',
              void 0,
            ),
            (d = []))
          : (d = e)
        if ((e = d) && e.length) {
          var u = !1
          d = []
          for (var q = 0; q < e.length; q++) {
            var t = e[q]
            if (t)
              if (t.version) var y = p(t)
              else
                t.inputs && t.eligibility
                  ? ((y = t.strings || {}),
                    (t = new h(
                      t.eligibility.isEligible,
                      t.inputs.a,
                      t.inputs.oid,
                      t.inputs.quantity,
                      y.TURBO_CHECKOUT_HEADER,
                      t.inputs.incentivizedCart,
                      t.inputs.customItemPrice,
                      t.inputs.concealmentEligibilityType,
                    )),
                    (y = new g(
                      'buy-now-button',
                      t.isTurboEligible,
                      [t],
                      y.TURBO_CHECKOUT_HEADER,
                      'retailwebsite',
                    )))
                  : (l(
                      'Legacy product state is missing "inputs" or "eligibility". Turbo will NOT show',
                      t,
                    ),
                    (y = n))
            else l('Product state parsed DOM object is invalid. Turbo may NOT show', t), (y = n)
            u = u || y.isTurboEligible || !1
            t = y.id
            if (d[t]) throw ((e = 'Duplicate product state found. id \x3d ' + t), l(e, d), Error(e))
            d.push(y)
            d[y.id] = y
          }
          d = new c(u, d)
        } else l('Parsed states are invalid. Turbo will NOT show', e), (d = k)
        l('Turbo Checkout Product State(s)', d)
        return d
      },
    }
  })
  ;('use strict')
  k.when(
    'A',
    'turbo-configuration',
    'turbo-checkout-csm',
    'turbo-checkout-utils',
    'turbo-checkout-auto-open',
    'turbo-checkout-address-id',
    'turbo-checkout-quantity-input',
    'turbo-checkout-warranty-input',
    'turbo-checkout-custom-price-input',
    'turbo-callback-list',
    'turbo-checkout-joined-state',
    'turbo-checkout-accessories-input',
    'turbo-checkout-session-id-input',
    'turbo-checkout-page-state',
    'buy-now-to-tango-switch',
    'turbo-checkout-page-ready',
  ).register(
    'turbo-checkout-state-handler',
    function (e, a, b, d, f, c, g, h, l, p, m, r, n, k, u) {
      function y(a, b, d, f, e, p) {
        a = a || g.getQuantity()
        b = b || c.getAddressId()
        d = d || h.getLineItem(a)
        f = f || l.getCustomPrice()
        p = p || r.getLineItem()
        return m.createTurboState(a, b, d, f, e, p)
      }
      function A(a, c) {
        d.logDebug('turbo-checkout-state-handler', a, c)
      }
      function q(a, c) {
        d.logWarning('turbo-checkout-state-handler', a, c)
      }
      function t(a, c, b, d, f) {
        x = y(a, c, b, B, d, f)
      }
      function C() {
        e.trigger('turbo:checkout:product:onChange')
        z.callAll()
      }
      function H() {
        var a = y()
        d.isDeepEquals(x, a) || ((x = a), A('New Turbo State', x), C())
      }
      var F = e.$,
        E = a.get(a.KEYS.AJAX_PAGE_UPDATE_EVENT),
        z = p.create(),
        D = !1
      var x = y()
      return {
        isProductTurboEligible: function () {
          return (!D && x.isProductStateEligible()) || a.get(a.KEYS.OVERRIDE_ELIGIBILITY)
        },
        isProductTangoEligible: function () {
          return u.isEnabled() && k.get().isTangoCheckoutEligible
        },
        getLineItems: function () {
          return x.getLineItems()
        },
        getAddressId: function () {
          return x.getAddressId()
        },
        getWeblabAllocation: function () {
          return x.getWeblabTreatment()
        },
        registerCallback: function (a) {
          z.push(a)
        },
        startMonitoringPage: function () {
          f.updateInputsAndThen(t)
          g.onChange(H)
          h.onChange(H)
          l.onChange(H)
          r.registerCallback(H)
          e.off(E, H)
          e.on(E, H)
          C()
        },
        getRequestId: function () {
          return x.getRequestId()
        },
        getSessionId: function () {
          return x.getSessionId()
        },
        getExperimentName: function () {
          return x.getWeblab()
        },
        getAdditionalWeblabAndTreatmentMap: function () {
          try {
            var a = x.getAdditionalWeblabs()
            '' === a && b.logCount('turboStateAdditionalWeblabsEmptyString')
            var c = JSON.parse(a)
            return c === B
              ? (b.logCount('turboCheckoutParseAdditionalWeblabsUndefined'),
                q('JSON::parsed additionalWeblabs as undefined for weblabs: [' + a + ']'),
                {})
              : c
          } catch (I) {
            return (
              b.logCount('turboCheckoutParseAdditionalWeblabsException'),
              q(
                'JSON::parse exception on additionalWeblabs: [' +
                  x.getAdditionalWeblabs() +
                  ']. Exception \x3d ' +
                  I,
              ),
              {}
            )
          }
        },
        getStrings: function () {
          return {
            TURBO_LOADING_TEXT: x.getLoadingText(),
            TURBO_CHECKOUT_HEADER: x.getHeaderText(),
            TURBO_CLOSE_TEXT: x.getCloseText(),
          }
        },
        getInitiateSelector: function () {
          return x.getInitiateSelector()
        },
        isTurboLaunched: function () {
          return x.isTurboLaunched()
        },
        isPhysicalGiftCardExperimentEligible: function () {
          var a = 0 !== F('#giftcardcustomtwister_feature_div').length
          a && (A('Physical Gift Card use case'), b.logCount('turboCheckoutGiftCardUseCase'))
          return a
        },
        setTurboStateNotEligible: function () {
          D = !0
        },
        resolveProductState: function (a) {
          x.resolve(a)
        },
        getActiveId: function () {
          return x.getActiveId()
        },
        getRefTag: function () {
          return x.getRefTag()
        },
        getCSRFToken: function () {
          var a
          ;(a = x.getCSRFToken()) ||
            (a = (a = x.getSessionId()) && 0 < a.length ? a : n.getSessionId())
          a = a || ''
          if (!a || 0 >= a.length)
            q('CSRF Token is empty. This will result in denied requests.'),
              b.logCount('turboCheckoutNoValidCSRFToken')
          return a
        },
        getClientId: function () {
          return x.getClientId()
        },
        getHoldbackSecondaryPanelsWeblab: function () {
          try {
            return JSON.parse(x.getHoldbackSecondaryPanelsWeblab())
          } catch (K) {
            b.logCount('turboCheckoutParseHoldbackSecondaryPanelsWeblabException'),
              q('JSON::parse exception. Exception \x3d ' + K)
          }
        },
      }
    },
  )
  ;('use strict')
  k.when('A', 'turbo-checkout-utils', 'turbo-checkout-page-ready').register(
    'turbo-checkout-aui-page-state-parser',
    function (e, a) {
      var b = e.$
      return {
        parse: function (d, f) {
          d = "script[data-a-state*\x3d'" + d + "'], #" + d
          f = f ? b(f).find(d) : b(d)
          d = []
          for (var c = 0; c < f.length; c++) {
            a: {
              try {
                var e = b(f[c]).text()
                var h = JSON.parse(e)
                break a
              } catch (l) {
                a.logError(
                  'JSON::parse exception. Exception \x3d ' + l,
                  'turbo-checkout-aui-page-state-parser',
                  void 0,
                )
              }
              h = void 0
            }
            h && d.push(h)
          }
          return d
        },
      }
    },
  )
  ;('use strict')
  k.when(
    'A',
    'turbo-checkout-page-state',
    'turbo-checkout-csm',
    'turbo-checkout-state-handler',
    'tango-checkout-urls',
    'turbo-checkout-page-ready',
  ).register('tango-checkout-eligibility', function (e, a, b, d, f) {
    function c() {
      var a = {},
        c = d.getAddressId()
      c && (a.addressID = c)
      return a
    }
    function g(a) {
      m()
      p(!1)
      n = null
      a && a.isTangoEligible
        ? (b.logCount('tangoCheckoutCustomerEligible'), y && y())
        : (l(''), b.logCount('tangoCheckoutCustomerNotEligible'), u && u())
    }
    function h(a, c, d) {
      m()
      p(!1)
      'timeout' === c && b.logCount('tangoCheckoutCustomerEligibilityCallFailedWithTimeOut')
      n = null
      l('')
      b.logCount('tangoCheckoutCustomerEligibilityCallFailed')
    }
    function l(a) {
      k.when('ready').execute(function () {
        e.state('checkout-url-migration-page-state', { checkoutUrl: a })
      })
    }
    function p(a) {
      e.state('checkout-url-migration-page-state', { ajaxEligibilityInProgress: a })
    }
    function m() {
      var a = new Date().getTime() - r
      b.logCount('tangoCheckoutCustomerEligibilityTime', a)
    }
    var r, n, y, u
    return {
      setEligibleCallback: function (a) {
        y = a
      },
      setIneligibleCallback: function (a) {
        u = a
      },
      isEligibleFromPageState: function () {
        return a.get().isJavaPipelineEligible
      },
      checkEligibility: function () {
        r = new Date().getTime()
        n && (n.abort(), (n = null))
        var a = f.buildEligibilityPathWithParams()
        p(!0)
        n = e.$.ajax(a, { type: 'POST', data: c(), success: g, error: h })
      },
      setTangoPageStateUrl: l,
      setEligibilityAJAXInProgress: p,
    }
  })
  ;('use strict')
  k.when(
    'A',
    'turbo-configuration',
    'turbo-shopping-portal-switch',
    'java-checkout-url-page-state',
    'turbo-checkout-page-ready',
  ).register('tango-checkout-urls', function (e, a, b, d) {
    function f(a) {
      return 0 === a.length ? '' : '?' + a.join('\x26')
    }
    function c(a, c) {
      var b = [],
        d
      for (d in a)
        if (a.hasOwnProperty(d)) {
          var f = a[d]
          if (c) {
            var e = d
            var g = document.createElement('input')
            g.type = 'hidden'
            g.className = 'checkout-url-migration-request-param'
            g.name = e
            g.value = f
            e = g
          } else e = d + '\x3d' + f
          b.push(e)
        }
      return b
    }
    function g(a) {
      var c = e.$(
        '#sc-buy-box form, #sw-atc-buy-box form, #sc-luxury-buy-box form, #sc-bazaar-buy-box form',
      )
      if (0 !== c.length) {
        var b = document.createDocumentFragment()
        a.forEach(function (a) {
          b.appendChild(a)
        })
        c.append(b)
      }
    }
    function h(a) {
      k.when('ready').execute(function () {
        e.state('checkout-url-migration-page-state', { queryParamString: a })
      })
    }
    var l = 'unknown'
    return {
      buildEligibilityPathWithParams: function () {
        var d = { isAsync: '1', pipelineType: 'Chewbacca' }
        d.referrer = a.get(a.KEYS.HOST_PAGE_TYPE_IDENTIFIER)
        d.ref_ = 'chk_' + l + '_eligibility'
        d = c(d, !1)
        return (
          (b.isShoppingPortalEnabled()
            ? '/checkout/turbo/tango-eligibility'
            : '/checkout/tango-eligibility') + f(d)
        )
      },
      buildProceedToCheckoutPathWithParams: function () {
        var b = d.get(),
          e = { pipelineType: 'Chewbacca' }
        e.referrer = a.get(a.KEYS.HOST_PAGE_TYPE_IDENTIFIER)
        e.ref_ = b.javaCheckoutQueryParams.ref_ || 'ox_' + l + '_proceed'
        var r = c(e, !0)
        g(r)
        e = c(e, !1)
        e = f(e)
        h(e)
        return b.javaCheckoutUrl || '/checkout/entry/cart'
      },
      buildBuyNowToTangoCheckoutPathWithParams: function (b) {
        var d = { pipelineType: 'Chewbacca' }
        d.referrer = a.get(a.KEYS.HOST_PAGE_TYPE_IDENTIFIER)
        d.isBuyNow = '1'
        d.ref_ = (b || 'unknown_buy_now') + '_chw'
        b = c(d, !1)
        return '/checkout/entry/buynow' + f(b)
      },
      setRefMarkerPageContext: function (a) {
        l = a
      },
    }
  })
  ;('use strict')
  k.when('jQuery', 'turbo-checkout-auto-open', 'turbo-checkout-page-ready').register(
    'turbo-checkout-page-load-spinner',
    function (e, a) {
      function b() {
        0 !== e('#turbo-checkout-auto-load-spinner-container').length &&
          (e('#turbo-checkout-auto-load-spinner-container').remove(),
          f.unbind('touchmove touchstart touchend touchcancel click scroll', d))
      }
      function d(a) {
        a.preventDefault()
        a.stopPropagation()
      }
      var f = e('body')
      a.isAutoOpenEligible() &&
        (f.bind('touchmove touchstart touchend touchcancel click scroll', d),
        f.append(
          "\x3cdiv id\x3d'turbo-checkout-auto-load-spinner-container' class\x3d'turbo-checkout-auto-load-spinner-container'\x3e\x3cdiv id\x3d'turbo-checkout-auto-load-circle-container' class\x3d'turbo-checkout-auto-load-circle-container'\x3e\x3cdiv id\x3d'turbo-checkout-auto-load-spinner' class\x3d'a-spinner a-spinner-medium turbo-checkout-auto-load-spinner'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e",
        ),
        setTimeout(b, 5e3))
      return { removePageLoadSpinner: b }
    },
  )
  ;('use strict')
  k.when('turbo-checkout-page-ready').register('turbo-callback-list', function () {
    function e() {
      var a = []
      this.callAll = function () {
        for (var b = 0; b < a.length; b++) {
          var d = a[b]
          d.apply(d, arguments)
        }
      }
      this.push = function (b) {
        if ('function' !== typeof b)
          throw Error(
            "Invalid callback. Expected typeof 'callback' to be 'function'. typeof \x3d " +
              typeof b,
          )
        ;-1 === a.indexOf(b) && a.push(b)
      }
      this.remove = function (b) {
        b = a.indexOf(b)
        ;-1 !== b && a.splice(b, 1)
      }
    }
    return {
      create: function () {
        return new e()
      },
    }
  })
  ;('use strict')
  k.when('turbo-callback-list', 'turbo-checkout-page-ready').register(
    'turbo-filtered-callback-list',
    function (e) {
      function a(a) {
        var b = e.create()
        this.callAll = b.callAll
        this.remove = b.remove
        this.push = function (d) {
          ;(d = d[a]) && 'function' === typeof d && b.push(d)
        }
      }
      return {
        create: function (b) {
          if (!b || 'string' !== typeof b)
            throw Error(
              "Invalid filter parameter. Expected 'filter' to be a non empty string. typeof \x3d " +
                typeof b +
                ' value \x3d ' +
                b,
            )
          return new a(b)
        },
      }
    },
  )
  ;('use strict')
  k.when('A', 'turbo-configuration', 'turbo-checkout-utils', 'turbo-checkout-page-ready').register(
    'turbo-checkout-form',
    function (e, a, b) {
      function d(c) {
        var b = a.get(a.KEYS.FORM_SELECTOR_OVERRIDE)
        if (b && 0 < f(b).length) return f(b)
        b = a.get(a.KEYS.FORM_TYPE)
        if ('link' === b) return c.find('a')
        if ('form' === b) return c.closest('form')
        throw Error('Unsupported FORM_TYPE is configured. value \x3d ' + b)
      }
      var f = e.$,
        c = /[\/?&]ref_?=([^?&]+)/
      return {
        getForms: d,
        getRefTag: function (a) {
          if (1 !== a.length)
            return (
              b.logError(
                'Expected getRefTag input to have a single element. Cannot resolve refTag as this is a data quality risk',
                'turbo-checkout-form',
              ),
              b.logDebug(
                'turbo-checkout-form',
                'Expected getRefTag input to have a single element. Cannot resolve refTag as this is a data quality risk',
                a,
              ),
              ''
            )
          a = d(a)
          a = ((a.attr('action') || a.attr('href') || '') + '\x26' + a.serialize()).match(c) || {}
          return 2 === a.length ? a[1] : ''
        },
      }
    },
  )
  ;('use strict')
  k.when('A', 'turbo-checkout-page-ready').register('turbo-checkout-ajax-wrapper', function (e) {
    return {
      load: function (a, b) {
        b.hasOwnProperty('timeout') || (b.timeout = 2e4)
        return e.ajax(a, b)
      },
      loadWithJQXHR: function (a, b) {
        b.hasOwnProperty('timeout') || (b.timeout = 2e4)
        return e.$.ajax(a, b)
      },
      createXHRRequest: function () {
        var a = new XMLHttpRequest()
        a.timeout = 2e4
        return a
      },
    }
  })
  ;('use strict')
  k.when(
    'A',
    'turbo-checkout-csm',
    'turbo-checkout-utils',
    'turbo-checkout-session-storage',
    'turbo-checkout-quantity-input',
    'turbo-checkout-address-id',
    'turbo-checkout-warranty-input',
    'turbo-checkout-accessories-input',
    'turbo-checkout-navigation-window',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-auto-open', function (e, a, b, d, f, c, g, h, l) {
    function p(a, c) {
      b.logDebug('turbo-checkout-auto-open', a, c)
    }
    function m() {
      return r() && 0 !== w
    }
    function r() {
      var c
      if ((c = '1' === q.trb_open || '1' === b.getUrlQueryParam('trb_open')))
        (c = d.isPresent('hasTurboAutoOpened')) && a.logCount('turboCheckoutAutoOpenLoopPrevented'),
          (c = !c)
      return c
    }
    function n() {
      return 1 === w && r()
    }
    function k() {
      n() &&
        (m() && ((w = 2), d.set('hasTurboAutoOpened', '1')),
        t(q.trb_bid),
        e.trigger('turbo:checkout:auto:open'))
    }
    var u = e.$,
      w = 0,
      A =
        'trb_open trb_addr trb_qty trb_warrAsin trb_auth trb_sid trb_bid trb_accessoryAsin trb_accessoryOffer'.split(
          ' ',
        ),
      q = {},
      t = function () {}
    return {
      setup: function (a, c) {
        if (r()) {
          w = 1
          var d = l.getWindow().location.href
          u.each(A, function (a, c) {
            a = b.getUrlQueryParam(c)
            q[c] = a
            d = b.removeQueryParam(c, a, d)
          })
          p('Parameters:', q)
          b.replaceHistory(d)
          'function' === typeof a
            ? (t = a)
            : b.logError('Initiate action must be supplied, and it must be a function.')
          e.on('turbo:checkout:prefetcher:state:dataStale', k)
          c()
        } else (w = 0), p('Disabled')
      },
      reset: function () {
        d.remove('hasTurboAutoOpened')
      },
      isAutoOpenEligible: r,
      isAutoOpenEnabled: m,
      isAutoOpenReadyToBeOpened: n,
      updateInputsAndThen: function (a) {
        var b = q.trb_qty,
          d = q.trb_addr,
          e = q.trb_warrAsin,
          l = q.trb_bid,
          r = q.trb_accessoryAsin,
          n = q.trb_accessoryOffer
        if (b || d || e || l || r || n) {
          b && f.setQuantity(b)
          d && c.set(d)
          if (e) {
            g.select(e)
            var m = g.getLineItem(b)
          }
          if (r && n) {
            h.select(r)
            var p = h.getLineItem()
          }
          a(b, d, m, l, p)
        }
      },
    }
  })
  ;('use strict')
  k.when('turbo-checkout-navigation-window', 'turbo-checkout-page-ready').register(
    'turbo-checkout-utils',
    function (e) {
      function a() {
        return navigator.userAgent
      }
      function b(a, c) {
        if (a === c || ('function' === typeof a && 'function' === typeof c)) return !0
        if (typeof a !== typeof c) return !1
        if ('object' !== typeof a || null === a || null === c)
          return a === c || (a !== a && c !== c)
        var d = Object.getOwnPropertyNames(a)
        if (d.length !== Object.getOwnPropertyNames(c).length) return !1
        for (var e = 0; e < d.length; e++) {
          var f = d[e]
          if (!a.hasOwnProperty(f) || !c.hasOwnProperty(f) || !b(a[f], c[f])) return !1
        }
        return !0
      }
      var d = {
        '\x26': '\x26amp;',
        '\x3c': '\x26lt;',
        '\x3e': '\x26gt;',
        '"': '\x26quot;',
        "'": '\x26#039;',
      }
      return {
        logError: function (a, c) {
          k.log(a, 'ERROR', c || 'turbo-checkout-utils')
        },
        logWarning: function (a, c) {
          k.log(a, 'WARN', c || 'turbo-checkout-utils')
        },
        logDebug: function () {},
        getUserAgent: a,
        isAndroid: function () {
          return !!a().match(/[a|A]ndroid/)
        },
        isIPhone: function () {
          return !!a().match(/iPhone/)
        },
        isIPad: function () {
          return !!a().match(/iPad/)
        },
        isInternetExplorer: function () {
          return !!a().match(/MSIE/)
        },
        createFQDN: function (a) {
          ;/^http/.test(a) ||
            (a = e.getWindow().location.origin
              ? e.getWindow().location.origin + a
              : e.getWindow().location.protocol +
                '//' +
                e.getWindow().location.hostname +
                ':' +
                e.getWindow().location.port +
                a)
          return a
        },
        getUrlQueryParam: function (a, c) {
          c || (c = e.getWindow().location.href)
          a = a.replace(/[\[\]]/g, '\\$\x26')
          return (a = new RegExp('[?\x26]' + a + '(\x3d([^\x26#]*)|\x26|#|$)').exec(c))
            ? a[2]
              ? decodeURIComponent(a[2].replace(/\+/g, ' '))
              : ''
            : B
        },
        removeQueryParam: function (a, c, b) {
          var d = b
          a &&
            c &&
            b &&
            ((a = a + '\x3d' + c),
            (d = b.replace(new RegExp('\\?' + a + '[\x26]?', 'g'), '?')),
            (d = d.replace(new RegExp('[\x26]?' + a, 'g'), '')))
          return d
        },
        replaceHistory: function (a) {
          e.getWindow().history.pushState &&
            (e.getWindow().history.replaceState(null, e.getWindow().title, a), e.getWindow())
        },
        isNonEmptyString: function (a) {
          return 'string' === typeof a && 0 < a.length
        },
        isDeepEquals: b,
        escapeHtml: function (a) {
          return a.replace(/[&<>"']/g, function (a) {
            return d[a]
          })
        },
      }
    },
  )
  ;('use strict')
  k.when('turbo-checkout-utils', 'turbo-checkout-page-ready').register(
    'turbo-checkout-csm',
    function (e) {
      function a(a, c, b, e) {
        return 'function' === typeof v.uet ? v.uet.apply(v.uet, arguments) : e || d()
      }
      function b(a, c, b) {
        return 'function' === typeof v.ues ? v.ues.apply(v.ues, arguments) : b
      }
      function d() {
        return +new Date()
      }
      function f(c) {
        function e() {
          h && f && l && g && !u && 'function' === typeof k && (k(h, f, l, g), (u = !0))
        }
        var f,
          g,
          l,
          h,
          u = !1,
          k
        this.getId = function () {
          return c
        }
        this.markClick = function () {
          h = a('tc', c)
        }
        this.markFirstByte = function () {
          f = b('t0', c, d())
        }
        this.markAboveTheFold = function () {
          l = a('af', c)
          e()
        }
        this.markCriticalFeature = function () {
          g = a('cf', c)
          e()
        }
        this.whenDataSet = function (a) {
          k = a
          e()
        }
      }
      function c(a) {
        'undefined' !== typeof v.ue_t0 && v.ue.count(a, Date.now() - v.ue_t0)
      }
      var g = 0,
        h = []
      return {
        createScope: function () {
          return new f('chk_turbo_' + ++g)
        },
        logCount: function (a, b) {
          b = b || 1
          e.logDebug('Logging counter ' + a + ' with value ' + b)
          if (v.ue && v.ue.count) {
            var d = a + '_time'
            v.ue.count(a, b)
            c(d)
            for (var f = 0; f < h.length; ++f) v.ue.count(a + '.' + h[f], b), c(d + '.' + h[f])
          }
        },
        logCountSimple: function (a, c) {
          c = c || 1
          e.logDebug('Logging counter ' + a + ' with value ' + c)
          v.ue && v.ue.count && v.ue.count(a, c)
        },
        addCounterExtraSuffix: function (a) {
          h.push(a)
        },
        timestamp: d,
      }
    },
  )
  ;('use strict')
  k.when('A', 'turbo-checkout-csm', 'turbo-checkout-page-ready').register(
    'turbo-checkout-counter',
    function (e, a) {
      var b = 0,
        d = 0,
        f = 0,
        c = 0,
        g = 0,
        h = 0,
        l = 'u'
      e.on('turbo:checkout:sheet:beforeOpen', function () {
        a.logCount('turboCheckoutSheetOpen', b)
        'u' !== l
          ? (++g,
            a.logCount('turboCheckoutPrefetchUsed', g),
            'p' === l
              ? a.logCount('turboCheckoutPrefetchUsedInProgress', g)
              : a.logCount('turboCheckoutPrefetchUsedFull', g))
          : (++h, a.logCount('turboCheckoutPrefetchMissing', h))
      })
      e.on('turbo:checkout:sheet:beforeClose', function () {
        ++d
        a.logCount('turboCheckoutSheetClose', d)
      })
      e.on('turbo:checkout:prefetcher:state:dataPrefetching', function () {
        a.logCount('turboCheckoutPrefetchRequested', f)
        l = 'p'
      })
      e.on('turbo:checkout:prefetcher:state:dataFresh', function () {
        ++c
        a.logCount('turboCheckoutPrefetchAvailable', c)
        l = 'a'
      })
      e.on('turbo:checkout:prefetcher:state:dataStale', function () {
        l = 'u'
      })
      return {
        incrementSheetOpenedCounter: function () {
          b++
        },
        incrementPrefetchCounter: function () {
          f++
        },
        getSheetOpenCount: function () {
          return b
        },
        getPrefetchCount: function () {
          return f
        },
      }
    },
  )
  ;('use strict')
  k.when('turbo-checkout-page-ready').register('turbo-checkout-cacher', function () {
    return {
      createCache: function (e) {
        var a = !1,
          b
        return function () {
          a || ((b = e()), (a = !0))
          return b
        }
      },
    }
  })
  ;('use strict')
  k.when(
    'A',
    'turbo-configuration',
    'turbo-checkout-utils',
    'turbo-checkout-counter',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-ref-tagger', function (e, a, b, d) {
    function f(a, b, e) {
      a = 'chk_' + a + '_' + (b + '_' + d.getPrefetchCount() + '-' + d.getSheetOpenCount())
      return c(e ? a + '_' + e : a)
    }
    function c(a) {
      if (!('string' === typeof a && 0 < a.length && 64 >= a.length && h.test(a)) || l.test(a))
        throw Error(
          'Invalid ref tag. This would be filtered and replaced in clickstream. Value \x3d ' + a,
        )
      return a
    }
    var g = { ELIGIBILITY: 'eligibility', BUY_NOW: 'buyNow', CLOSE: 'close' },
      h = /(^[A-z]$|^[A-z][A-z0-9_-]*[A-Za-z0-9]$)/,
      l = /[_-]{2,}/,
      p = a.get(a.KEYS.HOST_PAGE_TYPE_IDENTIFIER)
    return {
      generateRefTag: function (a, c, b) {
        return 'ref_\x3d' + f(a, c, b)
      },
      generateValue: f,
      generateJoinedValue: function (a) {
        if (!a) return f(p, g.BUY_NOW, 'fallback')
        try {
          var e = a + '_' + (g.BUY_NOW + '_' + d.getPrefetchCount() + '-' + d.getSheetOpenCount())
          return c(e)
        } catch (n) {
          return b.logError(n.message, 'turbo-checkout-ref-tagger'), f(p, g.BUY_NOW, 'fallback')
        }
      },
      generateEligibilityValue: function () {
        return f(p, g.ELIGIBILITY)
      },
      ACTIONS: g,
      TAGS: { TOUCH: 'touch', TOUCH_X: 'touchX', BACK: 'back', ROTATION: 'rotation', DONE: 'done' },
    }
  })
  ;('use strict')
  k.when('A', 'turbo-checkout-page-ready').register('turbo-checkout-prefetch-timer', function (e) {
    function a() {
      c || ((c = !0), e.trigger('turbo:checkout:timer:onTimeout'))
    }
    function b() {
      if (c) return !0
      var a = new Date().getTime()
      return f ? 6e5 <= a - f : !1
    }
    var d,
      f,
      c = !1
    return {
      startTimer: function () {
        d || (d = v.setTimeout(a, 6e5))
        f || (f = new Date().getTime())
      },
      isTimeout: b,
      resetTimer: function () {
        v.clearTimeout(d)
        c = !1
        f = d = null
      },
      checkTimeout: function () {
        b() && a()
      },
    }
  })
  ;('use strict')
  k.when(
    'A',
    'jQuery',
    'turbo-checkout-csm',
    'turbo-checkout-utils',
    'turbo-checkout-state-handler',
    'turbo-checkout-form',
    'turbo-checkout-buy-now-onclick-handler',
    'turbo-configuration',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-buy-now-button', function (e, a, b, d, f, c, g, h) {
    function l(a, c) {
      d.logDebug('turbo-checkout-buy-now-button', a, c)
    }
    function p(c) {
      return c ? m(c) : a(f.getInitiateSelector())
    }
    function m(c) {
      var e = a('#' + c),
        f = h.get(h.KEYS.BUY_NOW_CSS_CLASS_TO_RESOLVE_DUPLICATE_BUTTON_ID)
      if (!f) return e
      var g = a('[id\x3d' + c + ']')
      if (2 > g.length) return e
      b.logCount('turboCheckoutBuyNowDuplicateIdPresent')
      l(
        'Duplicate nodes present for BuyNow button ID: #' +
          c +
          '. Resolving BuyNow button with CSS: ' +
          f,
      )
      g = g.filter(f)
      return 1 !== g.length
        ? (b.logCount('turboCheckoutBuyNowUnableToResolveButtonIdWithCss'),
          d.logError(
            'Unable to resolve a unique BuyNow button with CSS: ' +
              f +
              '. Defaulting to first button with ID: #' +
              c,
            'turbo-checkout-buy-now-button',
            void 0,
          ),
          e)
        : g
    }
    function r(d) {
      l('Buy now button clicked')
      b.logCount('turboCheckoutBuyNowClicked')
      'landscape' === v
        ? b.logCount('turboCheckoutLandscapeOrientation')
        : b.logCount('turboCheckoutPortraitOrientation')
      g.isConflictingOnClickListenerPresent(a(d.currentTarget)) && (C = !0)
      ;(d && d.currentTarget && d.currentTarget.id) ||
        (l(
          'Click event target is INVALID. Expected event target with an id. Turbo will NOT show',
          d,
        ),
        (C = !0))
      if (C) (C = !1), l('Buy now button callbacks supressed')
      else {
        f.resolveProductState(d.currentTarget.id)
        l('Calling buy now button callbacks...')
        var e = !1
        for (var h = 0; h < t.length; h++) e = e || t[h]()
        e
          ? (l('Suppressing default buy now button action'),
            d.preventDefault(),
            d.stopPropagation(),
            d.stopImmediatePropagation(),
            (e = !0))
          : (e = void 0)
        if (e) return !1
      }
      c.getForms(a(d.currentTarget)).attr('data-action', n())
      l('Calling default BuyNow action. User will be sent to Checkout SPC. Turbo will NOT show.')
      b.logCount('turboCheckoutBuyNowDefault')
      g.callCachedOnClickListenerIfPresent(d.currentTarget, d)
      return !0
    }
    function n() {
      return p().attr('name') || 'submit.buy-now'
    }
    function k(a) {
      for (var c = t.length - 1; 0 <= c; --c) t[c] === a && t.splice(c, 1)
    }
    function u(a) {
      if (!a && 1 < p().length)
        throw Error(
          'Button id parameter is NOT present. Cannot execute action without a button id on a page with multiple buy now buttons!',
        )
    }
    function w(a) {
      a = p(a)
      A(a)
      a.click()
    }
    function A(c) {
      for (var d = h.get(h.KEYS.CONFLICTING_INITIATE_LISTENERS), e = 0; e < d.length; e++) {
        var f = d[e]
        l("Unbound configured event '" + f + "' from buy now button")
        b.logCount('turboCheckoutBuyNowButtonConflictingListeners')
        c.unbind(f)
        a(document.body).undelegate(c.selector, f)
      }
    }
    var q = h.get(h.KEYS.BUY_NOW_CLICK_EVENT),
      t = [],
      C = !1,
      v = 'portrait'
    e.on('turbo:checkout:clickInitiate', w)
    e.on('turbo:checkout:orientation:onChange', function (a) {
      v = a.orientation
    })
    b.logCount('turboCheckoutBuyNowButtonBound')
    return {
      registerOnClickCallback: function (a) {
        k(a)
        t.push(a)
      },
      deregisterOnClickCallback: k,
      executeOriginalBuyNowAction: function (a) {
        u(a)
        C = !0
        var d = c.getForms(p(a)).attr('action')
        d && -1 !== d.indexOf('/checkout/entry/buynow')
          ? b.logCount('turboCheckoutYieldToTango')
          : b.logCount('turboCheckoutYieldToGurupa')
        e.trigger('turbo:checkout:buyNowDisabled')
        e.trigger('turbo:checkout:clickInitiate', a)
      },
      executeTurboBuyNowAction: function (a) {
        u(a)
        C = !1
        w(a)
      },
      getSubmitAction: n,
      bindTurboClickEvent: function (a) {
        a = a || p()
        g.removeConflictingOnClickListenerIfPresentAndCacheIt(a)
        a.unbind(q).bind(q, r)
      },
      removeConflictingListeners: A,
      getBuyNowButtons: p,
    }
  })
  ;('use strict')
  k.when(
    'A',
    'jQuery',
    'turbo-checkout-csm',
    'turbo-checkout-utils',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-buy-now-onclick-handler', function (e, a, b, d) {
    function f(c, b) {
      c.each(function (c, d) {
        a(d).removeProp(b)
      })
    }
    function c(c, b) {
      var d = !1
      c.each(function () {
        var c = a(this),
          e = c.find('[onclick]'),
          f = c.prop('onclick'),
          g = e.prop('onclick')
        return (l(f) && l(g)) || 1 < e.length || !l(f || g) || h(c) !== b ? ((d = !0), !1) : !0
      })
      return d
    }
    function g(a) {
      return a.prop('onclick') || a.find('[onclick]').prop('onclick')
    }
    function h(a) {
      return a.attr('onclick') || a.find('[onclick]').attr('onclick')
    }
    function l(a) {
      return 'function' === typeof a
    }
    function p(a, c) {
      d.logDebug('turbo-checkout-buy-now-onclick-handler', a, c)
    }
    var m
    return {
      callCachedOnClickListenerIfPresent: function (a, c) {
        l(m) &&
          (p('BuyNow button onclick listener function called.'),
          b.logCount('turboCheckoutBuyNowButtonOnClickListenerCalled'),
          m.call(a, c.originalEvent))
      },
      removeConflictingOnClickListenerIfPresentAndCacheIt: function (a) {
        var d = g(a),
          e = h(a)
        l(d) &&
          e &&
          (c(a, e)
            ? (p(
                "[DOM ERROR] Turbo will NOT show. BuyNow button node has INVALID 'onclick' DOM structure.",
                a,
              ),
              b.logCount('turboCheckoutBuyNowButtonInvalidOnClickDOM'))
            : (p(
                "BuyNow button node has 'onclick' attribute. Removing its listener and caching it.",
                a,
              ),
              b.logCount('turboCheckoutBuyNowButtonOnClickListenerRemoveAndCache'),
              (m = d),
              (d = a.find('[onclick]')),
              f(a, 'onclick'),
              f(d, 'onclick')))
      },
      isConflictingOnClickListenerPresent: function (a) {
        if ((a = l(g(a))))
          p("Turbo will NOT show. BuyNow button node has conflicting 'onclick' listener."),
            b.logCount('turboCheckoutBuyNowButtonConflictingOnClickListener')
        return a
      },
    }
  })
  ;('use strict')
  k.when(
    'A',
    'turbo-checkout-utils',
    'turbo-checkout-buy-now-button',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-buy-now-integration', function (e, a, b) {
    function d(c, b) {
      a.logDebug(c, 'turbo-checkout-buy-now-integration', b)
    }
    var f = e.$,
      c = []
    e.on('turbo:checkout:page:reappear', function () {
      d('Removing additional form inputs from form', c)
      for (var a; (a = c.shift()) !== B; ) a.remove()
    })
    return {
      isBuyNow: function (a) {
        return a instanceof f && a.attr('data-action') === b.getSubmitAction()
      },
      checkoutWith: function (b, e) {
        if (Array.isArray(b) && e instanceof f) {
          var g = e
          for (
            var h = 1;
            0 < g.find('input[name\x3d"asin.' + h + '"]').length ||
            0 < g.find('input[name\x3d"offeringID.' + h + '"]').length;

          )
            h++
          g = h
          h = []
          for (var m = 0; m < b.length; m++) {
            var k = b[m]
            if (k !== B && k.asin && k.offerListingId) {
              var n = g
              k = [
                f('\x3cinput /\x3e', { type: 'hidden', name: 'asin.' + n, value: k.asin }),
                f('\x3cinput /\x3e', {
                  type: 'hidden',
                  name: 'offeringID.' + n,
                  value: k.offerListingId,
                }),
                f('\x3cinput /\x3e', {
                  type: 'hidden',
                  name: 'quantity.' + n,
                  value: k.quantity || 1,
                }),
              ]
              Array.prototype.push.apply(h, k)
              g++
            } else
              d(
                'Line item inputs are invalid. Expected "asin" and "offerListingId" keys in object. Customer purchase inputs ignored!',
                k,
              ),
                a.logError(
                  'Line item inputs are invalid. Expected "asin" and "offerListingId" keys in object. Customer purchase inputs ignored!',
                )
          }
          m = e.find('input[name\x3d"itemCount"]')
          1 === m.length
            ? m.val(g)
            : e.append(f('\x3cinput /\x3e', { type: 'hidden', name: 'itemCount', value: g }))
          d('Appended additional buy now inputs.', h)
          e.append.apply(e, h)
          c = h
        } else
          (g =
            'Inputs are invalid. Expected array and jQuery object. lineItems \x3d ' +
            b +
            ' $form \x3d ' +
            e),
            d(g, arguments),
            a.logError(g)
      },
    }
  })
  ;('use strict')
  k.when('turbo-checkout-page-ready').register('turbo-configuration-keys', function (e) {
    var a = {
      HOST_PAGE_TYPE_IDENTIFIER: 'HOST_PAGE_TYPE_IDENTIFIER',
      IS_BUY_NOW_TO_TANGO_ENABLED: 'IS_BUY_NOW_TO_TANGO_ENABLED',
      IS_BUY_NOW_TO_TANGO_PRIME_SPLIT: 'IS_BUY_NOW_TO_TANGO_PRIME_SPLIT',
      BUY_NOW_TO_TANGO_PARAMETER_ALLOW_LIST: 'BUY_NOW_TO_TANGO_PARAMETER_ALLOW_LIST',
      BUY_NOW_TO_TANGO_PARAMETER_ALLOW_LIST_PRIME: 'BUY_NOW_TO_TANGO_PARAMETER_ALLOW_LIST_PRIME',
      BUY_NOW_TO_TANGO_PARAMETER_ALLOW_LIST_NON_PRIME:
        'BUY_NOW_TO_TANGO_PARAMETER_ALLOW_LIST_NON_PRIME',
      BUY_NOW_TO_TANGO_PARAMETER_EXCLUSION_LIST: 'BUY_NOW_TO_TANGO_PARAMETER_EXCLUSION_LIST',
      BUY_NOW_TO_TANGO_PARAMETER_EXCLUSION_LIST_PRIME:
        'BUY_NOW_TO_TANGO_PARAMETER_EXCLUSION_LIST_PRIME',
      BUY_NOW_TO_TANGO_PARAMETER_EXCLUSION_LIST_NON_PRIME:
        'BUY_NOW_TO_TANGO_PARAMETER_EXCLUSION_LIST_NON_PRIME',
      BUY_NOW_TO_TANGO_PARAMETER_TO_FEATURE_MAPPING:
        'BUY_NOW_TO_TANGO_PARAMETER_TO_FEATURE_MAPPING',
      BUY_NOW_TO_TANGO_FEATURE_PARAMETER_GROUP_MAPPING:
        'BUY_NOW_TO_TANGO_FEATURE_PARAMETER_GROUP_MAPPING',
      FORM_TYPE: 'FORM_TYPE',
      FORM_SELECTOR_OVERRIDE: 'FORM_SELECTOR_OVERRIDE',
      BUY_NOW_BUTTON_SELECTOR: 'BUY_NOW_BUTTON_SELECTOR',
      BUY_NOW_BUTTON_V2_SELECTOR: 'BUY_NOW_BUTTON_V2_SELECTOR',
      BUY_NOW_CLICK_EVENT: 'BUY_NOW_CLICK_EVENT',
      BUY_NOW_CSS_CLASS_TO_RESOLVE_DUPLICATE_BUTTON_ID:
        'BUY_NOW_CSS_CLASS_TO_RESOLVE_DUPLICATE_BUTTON_ID',
      QUANTITY_SELECT_SELECTOR: 'QUANTITY_SELECT_SELECTOR',
      ADDRESS_INPUT_SELECTORS: 'ADDRESS_INPUT_SELECTORS',
      SESSION_ID_SELECTOR: 'SESSION_ID_SELECTOR',
      LEGACY_SESSION_ID_IDENTIFIER: 'LEGACY_SESSION_ID_IDENTIFIER',
      WARRANTY_CHECKBOX_INPUT_SELECTOR: 'WARRANTY_CHECKBOX_INPUT_SELECTOR',
      WARRANTY_CHECKBOX_RELATIVE_PARENT_SELECTOR: 'WARRANTY_CHECKBOX_RELATIVE_PARENT_SELECTOR',
      WARRANTY_ASIN_INPUT_NAME: 'WARRANTY_ASIN_INPUT_NAME',
      WARRANTY_OFFER_INPUT_SELECTOR: 'WARRANTY_OFFER_INPUT_SELECTOR',
      AJAX_PAGE_UPDATE_EVENT: 'AJAX_PAGE_UPDATE_EVENT',
      PREFETCH_TREATMENT: 'PREFETCH_TREATMENT',
      NO_PREFETCH_TREATMENT: 'NO_PREFETCH_TREATMENT',
      BUY_NOW_ONLY_TREATMENT: 'BUY_NOW_ONLY_TREATMENT',
      IS_DEVICE_FILTER_REQUIRED: 'IS_DEVICE_FILTER_REQUIRED',
      IS_SIGN_IN_SUPPORTED: 'IS_SIGN_IN_SUPPORTED',
      USES_MASH_WILL_REAPPEAR: 'USES_MASH_WILL_REAPPEAR',
      SHOW_SIGN_IN_INTERFACE: 'SHOW_SIGN_IN_INTERFACE',
      IFRAME_ID: 'IFRAME_ID',
      EXTEND_ELIGIBLE_STATE: 'EXTEND_ELIGIBLE_STATE',
      VIEW_ADAPTER: 'VIEW_ADAPTER',
      PAGE_STATE_PARSING_ROOT_NODE_SELECTOR: 'PAGE_STATE_PARSING_ROOT_NODE_SELECTOR',
      PRODUCT_STATE_PARSING_ROOT_NODE_SELECTOR: 'PRODUCT_STATE_PARSING_ROOT_NODE_SELECTOR',
      JAVA_CHECKOUT_URL_PAGE_STATE_PARSING_ROOT_NODE_SELECTOR:
        'JAVA_CHECKOUT_URL_PAGE_STATE_PARSING_ROOT_NODE_SELECTOR',
      TURBO_PAGE_STATE_KEY: 'TURBO_PAGE_STATE_KEY',
      TURBO_PRODUCT_STATE_KEY: 'TURBO_PRODUCT_STATE_KEY',
      JAVA_CHECKOUT_URL_PAGE_STATE_KEY: 'JAVA_CHECKOUT_URL_PAGE_STATE_KEY',
      DEVICE_OVERRIDE: 'DEVICE_OVERRIDE',
      CONFLICTING_INITIATE_LISTENERS: 'CONFLICTING_INITIATE_LISTENERS',
      VAS_CHANGE_EVENTS: 'VAS_CHANGE_EVENTS',
      VAS_CHECKBOX_SELCTOR: 'VAS_CHECKBOX_SELCTOR',
      CHECKBOX_EXCLUSION_ROOT_NODES: 'CHECKBOX_EXCLUSION_ROOT_NODES',
      MASH_ADAPTER: 'MASH_ADAPTER',
      IS_ADD_TO_CART_ENABLED: 'IS_ADD_TO_CART_ENABLED',
      IS_BUYNOW_ENABLED_FOR_SCREENREADER: 'IS_BUYNOW_ENABLED_FOR_SCREENREADER',
      BACKGROUND_SCROLL_TARGET_SELECTOR: 'BACKGROUND_SCROLL_TARGET_SELECTOR',
      NO_PREFETCH_EXPERIMENT_WEBLABS: 'NO_PREFETCH_EXPERIMENT_WEBLABS',
      ENABLED_ACCESSORIES_SELECTOR: 'ENABLED_ACCESSORIES_SELECTOR',
      OVERRIDE_ELIGIBILITY: 'OVERRIDE_ELIGIBILITY',
      validate: function (b) {
        if ('string' !== typeof b || !a[b])
          throw Error("The key '" + b + "' is not defined within 'turbo-configuration-keys'.")
      },
    }
    return a
  })
  ;('use strict')
  k.when(
    'A',
    'turbo-configuration-keys',
    'turbo-device-configuration',
    'turbo-client-configuration',
    'turbo-eligibility-override',
    'turbo-checkout-page-ready',
  ).register('turbo-configuration', function (e, a, b, d, f) {
    function c(a, c) {
      var b = g(a)
      k[a] = b === B ? c : b
    }
    function g(a) {
      var c = d[a]
      a = b[a]
      if (h(c)) return c
      if (h(a)) return a
    }
    function h(a) {
      return 'boolean' === typeof a || a
    }
    function l(a) {
      if (!h(d[a]) && !h(b[a]))
        throw Error("Required configuration override for key '" + a + "' is missing")
      k[a] = g(a)
    }
    var k,
      m = {
        isGift: 'GiftOptions',
        'items[0.base][additionalParameters][giftOptions][includeGiftReceipt]': 'GiftOptions',
        'gift-wrap': 'GiftOptions',
        offerListingID: 'OfferService',
        snsMostCommonFrequency: 'SNS',
        snsOnmlOfferId: 'SNS',
        snsOptIn: 'SNS',
        rcxOrdFreq: 'SNS',
        snsOfferListingID: 'SNS',
        ref: 'SNS',
        skipCart: '',
        isBuyBack: '',
        shippingAddressID: '',
        tag: '',
        b2brdOptIn: '',
        cartCustomerID: '',
        fromSignIn: '',
        siteState: '',
        mbboid: '',
        mbbq: '',
        mbba: '',
        'openid.assoc_handle': '',
        'openid.claimed_id': '',
        'openid.identity': '',
        'openid.mode': '',
        'openid.ns': '',
        'openid.ns.pape': '',
        'openid.op_endpoint': '',
        'openid.pape.auth_policies': '',
        'openid.pape.auth_time': '',
        'openid.response_nonce': '',
        'openid.return_to': '',
        'openid.sig': '',
        'openid.signed': '',
        'custom-name.1.incentivizedCart': 'IncentivizedCart',
        'custom-value.1.incentivizedCart': 'IncentivizedCart',
        pickupAddressId: 'BOPIS',
        pickupStoreChainId: 'BOPIS',
        pickupStoreChainOwnerId: 'BOPIS',
        inHouseInstallments: 'UFO',
        'installments-check': 'UFO',
        'installments-programId': 'UFO',
        isInstallmentsChecked: 'UFO',
        paymentOfferInfo: 'UFO',
        'items[0.base][additionalParameters][paymentOfferInfo]': 'UFO',
        'items[0.base][additionalParameters][installments][programId]': 'UFO',
        serial: '',
        a: '',
        checkoutClientId: '',
        'discoveredAsins.1': '',
        customId: '',
        fulfillmentType: '',
        claim_type: '',
        new_account: '',
        returnFromLogin: '',
        captcha_verified: '',
        pickupAsin: '',
        'session-id': '',
        clientName: '',
        merchantID: '',
        useDefaultCart: '',
        distributableLicense: '',
        'asin.1': '',
        'offeringID.1': '',
        'quantity.1': '',
        purchaseAsin: '',
        type: '',
        AssociateTag: '',
        dplnkId: '',
        'submit.buy-now': '',
        'custom-name.2.1': '',
        'address-ui-widgets-enableEmailAddress': '',
        oid: '',
        sr: '',
        ASIN: '',
        'custom-name.1.2': '',
        'address-ui-widgets-enableAddressWizardInlineSuggestions': '',
        'address-ui-widgets-enableAddressWizardForm': '',
        'address-ui-widgets-enterAddressPostalCode': '',
        'address-ui-widgets-locale': '',
        rebateId: '',
        'custom-value.1.5': '',
        'address-ui-widgets-avsSuppressSoftblock': '',
        offerListingId: '',
        'custom-value.1.6': '',
        qid: '',
        cimarronIssuerId: '',
        'custom-name.2.2': '',
        popoverContentStringId: '',
        'custom-name.1.11': '',
        'address-ui-widgets-csrfToken': '',
        registryItemID: '',
        'address-ui-widgets-delivery-instructions-desktop-expander-context': '',
        paymentCadenceValue: '',
        numberOfPayments: '',
        'address-ui-widgets-obfuscated-customerId': '',
        'address-ui-widgets-enterAddressLine2': '',
        'custom-name.1.13': '',
        addressID: '',
        'custom-name.1.3': '',
        'address-ui-widgets-amazonBusinessGroupId': '',
        'custom-name.2.3': '',
        timestamp: '',
        'ppw-widgetState': '',
        taxDistributionStrategy: '',
        'address-ui-widgets-enableLatestAddressWizardForm': '',
        'custom-value.2.3': '',
        'custom-value.2.1': '',
        'custom-value.2.2': '',
        'custom-value.1.13': '',
        'address-ui-widgets-enterAddressFullName': '',
        'inHouseInstallments-programType': '',
        'address-ui-widgets-enableAddressDetails': '',
        _from: '',
        'address-ui-widgets-enterAddressPhoneNumber': '',
        'custom-value.1.0': '',
        'address-ui-widgets-locationData': '',
        turboPageRequestId: '',
        'custom-name.2.4': '',
        'address-ui-widgets-delivery-instructions-data': '',
        'address-ui-widgets-enterAddressCity': '',
        quantity: '',
        paymentCadenceUnit: '',
        'address-ui-widgets-returnLegacyAddressID': '',
        addressId: '',
        'custom-value.1.7': '',
        purchaseInputs: '',
        'custom-value.1.1': '',
        'custom-name.1.1': '',
        'preorder-button': '',
        'address-ui-widgets-heading-string-id': '',
        ref_: '',
        'address-ui-widgets-enterAddressStateOrRegion': '',
        triggerTurboWeblab: '',
        'custom-value.1.2': '',
        'custom-name.1.4': '',
        sessionID: '',
        'address-ui-widgets-enableDeliveryInstructions': '',
        'address-ui-widgets-avsSuppressSuggestion': '',
        'custom-name.1.6': '',
        ttclid: '',
        'address-ui-widgets-countryCode': '',
        'custom-name.1.5': '',
        turboPageSessionId: '',
        'address-ui-widgets-ab-delivery-instructions-data': '',
        'address-ui-widgets-form-load-start-time': '',
        'custom-value.1.3': '',
        termsAndConditionUrl: '',
        'custom-value.1.11': '',
        offeringID: '',
        'custom-name.1.0': '',
        'address-ui-widgets-addressFormHideHeading': '',
        'address-ui-widgets-address-wizard-interaction-id': '',
        'custom-name.1.7': '',
        'address-ui-widgets-use-as-my-default': '',
        'custom-name.1.12': '',
        'custom-value.1.12': '',
        'address-ui-widgets-addressFormButtonText': '',
        offerConfigurationType: '',
        'address-ui-widgets-clientName': '',
        registryID: '',
        'address-ui-widgets-enableAddressTips': '',
        buyNow: '',
        'address-ui-widgets-previous-address-form-state-token': '',
        asin: '',
        fbclid: '',
        'custom-value.1.4': '',
        triggerTurboWeblabName: '',
        'custom-value.2.4': '',
        'address-ui-widgets-addressFormHideSubmitButton': '',
        'address-ui-widgets-enterAddressLine1': '',
      },
      r = {},
      n
    for (n in m)
      if (m.hasOwnProperty(n) && '' !== m[n]) {
        var y = m[n]
        r[y] || (r[y] = [])
        r[y].push(n)
      }
    return {
      get: function (b) {
        a.validate(b)
        k ||
          ((k = {}),
          l(a.HOST_PAGE_TYPE_IDENTIFIER),
          l(a.SHOW_SIGN_IN_INTERFACE),
          l(a.EXTEND_ELIGIBLE_STATE),
          l(a.VIEW_ADAPTER),
          c(a.IS_BUY_NOW_TO_TANGO_ENABLED, !1),
          c(a.IS_BUY_NOW_TO_TANGO_PRIME_SPLIT, !1),
          c(a.BUY_NOW_TO_TANGO_PARAMETER_ALLOW_LIST, {}),
          c(a.BUY_NOW_TO_TANGO_PARAMETER_ALLOW_LIST_PRIME, {}),
          c(a.BUY_NOW_TO_TANGO_PARAMETER_ALLOW_LIST_NON_PRIME, {}),
          c(a.BUY_NOW_TO_TANGO_PARAMETER_EXCLUSION_LIST, {}),
          c(a.BUY_NOW_TO_TANGO_PARAMETER_EXCLUSION_LIST_PRIME, {}),
          c(a.BUY_NOW_TO_TANGO_PARAMETER_EXCLUSION_LIST_NON_PRIME, {}),
          c(a.FORM_TYPE, 'form'),
          c(a.FORM_SELECTOR_OVERRIDE, ''),
          c(a.BUY_NOW_BUTTON_SELECTOR, '#buy-now-button'),
          c(a.BUY_NOW_BUTTON_V2_SELECTOR, '.checkout-buy-now'),
          c(a.BUY_NOW_CLICK_EVENT, 'click.turboCheckout'),
          c(a.BUY_NOW_CSS_CLASS_TO_RESOLVE_DUPLICATE_BUTTON_ID, ''),
          c(a.QUANTITY_SELECT_SELECTOR, 'select[name\x3d"quantity"]'),
          c(a.SESSION_ID_SELECTOR, ''),
          c(a.LEGACY_SESSION_ID_IDENTIFIER, ''),
          c(a.ADDRESS_INPUT_SELECTORS, [
            '#unifiedLocation1ClickAddress',
            '#unifiedLocationAddress',
          ]),
          c(a.WARRANTY_CHECKBOX_INPUT_SELECTOR, '.mbb-checkbox input[name\x3dmbba]'),
          c(a.WARRANTY_CHECKBOX_RELATIVE_PARENT_SELECTOR, '.mbb-checkbox-column'),
          c(a.WARRANTY_ASIN_INPUT_NAME, 'mbba'),
          c(a.WARRANTY_OFFER_INPUT_SELECTOR, '#mbb-offering-id'),
          c(a.AJAX_PAGE_UPDATE_EVENT, 'a:pageUpdate'),
          c(a.PREFETCH_TREATMENT, 'PREFETCH_DISABLED'),
          c(a.NO_PREFETCH_TREATMENT, 'T1'),
          c(a.BUY_NOW_ONLY_TREATMENT, 'BUY_NOW_LAUNCHED'),
          c(a.IS_DEVICE_FILTER_REQUIRED, !1),
          c(a.IS_SIGN_IN_SUPPORTED, !0),
          c(a.USES_MASH_WILL_REAPPEAR, !1),
          c(a.IFRAME_ID, 'turbo-checkout-iframe'),
          c(a.PAGE_STATE_PARSING_ROOT_NODE_SELECTOR, '#turboState'),
          c(a.PRODUCT_STATE_PARSING_ROOT_NODE_SELECTOR, '#turboState'),
          c(a.JAVA_CHECKOUT_URL_PAGE_STATE_PARSING_ROOT_NODE_SELECTOR, '#turboState'),
          c(a.TURBO_PAGE_STATE_KEY, 'turbo-checkout-page-state'),
          c(a.TURBO_PRODUCT_STATE_KEY, 'turbo-checkout-page-state'),
          c(a.JAVA_CHECKOUT_URL_PAGE_STATE_KEY, 'java-checkout-url-page-state'),
          c(a.DEVICE_OVERRIDE, ''),
          c(a.CONFLICTING_INITIATE_LISTENERS, []),
          c(
            a.CHECKBOX_EXCLUSION_ROOT_NODES,
            '#simpleBundle_feature_div #monthlyPayments_feature_div #bbg_feature_div #addons_feature_div #mobile-accessory-upsell #twister-plus-feature #payment-options-feature #detailPageGifting_feature_div #giftingODF_feature_div #giftWrapInfoFeature_feature_div #dynamicGiftWrapInfoFeature_feature_div'.split(
              ' ',
            ),
          ),
          c(a.ENABLED_ACCESSORIES_SELECTOR, '.simpleBundleCheckBoxArea'),
          c(a.MASH_ADAPTER, ''),
          c(a.IS_ADD_TO_CART_ENABLED, !0),
          c(a.IS_BUYNOW_ENABLED_FOR_SCREENREADER, !0),
          c(a.BACKGROUND_SCROLL_TARGET_SELECTOR, '#productTitleGroupAnchor'),
          c(a.VAS_CHANGE_EVENTS, ['turbo:checkout:sheet:doClose']),
          c(a.VAS_CHECKBOX_SELCTOR, '#vas-checkbox-input'),
          c(a.VAS_CHANGE_EVENTS, ['turbo:checkout:sheet:doClose']),
          c(a.VAS_CHECKBOX_SELCTOR, '#vas-checkbox-input'),
          c(a.NO_PREFETCH_EXPERIMENT_WEBLABS, ['RCX_CHECKOUT_TURBO_PRIME_UPSELL_222066']),
          c(a.BUY_NOW_TO_TANGO_PARAMETER_TO_FEATURE_MAPPING, m),
          c(a.BUY_NOW_TO_TANGO_FEATURE_PARAMETER_GROUP_MAPPING, r),
          c(a.OVERRIDE_ELIGIBILITY, f))
        var d = k
        return d[b]
      },
      KEYS: e.copy(a),
    }
  })
  ;('use strict')
  k.when(
    'A',
    'turbo-checkout-utils',
    'turbo-checkout-weblab-allocation',
    'turbo-checkout-state-handler',
    'turbo-checkbox-exclusion-listener',
    'turbo-checkout-content-loader',
    'turbo-checkout-device-filter',
    'turbo-callback-list',
    'turbo-checkout-auto-open',
    'turbo-checkout-vas-input',
    'turbo-checkout-accessories-input',
    'turbo-checkout-devices-accessories-input',
    'turbo-checkout-devices-account-linking-input',
    'turbo-checkout-page-ready',
  ).register('turbo-base-eligible-state', function (e, a, b, d, f, c, g, h, l, k, m, r, n) {
    function p() {
      v = !0
    }
    function u() {
      v = !1
    }
    function w() {
      var a = new A()
      g.isDeviceTurboEligible() || a.invalidate('Device is NOT eligible')
      c.isError() && !b.isNoPrefetch() && a.invalidate('Prefetch failed')
      d.isProductTurboEligible() || a.invalidate('Product is NOT eligible')
      l.isAutoOpenEnabled() || v || a.invalidate('Cheetah eligibility response is false')
      b.isControl() && a.invalidate('Weblab is in CONTROL')
      b.isBuyNowOnly() && a.invalidate('Weblab is in buy now only treatment')
      k.isSelected() && a.invalidate('Value added service is selected and NOT supported')
      m.isEligible() || a.invalidate('Accessory selection was not eligible')
      f.isAnyCheckboxChecked() && a.invalidate('Exclusion case checkbox is checked')
      n.isEligible() || a.invalidate('Devices Accessory selection was not eligible')
      r.isEligible() || a.invalidate('Devices Accessory selection was not eligible')
      t.callAll(a)
      a.logInvalidState()
      return a.canShow()
    }
    function A() {
      var c = !0,
        b = []
      this.invalidate = function (a) {
        c = !1
        b.push(a)
      }
      this.logInvalidState = function () {
        c || a.logDebug('turbo-base-eligible-state', 'Cannot show turbo because: ' + b)
      }
      this.canShow = function () {
        return c
      }
    }
    function q(a) {
      C.callAll(w(), a)
    }
    var t = h.create(),
      C = h.create(),
      v = !1
    return {
      addStateCheck: function (a) {
        t.push(a)
      },
      canShow: w,
      registerStateChangeCallback: function (a) {
        C.push(a)
      },
      onStateChange: q,
      setup: function () {
        c.registerCallback({ onTurboEligible: p, onFinish: p, onTurboIneligible: u })
        d.registerCallback(q)
        f.onStateChange(q)
        k.onChange(q)
        m.registerCallback(q)
        r.registerCallback(q)
        n.registerCallback(q)
      },
    }
  })
  ;('use strict')
  k.when('A', 'turbo-callback-list', 'turbo-checkout-page-ready').register(
    'turbo-checkout-base-view',
    function (e, a) {
      function b(b) {
        if ('string' !== typeof b)
          throw Error("Parameter 'iFrameContainerSelector' is not a string.")
        this.onBoundsAdjustedCallbacks = a.create()
        this.IFRAME_CONTAINER_SELECTOR = b
      }
      var d = e.$
      b.prototype.updateBounds = function (a, c) {
        if ('number' !== typeof a)
          throw Error(
            "Parameter 'iFrameContainerHeightInPixels' is not a number. Cannot validate bounds.",
          )
        var b = this.$getIFrameContainer().height(),
          d = a - b,
          e = b + d
        0 !== d &&
          (this.$getIFrameContainer().height(e),
          this.updateScrollHeight(a, c),
          (a = parseInt(this.$getIFrameContainer().css('min-height'), 10)),
          (e = e > a ? e : a),
          b !== e && this.onBoundsAdjustedCallbacks.callAll(e))
      }
      b.prototype.updateScrollHeight = function (a, c) {
        c && a !== c
          ? (this.$getIFrame().height(c),
            this.$getIFrameContainer().css('overflow-y', 'scroll'),
            this.$getIFrameContainer().css('-webkit-overflow-scrolling', 'touch'))
          : (this.$getIFrame().height('100%'),
            this.$getIFrameContainer().css('overflow-y', ''),
            this.$getIFrameContainer().css('-webkit-overflow-scrolling', ''))
      }
      b.prototype.getHeight = function () {
        return this.$getIFrameContainer().height()
      }
      b.prototype.$getIFrameContainer = function () {
        return d(this.IFRAME_CONTAINER_SELECTOR)
      }
      b.prototype.$getIFrame = function () {
        return d(this.IFRAME_CONTAINER_SELECTOR + ' iframe')
      }
      b.prototype.pushBoundsAdjustedCallback = function (a) {
        this.onBoundsAdjustedCallbacks.push(a)
      }
      return {
        extend: function () {
          function a() {
            b.apply(this, arguments)
          }
          a.prototype = Object.create(b.prototype)
          return (a.prototype.constructor = a)
        },
      }
    },
  )
  ;('use strict')
  k.when('turbo-configuration', 'turbo-checkout-page-ready').execute(
    'turbo-eligible-state-check',
    function (e) {
      e.get(e.KEYS.EXTEND_ELIGIBLE_STATE) ||
        k.when('turbo-base-eligible-state').register('turbo-checkout-eligible-state', function (a) {
          return {
            canShow: a.canShow,
            registerStateChangeCallback: a.registerStateChangeCallback,
            setup: a.setup,
          }
        })
    },
  )
  ;('use strict')
  k.when(
    'A',
    'turbo-checkout-state-handler',
    'turbo-configuration',
    'turbo-checkout-utils',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-weblab-allocation', function (e, a, b) {
    function d() {
      return a.getWeblabAllocation()
    }
    function f() {
      return a.getExperimentName()
    }
    function c(c) {
      for (var b = a.getAdditionalWeblabAndTreatmentMap(), d = {}, e = 0; e < c.length; e++)
        b.hasOwnProperty(c[e]) && (d[c[e]] = b[c[e]])
      return d
    }
    function g() {
      var c = a.getAdditionalWeblabAndTreatmentMap(),
        b = {},
        d
      for (d in c) c.hasOwnProperty(d) && -1 === k.indexOf(d) && (b[d] = c[d])
      return b
    }
    function h() {
      return 'C' === d()
    }
    function l() {
      var a = b.get(b.KEYS.NO_PREFETCH_EXPERIMENT_WEBLABS)
      return Array.isArray(a) && -1 !== a.indexOf(f()) && !h()
    }
    var k =
        'PAX_CHECKOUT_BUY_NOW_TO_TANGO_MOBILE_EXPERIMENT_969578 PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581 PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576 PAX_CHECKOUT_BUY_NOW_TO_TANGO_PARAMETER_ELIGIBILITY_REVERSE_MOBILE_1089851 PAX_CHECKOUT_BUY_NOW_TO_TANGO_PARAMETER_ELIGIBILITY_REVERSE_DESKTOP_1089853 UPMT_CHECKOUT_BUY_NOW_GIFT_TANGO_MOBILE_1044567 UPMT_CHECKOUT_BUY_NOW_GIFT_TANGO_DESKTOP_1044576 PAX_CHECKOUT_BUY_NOW_TO_TANGO_PARAMETER_ELIGIBILITY_REVERSE_MOBILE_BATCH2_1114210 PAX_CHECKOUT_BUY_NOW_TO_TANGO_PARAMETER_ELIGIBILITY_REVERSE_DESKTOP_BATCH2_1114232 PAX_CHECKOUT_BUY_NOW_UFO_TANGO_MOBILE_1116443 PAX_CHECKOUT_BUY_NOW_UFO_TANGO_DESKTOP_1118473 PAX_CHECKOUT_BUY_NOW_AMP_TANGO_MOBILE_1118485 PAX_CHECKOUT_BUY_NOW_AMP_TANGO_DESKTOP_1118500'.split(
          ' ',
        ),
      m = [
        'PAX_TURBO_INITIATE_MIGRATION_MOBILE_868121',
        'PAX_TURBO_INITIATE_MIGRATION_MOBILE_NON_PRIME_986683',
        'PAX_TURBO_INITIATE_MIGRATION_DESKTOP_868123',
        'PAX_TURBO_INITIATE_MIGRATION_DESKTOP_NON_PRIME_986684',
      ]
    return {
      getAllocation: d,
      getExperimentName: f,
      getAdditionalWeblabAndTreatmentMap: g,
      getBuyNowToTangoWeblabs: function () {
        return c(k)
      },
      getTurboRedesignWeblabs: function () {
        return c(m)
      },
      getHoldbackSecondaryPanelsWeblab: function () {
        return a.getHoldbackSecondaryPanelsWeblab()
      },
      isControl: h,
      isBuyNowOnly: function () {
        return d() === b.get(b.KEYS.BUY_NOW_ONLY_TREATMENT)
      },
      isDisableTurboWeblabInTreatment: function () {
        for (
          var a = g(),
            c = [
              'RCX_CHECKOUT_DISABLE_TURBO_FOR_NPA_EXPERIMENT_543201',
              'RCX_CHECKOUT_DISABLE_TURBO_FOR_PRIME_MOBILE_EXPERIMENT_601969',
              'RCX_CHECKOUT_DISABLE_TURBO_FOR_PRIME_DESKTOP_EXPERIMENT_601976',
            ],
            b = 0;
          b < c.length;
          b++
        ) {
          var d = c[b]
          if (d in a && 'T1' === a[d]) return !0
        }
        return !1
      },
      isPrefetch: function () {
        return !l() && d() === b.get(b.KEYS.PREFETCH_TREATMENT)
      },
      isNoPrefetch: function () {
        var a = b.get(b.KEYS.NO_PREFETCH_TREATMENT)
        return l() || !!d().match(a)
      },
    }
  })
  ;('use strict')
  k.when(
    'A',
    'jQuery',
    'turbo-checkout-ajax-wrapper',
    'turbo-checkout-utils',
    'turbo-checkout-urls',
    'turbo-checkout-csm',
    'turbo-checkout-weblab-allocation',
    'turbo-checkout-buy-now-button',
    'turbo-checkout-form',
    'turbo-configuration',
    'turbo-checkout-state-handler',
    'turbo-checkout-eligibility-response-weblabs',
    'turbo-checkout-eligible-state',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-weblab-trigger', function (e, a, b, d, f, c, g, h, l, k, m, r, n) {
    function p() {
      e.on('turbo:checkout:prefetch:onTurboEligible', function () {
        B = !0
        q()
      })
    }
    function u() {
      e.on('turbo:checkout:prefetch:onTurboIneligible', function () {
        B = !1
        q()
      })
    }
    function w() {
      e.on('a:pageUpdate', function () {
        q()
      })
    }
    function A() {
      e.on('turbo:checkout:auto:open', function () {
        H()
      })
    }
    function q() {
      0 === t().length
        ? c.logCount('turboCheckoutBuyNowButtonMissing')
        : 0 === l.getForms(t()).length && c.logCount('turboCheckoutBuyNowFormMissing')
      0 < l.getForms(t()).length &&
        (B
          ? (d.logDebug(
              'turbo-checkout-weblab-trigger',
              'Adding trigger to form: ' + g.getAllocation(),
            ),
            E.val(g.getAllocation()),
            z.val(g.getExperimentName()),
            D.val(m.getRequestId()),
            x.val(m.getSessionId()),
            l.getForms(t()).append(E, z, D, x))
          : (d.logDebug(
              'turbo-checkout-weblab-trigger',
              'Removing trigger from form: ' + g.getAllocation(),
            ),
            E.remove(),
            z.remove(),
            D.remove(),
            x.remove()))
    }
    function t() {
      var c = k.get(k.KEYS.BUY_NOW_BUTTON_SELECTOR),
        b = k.get(k.KEYS.BUY_NOW_BUTTON_V2_SELECTOR)
      return 0 === a(c).length ? a(b) : a(c)
    }
    function C() {
      if ((r.get() && 0 < r.get().length) || (B && !m.isTurboLaunched())) {
        d.logDebug(
          'turbo-checkout-weblab-trigger',
          'Calling cheetah to trigger: ' + g.getAllocation(),
        )
        0 < l.getForms(t()).find(E).length || c.logCount('turboCheckoutTriggerMissing')
        var a =
          !B || m.isTurboLaunched()
            ? f.buildTriggerWeblabPathWithoutWeblab(m.getRefTag, m.getRequestId(), m.getSessionId())
            : f.buildTriggerWeblabPathWith(
                m.getRefTag(),
                g.getExperimentName(),
                g.getAllocation(),
                m.getRequestId(),
                m.getSessionId(),
              )
        if (B && !m.isTurboLaunched() && n.canShow()) {
          var b = g.getAdditionalWeblabAndTreatmentMap()
          var e = [],
            h
          for (h in b) b.hasOwnProperty(h) && e.push({ weblabName: h, weblabAllocation: b[h] })
          b = e
        } else b = []
        H(a, b)
      }
    }
    function H(b, d) {
      d = [].concat(d).concat(r.get())
      d = { additionalWeblabsToTrigger: JSON.stringify(d) }
      var e = 'function' === typeof v.Blob
      'function' === typeof v.navigator.sendBeacon && e
        ? ((d = new Blob([a.param(d)], { type: 'application/x-www-form-urlencoded' })),
          v.navigator.sendBeacon(b, d) || c.logCount('turboCheckoutTriggerRecordingFailed'))
        : F(b, d)
    }
    function F(a, d) {
      b.load(a, {
        method: 'POST',
        params: d,
        error: function (a, b, d) {
          ;(a && 204 === a.http.status) || c.logCount('turboCheckoutTriggerRecordingFailed')
        },
        abort: function (a) {
          c.logCount('turboCheckoutTriggerRecordingFailed')
        },
      })
    }
    var E,
      z,
      D,
      x,
      B = !1
    return {
      setup: function () {
        E = a('\x3cinput/\x3e', { type: 'hidden', name: 'triggerTurboWeblab', value: '' })
        z = a('\x3cinput/\x3e', { type: 'hidden', name: 'triggerTurboWeblabName', value: '' })
        D = a('\x3cinput/\x3e', { type: 'hidden', name: 'turboPageRequestId', value: '' })
        x = a('\x3cinput/\x3e', { type: 'hidden', name: 'turboPageSessionId', value: '' })
        w()
        p()
        u()
        h.registerOnClickCallback(C)
        A()
      },
      sendTurboWeblabRequest: H,
    }
  })
  ;('use strict')
  k.when(
    'A',
    'turbo-checkout-form',
    'turbo-checkout-utils',
    'turbo-checkout-state-handler',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-page-filter', function (e, a, b, d) {
    function f(a, d) {
      b.logDebug('turbo-checkout-page-filter', a, d)
    }
    return {
      isCurrentViewTurboEligible: function () {
        var c = e.$(d.getInitiateSelector()),
          b = a.getForms(c),
          h = 0 < c.length && c.length === b.length
        h ||
          (f(
            'Page is NOT turbo eligible. Parent forms / nested links do not match the number of initiate selectors',
            c,
          ),
          f('Forms', b))
        return h
      },
    }
  })
  ;('use strict')
  k.when('turbo-configuration', 'turbo-checkout-page-ready').execute(
    'turbo-device-filter-check',
    function (e) {
      e.get(e.KEYS.IS_DEVICE_FILTER_REQUIRED) ||
        k
          .when('turbo-checkout-cacher', 'turbo-checkout-page-ready')
          .register('turbo-checkout-device-filter', function (a) {
            var b = function () {
              return !0
            }
            return {
              isDeviceTurboEligible: a.createCache(b),
              isSignInSupported: a.createCache(b),
              isMashBeta: a.createCache(function () {
                return !1
              }),
              isBuyNowToTangoSupported: a.createCache(b),
            }
          })
    },
  )
  ;('use strict')
  k.when(
    'A',
    'turbo-checkout-state-handler',
    'turbo-checkout-device-filter',
    'turbo-checkout-page-filter',
    'turbo-checkout-weblab-allocation',
    'buy-now-to-tango-switch',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-eligibility-aggregator', function (e, a, b, d, f, c) {
    function g() {
      return d.isCurrentViewTurboEligible() && a.isProductTurboEligible() && !f.isBuyNowOnly()
    }
    return {
      isTurboEligible: g,
      isTurboOrTangoPrefetchEligible: function () {
        return g() || (c.isEnabled() && a.isProductTangoEligible())
      },
      isSignInSupported: function () {
        return b.isSignInSupported() && !f.isBuyNowOnly()
      },
      shouldAttemptTangoPrefetch: function () {
        return c.isEnabled() && a.isProductTangoEligible()
      },
      shouldAttemptTurboPrefetch: function () {
        return b.isDeviceTurboEligible() && !f.isBuyNowOnly()
      },
    }
  })
  ;('use strict')
  k.when(
    'A',
    'turbo-view-adapter',
    'turbo-checkout-ref-tagger',
    'turbo-filtered-callback-list',
    'turbo-checkout-state-handler',
    'turbo-checkout-ajax-wrapper',
    'turbo-checkout-utils',
    'turbo-checkout-urls',
    'turbo-checkout-csm',
    'turbo-checkout-eligibility-aggregator',
    'turbo-checkout-eligibility-response-weblabs',
    'turbo-checkout-accessories-input',
    'turbo-chewbacca-migration-switch',
    'turbo-chewbacca-migration-shadow',
    'turbo-initiate-migration-switch',
    'buy-now-to-tango-switch',
    'turbo-checkout-navigation-window',
    'turbo-chewbacca-migration-optimistic-flushing',
    'turbo-checkout-weblab-allocation',
    'turbo-checkout-page-ready',
  ).register(
    'turbo-checkout-content-loader',
    function (e, a, b, d, f, c, g, h, l, k, m, r, n, y, u, w, A, q, t) {
      function p(d) {
        l.logCount('turboCheckoutInitiate')
        P()
        L = !1
        S = d
        M = Date.now()
        z('Notifying loading callbacks')
        G = 'started'
        T.callAll()
        e.trigger('turbo:checkout:prefetch:onStart')
        d &&
          (w.isEnabled() &&
            f.isProductTangoEligible() &&
            l.logCount('tangoCheckCustomerEligibilityPrefetchStarted'),
          k.shouldAttemptTurboPrefetch &&
            k.isTurboEligible() &&
            l.logCount('turboCheckCustomerEligibilityPrefetchStarted'))
        l.logCount('turboCheckoutPrefetchStart')
        var g = d ? [] : f.getLineItems(),
          t = d ? b.generateEligibilityValue() : f.getRefTag()
        g = (d ? h.buildEligibilityPathWith : h.buildInitiatePathWith)(
          t,
          f.getExperimentName(),
          f.getClientId(),
          f.getRequestId(),
          f.getSessionId(),
          g,
        )
        u.isEnabled() && a.updateBottomSheetAttributes()
        J = c.loadWithJQXHR(g, {
          type: 'POST',
          data: v(d),
          headers: F(),
          xhr: E,
          success: K,
          error: aa,
        })
      }
      function v(a) {
        var c = { isAsync: 1 }
        f.getAddressId() && (c.addressID = f.getAddressId())
        f.isPhysicalGiftCardExperimentEligible() && (c.isPhysicalGiftCard = !0)
        if (a && r.isEligible() && r.getLineItem()) {
          var b = r.getLineItem()
          c['offerListing.1'] = b.offerListingId
          c['requiresEligibilityCheck.1'] = 'true'
        }
        a ||
          f.getLineItems().forEach(function (a, b) {
            b += 1
            c['offerListing.' + b] = a.offerListingId
            c['quantity.' + b] = a.quantity
            a.incentivizedCart &&
              ((c['incentivizedCart.' + b] = a.incentivizedCart),
              (c.incentivizedCart = a.incentivizedCart))
            a.customItemPrice &&
              ((c['customItemPrice.' + b] = a.customItemPrice),
              (c.customItemPrice = a.customItemPrice))
            var d = a.addToCartTimeAsUnixEpochMilliseconds
            d && (c['addToCartTimeAsUnixEpochMilliseconds.' + b] = d)
            ;(d = a.addToCartSessionId) && (c['addToCartSessionId.' + b] = d)
            a.concealmentEligibilityType &&
              (c['concealmentEligibilityType.' + b] = a.concealmentEligibilityType)
          })
        return c
      }
      function F() {
        var a = { 'x-amz-support-custom-signin': 1 }
        a['x-amz-turbo-checkout-dp-url'] = A.getWindow().location.href
        a['x-amz-checkout-entry-referer-url'] = A.getWindow().location.href
        var c = f.getCSRFToken()
        c && 0 < c.length && (a['x-amz-checkout-csrf-token'] = c)
        return a
      }
      function E() {
        var b = c.createXHRRequest()
        b.receivedDataLength = 0
        b.addEventListener('readystatechange', function () {
          if (Q() && L && (3 === b.readyState || 4 === b.readyState)) {
            var c = b.responseText.substring(b.receivedDataLength)
            0 === b.receivedDataLength ? a.initiateIFrameContent(c) : a.appendToIFrameContent(c)
            b.receivedDataLength = b.responseText.length
          } else if (L || !b.readyState || 2 > b.readyState)
            z('Ignoring ready state changed event because headers already received or missing xhr')
          else if (
            ((L = !0),
            l.logCount('turboCheckoutPrefetchHeadersReceived'),
            l.logCount('turboCheckoutPrefetchHeadersReceivedDuration', Date.now() - M),
            b && b.getResponseHeader('x-amz-turbo-checkout-eligible'))
          ) {
            z('Headers received: Turbo eligible')
            l.logCount('turboCheckoutTurboEligibleAfterCheetahChecks')
            c = b && b.getResponseHeader('x-amzn-checkout-login-required')
            var d = k.isSignInSupported()
            c &&
              (z('Headers received: Signin required'),
              l.logCount('turboCheckoutSigninRequired'),
              d ||
                (z('Sign-in required but it is disabled or not supported.'),
                l.logCount('turboCheckoutSigninNotSupported')))
            if (d || !c)
              z('Notifying turbo eligible callbacks'),
                U.callAll(),
                e.trigger('turbo:checkout:prefetch:onTurboEligible')
            x(b) && V.callAll(b.getResponseHeader('x-amzn-checkout-login-provider'))
            t.isDisableTurboWeblabInTreatment() ? D(b) : N.callAll()
          } else
            z('Headers received: Not turbo eligible'),
              W.callAll(),
              e.trigger('turbo:checkout:prefetch:onTurboIneligible'),
              D(b)
        })
        return b
      }
      function z(a, c) {
        g.logDebug('turbo-checkout-content-loader', a, c)
      }
      function D(a) {
        a && a.getResponseHeader('x-amz-tango-checkout-eligible')
          ? (l.logCount('tangoCheckoutEligibleAfterCheetahChecks'), X.callAll())
          : N.callAll()
      }
      function x(a) {
        return k.isSignInSupported() && a && a.getResponseHeader('x-amzn-checkout-login-required')
      }
      function K(a, c, b) {
        l.logCount('turboCheckoutPrefetchEnd', Date.now() - M)
        J = null
        c = b && b.getResponseHeader('x-amz-turbo-checkout-eligible')
        var d = a && a.match(ba)
        if (d && 0 < d.length)
          try {
            var f = R(d[0])
            var h = R.parseJSON(f.text())
          } catch (O) {
            g.logError('Could not extract page state from cheetah page: ' + O)
          }
        else z('Could not extract page state from response data')
        f = h && 'turbo' === h.pipelineType
        d = h && h.currentPurchaseId && 0 < String(h.currentPurchaseId).trim().length
        var k = b.getResponseHeader('x-amzn-experiment-weblabs-to-trigger')
        if (k !== B) {
          var t = []
          try {
            t = JSON.parse(k)
          } catch (O) {
            console.error('Error parsing additional weblabs from xhr response header: ', O)
          }
          m.set(t)
        }
        f && !d && g.logError('No purchaseid provided, cannot show turbo')
        c && f && d
          ? ('started' !== G &&
              g.logError(
                'turbo-checkout-content-loader',
                'Error processing turbo available callbacks. Expected state to be started but was ' +
                  G,
              ),
            z('Notifying turbo available callbacks'),
            (G = 'success'),
            Y.callAll(a, h),
            e.trigger('turbo:checkout:prefetch:onSuccess'),
            l.logCount('turboCheckoutTurboPrefetchSuccess'))
          : c && x(b)
            ? z('Body received: Eligible and sign-in is supported and required.')
            : b.getResponseHeader('x-amz-checkout-redirect')
              ? A.getWindow().location.replace(b.getResponseHeader('x-amz-checkout-redirect'))
              : (z(
                  'Body received: No turbo page or not eligible: isTurboEligible: ' +
                    c +
                    ' isTurboPage: ' +
                    f +
                    ' hasPurchaseId: ' +
                    d,
                ),
                I(),
                l.logCount('turboCheckoutTurboPrefetchFail'))
      }
      function aa(a, c, b) {
        l.logCount('turboCheckoutPrefetchEnd')
        J = null
        z('Error while initiate', b)
        l.logCount('turboCheckoutTurboPrefetchError')
        'timeout' === c && l.logCount('turboCheckoutInitiateTimeOut')
        I()
      }
      function I() {
        'started' !== G &&
          g.logError(
            'turbo-checkout-content-loader',
            'Error processing turbo not available callbacks. Expected state to be started but was ' +
              G,
          )
        z('Notifying error callbacks')
        G = 'error'
        Z.callAll()
        e.trigger('turbo:checkout:prefetch:onError')
      }
      function P() {
        J && J.abort && (z('Aborting running request...'), J.abort())
      }
      function Q() {
        return u.isEnabled() && !S && q.isEnabled()
      }
      var ba = /<script.*data-a-state.*checkout:conductor:page.*>.*<\/script>/,
        R = e.$,
        J,
        G = 'stopped',
        M,
        L = !1,
        S = !1,
        T = d.create('onStart'),
        Y = d.create('onFinish'),
        Z = d.create('onError'),
        U = d.create('onTurboEligible'),
        W = d.create('onTurboIneligible'),
        X = d.create('onTangoEligible'),
        N = d.create('onTangoIneligible'),
        V = d.create('onSigninRequired')
      e.on('turbo:checkout:signInController:onDoSignIn', I)
      return {
        registerCallback: function (a) {
          T.push(a)
          Y.push(a)
          Z.push(a)
          U.push(a)
          V.push(a)
          W.push(a)
          X.push(a)
          N.push(a)
        },
        callInitiate: function () {
          z('Calling turbo initiate')
          p(!1)
        },
        checkEligibility: function () {
          z('Calling turbo eligibility check only')
          p(!0)
        },
        abortCall: P,
        isSuccess: function () {
          return 'success' === G
        },
        isError: function () {
          return 'error' === G
        },
        isStarted: function () {
          return 'started' === G
        },
        shadowCallChewbaccaInitiate: function () {
          n.isShadowModeEnabled() && y.shadowCallChewbaccaInitiate()
        },
        isTurboOptimisticFlushingEnabled: Q,
      }
    },
  )
  ;('use strict')
  k.when(
    'A',
    'jQuery',
    'turbo-checkout-ref-tagger',
    'turbo-checkout-utils',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-history-manager', function (e, a, b, d) {
    function f() {
      if (v.history.state && v.history.state.turboAction) return v.history.state.turboAction
    }
    function c() {
      f()
      f() ||
        (d.logDebug('turbo-checkout-history-manager', 'Adding turbo history state'),
        v.history.pushState({ turboAction: 'popover' }, document.title + ' Turbo open'))
    }
    var g = !1
    a(v).bind('popstate.turbo', function (a) {
      f()
      g
        ? (d.logDebug('turbo-checkout-history-manager', 'Trigger Subpanel Back Clicked'),
          e.trigger('turbo:checkout:dimmer:clicked'),
          (g = !1),
          c())
        : f()
          ? (d.logDebug('turbo-checkout-history-manager', 'Trigger sheet open'),
            e.trigger('turbo:checkout:sheet:doOpen'))
          : (d.logDebug('turbo-checkout-history-manager', 'Trigger sheet close'),
            e.trigger('turbo:checkout:sheet:doClose', { immediate: !1, reason: b.TAGS.BACK }))
    })
    return {
      sheetOpened: c,
      sheetClosed: function () {
        f()
        f() &&
          (d.logDebug('turbo-checkout-history-manager', 'Removing turbo history state'),
          v.history.back())
      },
      subPanelOpened: function () {
        g = !0
      },
      subPanelClosed: function () {
        g = !1
      },
    }
  })
  ;('use strict')
  k.when('A', 'turbo-checkout-page-ready').register('turbo-base-visibility-manager', function (e) {
    function a() {
      e.trigger('turbo:checkout:page:gone')
    }
    return {
      setup: function () {
        e.on('turbo:checkout:sheet:onNavigateAway', a)
      },
    }
  })
  k.when('turbo-configuration', 'turbo-checkout-page-ready').execute(
    'turbo-mash-will-reappear-check',
    function (e) {
      e.get(e.KEYS.USES_MASH_WILL_REAPPEAR) ||
        k
          .when('turbo-base-visibility-manager')
          .register('turbo-checkout-page-visibility-manager', function (a) {
            return a
          })
    },
  )
  ;('use strict')
  k.when(
    'A',
    'jQuery',
    'turbo-checkout-view-state',
    'turbo-checkout-weblab-allocation',
    'turbo-checkout-state-handler',
    'turbo-checkout-content-loader',
    'turbo-checkout-prefetch-timer',
    'turbo-checkout-page-visibility-manager',
    'turbo-checkout-counter',
    'turbo-checkout-utils',
    'turbo-checkout-eligibility-aggregator',
    'turbo-checkout-auto-open',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-prefetcher', function (e, a, b, d, f, c, g, h, l, k, m, r) {
    function n(a) {
      var c = u
      u = a
      k.logDebug('turbo-checkout-prefetcher', 'Transitioning from ' + c.name + ' to ' + a.name)
      if (c.onExit) c.onExit(a.name)
      if (a.onEnter) a.onEnter(c.name)
      e.trigger('turbo:checkout:prefetcher:state:' + a.name)
      e.trigger('turbo:checkout:prefetcher:state', a.name)
    }
    var p,
      u,
      w = function () {
        var a = c.isError(),
          b = !m.isTurboOrTangoPrefetchEligible(),
          d = g.isTimeout(),
          e = 0 === p
        k.logDebug(
          'turbo-checkout-prefetcher',
          'Test is data stale: isStaleWhenCheetahReturnsError: ' +
            a +
            ' isStaleWhenProductNotEligiblie: ' +
            b +
            ' isStaleWhenTimeoutOccurs: ' +
            d +
            ' isStaleWhenNoMorePrefetchesAvailable: ' +
            e,
        )
        return a || b || d || e
      },
      A = function () {
        var a = m.isTurboOrTangoPrefetchEligible() && !g.isTimeout() && 0 < p
        k.logDebug(
          'turbo-checkout-prefetcher',
          'Test should prefetch: eligibilityAggregator.isTurboOrTangoPrefetchEligible(): ' +
            m.isTurboOrTangoPrefetchEligible() +
            ' !timer.isTimeout(): ' +
            !g.isTimeout() +
            ' _prefetchesAvailable: ' +
            p,
        )
        return a
      },
      q = {
        name: 'start',
        onEvent: function (a) {
          m.shouldAttemptTurboPrefetch() || m.shouldAttemptTangoPrefetch()
            ? 'controller:onPageLoaded' === a && n(t)
            : (k.logDebug(
                'turbo-checkout-prefetcher',
                'Turbo experience is disabled eligibilityAggregator.shouldAttemptTurboPrefetch() is' +
                  m.shouldAttemptTurboPrefetch() +
                  ' and product is not Tango eligible since eligibilityAggregator.shouldAttemptTangoPrefetch() is also' +
                  m.shouldAttemptTangoPrefetch() +
                  ' Hence customer eligibility prefetch call is not fired',
              ),
              n(B))
        },
        onExit: function () {
          f.startMonitoringPage()
        },
      },
      t = {
        name: 'dataStale',
        onEvent: function (a) {
          'page:gone' !== a && 'prefetch:onError' !== a && 'sheet:afterClose' !== a && A() && n(C)
        },
      },
      C = {
        name: 'dataPrefetching',
        onEnter: function () {
          l.incrementPrefetchCounter()
          d.isPrefetch() || b.isOpeningOrOpen() || r.isAutoOpenReadyToBeOpened()
            ? c.callInitiate()
            : c.checkEligibility()
          --p
        },
        onEvent: function (a) {
          if ('page:gone' === a) n(t)
          else {
            var b = c.isSuccess() && d.isPrefetch(),
              e = c.isSuccess() && d.isNoPrefetch()
            k.logDebug(
              'turbo-checkout-prefetcher',
              'Test is data fresh: isFreshWhenPrefetchResultOKInT1: ' +
                b +
                ' isFreshWhenPrefetchResultOKInT4: ' +
                e,
            )
            b || e ? n(v) : w() ? n(t) : 'product:onChange' === a && A() && n(C)
          }
        },
        onExit: function (a) {
          'dataFresh' !== a && c.abortCall()
        },
      },
      v = {
        name: 'dataFresh',
        onEnter: function () {
          g.startTimer()
        },
        onEvent: function (a) {
          'page:gone' === a
            ? n(t)
            : w()
              ? n(t)
              : (b.isClosed() || 'product:onChange' === a) && A() && n(C)
        },
        onExit: function () {
          g.resetTimer()
        },
      },
      B = { name: 'end' },
      E =
        'controller:onPageLoaded sheet:beforeOpen sheet:afterClose product:onChange prefetch:onSuccess prefetch:onError timer:onTimeout page:gone page:reappear'.split(
          ' ',
        ),
      z = {
        'sheet:beforeOpen': function () {
          p = 10
        },
      }
    return {
      setup: function () {
        p = 10
        u = q
        a.each(E, function (a, c) {
          var b = z[c]
          e.on('turbo:checkout:' + c, function (a) {
            k.logDebug('turbo-checkout-prefetcher', 'Processing ' + c)
            b && b()
            if (u.onEvent) u.onEvent(c)
          })
        })
      },
      getState: function () {
        return u.name
      },
    }
  })
  ;('use strict')
  k.when(
    'A',
    'turbo-signin-adapter',
    'turbo-checkout-content-loader',
    'turbo-checkout-buy-now-button',
    'turbo-checkout-csm',
    'turbo-checkout-weblab-allocation',
    'turbo-checkout-utils',
    'turbo-callback-list',
    'turbo-checkout-state-handler',
    'turbo-checkout-eligible-state',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-signin-controller', function (e, a, b, d, f, c, g, h, l, k) {
    function m() {
      A = !1
    }
    function p(a) {
      A = !0
      q = a
      f.logCount('turboCheckoutSigninRequired')
    }
    function n() {
      var c = A && k.canShow()
      c &&
        (g.logDebug('turbo-checkout-signin-controller', 'Showing sign in dialog'),
        f.logCount('turboCheckoutSigninPopup'),
        a.show(q, y, u),
        e.trigger('turbo:checkout:signInController:onDoSignIn'))
      return c
    }
    function y() {
      g.logDebug('turbo-checkout-signin-controller', 'Signin success')
      f.logCount('turboCheckoutSigninSuccess')
      w.callAll()
    }
    function u() {
      g.logDebug('turbo-checkout-signin-controller', 'Signin failed')
      f.logCount('turboCheckoutSigninFailed')
    }
    var w = h.create(),
      A = !1,
      q
    return {
      setup: function () {
        b.registerCallback({ onStart: m, onSigninRequired: p })
        d.registerOnClickCallback(n)
      },
      registerCallback: w.push,
    }
  })
  ;('use strict')
  k.when(
    'A',
    'turbo-configuration',
    'turbo-callback-list',
    'turbo-filtered-callback-list',
    'turbo-initiate-migration-switch',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-iframe', function (e, a, b, d, f) {
    function c(a) {
      if ('string' !== typeof a)
        throw Error('Attempted to write non-string value to iFrame. typeof \x3d ' + typeof a)
    }
    function g() {
      return e.$('#' + r)
    }
    function h() {
      if (!(0 < g().length))
        throw Error(
          'Attempted to read / write the iFrame without it being in the DOM. This would result in an undefined iFrame document.',
        )
      var a = g()[0]
      return a.contentDocument || a.contentWindow.document
    }
    function k() {
      if (0 < g().length) throw Error('Attempted to insert multiple Turbo Checkout iFrames')
    }
    function p() {
      var a = e.$('\x3ciframe/\x3e', {
        id: r,
        src: 'about:blank',
        scrolling: 'no',
        class: 'turbo-checkout-blank',
      })
      f.isEnabled() && a.css({ borderRadius: '24px 24px 0px 0px' })
      return a
    }
    function m(a) {
      u.push(a)
    }
    var r = a.get(a.KEYS.IFRAME_ID),
      n = d.create('beforeFramePopulated'),
      y = d.create('afterFramePopulated'),
      u = b.create(),
      w = d.create('beforeOptimisticFlushing'),
      A = d.create('afterOptimisticFlushing'),
      q = d.create('csmMarkFirstByte')
    m(function (a) {
      a.addClass('turbo-checkout-shown')
    })
    e.on('turbo:checkout:iframe:document:loaded', function () {
      u.callAll(g())
    })
    return {
      write: function (a) {
        n.callAll()
        a +=
          '\x3cscript\x3e"use strict";window.parent.P.now("turbo-checkout-controller").execute("callbackPageController", function callbackPageController(controller) {controller.frameHtmlRendered();});P.when("load").execute("onTurboDocumentLoaded", function onTurboDocumentLoaded() {window.parent.P.when("A").execute("triggerTurboDocumentLoaded", function triggerTurboDocumentLoaded(A) {A.trigger("turbo:checkout:iframe:document:loaded");});});\x3c/script\x3e'
        c(a)
        var b = h()
        b.open()
        b.write(a)
        b.close()
        y.callAll(g()[0])
      },
      remove: function () {
        g().remove()
      },
      appendTo: function (a) {
        k()
        a.append(p())
      },
      insertInto: function (a) {
        k()
        a.html(p())
      },
      hasContent: function () {
        var a = 0 < g().length && h()
        return a && (a.body.hasChildNodes() || a.head.hasChildNodes())
      },
      registerCallbacks: function (a) {
        n.push(a)
        y.push(a)
        w.push(a)
        A.push(a)
        q.push(a)
      },
      onContentLoaded: m,
      appendToIFrameDocument: function (a, b) {
        c(b)
        var d = h()
        a ? (w.callAll(), d.open(), d.write(b), q.callAll()) : d.write(b)
      },
      finalizeAndAppendCallback: function () {
        var a = h()
        a.write(
          '\x3cscript\x3e"use strict";window.parent.P.now("turbo-checkout-controller").execute("callbackPageController", function callbackPageController(controller) {controller.frameHtmlRendered();});P.when("load").execute("onTurboDocumentLoaded", function onTurboDocumentLoaded() {window.parent.P.when("A").execute("triggerTurboDocumentLoaded", function triggerTurboDocumentLoaded(A) {A.trigger("turbo:checkout:iframe:document:loaded");});});\x3c/script\x3e',
        )
        a.close()
        A.callAll()
      },
    }
  })
  ;('use strict')
  k.when('A', 'turbo-checkout-page-ready').register('turbo-checkout-view-state', function (e) {
    function a(a, b) {
      return function () {
        return f === a || f === b
      }
    }
    function b(a) {
      return function () {
        f = a
        d.apply(d, arguments)
      }
    }
    function d(a, b) {
      a && 'string' === typeof a && e.trigger(a, b)
    }
    var f = 0
    return {
      isClosed: a(0),
      isClosing: a(1),
      isOpen: a(2),
      isOpening: a(3),
      isClosingOrClosed: a(1, 0),
      isOpeningOrOpen: a(3, 2),
      setToOpen: b(2),
      setToOpening: b(3),
      setToClosed: b(0),
      setToClosing: b(1),
    }
  })
  ;('use strict')
  k.when(
    'turbo-checkout-page-load-spinner',
    'turbo-checkout-controller',
    'turbo-checkout-csm',
    'turbo-checkout-page-state',
    'turbo-constants',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-startup', function (e, a, b, d, f) {
    d.get().turboAssetsMode !== f.ASSET_MODE_CLT_CX_ONLY &&
      (e.removePageLoadSpinner(), b.logCount('turboCheckoutControllerPageLoaded'), a.pageLoaded())
  })
  ;('use strict')
  k.when('turbo-checkout-assets-load-trigger').register('turbo-checkout-page-ready', function () {
    v.ue &&
      v.ue.count &&
      'undefined' !== typeof v.ue_t0 &&
      v.ue.count('turboCheckoutPageReady', Date.now() - v.ue_t0)
  })
  ;('use strict')
  k.when(
    'A',
    'turbo-checkout-csm',
    'turbo-checkout-utils',
    'turbo-checkout-state-handler',
    'turbo-checkout-quantity-input',
    'turbo-checkout-warranty-input',
    'turbo-checkout-accessories-input',
    'turbo-checkout-navigation-window',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-authportal-return-query', function (e, a, b, d, f, c, g, h) {
    function k(a) {
      b.logDebug('turbo-checkout-authportal-return-query', a)
    }
    function p(a) {
      return !!a.match('trb_auth\x3d1')
    }
    function m(c) {
      if (p(c)) {
        c = ((c || '').match(y) || [])[1] || ''
        var e = d.getSessionId()
        b.isNonEmptyString(c) || a.logCount('turboCheckoutPostAuthEmptySessionParameter')
        b.isNonEmptyString(e) || a.logCount('turboCheckoutPostAuthEmptySessionPageState')
        b.isNonEmptyString(c) &&
          b.isNonEmptyString(e) &&
          c !== e &&
          (b.logWarning(
            'Turbo Session Flip Detected. Post authentication sessionId \x3d ' +
              e +
              ', Expected \x3d ' +
              c,
            'turbo-checkout-authportal-return-query',
          ),
          a.logCount('turboCheckoutPostAuthSessionFlip'))
      }
    }
    var r = /&?(openid|aToken|serial)[^&]*/g,
      n = /&?trb_(open|auth|qty|warrAsin|sid|accessory(Asin|Offer))=[^&]*/g,
      y = /&?trb_sid=([^&]*)/,
      u = /\?[?&]*/,
      w = /[?&]{2,}/g
    m(h.getWindow().location.search)
    return {
      buildFrom: function (a) {
        k('Initial Query \x3d ' + a)
        a = (a || '?').replace(r, '')
        a = a.replace(n, '')
        a += '\x26trb_auth\x3d1\x26trb_open\x3d1'
        var b = f.getQuantity()
        a += 1 < b ? '\x26trb_qty\x3d' + b : ''
        b = c.getLineItem()
        a += b && b.asin ? '\x26trb_warrAsin\x3d' + b.asin : ''
        b = d.getSessionId()
        a += 0 < b.length ? '\x26trb_sid\x3d' + b : ''
        b = d.getActiveId()
        a += b ? '\x26trb_bid\x3d' + b : ''
        b = g.getLineItem()
        a +=
          b && b.asin && b.offerListingId
            ? '\x26trb_accessoryAsin\x3d' + b.asin + '\x26trb_accessoryOffer\x3d' + b.offerListingId
            : ''
        a = a.replace(u, '?').replace(w, '\x26')
        k('Final Query \x3d ' + a)
        return a
      },
      isReturningFromAuthPortal: p,
      validateSession: m,
    }
  })
  ;('use strict')
  k.when(
    'turbo-checkout-utils',
    'turbo-checkout-csm',
    'turbo-checkout-authportal-return-query',
    'turbo-checkout-navigation-window',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-signin-utils', function (e, a, b, d) {
    function f(a) {
      return null !== a.match(g)
    }
    function c() {
      var a = b.buildFrom(d.getWindow().location.search)
      return encodeURIComponent(
        'https://' +
          d.getWindow().location.hostname +
          d.getWindow().location.pathname.replace(h, '/ref\x3dtrb_chk_auth') +
          a,
      )
    }
    var g = /openid\.return_to=([^&$]+)/,
      h = /(\/ref=[^/]*\/?$|\/?$)/
    return {
      encodeSignInUrl: function (b) {
        if (f(b)) {
          a.logCount('turboCheckoutForceMobileClaimCollection')
          var d = b.match(g)[1],
            h = decodeURIComponent(d)
          d === h && e.logError('The pre-defined returnTo seems to be un-encoded')
          h = encodeURIComponent(
            h + (-1 === h.indexOf('?') ? '?' : '\x26') + 'openid.return_to\x3d' + c(),
          )
          return b.replace(d, h)
        }
        return b + (-1 === b.indexOf('?') ? '?' : '\x26') + 'openid.return_to\x3d' + c()
      },
      isEnforceMobileClaimUrl: function (a) {
        var b =
          null !==
            a.match('openid.pape.preferred_auth_policies%3DEnforcePossessionOnMobileClaim') ||
          null !==
            a.match(
              decodeURIComponent(
                'openid.pape.preferred_auth_policies%3DEnforcePossessionOnMobileClaim',
              ),
            )
        a =
          null !== a.match('intercept%3Dfalse') ||
          null !== a.match(decodeURIComponent('intercept%3Dfalse'))
        return b && a
      },
      _isReturnToParameterPredefined: f,
    }
  })
  ;('use strict')
  k.when(
    'turbo-checkout-utils',
    'turbo-checkout-csm',
    'turbo-checkout-auto-open',
    'turbo-checkout-authportal-return-query',
    'turbo-checkout-signin-utils',
    'turbo-checkout-navigation-window',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-browser-signin', function (e, a, b, d, f, c) {
    function g() {
      var b = c.getWindow().location.search.match(h)
        ? 'turboCheckoutSigninSuccess'
        : 'turboCheckoutSigninFailed'
      a.logCount(b)
    }
    var h = /openid\.mode=id_res/
    d.isReturningFromAuthPortal(c.getWindow().location.search) &&
      (a.logCount('turboCheckoutAuthPortalReturn'), g())
    return {
      show: function (d) {
        d = f.encodeSignInUrl(d)
        a.logCount('turboCheckoutSignInUrlSize', d.length)
        b.reset()
        c.getWindow().location.assign(d)
      },
    }
  })
  ;('use strict')
  k.when(
    'turbo-checkout-utils',
    'turbo-checkout-state-handler',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-strings', function (e, a) {
    function b(b) {
      return function () {
        var d = a.getStrings()[b]
        if (d) return e.escapeHtml(d)
        e.logDebug(
          'turbo-checkout-strings',
          'String for key "' + b + '" is undefined! Returning empty string.',
        )
        return ''
      }
    }
    return {
      getHeaderText: b('TURBO_CHECKOUT_HEADER'),
      getLoadingText: b('TURBO_LOADING_TEXT'),
      getCloseText: b('TURBO_CLOSE_TEXT'),
    }
  })
  ;('use strict')
  k.when(
    'jQuery',
    'A',
    'turbo-checkout-ref-tagger',
    'turbo-checkout-strings',
    'turbo-initiate-migration-switch',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-loading-spinner', function (e, a, b, d, f) {
    function c() {
      return e('#turbo-loading-container')
    }
    function g(a) {
      var b = e('\x3cdiv\x3e', { id: 'turbo-loading-content' }).append(
        e('\x3cdiv\x3e', { id: 'turbo-loading-spinner', class: 'a-spinner a-spinner-medium' }),
      )
      if (f.isEnabled()) {
        var c = e('\x3cspan/\x3e', {
          id: 'turbo-checkout-loading-sheet-dimmer-close',
          tabindex: 0,
          role: 'button',
          'aria-label': d.getCloseText(),
        })
        b.append(c)
        c.bind('click', h)
        c.bind('keypress', k)
      }
      'string' === typeof a &&
        a &&
        b.append(e('\x3cdiv\x3e', { id: 'turbo-loading-text', text: a }))
      return b
    }
    function h() {
      a.trigger('turbo:checkout:sheet:doClose', { reason: b.TAGS.TOUCH_X })
    }
    function k(c) {
      13 === (c.which || c.keyCode || 0) &&
        (c.preventDefault(), a.trigger('turbo:checkout:sheet:doClose', { reason: b.TAGS.TOUCH_X }))
    }
    return {
      create: function (a) {
        return e('\x3cdiv\x3e', { id: 'turbo-loading-container' }).append(g(a))
      },
      get: c,
      show: function () {
        c().addClass('turbo-checkout-shown')
      },
    }
  })
  ;('use strict')
  k.when('A', 'turbo-checkout-utils', 'turbo-checkout-page-ready').register(
    'turbo-checkout-eligibility-response-weblabs',
    function (e, a) {
      var b = []
      return {
        set: function (a) {
          e.$.isArray(a) && (b = a)
        },
        get: function () {
          return b
        },
      }
    },
  )
  ;('use strict')
  k.when('turbo-checkout-csm', 'turbo-checkout-utils', 'turbo-checkout-page-ready').register(
    'turbo-checkout-session-storage',
    function (e, a) {
      function b(b, e) {
        a.logDebug('turbo-checkout-session-storage', b, e)
      }
      return {
        isPresent: function (a) {
          a: {
            try {
              var d = v.sessionStorage.getItem(a)
              break a
            } catch (c) {
              e.logCount('turboCheckoutSessionStorageExceptionGet'),
                b('turboCheckoutSessionStorage get() exception', c)
            }
            d = null
          }
          return null !== d && d !== B
        },
        set: function (a, f) {
          try {
            v.sessionStorage.setItem(a, f)
          } catch (c) {
            e.logCount('turboCheckoutSessionStorageExceptionSet'),
              b('turboCheckoutSessionStorage set() exception', c)
          }
        },
        remove: function (a) {
          try {
            return v.sessionStorage.removeItem(a)
          } catch (f) {
            e.logCount('turboCheckoutSessionStorageExceptionRemove'),
              b('turboCheckoutSessionStorage remove() exception', f)
          }
        },
      }
    },
  )
  ;('use strict')
  k.when('A', 'turbo-configuration', 'turbo-checkout-page-ready').register(
    'turbo-checkout-load-events',
    function (e, a) {
      var b = a.get(a.KEYS.AJAX_PAGE_UPDATE_EVENT)
      return {
        bind: function (a) {
          e.off(b, a)
          e.off('turbo:checkout:controller:onPageLoaded', a)
          e.on(b, a)
          e.on('turbo:checkout:controller:onPageLoaded', a)
        },
      }
    },
  )
  ;('use strict')
  k.when(
    'A',
    'jQuery',
    'turbo-checkout-csm',
    'turbo-checkout-utils',
    'turbo-checkout-buy-now-button',
    'turbo-configuration',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-event-verification', function (e, a, b, d, f, c) {
    function g() {
      var a = c.get(c.KEYS.BUY_NOW_CLICK_EVENT).split('.')
      return 1 < a.length ? a[1] : 'turboCheckout'
    }
    function h(a) {
      var c = a
        .map(function (a) {
          return a.namespace
        })
        .filter(function (a, b, c) {
          return c.indexOf(a) === b
        })
      a.length !== c.length && b.logCount('turboCheckoutBuyNowButtonDuplicateClickHandler')
    }
    function k(a) {
      if (
        (a = a.filter(function (a) {
          return a !== B && 'click' === a.type && 0 <= r.indexOf(a.namespace)
        })) &&
        0 < a.length
      ) {
        var c = 0
        a.forEach(function (a) {
          a.namespace !== g() &&
            (b.logCount('turboCheckoutBuyNowButtonClickHandlerWhitelisted:' + a.namespace), c++)
        })
        0 < c && b.logCount('turboCheckoutBuyNowButtonClickHandlerWhitelistedQuantity:' + c)
      }
    }
    function p(a) {
      if (
        (a = a.filter(function (a) {
          return a !== B && 'click' === a.type && 0 > r.indexOf(a.namespace)
        })) &&
        0 < a.length
      ) {
        var c = 0
        a.forEach(function () {
          b.logCount('turboCheckoutBuyNowButtonClickHandlerNotWhitelisted')
          c++
        })
        b.logCount('turboCheckoutBuyNowButtonClickHandlerNotWhitelistedQuantity:' + c)
      }
    }
    var m = !1,
      r = [
        g(),
        'accessoryUpsellInterstitial',
        'makoPreRegistration',
        'moq',
        'siatc',
        'hctpDFL',
        'bbg',
        'vasBuyNow',
        'ppdBundles',
        'makoGiftingMetrics',
        'financialOptionsCheckout',
      ]
    return {
      logBuyNowButtonClickHandlerMetrics: function () {
        var c = f.getBuyNowButtons()
        if (!m && c && 0 < c.length) {
          for (var e = 0; e < c.length; e++) {
            var g = a._data(c[e], 'events')
            if (!g || !g.click) {
              b.logCount('turboCheckoutBuyNowButtonNoBoundHandlers')
              return
            }
            var l = (g = g.click) ? g.length : 0
            1 < l &&
              (d.logDebug(
                'turbo-checkout-event-verification',
                "Multiple handlers bound to 'click' in Buy Now button. Number of handlers: " + l,
                void 0,
              ),
              b.logCount('turboCheckoutBuyNowButtonMultipleClickEventsBound'),
              b.logCount('turboCheckoutBuyNowButtonMultipleClickEventsBoundQuantity:' + l))
            h(g)
            p(g)
            k(g)
          }
          m = !0
        }
      },
    }
  })
  ;('use strict')
  k.when('turbo-checkout-page-ready').register('turbo-constants', function () {
    return {
      ASSET_MODE_TURBO_ONLY: 'TURBO_ONLY',
      ASSET_MODE_CLT_CX_ONLY: 'CLT_CX_ONLY',
      ASSET_MODE_TURBO_AND_CLT_CX: 'TURBO_AND_CLT_CX',
    }
  })
  ;('use strict')
  k.when(
    'A',
    'turbo-checkout-state-handler',
    'turbo-checkout-ajax-wrapper',
    'turbo-checkout-utils',
    'turbo-checkout-urls',
    'turbo-checkout-csm',
    'turbo-checkout-navigation-window',
    'turbo-checkout-page-ready',
  ).register('turbo-chewbacca-migration-shadow', function (e, a, b, d, f, c, g) {
    function h(a, b) {
      d.logDebug('turbo-chewbacca-migration-shadow', a, b)
    }
    function k() {
      var a = b.createXHRRequest()
      a.addEventListener('readystatechange', function () {
        u || !a.readyState || 2 > a.readyState
          ? h(
              'Chewbacca Request Ignoring ready state changed event because headers already received or missing xhr',
            )
          : ((u = !0),
            c.logCount('turboCheckoutChewbaccaHeadersReceived'),
            c.logCount('turboCheckoutChewbaccaHeadersReceivedDuration', Date.now() - v),
            a && a.getResponseHeader('x-amz-turbo-checkout-eligible')
              ? (h('Chewbacca Request Headers received: Turbo eligible'),
                c.logCount('turboCheckoutChewbaccaEligible'))
              : (h('Chewbacca Request Headers received: Not turbo eligible'),
                c.logCount('turboCheckoutChewbaccaNotEligible')))
      })
      return a
    }
    function p(a, b, e) {
      c.logCount('turboCheckoutChewbaccaCallEnd', Date.now() - v)
      w = null
      b = e && e.getResponseHeader('x-amz-turbo-checkout-eligible')
      if ((a = a && a.match(A)) && 0 < a.length)
        try {
          var f = q(a[0])
          var g = q.parseJSON(f.text())
        } catch (z) {
          d.logError('Chewbacca Request Could not extract page state from chewbacca page: ' + z)
        }
      else h('Chewbacca Request Could not extract page state from response data')
      g = (f = g) && 'turbo' === f.pipelineType
      f = f && f.currentPurchaseId && 0 < String(f.currentPurchaseId).trim().length
      g && !f && d.logError('Chewbacca Request No purchaseid provided, cannot show turbo')
      b && g && f
        ? (h('Notifying Chewbacca Request success'),
          c.logCount('turboCheckoutChewbaccaCallSuccess'))
        : (h('Notifying Chewbacca Request Fail'), c.logCount('turboCheckoutChewbaccaCallFail'))
    }
    function m(a, b, d) {
      c.logCount('turboCheckoutChewbaccaCallEnd')
      w = null
      h('Chewbacca Request Error while initiate', d)
      c.logCount('turboCheckoutChewbaccaCallError')
      'timeout' === b && c.logCount('turboCheckoutChewbaccaInitiateTimeOut')
    }
    function r() {
      var b = { isAsync: 1 }
      a.getAddressId() && (b.addressID = a.getAddressId())
      a.isPhysicalGiftCardExperimentEligible() && (b.isPhysicalGiftCard = !0)
      a.getLineItems().forEach(function (a, c) {
        c += 1
        b['offerListing.' + c] = a.offerListingId
        b['quantity.' + c] = a.quantity
        a.incentivizedCart &&
          ((b['incentivizedCart.' + c] = a.incentivizedCart),
          (b.incentivizedCart = a.incentivizedCart))
        a.customItemPrice &&
          ((b['customItemPrice.' + c] = a.customItemPrice), (b.customItemPrice = a.customItemPrice))
      })
      return b
    }
    function n() {
      var b = { 'x-amz-support-custom-signin': 1 }
      b['x-amz-turbo-checkout-dp-url'] = g.getWindow().location.href
      b['x-amz-checkout-entry-referer-url'] = g.getWindow().location.href
      var c = a.getCSRFToken()
      c && 0 < c.length && (b['x-amz-checkout-csrf-token'] = c)
      return b
    }
    var v,
      u = !1,
      w,
      A = /<script.*data-a-state.*checkout:conductor:page.*>.*<\/script>/,
      q = e.$
    return {
      shadowCallChewbaccaInitiate: function () {
        c.logCount('turboCheckoutChewbaccaInitiate')
        w && w.abort && (h('Aborting running Chewbacca request...'), w.abort())
        u = !1
        v = Date.now()
        c.logCount('turboCheckoutChewbaccaCallStart')
        var d = f.buildInitiatePathWith(
          a.getRefTag(),
          a.getExperimentName(),
          a.getClientId(),
          a.getRequestId(),
          a.getSessionId(),
          a.getLineItems(),
          !0,
        )
        w = b.loadWithJQXHR(d, {
          type: 'POST',
          data: r(),
          headers: n(),
          xhr: k,
          success: p,
          error: m,
        })
      },
    }
  })
  ;('use strict')
  k.when('A', 'turbo-checkout-utils', 'turbo-checkout-page-ready').execute(
    'turbo-checkout-buy-again-workaround',
    function (e, a) {
      e.on('ride:show', function () {
        a.logDebug(
          'turbo-checkout-buy-again-workaround',
          'Firing page:gone event to reset prefetches',
        )
        e.trigger('turbo:checkout:page:gone')
      })
    },
  )
})
/* ******** */
;(function (f) {
  var p = window.AmazonUIPageJS || window.P,
    r = p._namespace || p.attributeErrors,
    a = r ? r('TurboCheckoutDesktopAssets', '') : p
  a.guardFatal
    ? a.guardFatal(f)(a, window)
    : a.execute(function () {
        f(a, window)
      })
})(function (f, p, r) {
  f.when('turbo-configuration-keys', 'turbo-checkout-page-ready').register(
    'turbo-device-configuration',
    function (a) {
      if (!c) {
        var c = {}
        c[a.SHOW_SIGN_IN_INTERFACE] = 'turbo-checkout-browser-signin'
        c[a.EXTEND_ELIGIBLE_STATE] = !1
        c[a.IS_DEVICE_FILTER_REQUIRED] = !0
        c[a.VIEW_ADAPTER] = 'turbo-checkout-modal'
        c[a.WARRANTY_CHECKBOX_INPUT_SELECTOR] = 'input[id^\x3dmbb-offeringID-]'
        c[a.WARRANTY_CHECKBOX_RELATIVE_PARENT_SELECTOR] = '.abbListItem'
        c[a.WARRANTY_OFFER_INPUT_SELECTOR] = 'input[id^\x3dmbb-offeringID-]:checked'
        c[a.WARRANTY_ASIN_INPUT_NAME] = 'asin'
      }
      return c
    },
  )
  ;('use strict')
  f.when(
    'A',
    'turbo-checkout-csm',
    'turbo-checkout-utils',
    'turbo-configuration',
    'turbo-checkout-device-variant',
    'turbo-checkout-is-touch-and-orientation-enabled',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-device-filter', function (a, c, g, f, h, p) {
    function k(a) {
      var b = !1
      this.countOnce = function () {
        b || (c.logCount(a), (b = !0))
      }
    }
    function d(a) {
      g.logDebug('turbo-checkout-device-filter', a)
    }
    var r = 'turboCheckoutDisabledDesktopAuiVariant' + h,
      l,
      b,
      y,
      u,
      t,
      m,
      v
    return {
      isDeviceTurboEligible: function () {
        l = l || new k('Desktop' === h ? 'turboCheckoutDesktopAuiVariantEligible' : r)
        var e
        ;(e = b) ||
          ((e = g.isInternetExplorer()
            ? 'turboCheckoutDisabledDesktopIE'
            : g.isIPad()
              ? 'turboCheckoutDisabledDesktopIPad'
              : g.isIPhone()
                ? 'turboCheckoutDisabledDesktopIPhone'
                : g.isAndroid()
                  ? 'turboCheckoutDisabledDesktopAndroid'
                  : 'turboCheckoutDesktopUserAgentEligible'),
          (e = new k(e)))
        b = e
        y = y || new k('turboCheckoutDisabledDesktopTouch')
        u = u || new k('turboCheckoutDisabledDesktopOrientation')
        t = t || new k('turboCheckoutDisabledDesktopTouchAndOrientation')
        m = m || new k('turboCheckoutDisabledTurboDesktopOnDevice')
        v = v || new k('turboCheckoutEnabledTurboDesktopOnDevice')
        l.countOnce()
        'Desktop' === h ||
          d('Aui device variant is NOT Desktop. Turbo will NOT show. Variant is ' + h)
        ;(e = 'Desktop' !== h) ||
          (b.countOnce(),
          (e = !!(g.isInternetExplorer() || g.isIPad() || g.isAndroid() || g.isIPhone())))
        if (e) return m.countOnce(), !1
        if ((e = a.capabilities.touch))
          y.countOnce(), d('Touch enabled device. Turbo will NOT show')
        var c = a.capabilities.orientation
        c && (u.countOnce(), d('Orientation enabled device. Turbo will NOT show'))
        e && c && t.countOnce()
        if ((e || c) && !p) return m.countOnce(), !1
        v.countOnce()
        return !0
      },
      isSignInSupported: function () {
        return f.get(f.KEYS.IS_SIGN_IN_SUPPORTED)
      },
      isMashBeta: function () {
        return !1
      },
      isBuyNowToTangoSupported: function () {
        return !0
      },
    }
  })
  ;('use strict')
  f.when('turbo-checkout-page-ready').execute(function () {
    f.declare('turbo-checkout-device-variant', 'Desktop')
  })
  ;('use strict')
  f.when(
    'A',
    'a-modal',
    'turbo-checkout-csm',
    'turbo-checkout-utils',
    'turbo-checkout-iframe',
    'turbo-checkout-base-view',
    'turbo-checkout-loading-spinner',
    'turbo-checkout-view-state',
    'turbo-checkout-ref-tagger',
    'turbo-checkout-strings',
    'turbo-checkout-page-ready',
  ).register('turbo-checkout-modal', function (a, c, f, F, h, G, k, d, z, l) {
    function b(a) {
      F.logDebug('turbo-checkout-modal', a)
    }
    function g() {
      !A() || d.isOpeningOrOpen()
        ? b('show() suppressed. View is null or undefined or view state is opening or open')
        : (d.setToOpening(), m().show())
    }
    function u() {
      w && d.isOpeningOrOpen() && (h.appendTo(e()), h.write(w))
    }
    function t() {
      h.remove()
      if (0 < e().length)
        b('Modal frame is in DOM. Inserting Spinner'),
          e().height('').html(k.create(l.getLoadingText())).append(v()),
          q('#turbo-checkout-modal-header').text(l.getHeaderText())
      else {
        b('Modal frame is NOT in DOM. Resetting Modal')
        var a = {
          inlineContent: q('\x3cdiv\x3e', { id: 'turbo-checkout-frame' })
            .html(k.create(l.getLoadingText()))
            .append(v())
            .prop('outerHTML'),
          padding: 'none',
          dataStrategy: 'inline',
          header:
            '\x3cdiv id\x3d"turbo-checkout-modal-header"\x3e' + l.getHeaderText() + '\x3c/div\x3e',
        }
        m().update(a)
      }
    }
    function m() {
      return (B = B || c.get(q('#turbo-checkout-modal')))
    }
    function v() {
      return q('\x3cscript/\x3e', {
        type: 'text/javascript',
        html: 'P.when("A").execute(function turboFrameReady(A) { A.trigger("turbo:checkout:frame:ready"); });',
      })
    }
    function e() {
      return q('#turbo-checkout-frame')
    }
    function x(a) {
      !A() || d.isClosingOrClosed()
        ? b('close() suppressed. View is undefined or null or view state is closing or closed')
        : ((n = a || n),
          (n.notify = !0 === n.notify || n.notify === r),
          d.setToClosing(),
          m().hide())
    }
    function A() {
      var a = m()
      a || b('Modal is undefined or null. Modal \x3d ' + a)
      return a ? !0 : !1
    }
    function C(b) {
      q(document.body).unbind('click')
      b()
      a.trigger('turbo:checkout:sheet:onNavigateAway')
      x({ notify: !1, immediate: !0, doNotLog: !0 })
    }
    function D(a) {
      b('onDismiss')
      n = { notify: !0, reason: a }
    }
    var q = a.$,
      n = {},
      w,
      B,
      E = new (G.extend())('#turbo-checkout-frame')
    h.onContentLoaded(function (a) {
      k.get().remove()
    })
    a.on('a:popover:dismiss:turbo', function () {
      b('onClick_X')
      D(z.TAGS.TOUCH_X)
    })
    a.declarative('a-popover-floating-close', 'click', function () {
      b('onDimmerClicked')
      D(z.TAGS.TOUCH)
    })
    a.on('a:popover:beforeShow:turbo', function () {
      b('onBeforeOpen')
      d.setToOpening('turbo:checkout:sheet:beforeOpen')
      t()
    })
    a.on('a:popover:show:turbo', function () {
      b('onOpen')
      d.setToOpen()
      w || k.show()
    })
    a.on('a:popover:beforeHide:turbo', function () {
      b('onBeforeClose')
      d.setToClosing.apply(d, !0 === n.notify ? ['turbo:checkout:sheet:beforeClose', n] : r)
      e().removeClass('turbo-checkout-shown')
    })
    a.on('a:popover:hide:turbo', function () {
      b('onClose')
      d.setToClosed('turbo:checkout:sheet:afterClose')
      n = {}
    })
    a.on('a:popover:afterHide:turbo', t)
    a.on('turbo:checkout:sheet:doOpen', g)
    a.on('turbo:checkout:sheet:doClose', x)
    a.on('turbo:checkout:frame:ready', u)
    a.on(a.constants.BROWSER_EVENTS.ORIENTATION_CHANGE, function () {
      f.logCount('turboCheckoutDesktopOrientationChange')
      d.isOpen() && f.logCount('turboCheckoutDesktopOrientationChangeWhenModalOpen')
    })
    a.on('turbo:checkout:state:product:resolved', function () {
      q('#turbo-checkout-modal-header').text(l.getHeaderText())
    })
    a.on('turbo:checkout:update:modal:header:afterReload', function (a) {
      null !== a && q('#turbo-checkout-modal-header').text(a)
    })
    return {
      show: g,
      setContent: function (a) {
        w = a
        b('iFrame content saved')
        d.isOpeningOrOpen()
          ? u()
          : (b('setFrameContent NOT called'),
            b('viewState is not opening? isOpeningOrOpen \x3d ' + d.isOpeningOrOpen()),
            b('iFrame already has content? iFrame.hasContent \x3d ' + h.hasContent()))
      },
      removeContent: function () {
        w = ''
        t()
      },
      close: x,
      closeToFullscreen: function (a) {
        C(function () {
          p.location.href = a
        })
      },
      closeImmediatelyThenExecute: C,
      closeAndNavigate: function (b) {
        p.location.href = b
        a.trigger('turbo:checkout:sheet:onNavigateAway')
        x({ notify: !1, doNotLog: !0 })
      },
      registerCallbacks: h.registerCallbacks,
      updateBounds: function (a) {
        E.updateBounds(a)
      },
      getHeight: function () {
        return E.getHeight()
      },
      updateBottomSheetAttributes: function () {},
    }
  })
  ;('use strict')
  f.declare('turbo-checkout-is-touch-and-orientation-enabled', !1)
})
/* ******** */
;(function (e) {
  var f = window.AmazonUIPageJS || window.P,
    g = f._namespace || f.attributeErrors,
    a = g ? g('DetailPageTurboCheckoutDesktopAssets', '') : f
  a.guardFatal
    ? a.guardFatal(e)(a, window)
    : a.execute(function () {
        e(a, window)
      })
})(function (e, f, g) {
  e.when(
    'turbo-configuration-keys',
    'turbo-product-state-key',
    'turbo-state-parsing-root-node-selector',
    'turbo-checkout-page-ready',
  ).register('turbo-client-configuration', function (a, e, f) {
    var g =
        'asin sessionID timestamp qid sr offeringID buyNow addressID registryID registryItemID quantity rebateId triggerTurboWeblab triggerTurboWeblabName turboPageRequestId turboPageSessionId pipelineType referrer ref_ isBuyNow anti-csrftoken-a2z items[0.base][customerVisiblePrice][amount] items[0.base][customerVisiblePrice][currencyCode] items[0.base][customerVisiblePrice][displayString] items[0.base][asin] clientName items[0.base][offerListingId] pageLoadTimestampUTC offerListingID session-id ASIN isMerchantExclusive merchantID isAddon nodeID sellingCustomerID storeID tagActionCode viewID ctaDeviceType ctaPageType usePrimeHandler smokeTestEnabled rsid sourceCustomerOrgListID sourceCustomerOrgListItemID wlPopCommand items[0.base][quantity] submit.buy-now dropdown-selection dropdown-selection-ubb skipCart custom-name.1.1 custom-value.1.1 custom-name.1.incentivizedCart custom-value.1.incentivizedCart items[0.base][additionalParameters][incentivizedCart] ue_back'.split(
          ' ',
        ),
      h = [],
      c = {}
    g.forEach(function (a) {
      c[a] = 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581'
    })
    h.forEach(function (a) {
      c[a] = 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_PARAMETER_ELIGIBILITY_REVERSE_DESKTOP_1089853'
    })
    c['items[0.base][additionalParameters][giftOptions][includeGiftReceipt]'] =
      'UPMT_CHECKOUT_BUY_NOW_GIFT_TANGO_DESKTOP_1044576'
    c['gift-wrap'] = 'UPMT_CHECKOUT_BUY_NOW_GIFT_TANGO_DESKTOP_1044576'
    c.paymentOfferInfo = 'PAX_CHECKOUT_BUY_NOW_UFO_TANGO_DESKTOP_1118473'
    c['items[0.base][additionalParameters][paymentOfferInfo]'] =
      'PAX_CHECKOUT_BUY_NOW_UFO_TANGO_DESKTOP_1118473'
    c.inHouseInstallments = 'PAX_CHECKOUT_BUY_NOW_AMP_TANGO_DESKTOP_1118500'
    c['installments-check'] = 'PAX_CHECKOUT_BUY_NOW_AMP_TANGO_DESKTOP_1118500'
    c.isInstallmentsChecked = 'PAX_CHECKOUT_BUY_NOW_AMP_TANGO_DESKTOP_1118500'
    c['items[0.base][additionalParameters][installments][programId]'] =
      'PAX_CHECKOUT_BUY_NOW_AMP_TANGO_DESKTOP_1118500'
    c['installments-programId'] = 'PAX_CHECKOUT_BUY_NOW_AMP_TANGO_DESKTOP_1118500'
    var d = {}
    g.forEach(function (a) {
      d[a] = 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576'
    })
    h.forEach(function (a) {
      d[a] = 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_PARAMETER_ELIGIBILITY_REVERSE_DESKTOP_1089853'
    })
    d['items[0.base][additionalParameters][giftOptions][includeGiftReceipt]'] =
      'UPMT_CHECKOUT_BUY_NOW_GIFT_TANGO_DESKTOP_1044576'
    d['gift-wrap'] = 'UPMT_CHECKOUT_BUY_NOW_GIFT_TANGO_DESKTOP_1044576'
    d.paymentOfferInfo = 'PAX_CHECKOUT_BUY_NOW_UFO_TANGO_DESKTOP_1118473'
    d['items[0.base][additionalParameters][paymentOfferInfo]'] =
      'PAX_CHECKOUT_BUY_NOW_UFO_TANGO_DESKTOP_1118473'
    d.inHouseInstallments = 'PAX_CHECKOUT_BUY_NOW_AMP_TANGO_DESKTOP_1118500'
    d['installments-check'] = 'PAX_CHECKOUT_BUY_NOW_AMP_TANGO_DESKTOP_1118500'
    d.isInstallmentsChecked = 'PAX_CHECKOUT_BUY_NOW_AMP_TANGO_DESKTOP_1118500'
    d['items[0.base][additionalParameters][installments][programId]'] =
      'PAX_CHECKOUT_BUY_NOW_AMP_TANGO_DESKTOP_1118500'
    d['installments-programId'] = 'PAX_CHECKOUT_BUY_NOW_AMP_TANGO_DESKTOP_1118500'
    if (!b) {
      var b = {}
      b[a.HOST_PAGE_TYPE_IDENTIFIER] = 'detail'
      b[a.IS_BUY_NOW_TO_TANGO_ENABLED] = !0
      b[a.IS_BUY_NOW_TO_TANGO_PRIME_SPLIT] = !0
      b[a.BUY_NOW_TO_TANGO_PARAMETER_ALLOW_LIST_PRIME] = {
        asin: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        sessionID: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        timestamp: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        qid: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        sr: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        offeringID: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        buyNow: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        addressID: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        registryID: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        registryItemID: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        quantity: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        rebateId: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        triggerTurboWeblab: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        triggerTurboWeblabName: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        turboPageRequestId: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        turboPageSessionId: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        pipelineType: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        referrer: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        ref_: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        isBuyNow: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        'anti-csrftoken-a2z': 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        'items[0.base][customerVisiblePrice][amount]':
          'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        'items[0.base][customerVisiblePrice][currencyCode]':
          'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        'items[0.base][customerVisiblePrice][displayString]':
          'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        'items[0.base][asin]': 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        clientName: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        'items[0.base][offerListingId]': 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        pageLoadTimestampUTC: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        offerListingID: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        'session-id': 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        ASIN: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        isMerchantExclusive: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        merchantID: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        isAddon: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        nodeID: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        sellingCustomerID: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        storeID: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        tagActionCode: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        viewID: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        ctaDeviceType: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        ctaPageType: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        usePrimeHandler: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        smokeTestEnabled: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        rsid: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        sourceCustomerOrgListID: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        sourceCustomerOrgListItemID: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        wlPopCommand: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        'items[0.base][quantity]': 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        'submit.buy-now': 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        'dropdown-selection': 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        'dropdown-selection-ubb': 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        skipCart: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        'custom-name.1.1': 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        'custom-value.1.1': 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        'custom-name.1.incentivizedCart': 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        'custom-value.1.incentivizedCart':
          'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        'items[0.base][additionalParameters][incentivizedCart]':
          'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        ue_back: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_969581',
        'items[0.base][additionalParameters][giftOptions][includeGiftReceipt]':
          'UPMT_CHECKOUT_BUY_NOW_GIFT_TANGO_DESKTOP_1044576',
        'gift-wrap': 'UPMT_CHECKOUT_BUY_NOW_GIFT_TANGO_DESKTOP_1044576',
        paymentOfferInfo: 'PAX_CHECKOUT_BUY_NOW_UFO_TANGO_DESKTOP_1118473',
        'items[0.base][additionalParameters][paymentOfferInfo]':
          'PAX_CHECKOUT_BUY_NOW_UFO_TANGO_DESKTOP_1118473',
        inHouseInstallments: 'PAX_CHECKOUT_BUY_NOW_AMP_TANGO_DESKTOP_1118500',
        'installments-check': 'PAX_CHECKOUT_BUY_NOW_AMP_TANGO_DESKTOP_1118500',
        isInstallmentsChecked: 'PAX_CHECKOUT_BUY_NOW_AMP_TANGO_DESKTOP_1118500',
        'items[0.base][additionalParameters][installments][programId]':
          'PAX_CHECKOUT_BUY_NOW_AMP_TANGO_DESKTOP_1118500',
        'installments-programId': 'PAX_CHECKOUT_BUY_NOW_AMP_TANGO_DESKTOP_1118500',
      }
      b[a.BUY_NOW_TO_TANGO_PARAMETER_ALLOW_LIST_NON_PRIME] = {
        asin: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        sessionID: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        timestamp: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        qid: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        sr: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        offeringID: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        buyNow: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        addressID: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        registryID: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        registryItemID: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        quantity: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        rebateId: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        triggerTurboWeblab: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        triggerTurboWeblabName:
          'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        turboPageRequestId: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        turboPageSessionId: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        pipelineType: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        referrer: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        ref_: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        isBuyNow: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        'anti-csrftoken-a2z': 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        'items[0.base][customerVisiblePrice][amount]':
          'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        'items[0.base][customerVisiblePrice][currencyCode]':
          'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        'items[0.base][customerVisiblePrice][displayString]':
          'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        'items[0.base][asin]': 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        clientName: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        'items[0.base][offerListingId]':
          'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        pageLoadTimestampUTC: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        offerListingID: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        'session-id': 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        ASIN: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        isMerchantExclusive: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        merchantID: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        isAddon: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        nodeID: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        sellingCustomerID: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        storeID: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        tagActionCode: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        viewID: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        ctaDeviceType: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        ctaPageType: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        usePrimeHandler: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        smokeTestEnabled: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        rsid: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        sourceCustomerOrgListID:
          'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        sourceCustomerOrgListItemID:
          'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        wlPopCommand: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        'items[0.base][quantity]':
          'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        'submit.buy-now': 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        'dropdown-selection': 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        'dropdown-selection-ubb':
          'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        skipCart: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        'custom-name.1.1': 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        'custom-value.1.1': 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        'custom-name.1.incentivizedCart':
          'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        'custom-value.1.incentivizedCart':
          'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        'items[0.base][additionalParameters][incentivizedCart]':
          'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        ue_back: 'PAX_CHECKOUT_BUY_NOW_TO_TANGO_DESKTOP_EXPERIMENT_NON_PRIME_1088576',
        'items[0.base][additionalParameters][giftOptions][includeGiftReceipt]':
          'UPMT_CHECKOUT_BUY_NOW_GIFT_TANGO_DESKTOP_1044576',
        'gift-wrap': 'UPMT_CHECKOUT_BUY_NOW_GIFT_TANGO_DESKTOP_1044576',
        paymentOfferInfo: 'PAX_CHECKOUT_BUY_NOW_UFO_TANGO_DESKTOP_1118473',
        'items[0.base][additionalParameters][paymentOfferInfo]':
          'PAX_CHECKOUT_BUY_NOW_UFO_TANGO_DESKTOP_1118473',
        inHouseInstallments: 'PAX_CHECKOUT_BUY_NOW_AMP_TANGO_DESKTOP_1118500',
        'installments-check': 'PAX_CHECKOUT_BUY_NOW_AMP_TANGO_DESKTOP_1118500',
        isInstallmentsChecked: 'PAX_CHECKOUT_BUY_NOW_AMP_TANGO_DESKTOP_1118500',
        'items[0.base][additionalParameters][installments][programId]':
          'PAX_CHECKOUT_BUY_NOW_AMP_TANGO_DESKTOP_1118500',
        'installments-programId': 'PAX_CHECKOUT_BUY_NOW_AMP_TANGO_DESKTOP_1118500',
      }
      b[a.BUY_NOW_TO_TANGO_PARAMETER_EXCLUSION_LIST_PRIME] = c
      b[a.BUY_NOW_TO_TANGO_PARAMETER_EXCLUSION_LIST_NON_PRIME] = d
      b[a.BUY_NOW_ONLY_TREATMENT] = 'T1'
      b[a.NO_PREFETCH_TREATMENT] = /T[2-9]/
      b[a.ADDRESS_INPUT_SELECTORS] = [
        '#unifiedLocation1ClickAddress',
        "#addToCart input[name\x3d'dropdown-selection']",
        '#unifiedLocationAddress',
        "input[name\x3d'dropdown-selection']",
      ]
      b[a.QUANTITY_SELECT_SELECTOR] = '#quantity'
      b[a.CONFLICTING_INITIATE_LISTENERS] = ['click.siatc']
      b[a.VAS_CHANGE_EVENTS] = [
        'vas:remove-service-asin-buybox-event',
        'vas:add-service-asin-buybox-event',
      ]
      b[a.VAS_CHECKBOX_SELCTOR] = '#ppdb-add-service-checkbox'
      b[a.SESSION_ID_SELECTOR] = 'input[name\x3d"session-id"]'
      b[a.TURBO_PRODUCT_STATE_KEY] = e
      b[a.PAGE_STATE_PARSING_ROOT_NODE_SELECTOR] = f
      b[a.PRODUCT_STATE_PARSING_ROOT_NODE_SELECTOR] = f
    }
    return b
  })
  ;('use strict')
  e.when('turbo-checkout-page-ready').execute(function () {
    e.declare('turbo-product-state-key', 'turbo-checkout-page-state')
  })
  ;('use strict')
  e.when('turbo-checkout-page-ready').execute(function () {
    e.declare('turbo-state-parsing-root-node-selector', '#turboState')
  })
})
/* ******** */
